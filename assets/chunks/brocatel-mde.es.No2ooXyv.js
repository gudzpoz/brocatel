import{d as Dt,j as zt,Y as Xi,I as ct,F as hp,N as Fs,k as S1,z as w1,ai as x1,aj as wc,ak as _$,al as F$,G as ni,am as cp,h as ps,an as U$,x as nn,ao as G$,o as an,b as v1,w as xu,m as de,S as H$,c as ri,n as Yl,l as pe,a as ca,t as Rh,e as Eh,ap as lf,aq as af,J as K$,ar as J$,P as eP}from"./framework.CPGI-sM3.js";import{t as tP,u as vu,r as $u,c as fa,g as nP,e as fp,v as Lr,S as vg,N as iP,Z as rP,R as sP}from"./brocatel-md.es.nkvA-ni7.js";var St=(i=>(i.docTypeError="docTypeError",i.contextNotFound="contextNotFound",i.timerNotFound="timerNotFound",i.ctxCallOutOfScope="ctxCallOutOfScope",i.createNodeInParserFail="createNodeInParserFail",i.stackOverFlow="stackOverFlow",i.parserMatchError="parserMatchError",i.serializerMatchError="serializerMatchError",i.getAtomFromSchemaFail="getAtomFromSchemaFail",i.expectDomTypeError="expectDomTypeError",i.callCommandBeforeEditorView="callCommandBeforeEditorView",i.missingRootElement="missingRootElement",i.missingNodeInSchema="missingNodeInSchema",i.missingMarkInSchema="missingMarkInSchema",i.ctxNotBind="ctxNotBind",i.missingYjsDoc="missingYjsDoc",i))(St||{});let It=class extends Error{constructor(e,t){super(t),this.name="MilkdownError",this.code=e}};const oP=(i,e)=>typeof e=="function"?"[Function]":e,As=i=>JSON.stringify(i,oP);function lP(i){return new It(St.docTypeError,`Doc type error, unsupported type: ${As(i)}`)}function aP(i){return new It(St.contextNotFound,`Context "${i}" not found, do you forget to inject it?`)}function hP(i){return new It(St.timerNotFound,`Timer "${i}" not found, do you forget to record it?`)}function up(){return new It(St.ctxCallOutOfScope,"Should not call a context out of the plugin.")}function cP(...i){const e=i.reduce((t,n)=>{if(!n)return t;const r=s=>Array.isArray(s)?s.map(o=>r(o)).join(", "):s.toJSON?As(s.toJSON()):s.spec?As(s.spec):s.toString();return`${t}, ${r(n)}`},"Create prosemirror node from remark failed in parser");return new It(St.createNodeInParserFail,e)}function $1(){return new It(St.stackOverFlow,"Stack over flow, cannot pop on an empty stack.")}function fP(i){return new It(St.parserMatchError,`Cannot match target parser for node: ${As(i)}.`)}function uP(i){return new It(St.serializerMatchError,`Cannot match target serializer for node: ${As(i)}.`)}function dP(i,e){return new It(St.getAtomFromSchemaFail,`Cannot get ${i}: ${e} from schema.`)}function zr(i){return new It(St.expectDomTypeError,`Expect to be a dom, but get: ${As(i)}.`)}function pP(){return new It(St.callCommandBeforeEditorView,"You're trying to call a command before editor view initialized, make sure to get commandManager from ctx after editor view has been initialized")}function mP(i){return new It(St.missingNodeInSchema,`Missing node in schema, milkdown cannot find "${i}" in schema.`)}function gP(i){return new It(St.missingMarkInSchema,`Missing mark in schema, milkdown cannot find "${i}" in schema.`)}var P1=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)},D=(i,e,t)=>(P1(i,e,"read from private field"),t?t.call(i):e.get(i)),we=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},ee=(i,e,t,n)=>(P1(i,e,"write to private field"),n?n.call(i,t):e.set(i,t),t);let Q1=class{constructor(){this.sliceMap=new Map,this.get=e=>{const t=typeof e=="string"?[...this.sliceMap.values()].find(n=>n.type.name===e):this.sliceMap.get(e.id);if(!t){const n=typeof e=="string"?e:e.name;throw aP(n)}return t},this.remove=e=>{const t=typeof e=="string"?[...this.sliceMap.values()].find(n=>n.type.name===e):this.sliceMap.get(e.id);t&&this.sliceMap.delete(t.type.id)},this.has=e=>typeof e=="string"?[...this.sliceMap.values()].some(t=>t.type.name===e):this.sliceMap.has(e.id)}};var vn,Oi,yo;let OP=class{constructor(e,t,n){we(this,vn,void 0),we(this,Oi,void 0),we(this,yo,void 0),ee(this,vn,[]),ee(this,yo,()=>{D(this,vn).forEach(r=>r(D(this,Oi)))}),this.set=r=>{ee(this,Oi,r),D(this,yo).call(this)},this.get=()=>D(this,Oi),this.update=r=>{ee(this,Oi,r(D(this,Oi))),D(this,yo).call(this)},this.type=n,ee(this,Oi,t),e.set(n.id,this)}on(e){return D(this,vn).push(e),()=>{ee(this,vn,D(this,vn).filter(t=>t!==e))}}once(e){const t=this.on(n=>{e(n),t()});return t}off(e){ee(this,vn,D(this,vn).filter(t=>t!==e))}offAll(){ee(this,vn,[])}};vn=new WeakMap,Oi=new WeakMap,yo=new WeakMap;let yP=class{constructor(e,t){this.id=Symbol(`Context-${t}`),this.name=t,this._defaultValue=e,this._typeInfo=()=>{throw up()}}create(e,t=this._defaultValue){return new OP(e,t,this)}};const ne=(i,e)=>new yP(i,e);var za,Ya,ja,Hr,ko,or,bo,So,wo;let kP=class{constructor(e,t,n){we(this,za,void 0),we(this,Ya,void 0),we(this,ja,void 0),we(this,Hr,void 0),we(this,ko,void 0),we(this,or,void 0),we(this,bo,void 0),we(this,So,void 0),we(this,wo,void 0),ee(this,Hr,new Set),ee(this,ko,new Set),ee(this,or,new Map),ee(this,bo,new Map),this.read=()=>({metadata:D(this,za),injectedSlices:[...D(this,Hr)].map(r=>({name:typeof r=="string"?r:r.name,value:D(this,So).call(this,r)})),consumedSlices:[...D(this,ko)].map(r=>({name:typeof r=="string"?r:r.name,value:D(this,So).call(this,r)})),recordedTimers:[...D(this,or)].map(([r,{duration:s}])=>({name:r.name,duration:s,status:D(this,wo).call(this,r)})),waitTimers:[...D(this,bo)].map(([r,{duration:s}])=>({name:r.name,duration:s,status:D(this,wo).call(this,r)}))}),this.onRecord=r=>{D(this,or).set(r,{start:Date.now(),duration:0})},this.onClear=r=>{D(this,or).delete(r)},this.onDone=r=>{const s=D(this,or).get(r);s&&(s.duration=Date.now()-s.start)},this.onWait=(r,s)=>{const o=Date.now();s.finally(()=>{D(this,bo).set(r,{duration:Date.now()-o})})},this.onInject=r=>{D(this,Hr).add(r)},this.onRemove=r=>{D(this,Hr).delete(r)},this.onUse=r=>{D(this,ko).add(r)},ee(this,So,r=>D(this,Ya).get(r).get()),ee(this,wo,r=>D(this,ja).get(r).status),ee(this,Ya,e),ee(this,ja,t),ee(this,za,n)}};za=new WeakMap,Ya=new WeakMap,ja=new WeakMap,Hr=new WeakMap,ko=new WeakMap,or=new WeakMap,bo=new WeakMap,So=new WeakMap,wo=new WeakMap;var yi,ki,_a,tn;const bP=class C1{constructor(e,t,n){we(this,yi,void 0),we(this,ki,void 0),we(this,_a,void 0),we(this,tn,void 0),this.produce=r=>r&&Object.keys(r).length?new C1(D(this,yi),D(this,ki),{...r}):this,this.inject=(r,s)=>{var o;const l=r.create(D(this,yi).sliceMap);return s!=null&&l.set(s),(o=D(this,tn))==null||o.onInject(r),this},this.remove=r=>{var s;return D(this,yi).remove(r),(s=D(this,tn))==null||s.onRemove(r),this},this.record=r=>{var s;return r.create(D(this,ki).store),(s=D(this,tn))==null||s.onRecord(r),this},this.clearTimer=r=>{var s;return D(this,ki).remove(r),(s=D(this,tn))==null||s.onClear(r),this},this.isInjected=r=>D(this,yi).has(r),this.isRecorded=r=>D(this,ki).has(r),this.use=r=>{var s;return(s=D(this,tn))==null||s.onUse(r),D(this,yi).get(r)},this.get=r=>this.use(r).get(),this.set=(r,s)=>this.use(r).set(s),this.update=(r,s)=>this.use(r).update(s),this.timer=r=>D(this,ki).get(r),this.done=r=>{var s;this.timer(r).done(),(s=D(this,tn))==null||s.onDone(r)},this.wait=r=>{var s;const o=this.timer(r).start();return(s=D(this,tn))==null||s.onWait(r,o),o},this.waitTimers=async r=>{await Promise.all(this.get(r).map(s=>this.wait(s)))},ee(this,yi,e),ee(this,ki,t),ee(this,_a,n),n&&ee(this,tn,new kP(e,t,n))}get meta(){return D(this,_a)}get inspector(){return D(this,tn)}};yi=new WeakMap,ki=new WeakMap,_a=new WeakMap,tn=new WeakMap;let SP=bP,wP=class{constructor(){this.store=new Map,this.get=e=>{const t=this.store.get(e.id);if(!t)throw hP(e.name);return t},this.remove=e=>{this.store.delete(e.id)},this.has=e=>this.store.has(e.id)}};var Kr,lr,xo,bi,vo,Fa;let xP=class{constructor(e,t){we(this,Kr,void 0),we(this,lr,void 0),we(this,xo,void 0),we(this,bi,void 0),we(this,vo,void 0),we(this,Fa,void 0),ee(this,Kr,null),ee(this,lr,null),ee(this,bi,"pending"),this.start=()=>(D(this,Kr)??ee(this,Kr,new Promise((n,r)=>{ee(this,lr,s=>{s instanceof CustomEvent&&s.detail.id===D(this,xo)&&(ee(this,bi,"resolved"),D(this,vo).call(this),s.stopImmediatePropagation(),n())}),D(this,Fa).call(this,()=>{D(this,bi)==="pending"&&ee(this,bi,"rejected"),D(this,vo).call(this),r(new Error(`Timing ${this.type.name} timeout.`))}),ee(this,bi,"pending"),addEventListener(this.type.name,D(this,lr))})),D(this,Kr)),this.done=()=>{const n=new CustomEvent(this.type.name,{detail:{id:D(this,xo)}});dispatchEvent(n)},ee(this,vo,()=>{D(this,lr)&&removeEventListener(this.type.name,D(this,lr))}),ee(this,Fa,n=>{setTimeout(()=>{n()},this.type.timeout)}),ee(this,xo,Symbol(t.name)),this.type=t,e.set(t.id,this)}get status(){return D(this,bi)}};Kr=new WeakMap,lr=new WeakMap,xo=new WeakMap,bi=new WeakMap,vo=new WeakMap,Fa=new WeakMap;let vP=class{constructor(e,t=3e3){this.create=n=>new xP(n,this),this.id=Symbol(`Timer-${e}`),this.name=e,this.timeout=t}};const Ki=(i,e=3e3)=>new vP(i,e);function Xe(i){this.content=i}Xe.prototype={constructor:Xe,find:function(i){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===i)return e;return-1},get:function(i){var e=this.find(i);return e==-1?void 0:this.content[e+1]},update:function(i,e,t){var n=t&&t!=i?this.remove(t):this,r=n.find(i),s=n.content.slice();return r==-1?s.push(t||i,e):(s[r+1]=e,t&&(s[r]=t)),new Xe(s)},remove:function(i){var e=this.find(i);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new Xe(t)},addToStart:function(i,e){return new Xe([i,e].concat(this.remove(i).content))},addToEnd:function(i,e){var t=this.remove(i).content.slice();return t.push(i,e),new Xe(t)},addBefore:function(i,e,t){var n=this.remove(e),r=n.content.slice(),s=n.find(i);return r.splice(s==-1?r.length:s,0,e,t),new Xe(r)},forEach:function(i){for(var e=0;e<this.content.length;e+=2)i(this.content[e],this.content[e+1])},prepend:function(i){return i=Xe.from(i),i.size?new Xe(i.content.concat(this.subtract(i).content)):this},append:function(i){return i=Xe.from(i),i.size?new Xe(this.subtract(i).content.concat(i.content)):this},subtract:function(i){var e=this;i=Xe.from(i);for(var t=0;t<i.content.length;t+=2)e=e.remove(i.content[t]);return e},toObject:function(){var i={};return this.forEach(function(e,t){i[e]=t}),i},get size(){return this.content.length>>1}};Xe.from=function(i){if(i instanceof Xe)return i;var e=[];if(i)for(var t in i)e.push(t,i[t]);return new Xe(e)};function T1(i,e,t){for(let n=0;;n++){if(n==i.childCount||n==e.childCount)return i.childCount==e.childCount?null:t;let r=i.child(n),s=e.child(n);if(r==s){t+=r.nodeSize;continue}if(!r.sameMarkup(s))return t;if(r.isText&&r.text!=s.text){for(let o=0;r.text[o]==s.text[o];o++)t++;return t}if(r.content.size||s.content.size){let o=T1(r.content,s.content,t+1);if(o!=null)return o}t+=r.nodeSize}}function M1(i,e,t,n){for(let r=i.childCount,s=e.childCount;;){if(r==0||s==0)return r==s?null:{a:t,b:n};let o=i.child(--r),l=e.child(--s),a=o.nodeSize;if(o==l){t-=a,n-=a;continue}if(!o.sameMarkup(l))return{a:t,b:n};if(o.isText&&o.text!=l.text){let h=0,c=Math.min(o.text.length,l.text.length);for(;h<c&&o.text[o.text.length-h-1]==l.text[l.text.length-h-1];)h++,t--,n--;return{a:t,b:n}}if(o.content.size||l.content.size){let h=M1(o.content,l.content,t-1,n-1);if(h)return h}t-=a,n-=a}}class P{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let n=0;n<e.length;n++)this.size+=e[n].nodeSize}nodesBetween(e,t,n,r=0,s){for(let o=0,l=0;l<t;o++){let a=this.content[o],h=l+a.nodeSize;if(h>e&&n(a,r+l,s||null,o)!==!1&&a.content.size){let c=l+1;a.nodesBetween(Math.max(0,e-c),Math.min(a.content.size,t-c),n,r+c)}l=h}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,n,r){let s="",o=!0;return this.nodesBetween(e,t,(l,a)=>{let h=l.isText?l.text.slice(Math.max(e,a)-a,t-a):l.isLeaf?r?typeof r=="function"?r(l):r:l.type.spec.leafText?l.type.spec.leafText(l):"":"";l.isBlock&&(l.isLeaf&&h||l.isTextblock)&&n&&(o?o=!1:s+=n),s+=h},0),s}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,n=e.firstChild,r=this.content.slice(),s=0;for(t.isText&&t.sameMarkup(n)&&(r[r.length-1]=t.withText(t.text+n.text),s=1);s<e.content.length;s++)r.push(e.content[s]);return new P(r,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let n=[],r=0;if(t>e)for(let s=0,o=0;o<t;s++){let l=this.content[s],a=o+l.nodeSize;a>e&&((o<e||a>t)&&(l.isText?l=l.cut(Math.max(0,e-o),Math.min(l.text.length,t-o)):l=l.cut(Math.max(0,e-o-1),Math.min(l.content.size,t-o-1))),n.push(l),r+=l.nodeSize),o=a}return new P(n,r)}cutByIndex(e,t){return e==t?P.empty:e==0&&t==this.content.length?this:new P(this.content.slice(e,t))}replaceChild(e,t){let n=this.content[e];if(n==t)return this;let r=this.content.slice(),s=this.size+t.nodeSize-n.nodeSize;return r[e]=t,new P(r,s)}addToStart(e){return new P([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new P(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,n=0;t<this.content.length;t++){let r=this.content[t];e(r,n,t),n+=r.nodeSize}}findDiffStart(e,t=0){return T1(this,e,t)}findDiffEnd(e,t=this.size,n=e.size){return M1(this,e,t,n)}findIndex(e,t=-1){if(e==0)return ua(0,e);if(e==this.size)return ua(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let n=0,r=0;;n++){let s=this.child(n),o=r+s.nodeSize;if(o>=e)return o==e||t>0?ua(n+1,o):ua(n,r);r=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return P.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new P(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return P.empty;let t,n=0;for(let r=0;r<e.length;r++){let s=e[r];n+=s.nodeSize,r&&s.isText&&e[r-1].sameMarkup(s)?(t||(t=e.slice(0,r)),t[t.length-1]=s.withText(t[t.length-1].text+s.text)):t&&t.push(s)}return new P(t||e,n)}static from(e){if(!e)return P.empty;if(e instanceof P)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new P([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}P.empty=new P([],0);const hf={index:0,offset:0};function ua(i,e){return hf.index=i,hf.offset=e,hf}function Nh(i,e){if(i===e)return!0;if(!(i&&typeof i=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(i);if(Array.isArray(e)!=t)return!1;if(t){if(i.length!=e.length)return!1;for(let n=0;n<i.length;n++)if(!Nh(i[n],e[n]))return!1}else{for(let n in i)if(!(n in e)||!Nh(i[n],e[n]))return!1;for(let n in e)if(!(n in i))return!1}return!0}class G{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,n=!1;for(let r=0;r<e.length;r++){let s=e[r];if(this.eq(s))return e;if(this.type.excludes(s.type))t||(t=e.slice(0,r));else{if(s.type.excludes(this.type))return e;!n&&s.type.rank>this.type.rank&&(t||(t=e.slice(0,r)),t.push(this),n=!0),t&&t.push(s)}}return t||(t=e.slice()),n||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Nh(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let n=e.marks[t.type];if(!n)throw new RangeError(`There is no mark type ${t.type} in this schema`);return n.create(t.attrs)}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].eq(t[n]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return G.none;if(e instanceof G)return[e];let t=e.slice();return t.sort((n,r)=>n.type.rank-r.type.rank),t}}G.none=[];class Dh extends Error{}class Z{constructor(e,t,n){this.content=e,this.openStart=t,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let n=Z1(this.content,e+this.openStart,t);return n&&new Z(n,this.openStart,this.openEnd)}removeBetween(e,t){return new Z(A1(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return Z.empty;let n=t.openStart||0,r=t.openEnd||0;if(typeof n!="number"||typeof r!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new Z(P.fromJSON(e,t.content),n,r)}static maxOpen(e,t=!0){let n=0,r=0;for(let s=e.firstChild;s&&!s.isLeaf&&(t||!s.type.spec.isolating);s=s.firstChild)n++;for(let s=e.lastChild;s&&!s.isLeaf&&(t||!s.type.spec.isolating);s=s.lastChild)r++;return new Z(e,n,r)}}Z.empty=new Z(P.empty,0,0);function A1(i,e,t){let{index:n,offset:r}=i.findIndex(e),s=i.maybeChild(n),{index:o,offset:l}=i.findIndex(t);if(r==e||s.isText){if(l!=t&&!i.child(o).isText)throw new RangeError("Removing non-flat range");return i.cut(0,e).append(i.cut(t))}if(n!=o)throw new RangeError("Removing non-flat range");return i.replaceChild(n,s.copy(A1(s.content,e-r-1,t-r-1)))}function Z1(i,e,t,n){let{index:r,offset:s}=i.findIndex(e),o=i.maybeChild(r);if(s==e||o.isText)return n&&!n.canReplace(r,r,t)?null:i.cut(0,e).append(t).append(i.cut(e));let l=Z1(o.content,e-s-1,t);return l&&i.replaceChild(r,o.copy(l))}function $P(i,e,t){if(t.openStart>i.depth)throw new Dh("Inserted content deeper than insertion position");if(i.depth-t.openStart!=e.depth-t.openEnd)throw new Dh("Inconsistent open depths");return R1(i,e,t,0)}function R1(i,e,t,n){let r=i.index(n),s=i.node(n);if(r==e.index(n)&&n<i.depth-t.openStart){let o=R1(i,e,t,n+1);return s.copy(s.content.replaceChild(r,o))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&i.depth==n&&e.depth==n){let o=i.parent,l=o.content;return $r(o,l.cut(0,i.parentOffset).append(t.content).append(l.cut(e.parentOffset)))}else{let{start:o,end:l}=PP(t,i);return $r(s,N1(i,o,l,e,n))}else return $r(s,Ih(i,e,n))}function E1(i,e){if(!e.type.compatibleContent(i.type))throw new Dh("Cannot join "+e.type.name+" onto "+i.type.name)}function Pu(i,e,t){let n=i.node(t);return E1(n,e.node(t)),n}function vr(i,e){let t=e.length-1;t>=0&&i.isText&&i.sameMarkup(e[t])?e[t]=i.withText(e[t].text+i.text):e.push(i)}function Fo(i,e,t,n){let r=(e||i).node(t),s=0,o=e?e.index(t):r.childCount;i&&(s=i.index(t),i.depth>t?s++:i.textOffset&&(vr(i.nodeAfter,n),s++));for(let l=s;l<o;l++)vr(r.child(l),n);e&&e.depth==t&&e.textOffset&&vr(e.nodeBefore,n)}function $r(i,e){return i.type.checkContent(e),i.copy(e)}function N1(i,e,t,n,r){let s=i.depth>r&&Pu(i,e,r+1),o=n.depth>r&&Pu(t,n,r+1),l=[];return Fo(null,i,r,l),s&&o&&e.index(r)==t.index(r)?(E1(s,o),vr($r(s,N1(i,e,t,n,r+1)),l)):(s&&vr($r(s,Ih(i,e,r+1)),l),Fo(e,t,r,l),o&&vr($r(o,Ih(t,n,r+1)),l)),Fo(n,null,r,l),new P(l)}function Ih(i,e,t){let n=[];if(Fo(null,i,t,n),i.depth>t){let r=Pu(i,e,t+1);vr($r(r,Ih(i,e,t+1)),n)}return Fo(e,null,t,n),new P(n)}function PP(i,e){let t=e.depth-i.openStart,r=e.node(t).copy(i.content);for(let s=t-1;s>=0;s--)r=e.node(s).copy(P.from(r));return{start:r.resolveNoCache(i.openStart+t),end:r.resolveNoCache(r.content.size-i.openEnd-t)}}class ul{constructor(e,t,n){this.pos=e,this.path=t,this.parentOffset=n,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let n=this.pos-this.path[this.path.length-1],r=e.child(t);return n?e.child(t).cut(n):r}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let n=this.path[t*3],r=t==0?0:this.path[t*3-1]+1;for(let s=0;s<e;s++)r+=n.child(s).nodeSize;return r}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return G.none;if(this.textOffset)return e.child(t).marks;let n=e.maybeChild(t-1),r=e.maybeChild(t);if(!n){let l=n;n=r,r=l}let s=n.marks;for(var o=0;o<s.length;o++)s[o].type.spec.inclusive===!1&&(!r||!s[o].isInSet(r.marks))&&(s=s[o--].removeFromSet(s));return s}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let n=t.marks,r=e.parent.maybeChild(e.index());for(var s=0;s<n.length;s++)n[s].type.spec.inclusive===!1&&(!r||!n[s].isInSet(r.marks))&&(n=n[s--].removeFromSet(n));return n}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);n>=0;n--)if(e.pos<=this.end(n)&&(!t||t(this.node(n))))return new D1(this,e,n);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let n=[],r=0,s=t;for(let o=e;;){let{index:l,offset:a}=o.content.findIndex(s),h=s-a;if(n.push(o,l,r+a),!h||(o=o.child(l),o.isText))break;s=h-1,r+=a+1}return new ul(t,n,s)}static resolveCached(e,t){for(let r=0;r<cf.length;r++){let s=cf[r];if(s.pos==t&&s.doc==e)return s}let n=cf[ff]=ul.resolve(e,t);return ff=(ff+1)%QP,n}}let cf=[],ff=0,QP=12;class D1{constructor(e,t,n){this.$from=e,this.$to=t,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const CP=Object.create(null);class hn{constructor(e,t,n,r=G.none){this.type=e,this.attrs=t,this.marks=r,this.content=n||P.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,n,r=0){this.content.nodesBetween(e,t,n,r,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,n,r){return this.content.textBetween(e,t,n,r)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,n){return this.type==e&&Nh(this.attrs,t||e.defaultAttrs||CP)&&G.sameSet(this.marks,n||G.none)}copy(e=null){return e==this.content?this:new hn(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new hn(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,n=!1){if(e==t)return Z.empty;let r=this.resolve(e),s=this.resolve(t),o=n?0:r.sharedDepth(t),l=r.start(o),h=r.node(o).content.cut(r.pos-l,s.pos-l);return new Z(h,r.depth-o,s.depth-o)}replace(e,t,n){return $P(this.resolve(e),this.resolve(t),n)}nodeAt(e){for(let t=this;;){let{index:n,offset:r}=t.content.findIndex(e);if(t=t.maybeChild(n),!t)return null;if(r==e||t.isText)return t;e-=r+1}}childAfter(e){let{index:t,offset:n}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:n}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:n}=this.content.findIndex(e);if(n<e)return{node:this.content.child(t),index:t,offset:n};let r=this.content.child(t-1);return{node:r,index:t-1,offset:n-r.nodeSize}}resolve(e){return ul.resolveCached(this,e)}resolveNoCache(e){return ul.resolve(this,e)}rangeHasMark(e,t,n){let r=!1;return t>e&&this.nodesBetween(e,t,s=>(n.isInSet(s.marks)&&(r=!0),!r)),r}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),I1(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,n=P.empty,r=0,s=n.childCount){let o=this.contentMatchAt(e).matchFragment(n,r,s),l=o&&o.matchFragment(this.content,t);if(!l||!l.validEnd)return!1;for(let a=r;a<s;a++)if(!this.type.allowsMarks(n.child(a).marks))return!1;return!0}canReplaceWith(e,t,n,r){if(r&&!this.type.allowsMarks(r))return!1;let s=this.contentMatchAt(e).matchType(n),o=s&&s.matchFragment(this.content,t);return o?o.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content);let e=G.none;for(let t=0;t<this.marks.length;t++)e=this.marks[t].addToSet(e);if(!G.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let n=null;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,n)}let r=P.fromJSON(e,t.content);return e.nodeType(t.type).create(t.attrs,r,n)}}hn.prototype.text=void 0;let TP=class Qu extends hn{constructor(e,t,n,r){if(super(e,t,null,r),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):I1(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Qu(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Qu(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}};function I1(i,e){for(let t=i.length-1;t>=0;t--)e=i[t].type.name+"("+e+")";return e}class Zr{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let n=new MP(e,t);if(n.next==null)return Zr.empty;let r=W1(n);n.next&&n.err("Unexpected trailing text");let s=IP(DP(r));return WP(s,n),s}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,n=e.childCount){let r=this;for(let s=t;r&&s<n;s++)r=r.matchType(e.child(s).type);return r}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let n=0;n<e.next.length;n++)if(this.next[t].type==e.next[n].type)return!0;return!1}fillBefore(e,t=!1,n=0){let r=[this];function s(o,l){let a=o.matchFragment(e,n);if(a&&(!t||a.validEnd))return P.from(l.map(h=>h.createAndFill()));for(let h=0;h<o.next.length;h++){let{type:c,next:f}=o.next[h];if(!(c.isText||c.hasRequiredAttrs())&&r.indexOf(f)==-1){r.push(f);let u=s(f,l.concat(c));if(u)return u}}return null}return s(this,[])}findWrapping(e){for(let n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==e)return this.wrapCache[n+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let r=n.shift(),s=r.match;if(s.matchType(e)){let o=[];for(let l=r;l.type;l=l.via)o.push(l.type);return o.reverse()}for(let o=0;o<s.next.length;o++){let{type:l,next:a}=s.next[o];!l.isLeaf&&!l.hasRequiredAttrs()&&!(l.name in t)&&(!r.type||a.validEnd)&&(n.push({match:l.contentMatch,type:l,via:r}),t[l.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(n){e.push(n);for(let r=0;r<n.next.length;r++)e.indexOf(n.next[r].next)==-1&&t(n.next[r].next)}return t(this),e.map((n,r)=>{let s=r+(n.validEnd?"*":" ")+" ";for(let o=0;o<n.next.length;o++)s+=(o?", ":"")+n.next[o].type.name+"->"+e.indexOf(n.next[o].next);return s}).join(`
`)}}Zr.empty=new Zr(!0);class MP{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function W1(i){let e=[];do e.push(AP(i));while(i.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function AP(i){let e=[];do e.push(ZP(i));while(i.next&&i.next!=")"&&i.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function ZP(i){let e=NP(i);for(;;)if(i.eat("+"))e={type:"plus",expr:e};else if(i.eat("*"))e={type:"star",expr:e};else if(i.eat("?"))e={type:"opt",expr:e};else if(i.eat("{"))e=RP(i,e);else break;return e}function $g(i){/\D/.test(i.next)&&i.err("Expected number, got '"+i.next+"'");let e=Number(i.next);return i.pos++,e}function RP(i,e){let t=$g(i),n=t;return i.eat(",")&&(i.next!="}"?n=$g(i):n=-1),i.eat("}")||i.err("Unclosed braced range"),{type:"range",min:t,max:n,expr:e}}function EP(i,e){let t=i.nodeTypes,n=t[e];if(n)return[n];let r=[];for(let s in t){let o=t[s];o.groups.indexOf(e)>-1&&r.push(o)}return r.length==0&&i.err("No node type or group '"+e+"' found"),r}function NP(i){if(i.eat("(")){let e=W1(i);return i.eat(")")||i.err("Missing closing paren"),e}else if(/\W/.test(i.next))i.err("Unexpected token '"+i.next+"'");else{let e=EP(i,i.next).map(t=>(i.inline==null?i.inline=t.isInline:i.inline!=t.isInline&&i.err("Mixing inline and block content"),{type:"name",value:t}));return i.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function DP(i){let e=[[]];return r(s(i,0),t()),e;function t(){return e.push([])-1}function n(o,l,a){let h={term:a,to:l};return e[o].push(h),h}function r(o,l){o.forEach(a=>a.to=l)}function s(o,l){if(o.type=="choice")return o.exprs.reduce((a,h)=>a.concat(s(h,l)),[]);if(o.type=="seq")for(let a=0;;a++){let h=s(o.exprs[a],l);if(a==o.exprs.length-1)return h;r(h,l=t())}else if(o.type=="star"){let a=t();return n(l,a),r(s(o.expr,a),a),[n(a)]}else if(o.type=="plus"){let a=t();return r(s(o.expr,l),a),r(s(o.expr,a),a),[n(a)]}else{if(o.type=="opt")return[n(l)].concat(s(o.expr,l));if(o.type=="range"){let a=l;for(let h=0;h<o.min;h++){let c=t();r(s(o.expr,a),c),a=c}if(o.max==-1)r(s(o.expr,a),a);else for(let h=o.min;h<o.max;h++){let c=t();n(a,c),r(s(o.expr,a),c),a=c}return[n(a)]}else{if(o.type=="name")return[n(l,void 0,o.value)];throw new Error("Unknown expr type")}}}}function X1(i,e){return e-i}function Pg(i,e){let t=[];return n(e),t.sort(X1);function n(r){let s=i[r];if(s.length==1&&!s[0].term)return n(s[0].to);t.push(r);for(let o=0;o<s.length;o++){let{term:l,to:a}=s[o];!l&&t.indexOf(a)==-1&&n(a)}}}function IP(i){let e=Object.create(null);return t(Pg(i,0));function t(n){let r=[];n.forEach(o=>{i[o].forEach(({term:l,to:a})=>{if(!l)return;let h;for(let c=0;c<r.length;c++)r[c][0]==l&&(h=r[c][1]);Pg(i,a).forEach(c=>{h||r.push([l,h=[]]),h.indexOf(c)==-1&&h.push(c)})})});let s=e[n.join(",")]=new Zr(n.indexOf(i.length-1)>-1);for(let o=0;o<r.length;o++){let l=r[o][1].sort(X1);s.next.push({type:r[o][0],next:e[l.join(",")]||t(l)})}return s}}function WP(i,e){for(let t=0,n=[i];t<n.length;t++){let r=n[t],s=!r.validEnd,o=[];for(let l=0;l<r.next.length;l++){let{type:a,next:h}=r.next[l];o.push(a.name),s&&!(a.isText||a.hasRequiredAttrs())&&(s=!1),n.indexOf(h)==-1&&n.push(h)}s&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function B1(i){let e=Object.create(null);for(let t in i){let n=i[t];if(!n.hasDefault)return null;e[t]=n.default}return e}function V1(i,e){let t=Object.create(null);for(let n in i){let r=e&&e[n];if(r===void 0){let s=i[n];if(s.hasDefault)r=s.default;else throw new RangeError("No value supplied for attribute "+n)}t[n]=r}return t}function q1(i){let e=Object.create(null);if(i)for(let t in i)e[t]=new XP(i[t]);return e}let Wh=class L1{constructor(e,t,n){this.name=e,this.schema=t,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=q1(n.attrs),this.defaultAttrs=B1(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Zr.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:V1(this.attrs,e)}create(e=null,t,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new hn(this,this.computeAttrs(e),P.from(t),G.setFrom(n))}createChecked(e=null,t,n){return t=P.from(t),this.checkContent(t),new hn(this,this.computeAttrs(e),t,G.setFrom(n))}createAndFill(e=null,t,n){if(e=this.computeAttrs(e),t=P.from(t),t.size){let o=this.contentMatch.fillBefore(t);if(!o)return null;t=o.append(t)}let r=this.contentMatch.matchFragment(t),s=r&&r.fillBefore(P.empty,!0);return s?new hn(this,e,t.append(s),G.setFrom(n)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let n=0;n<e.childCount;n++)if(!this.allowsMarks(e.child(n).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?t&&t.push(e[n]):t||(t=e.slice(0,n));return t?t.length?t:G.none:e}static compile(e,t){let n=Object.create(null);e.forEach((s,o)=>n[s]=new L1(s,t,o));let r=t.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(let s in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n}},XP=class{constructor(e){this.hasDefault=Object.prototype.hasOwnProperty.call(e,"default"),this.default=e.default}get isRequired(){return!this.hasDefault}};class xc{constructor(e,t,n,r){this.name=e,this.rank=t,this.schema=n,this.spec=r,this.attrs=q1(r.attrs),this.excluded=null;let s=B1(this.attrs);this.instance=s?new G(this,s):null}create(e=null){return!e&&this.instance?this.instance:new G(this,V1(this.attrs,e))}static compile(e,t){let n=Object.create(null),r=0;return e.forEach((s,o)=>n[s]=new xc(s,r++,t,o)),n}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}excludes(e){return this.excluded.indexOf(e)>-1}}let BP=class{constructor(e){this.cached=Object.create(null);let t=this.spec={};for(let r in e)t[r]=e[r];t.nodes=Xe.from(e.nodes),t.marks=Xe.from(e.marks||{}),this.nodes=Wh.compile(this.spec.nodes,this),this.marks=xc.compile(this.spec.marks,this);let n=Object.create(null);for(let r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");let s=this.nodes[r],o=s.spec.content||"",l=s.spec.marks;s.contentMatch=n[o]||(n[o]=Zr.parse(o,this.nodes)),s.inlineContent=s.contentMatch.inlineContent,s.markSet=l=="_"?null:l?Qg(this,l.split(" ")):l==""||!s.inlineContent?[]:null}for(let r in this.marks){let s=this.marks[r],o=s.spec.excludes;s.excluded=o==null?[s]:o==""?[]:Qg(this,o.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,n,r){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof Wh){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,n,r)}text(e,t){let n=this.nodes.text;return new TP(n,n.defaultAttrs,e,G.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return hn.fromJSON(this,e)}markFromJSON(e){return G.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}};function Qg(i,e){let t=[];for(let n=0;n<e.length;n++){let r=e[n],s=i.marks[r],o=s;if(s)t.push(s);else for(let l in i.marks){let a=i.marks[l];(r=="_"||a.spec.group&&a.spec.group.split(" ").indexOf(r)>-1)&&t.push(o=a)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[n]+"'")}return t}function VP(i){return i.tag!=null}function qP(i){return i.style!=null}class Rr{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[],t.forEach(n=>{VP(n)?this.tags.push(n):qP(n)&&this.styles.push(n)}),this.normalizeLists=!this.tags.some(n=>{if(!/^(ul|ol)\b/.test(n.tag)||!n.node)return!1;let r=e.nodes[n.node];return r.contentMatch.matchType(r)})}parse(e,t={}){let n=new Tg(this,t,!1);return n.addAll(e,t.from,t.to),n.finish()}parseSlice(e,t={}){let n=new Tg(this,t,!0);return n.addAll(e,t.from,t.to),Z.maxOpen(n.finish())}matchTag(e,t,n){for(let r=n?this.tags.indexOf(n)+1:0;r<this.tags.length;r++){let s=this.tags[r];if(YP(e,s.tag)&&(s.namespace===void 0||e.namespaceURI==s.namespace)&&(!s.context||t.matchesContext(s.context))){if(s.getAttrs){let o=s.getAttrs(e);if(o===!1)continue;s.attrs=o||void 0}return s}}}matchStyle(e,t,n,r){for(let s=r?this.styles.indexOf(r)+1:0;s<this.styles.length;s++){let o=this.styles[s],l=o.style;if(!(l.indexOf(e)!=0||o.context&&!n.matchesContext(o.context)||l.length>e.length&&(l.charCodeAt(e.length)!=61||l.slice(e.length+1)!=t))){if(o.getAttrs){let a=o.getAttrs(t);if(a===!1)continue;o.attrs=a||void 0}return o}}}static schemaRules(e){let t=[];function n(r){let s=r.priority==null?50:r.priority,o=0;for(;o<t.length;o++){let l=t[o];if((l.priority==null?50:l.priority)<s)break}t.splice(o,0,r)}for(let r in e.marks){let s=e.marks[r].spec.parseDOM;s&&s.forEach(o=>{n(o=Mg(o)),o.mark||o.ignore||o.clearMark||(o.mark=r)})}for(let r in e.nodes){let s=e.nodes[r].spec.parseDOM;s&&s.forEach(o=>{n(o=Mg(o)),o.node||o.ignore||o.mark||(o.node=r)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Rr(e,Rr.schemaRules(e)))}}const z1={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},LP={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Y1={ol:!0,ul:!0},Xh=1,Bh=2,Uo=4;function Cg(i,e,t){return e!=null?(e?Xh:0)|(e==="full"?Bh:0):i&&i.whitespace=="pre"?Xh|Bh:t&~Uo}class da{constructor(e,t,n,r,s,o,l){this.type=e,this.attrs=t,this.marks=n,this.pendingMarks=r,this.solid=s,this.options=l,this.content=[],this.activeMarks=G.none,this.stashMarks=[],this.match=o||(l&Uo?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(P.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let n=this.type.contentMatch,r;return(r=n.findWrapping(e.type))?(this.match=n,r):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Xh)){let n=this.content[this.content.length-1],r;if(n&&n.isText&&(r=/[ \t\r\n\u000c]+$/.exec(n.text))){let s=n;n.text.length==r[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-r[0].length))}}let t=P.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(P.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}popFromStashMark(e){for(let t=this.stashMarks.length-1;t>=0;t--)if(e.eq(this.stashMarks[t]))return this.stashMarks.splice(t,1)[0]}applyPending(e){for(let t=0,n=this.pendingMarks;t<n.length;t++){let r=n[t];(this.type?this.type.allowsMarkType(r.type):_P(r.type,e))&&!r.isInSet(this.activeMarks)&&(this.activeMarks=r.addToSet(this.activeMarks),this.pendingMarks=r.removeFromSet(this.pendingMarks))}}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!z1.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}let Tg=class{constructor(e,t,n){this.parser=e,this.options=t,this.isOpen=n,this.open=0;let r=t.topNode,s,o=Cg(null,t.preserveWhitespace,0)|(n?Uo:0);r?s=new da(r.type,r.attrs,G.none,G.none,!0,t.topMatch||r.type.contentMatch,o):n?s=new da(null,null,G.none,G.none,!0,null,o):s=new da(e.schema.topNodeType,null,G.none,G.none,!0,null,o),this.nodes=[s],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e){e.nodeType==3?this.addTextNode(e):e.nodeType==1&&this.addElement(e)}withStyleRules(e,t){let n=e.getAttribute("style");if(!n)return t();let r=this.readStyles(jP(n));if(!r)return;let[s,o]=r,l=this.top;for(let a=0;a<o.length;a++)this.removePendingMark(o[a],l);for(let a=0;a<s.length;a++)this.addPendingMark(s[a]);t();for(let a=0;a<s.length;a++)this.removePendingMark(s[a],l);for(let a=0;a<o.length;a++)this.addPendingMark(o[a])}addTextNode(e){let t=e.nodeValue,n=this.top;if(n.options&Bh||n.inlineContext(e)||/[^ \t\r\n\u000c]/.test(t)){if(n.options&Xh)n.options&Bh?t=t.replace(/\r\n?/g,`
`):t=t.replace(/\r?\n|\r/g," ");else if(t=t.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(t)&&this.open==this.nodes.length-1){let r=n.content[n.content.length-1],s=e.previousSibling;(!r||s&&s.nodeName=="BR"||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(t=t.slice(1))}t&&this.insertNode(this.parser.schema.text(t)),this.findInText(e)}else this.findInside(e)}addElement(e,t){let n=e.nodeName.toLowerCase(),r;Y1.hasOwnProperty(n)&&this.parser.normalizeLists&&zP(e);let s=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(r=this.parser.matchTag(e,this,t));if(s?s.ignore:LP.hasOwnProperty(n))this.findInside(e),this.ignoreFallback(e);else if(!s||s.skip||s.closeParent){s&&s.closeParent?this.open=Math.max(0,this.open-1):s&&s.skip.nodeType&&(e=s.skip);let o,l=this.top,a=this.needsBlock;if(z1.hasOwnProperty(n))l.content.length&&l.content[0].isInline&&this.open&&(this.open--,l=this.top),o=!0,l.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e);return}s&&s.skip?this.addAll(e):this.withStyleRules(e,()=>this.addAll(e)),o&&this.sync(l),this.needsBlock=a}else this.withStyleRules(e,()=>{this.addElementByRule(e,s,s.consuming===!1?r:void 0)})}leafFallback(e){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`))}ignoreFallback(e){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(e){let t=G.none,n=G.none;for(let r=0;r<e.length;r+=2)for(let s=void 0;;){let o=this.parser.matchStyle(e[r],e[r+1],this,s);if(!o)break;if(o.ignore)return null;if(o.clearMark?this.top.pendingMarks.concat(this.top.activeMarks).forEach(l=>{o.clearMark(l)&&(n=l.addToSet(n))}):t=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(t),o.consuming===!1)s=o;else break}return[t,n]}addElementByRule(e,t,n){let r,s,o;t.node?(s=this.parser.schema.nodes[t.node],s.isLeaf?this.insertNode(s.create(t.attrs))||this.leafFallback(e):r=this.enter(s,t.attrs||null,t.preserveWhitespace)):(o=this.parser.schema.marks[t.mark].create(t.attrs),this.addPendingMark(o));let l=this.top;if(s&&s.isLeaf)this.findInside(e);else if(n)this.addElement(e,n);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(a=>this.insertNode(a));else{let a=e;typeof t.contentElement=="string"?a=e.querySelector(t.contentElement):typeof t.contentElement=="function"?a=t.contentElement(e):t.contentElement&&(a=t.contentElement),this.findAround(e,a,!0),this.addAll(a)}r&&this.sync(l)&&this.open--,o&&this.removePendingMark(o,l)}addAll(e,t,n){let r=t||0;for(let s=t?e.childNodes[t]:e.firstChild,o=n==null?null:e.childNodes[n];s!=o;s=s.nextSibling,++r)this.findAtPoint(e,r),this.addDOM(s);this.findAtPoint(e,r)}findPlace(e){let t,n;for(let r=this.open;r>=0;r--){let s=this.nodes[r],o=s.findWrapping(e);if(o&&(!t||t.length>o.length)&&(t=o,n=s,!o.length)||s.solid)break}if(!t)return!1;this.sync(n);for(let r=0;r<t.length;r++)this.enterInner(t[r],null,!1);return!0}insertNode(e){if(e.isInline&&this.needsBlock&&!this.top.type){let t=this.textblockFromContext();t&&this.enterInner(t)}if(this.findPlace(e)){this.closeExtra();let t=this.top;t.applyPending(e.type),t.match&&(t.match=t.match.matchType(e.type));let n=t.activeMarks;for(let r=0;r<e.marks.length;r++)(!t.type||t.type.allowsMarkType(e.marks[r].type))&&(n=e.marks[r].addToSet(n));return t.content.push(e.mark(n)),!0}return!1}enter(e,t,n){let r=this.findPlace(e.create(t));return r&&this.enterInner(e,t,!0,n),r}enterInner(e,t=null,n=!1,r){this.closeExtra();let s=this.top;s.applyPending(e),s.match=s.match&&s.match.matchType(e);let o=Cg(e,r,s.options);s.options&Uo&&s.content.length==0&&(o|=Uo),this.nodes.push(new da(e,t,s.activeMarks,s.pendingMarks,n,null,o)),this.open++}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(e){for(let t=this.open;t>=0;t--)if(this.nodes[t]==e)return this.open=t,!0;return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let n=this.nodes[t].content;for(let r=n.length-1;r>=0;r--)e+=n[r].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==t&&(this.find[n].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,n){if(e!=t&&this.find)for(let r=0;r<this.find.length;r++)this.find[r].pos==null&&e.nodeType==1&&e.contains(this.find[r].node)&&t.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),n=this.options.context,r=!this.isOpen&&(!n||n.parent.type==this.nodes[0].type),s=-(n?n.depth+1:0)+(r?0:1),o=(l,a)=>{for(;l>=0;l--){let h=t[l];if(h==""){if(l==t.length-1||l==0)continue;for(;a>=s;a--)if(o(l-1,a))return!0;return!1}else{let c=a>0||a==0&&r?this.nodes[a].type:n&&a>=s?n.node(a-s).type:null;if(!c||c.name!=h&&c.groups.indexOf(h)==-1)return!1;a--}}return!0};return o(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let n=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let t in this.parser.schema.nodes){let n=this.parser.schema.nodes[t];if(n.isTextblock&&n.defaultAttrs)return n}}addPendingMark(e){let t=FP(e,this.top.pendingMarks);t&&this.top.stashMarks.push(t),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)}removePendingMark(e,t){for(let n=this.open;n>=0;n--){let r=this.nodes[n];if(r.pendingMarks.lastIndexOf(e)>-1)r.pendingMarks=e.removeFromSet(r.pendingMarks);else{r.activeMarks=e.removeFromSet(r.activeMarks);let o=r.popFromStashMark(e);o&&r.type&&r.type.allowsMarkType(o.type)&&(r.activeMarks=o.addToSet(r.activeMarks))}if(r==t)break}}};function zP(i){for(let e=i.firstChild,t=null;e;e=e.nextSibling){let n=e.nodeType==1?e.nodeName.toLowerCase():null;n&&Y1.hasOwnProperty(n)&&t?(t.appendChild(e),e=t):n=="li"?t=e:n&&(t=null)}}function YP(i,e){return(i.matches||i.msMatchesSelector||i.webkitMatchesSelector||i.mozMatchesSelector).call(i,e)}function jP(i){let e=/\s*([\w-]+)\s*:\s*([^;]+)/g,t,n=[];for(;t=e.exec(i);)n.push(t[1],t[2].trim());return n}function Mg(i){let e={};for(let t in i)e[t]=i[t];return e}function _P(i,e){let t=e.schema.nodes;for(let n in t){let r=t[n];if(!r.allowsMarkType(i))continue;let s=[],o=l=>{s.push(l);for(let a=0;a<l.edgeCount;a++){let{type:h,next:c}=l.edge(a);if(h==e||s.indexOf(c)<0&&o(c))return!0}};if(o(r.contentMatch))return!0}}function FP(i,e){for(let t=0;t<e.length;t++)if(i.eq(e[t]))return e[t]}class Zn{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},n){n||(n=uf(t).createDocumentFragment());let r=n,s=[];return e.forEach(o=>{if(s.length||o.marks.length){let l=0,a=0;for(;l<s.length&&a<o.marks.length;){let h=o.marks[a];if(!this.marks[h.type.name]){a++;continue}if(!h.eq(s[l][0])||h.type.spec.spanning===!1)break;l++,a++}for(;l<s.length;)r=s.pop()[1];for(;a<o.marks.length;){let h=o.marks[a++],c=this.serializeMark(h,o.isInline,t);c&&(s.push([h,r]),r.appendChild(c.dom),r=c.contentDOM||c.dom)}}r.appendChild(this.serializeNodeInner(o,t))}),n}serializeNodeInner(e,t){let{dom:n,contentDOM:r}=Zn.renderSpec(uf(t),this.nodes[e.type.name](e));if(r){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,r)}return n}serializeNode(e,t={}){let n=this.serializeNodeInner(e,t);for(let r=e.marks.length-1;r>=0;r--){let s=this.serializeMark(e.marks[r],e.isInline,t);s&&((s.contentDOM||s.dom).appendChild(n),n=s.dom)}return n}serializeMark(e,t,n={}){let r=this.marks[e.type.name];return r&&Zn.renderSpec(uf(n),r(e,t))}static renderSpec(e,t,n=null){if(typeof t=="string")return{dom:e.createTextNode(t)};if(t.nodeType!=null)return{dom:t};if(t.dom&&t.dom.nodeType!=null)return t;let r=t[0],s=r.indexOf(" ");s>0&&(n=r.slice(0,s),r=r.slice(s+1));let o,l=n?e.createElementNS(n,r):e.createElement(r),a=t[1],h=1;if(a&&typeof a=="object"&&a.nodeType==null&&!Array.isArray(a)){h=2;for(let c in a)if(a[c]!=null){let f=c.indexOf(" ");f>0?l.setAttributeNS(c.slice(0,f),c.slice(f+1),a[c]):l.setAttribute(c,a[c])}}for(let c=h;c<t.length;c++){let f=t[c];if(f===0){if(c<t.length-1||c>h)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:u,contentDOM:d}=Zn.renderSpec(e,f,n);if(l.appendChild(u),d){if(o)throw new RangeError("Multiple content holes");o=d}}}return{dom:l,contentDOM:o}}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Zn(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=Ag(e.nodes);return t.text||(t.text=n=>n.text),t}static marksFromSchema(e){return Ag(e.marks)}}function Ag(i){let e={};for(let t in i){let n=i[t].spec.toDOM;n&&(e[t]=n)}return e}function uf(i){return i.document||window.document}function Cu(i){const e=this;e.compiler=t;function t(n){return tP(n,{...e.data("settings"),...i,extensions:e.data("toMarkdownExtensions")||[]})}}var j1=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)},U=(i,e,t)=>(j1(i,e,"read from private field"),t?t.call(i):e.get(i)),Re=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},Oe=(i,e,t,n)=>(j1(i,e,"write to private field"),n?n.call(i,t):e.set(i,t),t);let _1=class{},F1=class{constructor(){this.elements=[],this.size=()=>this.elements.length,this.top=()=>this.elements.at(-1),this.push=e=>{var t;(t=this.top())==null||t.push(e)},this.open=e=>{this.elements.push(e)},this.close=()=>{const e=this.elements.pop();if(!e)throw $1();return e}}},UP=class U1 extends _1{constructor(e,t,n){super(),this.type=e,this.content=t,this.attrs=n}push(e,...t){this.content.push(e,...t)}pop(){return this.content.pop()}static create(e,t,n){return new U1(e,t,n)}};var $n,$o,Ua,Ga,Ha,Po,Qo;const Tu=class extends F1{constructor(e){super(),Re(this,$n,void 0),Re(this,$o,void 0),Re(this,Ua,void 0),Re(this,Ga,void 0),Re(this,Ha,void 0),Re(this,Po,void 0),Re(this,Qo,void 0),Oe(this,$n,G.none),Oe(this,$o,t=>t.isText),Oe(this,Ua,(t,n)=>{if(U(this,$o).call(this,t)&&U(this,$o).call(this,n)&&G.sameSet(t.marks,n.marks))return this.schema.text(t.text+n.text,t.marks)}),Oe(this,Ga,t=>{const n=Object.values({...this.schema.nodes,...this.schema.marks}).find(r=>r.spec.parseMarkdown.match(t));if(!n)throw fP(t);return n}),Oe(this,Ha,t=>{const n=U(this,Ga).call(this,t);n.spec.parseMarkdown.runner(this,t,n)}),this.injectRoot=(t,n,r)=>(this.openNode(n,r),this.next(t.children),this),this.openNode=(t,n)=>(this.open(UP.create(t,[],n)),this),Oe(this,Po,()=>{Oe(this,$n,G.none);const t=this.close();return U(this,Qo).call(this,t.type,t.attrs,t.content)}),this.closeNode=()=>(U(this,Po).call(this),this),Oe(this,Qo,(t,n,r)=>{const s=t.createAndFill(n,r,U(this,$n));if(!s)throw cP(t,n,r);return this.push(s),s}),this.addNode=(t,n,r)=>(U(this,Qo).call(this,t,n,r),this),this.openMark=(t,n)=>{const r=t.create(n);return Oe(this,$n,r.addToSet(U(this,$n))),this},this.closeMark=t=>(Oe(this,$n,t.removeFromSet(U(this,$n))),this),this.addText=t=>{const n=this.top();if(!n)throw $1();const r=n.pop(),s=this.schema.text(t,U(this,$n));if(!r)return n.push(s),this;const o=U(this,Ua).call(this,r,s);return o?(n.push(o),this):(n.push(r,s),this)},this.build=()=>{let t;do t=U(this,Po).call(this);while(this.size());return t},this.next=(t=[])=>([t].flat().forEach(n=>U(this,Ha).call(this,n)),this),this.toDoc=()=>this.build(),this.run=(t,n)=>{const r=t.runSync(t.parse(n),n);return this.next(r),this},this.schema=e}};$n=new WeakMap,$o=new WeakMap,Ua=new WeakMap,Ga=new WeakMap,Ha=new WeakMap,Po=new WeakMap,Qo=new WeakMap,Tu.create=(i,e)=>{const t=new Tu(i);return n=>(t.run(e,n),t.toDoc())};let GP=Tu;const Mu=class extends _1{constructor(e,t,n,r={}){super(),this.type=e,this.children=t,this.value=n,this.props=r,this.push=(s,...o)=>{this.children||(this.children=[]),this.children.push(s,...o)},this.pop=()=>{var s;return(s=this.children)==null?void 0:s.pop()}}};Mu.create=(i,e,t,n={})=>new Mu(i,e,t,n);let Zg=Mu;const HP=i=>Object.prototype.hasOwnProperty.call(i,"size");var Gn,Co,Ka,Ja,To,eh,Mo,th,Jr,Ao,nh,Zo;const Au=class extends F1{constructor(e){super(),Re(this,Gn,void 0),Re(this,Co,void 0),Re(this,Ka,void 0),Re(this,Ja,void 0),Re(this,To,void 0),Re(this,eh,void 0),Re(this,Mo,void 0),Re(this,th,void 0),Re(this,Jr,void 0),Re(this,Ao,void 0),Re(this,nh,void 0),Re(this,Zo,void 0),Oe(this,Gn,G.none),Oe(this,Co,t=>{const n=Object.values({...this.schema.nodes,...this.schema.marks}).find(r=>r.spec.toMarkdown.match(t));if(!n)throw uP(t.type);return n}),Oe(this,Ka,t=>U(this,Co).call(this,t).spec.toMarkdown.runner(this,t)),Oe(this,Ja,(t,n)=>U(this,Co).call(this,t).spec.toMarkdown.runner(this,t,n)),Oe(this,To,t=>{const{marks:n}=t,r=s=>s.type.spec.priority??50;[...n].sort((s,o)=>r(s)-r(o)).every(s=>!U(this,Ja).call(this,s,t))&&U(this,Ka).call(this,t),n.forEach(s=>U(this,Zo).call(this,s))}),Oe(this,eh,(t,n)=>{var r;if(t.type===n||((r=t.children)==null?void 0:r.length)!==1)return t;const s=h=>{var c;if(h.type===n)return h;if(((c=h.children)==null?void 0:c.length)!==1)return null;const[f]=h.children;return f?s(f):null},o=s(t);if(!o)return t;const l=o.children?[...o.children]:void 0,a={...t,children:l};return a.children=l,o.children=[a],o}),Oe(this,Mo,t=>{const{children:n}=t;return n&&(t.children=n.reduce((r,s,o)=>{if(o===0)return[s];const l=r.at(-1);if(l&&l.isMark&&s.isMark){s=U(this,eh).call(this,s,l.type);const{children:a,...h}=s,{children:c,...f}=l;if(s.type===l.type&&a&&c&&JSON.stringify(h)===JSON.stringify(f)){const u={...f,children:[...c,...a]};return r.slice(0,-1).concat(U(this,Mo).call(this,u))}}return r.concat(s)},[])),t}),Oe(this,th,t=>{const n={...t.props,type:t.type};return t.children&&(n.children=t.children),t.value&&(n.value=t.value),n}),this.openNode=(t,n,r)=>(this.open(Zg.create(t,void 0,n,r)),this),Oe(this,Jr,()=>{const t=this.close();return U(this,Ao).call(this,t.type,t.children,t.value,t.props)}),this.closeNode=()=>(U(this,Jr).call(this),this),Oe(this,Ao,(t,n,r,s)=>{const o=Zg.create(t,n,r,s),l=U(this,Mo).call(this,U(this,th).call(this,o));return this.push(l),l}),this.addNode=(t,n,r,s)=>(U(this,Ao).call(this,t,n,r,s),this),Oe(this,nh,(t,n,r,s)=>t.isInSet(U(this,Gn))?this:(Oe(this,Gn,t.addToSet(U(this,Gn))),this.openNode(n,r,{...s,isMark:!0}))),Oe(this,Zo,t=>{t.isInSet(U(this,Gn))&&(Oe(this,Gn,t.type.removeFromSet(U(this,Gn))),U(this,Jr).call(this))}),this.withMark=(t,n,r,s)=>(U(this,nh).call(this,t,n,r,s),this),this.closeMark=t=>(U(this,Zo).call(this,t),this),this.build=()=>{let t=null;do t=U(this,Jr).call(this);while(this.size());return t},this.next=t=>HP(t)?(t.forEach(n=>{U(this,To).call(this,n)}),this):(U(this,To).call(this,t),this),this.toString=t=>t.stringify(this.build()),this.run=t=>(this.next(t),this),this.schema=e}};Gn=new WeakMap,Co=new WeakMap,Ka=new WeakMap,Ja=new WeakMap,To=new WeakMap,eh=new WeakMap,Mo=new WeakMap,th=new WeakMap,Jr=new WeakMap,Ao=new WeakMap,nh=new WeakMap,Zo=new WeakMap,Au.create=(i,e)=>{const t=new Au(i);return n=>(t.run(n),t.toString(e))};let KP=Au;const G1=65535,H1=Math.pow(2,16);function JP(i,e){return i+e*H1}function Rg(i){return i&G1}function eQ(i){return(i-(i&G1))/H1}const K1=1,J1=2,ih=4,ek=8;class Zu{constructor(e,t,n){this.pos=e,this.delInfo=t,this.recover=n}get deleted(){return(this.delInfo&ek)>0}get deletedBefore(){return(this.delInfo&(K1|ih))>0}get deletedAfter(){return(this.delInfo&(J1|ih))>0}get deletedAcross(){return(this.delInfo&ih)>0}}class Tt{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&Tt.empty)return Tt.empty}recover(e){let t=0,n=Rg(e);if(!this.inverted)for(let r=0;r<n;r++)t+=this.ranges[r*3+2]-this.ranges[r*3+1];return this.ranges[n*3]+t+eQ(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,n){let r=0,s=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?r:0);if(a>e)break;let h=this.ranges[l+s],c=this.ranges[l+o],f=a+h;if(e<=f){let u=h?e==a?-1:e==f?1:t:t,d=a+r+(u<0?0:c);if(n)return d;let p=e==(t<0?a:f)?null:JP(l/3,e-a),m=e==a?J1:e==f?K1:ih;return(t<0?e!=a:e!=f)&&(m|=ek),new Zu(d,m,p)}r+=c-h}return n?e+r:new Zu(e+r,0,null)}touches(e,t){let n=0,r=Rg(t),s=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?n:0);if(a>e)break;let h=this.ranges[l+s],c=a+h;if(e<=c&&l==r*3)return!0;n+=this.ranges[l+o]-h}return!1}forEach(e){let t=this.inverted?2:1,n=this.inverted?1:2;for(let r=0,s=0;r<this.ranges.length;r+=3){let o=this.ranges[r],l=o-(this.inverted?s:0),a=o+(this.inverted?0:s),h=this.ranges[r+t],c=this.ranges[r+n];e(l,l+h,a,a+c),s+=c-h}}invert(){return new Tt(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Tt.empty:new Tt(e<0?[0,-e,0]:[0,0,e])}}Tt.empty=new Tt([]);class ms{constructor(e=[],t,n=0,r=e.length){this.maps=e,this.mirror=t,this.from=n,this.to=r}slice(e=0,t=this.maps.length){return new ms(this.maps,this.mirror,e,t)}copy(){return new ms(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,t){this.to=this.maps.push(e),t!=null&&this.setMirror(this.maps.length-1,t)}appendMapping(e){for(let t=0,n=this.maps.length;t<e.maps.length;t++){let r=e.getMirror(t);this.appendMap(e.maps[t],r!=null&&r<t?n+r:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,n=this.maps.length+e.maps.length;t>=0;t--){let r=e.getMirror(t);this.appendMap(e.maps[t].invert(),r!=null&&r>t?n-r-1:void 0)}}invert(){let e=new ms;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let n=this.from;n<this.to;n++)e=this.maps[n].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,n){let r=0;for(let s=this.from;s<this.to;s++){let o=this.maps[s],l=o.mapResult(e,t);if(l.recover!=null){let a=this.getMirror(s);if(a!=null&&a>s&&a<this.to){s=a,e=this.maps[a].recover(l.recover);continue}}r|=l.delInfo,e=l.pos}return n?e:new Zu(e,r,null)}}const df=Object.create(null);class Je{getMap(){return Tt.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=df[t.stepType];if(!n)throw new RangeError(`No step type ${t.stepType} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in df)throw new RangeError("Duplicate use of step JSON ID "+e);return df[e]=t,t.prototype.jsonID=e,t}}class Qe{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new Qe(e,null)}static fail(e){return new Qe(null,e)}static fromReplace(e,t,n,r){try{return Qe.ok(e.replace(t,n,r))}catch(s){if(s instanceof Dh)return Qe.fail(s.message);throw s}}}function dp(i,e,t){let n=[];for(let r=0;r<i.childCount;r++){let s=i.child(r);s.content.size&&(s=s.copy(dp(s.content,e,s))),s.isInline&&(s=e(s,t,r)),n.push(s)}return P.fromArray(n)}class ii extends Je{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=e.resolve(this.from),r=n.node(n.sharedDepth(this.to)),s=new Z(dp(t.content,(o,l)=>!o.isAtom||!l.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),r),t.openStart,t.openEnd);return Qe.fromReplace(e,this.from,this.to,s)}invert(){return new Rn(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new ii(t.pos,n.pos,this.mark)}merge(e){return e instanceof ii&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new ii(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new ii(t.from,t.to,e.markFromJSON(t.mark))}}Je.jsonID("addMark",ii);class Rn extends Je{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=new Z(dp(t.content,r=>r.mark(this.mark.removeFromSet(r.marks)),e),t.openStart,t.openEnd);return Qe.fromReplace(e,this.from,this.to,n)}invert(){return new ii(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new Rn(t.pos,n.pos,this.mark)}merge(e){return e instanceof Rn&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Rn(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Rn(t.from,t.to,e.markFromJSON(t.mark))}}Je.jsonID("removeMark",Rn);class Ai extends Je{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Qe.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return Qe.fromReplace(e,this.pos,this.pos+1,new Z(P.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let n=this.mark.addToSet(t.marks);if(n.length==t.marks.length){for(let r=0;r<t.marks.length;r++)if(!t.marks[r].isInSet(n))return new Ai(this.pos,t.marks[r]);return new Ai(this.pos,this.mark)}}return new Zs(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Ai(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Ai(t.pos,e.markFromJSON(t.mark))}}Je.jsonID("addNodeMark",Ai);class Zs extends Je{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Qe.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return Qe.fromReplace(e,this.pos,this.pos+1,new Z(P.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new Ai(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Zs(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Zs(t.pos,e.markFromJSON(t.mark))}}Je.jsonID("removeNodeMark",Zs);class Ve extends Je{constructor(e,t,n,r=!1){super(),this.from=e,this.to=t,this.slice=n,this.structure=r}apply(e){return this.structure&&Ru(e,this.from,this.to)?Qe.fail("Structure replace would overwrite content"):Qe.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Tt([this.from,this.to-this.from,this.slice.size])}invert(e){return new Ve(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deletedAcross&&n.deletedAcross?null:new Ve(t.pos,Math.max(t.pos,n.pos),this.slice)}merge(e){if(!(e instanceof Ve)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?Z.empty:new Z(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Ve(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?Z.empty:new Z(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Ve(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Ve(t.from,t.to,Z.fromJSON(e,t.slice),!!t.structure)}}Je.jsonID("replace",Ve);class He extends Je{constructor(e,t,n,r,s,o,l=!1){super(),this.from=e,this.to=t,this.gapFrom=n,this.gapTo=r,this.slice=s,this.insert=o,this.structure=l}apply(e){if(this.structure&&(Ru(e,this.from,this.gapFrom)||Ru(e,this.gapTo,this.to)))return Qe.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return Qe.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,t.content);return n?Qe.fromReplace(e,this.from,this.to,n):Qe.fail("Content does not fit in gap")}getMap(){return new Tt([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new He(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1),r=e.map(this.gapFrom,-1),s=e.map(this.gapTo,1);return t.deletedAcross&&n.deletedAcross||r<t.pos||s>n.pos?null:new He(t.pos,n.pos,r,s,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new He(t.from,t.to,t.gapFrom,t.gapTo,Z.fromJSON(e,t.slice),t.insert,!!t.structure)}}Je.jsonID("replaceAround",He);function Ru(i,e,t){let n=i.resolve(e),r=t-e,s=n.depth;for(;r>0&&s>0&&n.indexAfter(s)==n.node(s).childCount;)s--,r--;if(r>0){let o=n.node(s).maybeChild(n.indexAfter(s));for(;r>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,r--}}return!1}function tQ(i,e,t,n){let r=[],s=[],o,l;i.doc.nodesBetween(e,t,(a,h,c)=>{if(!a.isInline)return;let f=a.marks;if(!n.isInSet(f)&&c.type.allowsMarkType(n.type)){let u=Math.max(h,e),d=Math.min(h+a.nodeSize,t),p=n.addToSet(f);for(let m=0;m<f.length;m++)f[m].isInSet(p)||(o&&o.to==u&&o.mark.eq(f[m])?o.to=d:r.push(o=new Rn(u,d,f[m])));l&&l.to==u?l.to=d:s.push(l=new ii(u,d,n))}}),r.forEach(a=>i.step(a)),s.forEach(a=>i.step(a))}function nQ(i,e,t,n){let r=[],s=0;i.doc.nodesBetween(e,t,(o,l)=>{if(!o.isInline)return;s++;let a=null;if(n instanceof xc){let h=o.marks,c;for(;c=n.isInSet(h);)(a||(a=[])).push(c),h=c.removeFromSet(h)}else n?n.isInSet(o.marks)&&(a=[n]):a=o.marks;if(a&&a.length){let h=Math.min(l+o.nodeSize,t);for(let c=0;c<a.length;c++){let f=a[c],u;for(let d=0;d<r.length;d++){let p=r[d];p.step==s-1&&f.eq(r[d].style)&&(u=p)}u?(u.to=h,u.step=s):r.push({style:f,from:Math.max(l,e),to:h,step:s})}}}),r.forEach(o=>i.step(new Rn(o.from,o.to,o.style)))}function iQ(i,e,t,n=t.contentMatch){let r=i.doc.nodeAt(e),s=[],o=e+1;for(let l=0;l<r.childCount;l++){let a=r.child(l),h=o+a.nodeSize,c=n.matchType(a.type);if(!c)s.push(new Ve(o,h,Z.empty));else{n=c;for(let f=0;f<a.marks.length;f++)t.allowsMarkType(a.marks[f].type)||i.step(new Rn(o,h,a.marks[f]));if(a.isText&&!t.spec.code){let f,u=/\r?\n|\r/g,d;for(;f=u.exec(a.text);)d||(d=new Z(P.from(t.schema.text(" ",t.allowedMarks(a.marks))),0,0)),s.push(new Ve(o+f.index,o+f.index+f[0].length,d))}}o=h}if(!n.validEnd){let l=n.fillBefore(P.empty,!0);i.replace(o,o,new Z(l,0,0))}for(let l=s.length-1;l>=0;l--)i.step(s[l])}function rQ(i,e,t){return(e==0||i.canReplace(e,i.childCount))&&(t==i.childCount||i.canReplace(0,t))}function vc(i){let t=i.parent.content.cutByIndex(i.startIndex,i.endIndex);for(let n=i.depth;;--n){let r=i.$from.node(n),s=i.$from.index(n),o=i.$to.indexAfter(n);if(n<i.depth&&r.canReplace(s,o,t))return n;if(n==0||r.type.spec.isolating||!rQ(r,s,o))break}return null}function sQ(i,e,t){let{$from:n,$to:r,depth:s}=e,o=n.before(s+1),l=r.after(s+1),a=o,h=l,c=P.empty,f=0;for(let p=s,m=!1;p>t;p--)m||n.index(p)>0?(m=!0,c=P.from(n.node(p).copy(c)),f++):a--;let u=P.empty,d=0;for(let p=s,m=!1;p>t;p--)m||r.after(p+1)<r.end(p)?(m=!0,u=P.from(r.node(p).copy(u)),d++):h++;i.step(new He(a,h,o,l,new Z(c.append(u),f,d),c.size-f,!0))}function tk(i,e,t=null,n=i){let r=oQ(i,e),s=r&&lQ(n,e);return s?r.map(Eg).concat({type:e,attrs:t}).concat(s.map(Eg)):null}function Eg(i){return{type:i,attrs:null}}function oQ(i,e){let{parent:t,startIndex:n,endIndex:r}=i,s=t.contentMatchAt(n).findWrapping(e);if(!s)return null;let o=s.length?s[0]:e;return t.canReplaceWith(n,r,o)?s:null}function lQ(i,e){let{parent:t,startIndex:n,endIndex:r}=i,s=t.child(n),o=e.contentMatch.findWrapping(s.type);if(!o)return null;let a=(o.length?o[o.length-1]:e).contentMatch;for(let h=n;a&&h<r;h++)a=a.matchType(t.child(h).type);return!a||!a.validEnd?null:o}function aQ(i,e,t){let n=P.empty;for(let o=t.length-1;o>=0;o--){if(n.size){let l=t[o].type.contentMatch.matchFragment(n);if(!l||!l.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}n=P.from(t[o].type.create(t[o].attrs,n))}let r=e.start,s=e.end;i.step(new He(r,s,r,s,new Z(n,0,0),t.length,!0))}function hQ(i,e,t,n,r){if(!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=i.steps.length;i.doc.nodesBetween(e,t,(o,l)=>{if(o.isTextblock&&!o.hasMarkup(n,r)&&cQ(i.doc,i.mapping.slice(s).map(l),n)){i.clearIncompatible(i.mapping.slice(s).map(l,1),n);let a=i.mapping.slice(s),h=a.map(l,1),c=a.map(l+o.nodeSize,1);return i.step(new He(h,c,h+1,c-1,new Z(P.from(n.create(r,null,o.marks)),0,0),1,!0)),!1}})}function cQ(i,e,t){let n=i.resolve(e),r=n.index();return n.parent.canReplaceWith(r,r+1,t)}function fQ(i,e,t,n,r){let s=i.doc.nodeAt(e);if(!s)throw new RangeError("No node at given position");t||(t=s.type);let o=t.create(n,null,r||s.marks);if(s.isLeaf)return i.replaceWith(e,e+s.nodeSize,o);if(!t.validContent(s.content))throw new RangeError("Invalid content for node type "+t.name);i.step(new He(e,e+s.nodeSize,e+1,e+s.nodeSize-1,new Z(P.from(o),0,0),1,!0))}function Go(i,e,t=1,n){let r=i.resolve(e),s=r.depth-t,o=n&&n[n.length-1]||r.parent;if(s<0||r.parent.type.spec.isolating||!r.parent.canReplace(r.index(),r.parent.childCount)||!o.type.validContent(r.parent.content.cutByIndex(r.index(),r.parent.childCount)))return!1;for(let h=r.depth-1,c=t-2;h>s;h--,c--){let f=r.node(h),u=r.index(h);if(f.type.spec.isolating)return!1;let d=f.content.cutByIndex(u,f.childCount),p=n&&n[c+1];p&&(d=d.replaceChild(0,p.type.create(p.attrs)));let m=n&&n[c]||f;if(!f.canReplace(u+1,f.childCount)||!m.type.validContent(d))return!1}let l=r.indexAfter(s),a=n&&n[0];return r.node(s).canReplaceWith(l,l,a?a.type:r.node(s+1).type)}function uQ(i,e,t=1,n){let r=i.doc.resolve(e),s=P.empty,o=P.empty;for(let l=r.depth,a=r.depth-t,h=t-1;l>a;l--,h--){s=P.from(r.node(l).copy(s));let c=n&&n[h];o=P.from(c?c.type.create(c.attrs,o):r.node(l).copy(o))}i.step(new Ve(e,e,new Z(s.append(o),t,t),!0))}function $c(i,e){let t=i.resolve(e),n=t.index();return dQ(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(n,n+1)}function dQ(i,e){return!!(i&&e&&!i.isLeaf&&i.canAppend(e))}function pQ(i,e,t){let n=new Ve(e-t,e+t,Z.empty,!0);i.step(n)}function mQ(i,e,t){let n=i.resolve(e);if(n.parent.canReplaceWith(n.index(),n.index(),t))return e;if(n.parentOffset==0)for(let r=n.depth-1;r>=0;r--){let s=n.index(r);if(n.node(r).canReplaceWith(s,s,t))return n.before(r+1);if(s>0)return null}if(n.parentOffset==n.parent.content.size)for(let r=n.depth-1;r>=0;r--){let s=n.indexAfter(r);if(n.node(r).canReplaceWith(s,s,t))return n.after(r+1);if(s<n.node(r).childCount)return null}return null}function nk(i,e,t){let n=i.resolve(e);if(!t.content.size)return e;let r=t.content;for(let s=0;s<t.openStart;s++)r=r.firstChild.content;for(let s=1;s<=(t.openStart==0&&t.size?2:1);s++)for(let o=n.depth;o>=0;o--){let l=o==n.depth?0:n.pos<=(n.start(o+1)+n.end(o+1))/2?-1:1,a=n.index(o)+(l>0?1:0),h=n.node(o),c=!1;if(s==1)c=h.canReplace(a,a,r);else{let f=h.contentMatchAt(a).findWrapping(r.firstChild.type);c=f&&h.canReplaceWith(a,a,f[0])}if(c)return l==0?n.pos:l<0?n.before(o+1):n.after(o+1)}return null}function pp(i,e,t=e,n=Z.empty){if(e==t&&!n.size)return null;let r=i.resolve(e),s=i.resolve(t);return ik(r,s,n)?new Ve(e,t,n):new gQ(r,s,n).fit()}function ik(i,e,t){return!t.openStart&&!t.openEnd&&i.start()==e.start()&&i.parent.canReplace(i.index(),e.index(),t.content)}class gQ{constructor(e,t,n){this.$from=e,this.$to=t,this.unplaced=n,this.frontier=[],this.placed=P.empty;for(let r=0;r<=e.depth;r++){let s=e.node(r);this.frontier.push({type:s.type,match:s.contentMatchAt(e.indexAfter(r))})}for(let r=e.depth;r>0;r--)this.placed=P.from(e.node(r).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let h=this.findFittable();h?this.placeNodes(h):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,n=this.$from,r=this.close(e<0?this.$to:n.doc.resolve(e));if(!r)return null;let s=this.placed,o=n.depth,l=r.depth;for(;o&&l&&s.childCount==1;)s=s.firstChild.content,o--,l--;let a=new Z(s,o,l);return e>-1?new He(n.pos,e,this.$to.pos,this.$to.end(),a,t):a.size||n.pos!=this.$to.pos?new Ve(n.pos,r.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,n=0,r=this.unplaced.openEnd;n<e;n++){let s=t.firstChild;if(t.childCount>1&&(r=0),s.type.spec.isolating&&r<=n){e=n;break}t=s.content}for(let t=1;t<=2;t++)for(let n=t==1?e:this.unplaced.openStart;n>=0;n--){let r,s=null;n?(s=pf(this.unplaced.content,n-1).firstChild,r=s.content):r=this.unplaced.content;let o=r.firstChild;for(let l=this.depth;l>=0;l--){let{type:a,match:h}=this.frontier[l],c,f=null;if(t==1&&(o?h.matchType(o.type)||(f=h.fillBefore(P.from(o),!1)):s&&a.compatibleContent(s.type)))return{sliceDepth:n,frontierDepth:l,parent:s,inject:f};if(t==2&&o&&(c=h.findWrapping(o.type)))return{sliceDepth:n,frontierDepth:l,parent:s,wrap:c};if(s&&h.matchType(s.type))break}}}openMore(){let{content:e,openStart:t,openEnd:n}=this.unplaced,r=pf(e,t);return!r.childCount||r.firstChild.isLeaf?!1:(this.unplaced=new Z(e,t+1,Math.max(n,r.size+t>=e.size-n?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:n}=this.unplaced,r=pf(e,t);if(r.childCount<=1&&t>0){let s=e.size-t<=t+r.size;this.unplaced=new Z(Ro(e,t-1,1),t-1,s?t-1:n)}else this.unplaced=new Z(Ro(e,t,1),t,n)}placeNodes({sliceDepth:e,frontierDepth:t,parent:n,inject:r,wrap:s}){for(;this.depth>t;)this.closeFrontierNode();if(s)for(let m=0;m<s.length;m++)this.openFrontierNode(s[m]);let o=this.unplaced,l=n?n.content:o.content,a=o.openStart-e,h=0,c=[],{match:f,type:u}=this.frontier[t];if(r){for(let m=0;m<r.childCount;m++)c.push(r.child(m));f=f.matchFragment(r)}let d=l.size+e-(o.content.size-o.openEnd);for(;h<l.childCount;){let m=l.child(h),g=f.matchType(m.type);if(!g)break;h++,(h>1||a==0||m.content.size)&&(f=g,c.push(rk(m.mark(u.allowedMarks(m.marks)),h==1?a:0,h==l.childCount?d:-1)))}let p=h==l.childCount;p||(d=-1),this.placed=Eo(this.placed,t,P.from(c)),this.frontier[t].match=f,p&&d<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,g=l;m<d;m++){let y=g.lastChild;this.frontier.push({type:y.type,match:y.contentMatchAt(y.childCount)}),g=y.content}this.unplaced=p?e==0?Z.empty:new Z(Ro(o.content,e-1,1),e-1,d<0?o.openEnd:e-1):new Z(Ro(o.content,e,h),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!mf(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:n}=this.$to,r=this.$to.after(n);for(;n>1&&r==this.$to.end(--n);)++r;return r}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:n,type:r}=this.frontier[t],s=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),o=mf(e,t,r,n,s);if(o){for(let l=t-1;l>=0;l--){let{match:a,type:h}=this.frontier[l],c=mf(e,l,h,a,!0);if(!c||c.childCount)continue e}return{depth:t,fit:o,move:s?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=Eo(this.placed,t.depth,t.fit)),e=t.move;for(let n=t.depth+1;n<=e.depth;n++){let r=e.node(n),s=r.type.contentMatch.fillBefore(r.content,!0,e.index(n));this.openFrontierNode(r.type,r.attrs,s)}return e}openFrontierNode(e,t=null,n){let r=this.frontier[this.depth];r.match=r.match.matchType(e),this.placed=Eo(this.placed,this.depth,P.from(e.create(t,n))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(P.empty,!0);t.childCount&&(this.placed=Eo(this.placed,this.frontier.length,t))}}function Ro(i,e,t){return e==0?i.cutByIndex(t,i.childCount):i.replaceChild(0,i.firstChild.copy(Ro(i.firstChild.content,e-1,t)))}function Eo(i,e,t){return e==0?i.append(t):i.replaceChild(i.childCount-1,i.lastChild.copy(Eo(i.lastChild.content,e-1,t)))}function pf(i,e){for(let t=0;t<e;t++)i=i.firstChild.content;return i}function rk(i,e,t){if(e<=0)return i;let n=i.content;return e>1&&(n=n.replaceChild(0,rk(n.firstChild,e-1,n.childCount==1?t-1:0))),e>0&&(n=i.type.contentMatch.fillBefore(n).append(n),t<=0&&(n=n.append(i.type.contentMatch.matchFragment(n).fillBefore(P.empty,!0)))),i.copy(n)}function mf(i,e,t,n,r){let s=i.node(e),o=r?i.indexAfter(e):i.index(e);if(o==s.childCount&&!t.compatibleContent(s.type))return null;let l=n.fillBefore(s.content,!0,o);return l&&!OQ(t,s.content,o)?l:null}function OQ(i,e,t){for(let n=t;n<e.childCount;n++)if(!i.allowsMarks(e.child(n).marks))return!0;return!1}function yQ(i){return i.spec.defining||i.spec.definingForContent}function kQ(i,e,t,n){if(!n.size)return i.deleteRange(e,t);let r=i.doc.resolve(e),s=i.doc.resolve(t);if(ik(r,s,n))return i.step(new Ve(e,t,n));let o=ok(r,i.doc.resolve(t));o[o.length-1]==0&&o.pop();let l=-(r.depth+1);o.unshift(l);for(let u=r.depth,d=r.pos-1;u>0;u--,d--){let p=r.node(u).type.spec;if(p.defining||p.definingAsContext||p.isolating)break;o.indexOf(u)>-1?l=u:r.before(u)==d&&o.splice(1,0,-u)}let a=o.indexOf(l),h=[],c=n.openStart;for(let u=n.content,d=0;;d++){let p=u.firstChild;if(h.push(p),d==n.openStart)break;u=p.content}for(let u=c-1;u>=0;u--){let d=h[u],p=yQ(d.type);if(p&&!d.sameMarkup(r.node(Math.abs(l)-1)))c=u;else if(p||!d.type.isTextblock)break}for(let u=n.openStart;u>=0;u--){let d=(u+c+1)%(n.openStart+1),p=h[d];if(p)for(let m=0;m<o.length;m++){let g=o[(m+a)%o.length],y=!0;g<0&&(y=!1,g=-g);let k=r.node(g-1),v=r.index(g-1);if(k.canReplaceWith(v,v,p.type,p.marks))return i.replace(r.before(g),y?s.after(g):t,new Z(sk(n.content,0,n.openStart,d),d,n.openEnd))}}let f=i.steps.length;for(let u=o.length-1;u>=0&&(i.replace(e,t,n),!(i.steps.length>f));u--){let d=o[u];d<0||(e=r.before(d),t=s.after(d))}}function sk(i,e,t,n,r){if(e<t){let s=i.firstChild;i=i.replaceChild(0,s.copy(sk(s.content,e+1,t,n,s)))}if(e>n){let s=r.contentMatchAt(0),o=s.fillBefore(i).append(i);i=o.append(s.matchFragment(o).fillBefore(P.empty,!0))}return i}function bQ(i,e,t,n){if(!n.isInline&&e==t&&i.doc.resolve(e).parent.content.size){let r=mQ(i.doc,e,n.type);r!=null&&(e=t=r)}i.replaceRange(e,t,new Z(P.from(n),0,0))}function SQ(i,e,t){let n=i.doc.resolve(e),r=i.doc.resolve(t),s=ok(n,r);for(let o=0;o<s.length;o++){let l=s[o],a=o==s.length-1;if(a&&l==0||n.node(l).type.contentMatch.validEnd)return i.delete(n.start(l),r.end(l));if(l>0&&(a||n.node(l-1).canReplace(n.index(l-1),r.indexAfter(l-1))))return i.delete(n.before(l),r.after(l))}for(let o=1;o<=n.depth&&o<=r.depth;o++)if(e-n.start(o)==n.depth-o&&t>n.end(o)&&r.end(o)-t!=r.depth-o)return i.delete(n.before(o),t);i.delete(e,t)}function ok(i,e){let t=[],n=Math.min(i.depth,e.depth);for(let r=n;r>=0;r--){let s=i.start(r);if(s<i.pos-(i.depth-r)||e.end(r)>e.pos+(e.depth-r)||i.node(r).type.spec.isolating||e.node(r).type.spec.isolating)break;(s==e.start(r)||r==i.depth&&r==e.depth&&i.parent.inlineContent&&e.parent.inlineContent&&r&&e.start(r-1)==s-1)&&t.push(r)}return t}class gs extends Je{constructor(e,t,n){super(),this.pos=e,this.attr=t,this.value=n}apply(e){let t=e.nodeAt(this.pos);if(!t)return Qe.fail("No node at attribute step's position");let n=Object.create(null);for(let s in t.attrs)n[s]=t.attrs[s];n[this.attr]=this.value;let r=t.type.create(n,null,t.marks);return Qe.fromReplace(e,this.pos,this.pos+1,new Z(P.from(r),0,t.isLeaf?0:1))}getMap(){return Tt.empty}invert(e){return new gs(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new gs(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new gs(t.pos,t.attr,t.value)}}Je.jsonID("attr",gs);class dl extends Je{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let r in e.attrs)t[r]=e.attrs[r];t[this.attr]=this.value;let n=e.type.create(t,e.content,e.marks);return Qe.ok(n)}getMap(){return Tt.empty}invert(e){return new dl(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new dl(t.attr,t.value)}}Je.jsonID("docAttr",dl);let Rs=class extends Error{};Rs=function i(e){let t=Error.call(this,e);return t.__proto__=i.prototype,t};Rs.prototype=Object.create(Error.prototype);Rs.prototype.constructor=Rs;Rs.prototype.name="TransformError";class wQ{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new ms}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new Rs(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,n=Z.empty){let r=pp(this.doc,e,t,n);return r&&this.step(r),this}replaceWith(e,t,n){return this.replace(e,t,new Z(P.from(n),0,0))}delete(e,t){return this.replace(e,t,Z.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,n){return kQ(this,e,t,n),this}replaceRangeWith(e,t,n){return bQ(this,e,t,n),this}deleteRange(e,t){return SQ(this,e,t),this}lift(e,t){return sQ(this,e,t),this}join(e,t=1){return pQ(this,e,t),this}wrap(e,t){return aQ(this,e,t),this}setBlockType(e,t=e,n,r=null){return hQ(this,e,t,n,r),this}setNodeMarkup(e,t,n=null,r){return fQ(this,e,t,n,r),this}setNodeAttribute(e,t,n){return this.step(new gs(e,t,n)),this}setDocAttribute(e,t){return this.step(new dl(e,t)),this}addNodeMark(e,t){return this.step(new Ai(e,t)),this}removeNodeMark(e,t){if(!(t instanceof G)){let n=this.doc.nodeAt(e);if(!n)throw new RangeError("No node at position "+e);if(t=t.isInSet(n.marks),!t)return this}return this.step(new Zs(e,t)),this}split(e,t=1,n){return uQ(this,e,t,n),this}addMark(e,t,n){return tQ(this,e,t,n),this}removeMark(e,t,n){return nQ(this,e,t,n),this}clearIncompatible(e,t,n){return iQ(this,e,t,n),this}}const gf=Object.create(null);class _{constructor(e,t,n){this.$anchor=e,this.$head=t,this.ranges=n||[new xQ(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=Z.empty){let n=t.content.lastChild,r=null;for(let l=0;l<t.openEnd;l++)r=n,n=n.lastChild;let s=e.steps.length,o=this.ranges;for(let l=0;l<o.length;l++){let{$from:a,$to:h}=o[l],c=e.mapping.slice(s);e.replaceRange(c.map(a.pos),c.map(h.pos),l?Z.empty:t),l==0&&Ig(e,s,(n?n.isInline:r&&r.isTextblock)?-1:1)}}replaceWith(e,t){let n=e.steps.length,r=this.ranges;for(let s=0;s<r.length;s++){let{$from:o,$to:l}=r[s],a=e.mapping.slice(n),h=a.map(o.pos),c=a.map(l.pos);s?e.deleteRange(h,c):(e.replaceRangeWith(h,c,t),Ig(e,n,t.isInline?-1:1))}}static findFrom(e,t,n=!1){let r=e.parent.inlineContent?new J(e):es(e.node(0),e.parent,e.pos,e.index(),t,n);if(r)return r;for(let s=e.depth-1;s>=0;s--){let o=t<0?es(e.node(0),e.node(s),e.before(s+1),e.index(s),t,n):es(e.node(0),e.node(s),e.after(s+1),e.index(s)+1,t,n);if(o)return o}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new Nt(e.node(0))}static atStart(e){return es(e,e,0,0,1)||new Nt(e)}static atEnd(e){return es(e,e,e.content.size,e.childCount,-1)||new Nt(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=gf[t.type];if(!n)throw new RangeError(`No selection type ${t.type} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in gf)throw new RangeError("Duplicate use of selection JSON ID "+e);return gf[e]=t,t.prototype.jsonID=e,t}getBookmark(){return J.between(this.$anchor,this.$head).getBookmark()}}_.prototype.visible=!0;let xQ=class{constructor(e,t){this.$from=e,this.$to=t}},Ng=!1;function Dg(i){!Ng&&!i.parent.inlineContent&&(Ng=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+i.parent.type.name+")"))}class J extends _{constructor(e,t=e){Dg(e),Dg(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let n=e.resolve(t.map(this.head));if(!n.parent.inlineContent)return _.near(n);let r=e.resolve(t.map(this.anchor));return new J(r.parent.inlineContent?r:n,n)}replace(e,t=Z.empty){if(super.replace(e,t),t==Z.empty){let n=this.$from.marksAcross(this.$to);n&&e.ensureMarks(n)}}eq(e){return e instanceof J&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Pc(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new J(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,n=t){let r=e.resolve(t);return new this(r,n==t?r:e.resolve(n))}static between(e,t,n){let r=e.pos-t.pos;if((!n||r)&&(n=r>=0?1:-1),!t.parent.inlineContent){let s=_.findFrom(t,n,!0)||_.findFrom(t,-n,!0);if(s)t=s.$head;else return _.near(t,n)}return e.parent.inlineContent||(r==0?e=t:(e=(_.findFrom(e,-n,!0)||_.findFrom(e,n,!0)).$anchor,e.pos<t.pos!=r<0&&(e=t))),new J(e,t)}}_.jsonID("text",J);class Pc{constructor(e,t){this.anchor=e,this.head=t}map(e){return new Pc(e.map(this.anchor),e.map(this.head))}resolve(e){return J.between(e.resolve(this.anchor),e.resolve(this.head))}}class V extends _{constructor(e){let t=e.nodeAfter,n=e.node(0).resolve(e.pos+t.nodeSize);super(e,n),this.node=t}map(e,t){let{deleted:n,pos:r}=t.mapResult(this.anchor),s=e.resolve(r);return n?_.near(s):new V(s)}content(){return new Z(P.from(this.node),0,0)}eq(e){return e instanceof V&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new mp(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new V(e.resolve(t.anchor))}static create(e,t){return new V(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}V.prototype.visible=!1;_.jsonID("node",V);class mp{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:n}=e.mapResult(this.anchor);return t?new Pc(n,n):new mp(n)}resolve(e){let t=e.resolve(this.anchor),n=t.nodeAfter;return n&&V.isSelectable(n)?new V(t):_.near(t)}}class Nt extends _{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=Z.empty){if(t==Z.empty){e.delete(0,e.doc.content.size);let n=_.atStart(e.doc);n.eq(e.selection)||e.setSelection(n)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new Nt(e)}map(e){return new Nt(e)}eq(e){return e instanceof Nt}getBookmark(){return vQ}}_.jsonID("all",Nt);const vQ={map(){return this},resolve(i){return new Nt(i)}};function es(i,e,t,n,r,s=!1){if(e.inlineContent)return J.create(i,t);for(let o=n-(r>0?0:1);r>0?o<e.childCount:o>=0;o+=r){let l=e.child(o);if(l.isAtom){if(!s&&V.isSelectable(l))return V.create(i,t-(r<0?l.nodeSize:0))}else{let a=es(i,l,t+r,r<0?l.childCount:0,r,s);if(a)return a}t+=l.nodeSize*r}return null}function Ig(i,e,t){let n=i.steps.length-1;if(n<e)return;let r=i.steps[n];if(!(r instanceof Ve||r instanceof He))return;let s=i.mapping.maps[n],o;s.forEach((l,a,h,c)=>{o==null&&(o=c)}),i.setSelection(_.near(i.doc.resolve(o),t))}const Wg=1,pa=2,Xg=4;let $Q=class extends wQ{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|Wg)&~pa,this.storedMarks=null,this}get selectionSet(){return(this.updated&Wg)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=pa,this}ensureMarks(e){return G.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&pa)>0}addStep(e,t){super.addStep(e,t),this.updated=this.updated&~pa,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let n=this.selection;return t&&(e=e.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||G.none))),n.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,n){let r=this.doc.type.schema;if(t==null)return e?this.replaceSelectionWith(r.text(e),!0):this.deleteSelection();{if(n==null&&(n=t),n=n??t,!e)return this.deleteRange(t,n);let s=this.storedMarks;if(!s){let o=this.doc.resolve(t);s=n==t?o.marks():o.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(t,n,r.text(e,s)),this.selection.empty||this.setSelection(_.near(this.selection.$to)),this}}setMeta(e,t){return this.meta[typeof e=="string"?e:e.key]=t,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=Xg,this}get scrolledIntoView(){return(this.updated&Xg)>0}};function Bg(i,e){return!e||!i?i:i.bind(e)}class No{constructor(e,t,n){this.name=e,this.init=Bg(t.init,n),this.apply=Bg(t.apply,n)}}const PQ=[new No("doc",{init(i){return i.doc||i.schema.topNodeType.createAndFill()},apply(i){return i.doc}}),new No("selection",{init(i,e){return i.selection||_.atStart(e.doc)},apply(i){return i.selection}}),new No("storedMarks",{init(i){return i.storedMarks||null},apply(i,e,t,n){return n.selection.$cursor?i.storedMarks:null}}),new No("scrollToSelection",{init(){return 0},apply(i,e){return i.scrolledIntoView?e+1:e}})];let Of=class{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=PQ.slice(),t&&t.forEach(n=>{if(this.pluginsByKey[n.key])throw new RangeError("Adding different instances of a keyed plugin ("+n.key+")");this.plugins.push(n),this.pluginsByKey[n.key]=n,n.spec.state&&this.fields.push(new No(n.key,n.spec.state,n))})}},lk=class Do{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=t){let r=this.config.plugins[n];if(r.spec.filterTransaction&&!r.spec.filterTransaction.call(r,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],n=this.applyInner(e),r=null;for(;;){let s=!1;for(let o=0;o<this.config.plugins.length;o++){let l=this.config.plugins[o];if(l.spec.appendTransaction){let a=r?r[o].n:0,h=r?r[o].state:this,c=a<t.length&&l.spec.appendTransaction.call(l,a?t.slice(a):t,h,n);if(c&&n.filterTransaction(c,o)){if(c.setMeta("appendedTransaction",e),!r){r=[];for(let f=0;f<this.config.plugins.length;f++)r.push(f<o?{state:n,n:t.length}:{state:this,n:0})}t.push(c),n=n.applyInner(c),s=!0}r&&(r[o]={state:n,n:t.length})}}if(!s)return{state:n,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new Do(this.config),n=this.config.fields;for(let r=0;r<n.length;r++){let s=n[r];t[s.name]=s.apply(e,this[s.name],this,t)}return t}get tr(){return new $Q(this)}static create(e){let t=new Of(e.doc?e.doc.type.schema:e.schema,e.plugins),n=new Do(t);for(let r=0;r<t.fields.length;r++)n[t.fields[r].name]=t.fields[r].init(e,n);return n}reconfigure(e){let t=new Of(this.schema,e.plugins),n=t.fields,r=new Do(t);for(let s=0;s<n.length;s++){let o=n[s].name;r[o]=this.hasOwnProperty(o)?this[o]:n[s].init(e,r)}return r}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(n=>n.toJSON())),e&&typeof e=="object")for(let n in e){if(n=="doc"||n=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let r=e[n],s=r.spec.state;s&&s.toJSON&&(t[n]=s.toJSON.call(r,this[r.key]))}return t}static fromJSON(e,t,n){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let r=new Of(e.schema,e.plugins),s=new Do(r);return r.fields.forEach(o=>{if(o.name=="doc")s.doc=hn.fromJSON(e.schema,t.doc);else if(o.name=="selection")s.selection=_.fromJSON(s.doc,t.selection);else if(o.name=="storedMarks")t.storedMarks&&(s.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(n)for(let l in n){let a=n[l],h=a.spec.state;if(a.key==o.name&&h&&h.fromJSON&&Object.prototype.hasOwnProperty.call(t,l)){s[o.name]=h.fromJSON.call(a,e,t[l],s);return}}s[o.name]=o.init(e,s)}}),s}};function ak(i,e,t){for(let n in i){let r=i[n];r instanceof Function?r=r.bind(e):n=="handleDOMEvents"&&(r=ak(r,e,{})),t[n]=r}return t}class wt{constructor(e){this.spec=e,this.props={},e.props&&ak(e.props,this,this.props),this.key=e.key?e.key.key:hk("plugin")}getState(e){return e[this.key]}}const yf=Object.create(null);function hk(i){return i in yf?i+"$"+ ++yf[i]:(yf[i]=0,i+"$")}class Ht{constructor(e="key"){this.key=hk(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const qe=function(i){for(var e=0;;e++)if(i=i.previousSibling,!i)return e},pl=function(i){let e=i.assignedSlot||i.parentNode;return e&&e.nodeType==11?e.host:e};let Eu=null;const Hn=function(i,e,t){let n=Eu||(Eu=document.createRange());return n.setEnd(i,t??i.nodeValue.length),n.setStart(i,e||0),n},QQ=function(){Eu=null},Er=function(i,e,t,n){return t&&(Vg(i,e,t,n,-1)||Vg(i,e,t,n,1))},CQ=/^(img|br|input|textarea|hr)$/i;function Vg(i,e,t,n,r){for(;;){if(i==t&&e==n)return!0;if(e==(r<0?0:Cn(i))){let s=i.parentNode;if(!s||s.nodeType!=1||jl(i)||CQ.test(i.nodeName)||i.contentEditable=="false")return!1;e=qe(i)+(r<0?0:1),i=s}else if(i.nodeType==1){if(i=i.childNodes[e+(r<0?-1:0)],i.contentEditable=="false")return!1;e=r<0?Cn(i):0}else return!1}}function Cn(i){return i.nodeType==3?i.nodeValue.length:i.childNodes.length}function TQ(i,e){for(;;){if(i.nodeType==3&&e)return i;if(i.nodeType==1&&e>0){if(i.contentEditable=="false")return null;i=i.childNodes[e-1],e=Cn(i)}else if(i.parentNode&&!jl(i))e=qe(i),i=i.parentNode;else return null}}function MQ(i,e){for(;;){if(i.nodeType==3&&e<i.nodeValue.length)return i;if(i.nodeType==1&&e<i.childNodes.length){if(i.contentEditable=="false")return null;i=i.childNodes[e],e=0}else if(i.parentNode&&!jl(i))e=qe(i)+1,i=i.parentNode;else return null}}function AQ(i,e,t){for(let n=e==0,r=e==Cn(i);n||r;){if(i==t)return!0;let s=qe(i);if(i=i.parentNode,!i)return!1;n=n&&s==0,r=r&&s==Cn(i)}}function jl(i){let e;for(let t=i;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==i||e.contentDOM==i)}const Qc=function(i){return i.focusNode&&Er(i.focusNode,i.focusOffset,i.anchorNode,i.anchorOffset)};function cr(i,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=i,t.key=t.code=e,t}function ZQ(i){let e=i.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function RQ(i,e,t){if(i.caretPositionFromPoint)try{let n=i.caretPositionFromPoint(e,t);if(n)return{node:n.offsetNode,offset:n.offset}}catch{}if(i.caretRangeFromPoint){let n=i.caretRangeFromPoint(e,t);if(n)return{node:n.startContainer,offset:n.startOffset}}}const Bn=typeof navigator<"u"?navigator:null,qg=typeof document<"u"?document:null,Ji=Bn&&Bn.userAgent||"",Nu=/Edge\/(\d+)/.exec(Ji),ck=/MSIE \d/.exec(Ji),Du=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ji),bt=!!(ck||Du||Nu),Bi=ck?document.documentMode:Du?+Du[1]:Nu?+Nu[1]:0,fn=!bt&&/gecko\/(\d+)/i.test(Ji);fn&&+(/Firefox\/(\d+)/.exec(Ji)||[0,0])[1];const Iu=!bt&&/Chrome\/(\d+)/.exec(Ji),ot=!!Iu,EQ=Iu?+Iu[1]:0,ft=!bt&&!!Bn&&/Apple Computer/.test(Bn.vendor),Es=ft&&(/Mobile\/\w+/.test(Ji)||!!Bn&&Bn.maxTouchPoints>2),Vt=Es||(Bn?/Mac/.test(Bn.platform):!1),NQ=Bn?/Win/.test(Bn.platform):!1,rn=/Android \d/.test(Ji),_l=!!qg&&"webkitFontSmoothing"in qg.documentElement.style,DQ=_l?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function IQ(i){let e=i.defaultView&&i.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:i.documentElement.clientWidth,top:0,bottom:i.documentElement.clientHeight}}function Un(i,e){return typeof i=="number"?i:i[e]}function WQ(i){let e=i.getBoundingClientRect(),t=e.width/i.offsetWidth||1,n=e.height/i.offsetHeight||1;return{left:e.left,right:e.left+i.clientWidth*t,top:e.top,bottom:e.top+i.clientHeight*n}}function Lg(i,e,t){let n=i.someProp("scrollThreshold")||0,r=i.someProp("scrollMargin")||5,s=i.dom.ownerDocument;for(let o=t||i.dom;o;o=pl(o)){if(o.nodeType!=1)continue;let l=o,a=l==s.body,h=a?IQ(s):WQ(l),c=0,f=0;if(e.top<h.top+Un(n,"top")?f=-(h.top-e.top+Un(r,"top")):e.bottom>h.bottom-Un(n,"bottom")&&(f=e.bottom-e.top>h.bottom-h.top?e.top+Un(r,"top")-h.top:e.bottom-h.bottom+Un(r,"bottom")),e.left<h.left+Un(n,"left")?c=-(h.left-e.left+Un(r,"left")):e.right>h.right-Un(n,"right")&&(c=e.right-h.right+Un(r,"right")),c||f)if(a)s.defaultView.scrollBy(c,f);else{let u=l.scrollLeft,d=l.scrollTop;f&&(l.scrollTop+=f),c&&(l.scrollLeft+=c);let p=l.scrollLeft-u,m=l.scrollTop-d;e={left:e.left-p,top:e.top-m,right:e.right-p,bottom:e.bottom-m}}if(a||/^(fixed|sticky)$/.test(getComputedStyle(o).position))break}}function XQ(i){let e=i.dom.getBoundingClientRect(),t=Math.max(0,e.top),n,r;for(let s=(e.left+e.right)/2,o=t+1;o<Math.min(innerHeight,e.bottom);o+=5){let l=i.root.elementFromPoint(s,o);if(!l||l==i.dom||!i.dom.contains(l))continue;let a=l.getBoundingClientRect();if(a.top>=t-20){n=l,r=a.top;break}}return{refDOM:n,refTop:r,stack:fk(i.dom)}}function fk(i){let e=[],t=i.ownerDocument;for(let n=i;n&&(e.push({dom:n,top:n.scrollTop,left:n.scrollLeft}),i!=t);n=pl(n));return e}function BQ({refDOM:i,refTop:e,stack:t}){let n=i?i.getBoundingClientRect().top:0;uk(t,n==0?0:n-e)}function uk(i,e){for(let t=0;t<i.length;t++){let{dom:n,top:r,left:s}=i[t];n.scrollTop!=r+e&&(n.scrollTop=r+e),n.scrollLeft!=s&&(n.scrollLeft=s)}}let Fr=null;function VQ(i){if(i.setActive)return i.setActive();if(Fr)return i.focus(Fr);let e=fk(i);i.focus(Fr==null?{get preventScroll(){return Fr={preventScroll:!0},!0}}:void 0),Fr||(Fr=!1,uk(e,0))}function dk(i,e){let t,n=2e8,r,s=0,o=e.top,l=e.top,a,h;for(let c=i.firstChild,f=0;c;c=c.nextSibling,f++){let u;if(c.nodeType==1)u=c.getClientRects();else if(c.nodeType==3)u=Hn(c).getClientRects();else continue;for(let d=0;d<u.length;d++){let p=u[d];if(p.top<=o&&p.bottom>=l){o=Math.max(p.bottom,o),l=Math.min(p.top,l);let m=p.left>e.left?p.left-e.left:p.right<e.left?e.left-p.right:0;if(m<n){t=c,n=m,r=m&&t.nodeType==3?{left:p.right<e.left?p.right:p.left,top:e.top}:e,c.nodeType==1&&m&&(s=f+(e.left>=(p.left+p.right)/2?1:0));continue}}else p.top>e.top&&!a&&p.left<=e.left&&p.right>=e.left&&(a=c,h={left:Math.max(p.left,Math.min(p.right,e.left)),top:p.top});!t&&(e.left>=p.right&&e.top>=p.top||e.left>=p.left&&e.top>=p.bottom)&&(s=f+1)}}return!t&&a&&(t=a,r=h,n=0),t&&t.nodeType==3?qQ(t,r):!t||n&&t.nodeType==1?{node:i,offset:s}:dk(t,r)}function qQ(i,e){let t=i.nodeValue.length,n=document.createRange();for(let r=0;r<t;r++){n.setEnd(i,r+1),n.setStart(i,r);let s=Si(n,1);if(s.top!=s.bottom&&gp(e,s))return{node:i,offset:r+(e.left>=(s.left+s.right)/2?1:0)}}return{node:i,offset:0}}function gp(i,e){return i.left>=e.left-1&&i.left<=e.right+1&&i.top>=e.top-1&&i.top<=e.bottom+1}function LQ(i,e){let t=i.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<i.getBoundingClientRect().left?t:i}function zQ(i,e,t){let{node:n,offset:r}=dk(e,t),s=-1;if(n.nodeType==1&&!n.firstChild){let o=n.getBoundingClientRect();s=o.left!=o.right&&t.left>(o.left+o.right)/2?1:-1}return i.docView.posFromDOM(n,r,s)}function YQ(i,e,t,n){let r=-1;for(let s=e,o=!1;s!=i.dom;){let l=i.docView.nearestDesc(s,!0);if(!l)return null;if(l.dom.nodeType==1&&(l.node.isBlock&&l.parent&&!o||!l.contentDOM)){let a=l.dom.getBoundingClientRect();if(l.node.isBlock&&l.parent&&!o&&(o=!0,a.left>n.left||a.top>n.top?r=l.posBefore:(a.right<n.left||a.bottom<n.top)&&(r=l.posAfter)),!l.contentDOM&&r<0&&!l.node.isText)return(l.node.isBlock?n.top<(a.top+a.bottom)/2:n.left<(a.left+a.right)/2)?l.posBefore:l.posAfter}s=l.dom.parentNode}return r>-1?r:i.docView.posFromDOM(e,t,-1)}function pk(i,e,t){let n=i.childNodes.length;if(n&&t.top<t.bottom)for(let r=Math.max(0,Math.min(n-1,Math.floor(n*(e.top-t.top)/(t.bottom-t.top))-2)),s=r;;){let o=i.childNodes[s];if(o.nodeType==1){let l=o.getClientRects();for(let a=0;a<l.length;a++){let h=l[a];if(gp(e,h))return pk(o,e,h)}}if((s=(s+1)%n)==r)break}return i}function jQ(i,e){let t=i.dom.ownerDocument,n,r=0,s=RQ(t,e.left,e.top);s&&({node:n,offset:r}=s);let o=(i.root.elementFromPoint?i.root:t).elementFromPoint(e.left,e.top),l;if(!o||!i.dom.contains(o.nodeType!=1?o.parentNode:o)){let h=i.dom.getBoundingClientRect();if(!gp(e,h)||(o=pk(i.dom,e,h),!o))return null}if(ft)for(let h=o;n&&h;h=pl(h))h.draggable&&(n=void 0);if(o=LQ(o,e),n){if(fn&&n.nodeType==1&&(r=Math.min(r,n.childNodes.length),r<n.childNodes.length)){let c=n.childNodes[r],f;c.nodeName=="IMG"&&(f=c.getBoundingClientRect()).right<=e.left&&f.bottom>e.top&&r++}let h;_l&&r&&n.nodeType==1&&(h=n.childNodes[r-1]).nodeType==1&&h.contentEditable=="false"&&h.getBoundingClientRect().top>=e.top&&r--,n==i.dom&&r==n.childNodes.length-1&&n.lastChild.nodeType==1&&e.top>n.lastChild.getBoundingClientRect().bottom?l=i.state.doc.content.size:(r==0||n.nodeType!=1||n.childNodes[r-1].nodeName!="BR")&&(l=YQ(i,n,r,e))}l==null&&(l=zQ(i,o,e));let a=i.docView.nearestDesc(o,!0);return{pos:l,inside:a?a.posAtStart-a.border:-1}}function zg(i){return i.top<i.bottom||i.left<i.right}function Si(i,e){let t=i.getClientRects();if(t.length){let n=t[e<0?0:t.length-1];if(zg(n))return n}return Array.prototype.find.call(t,zg)||i.getBoundingClientRect()}const _Q=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function mk(i,e,t){let{node:n,offset:r,atom:s}=i.docView.domFromPos(e,t<0?-1:1),o=_l||fn;if(n.nodeType==3)if(o&&(_Q.test(n.nodeValue)||(t<0?!r:r==n.nodeValue.length))){let a=Si(Hn(n,r,r),t);if(fn&&r&&/\s/.test(n.nodeValue[r-1])&&r<n.nodeValue.length){let h=Si(Hn(n,r-1,r-1),-1);if(h.top==a.top){let c=Si(Hn(n,r,r+1),-1);if(c.top!=a.top)return lo(c,c.left<h.left)}}return a}else{let a=r,h=r,c=t<0?1:-1;return t<0&&!r?(h++,c=-1):t>=0&&r==n.nodeValue.length?(a--,c=1):t<0?a--:h++,lo(Si(Hn(n,a,h),c),c<0)}if(!i.state.doc.resolve(e-(s||0)).parent.inlineContent){if(s==null&&r&&(t<0||r==Cn(n))){let a=n.childNodes[r-1];if(a.nodeType==1)return kf(a.getBoundingClientRect(),!1)}if(s==null&&r<Cn(n)){let a=n.childNodes[r];if(a.nodeType==1)return kf(a.getBoundingClientRect(),!0)}return kf(n.getBoundingClientRect(),t>=0)}if(s==null&&r&&(t<0||r==Cn(n))){let a=n.childNodes[r-1],h=a.nodeType==3?Hn(a,Cn(a)-(o?0:1)):a.nodeType==1&&(a.nodeName!="BR"||!a.nextSibling)?a:null;if(h)return lo(Si(h,1),!1)}if(s==null&&r<Cn(n)){let a=n.childNodes[r];for(;a.pmViewDesc&&a.pmViewDesc.ignoreForCoords;)a=a.nextSibling;let h=a?a.nodeType==3?Hn(a,0,o?0:1):a.nodeType==1?a:null:null;if(h)return lo(Si(h,-1),!0)}return lo(Si(n.nodeType==3?Hn(n):n,-t),t>=0)}function lo(i,e){if(i.width==0)return i;let t=e?i.left:i.right;return{top:i.top,bottom:i.bottom,left:t,right:t}}function kf(i,e){if(i.height==0)return i;let t=e?i.top:i.bottom;return{top:t,bottom:t,left:i.left,right:i.right}}function gk(i,e,t){let n=i.state,r=i.root.activeElement;n!=e&&i.updateState(e),r!=i.dom&&i.focus();try{return t()}finally{n!=e&&i.updateState(n),r!=i.dom&&r&&r.focus()}}function FQ(i,e,t){let n=e.selection,r=t=="up"?n.$from:n.$to;return gk(i,e,()=>{let{node:s}=i.docView.domFromPos(r.pos,t=="up"?-1:1);for(;;){let l=i.docView.nearestDesc(s,!0);if(!l)break;if(l.node.isBlock){s=l.contentDOM||l.dom;break}s=l.dom.parentNode}let o=mk(i,r.pos,1);for(let l=s.firstChild;l;l=l.nextSibling){let a;if(l.nodeType==1)a=l.getClientRects();else if(l.nodeType==3)a=Hn(l,0,l.nodeValue.length).getClientRects();else continue;for(let h=0;h<a.length;h++){let c=a[h];if(c.bottom>c.top+1&&(t=="up"?o.top-c.top>(c.bottom-o.top)*2:c.bottom-o.bottom>(o.bottom-c.top)*2))return!1}}return!0})}const UQ=/[\u0590-\u08ac]/;function GQ(i,e,t){let{$head:n}=e.selection;if(!n.parent.isTextblock)return!1;let r=n.parentOffset,s=!r,o=r==n.parent.content.size,l=i.domSelection();return!UQ.test(n.parent.textContent)||!l.modify?t=="left"||t=="backward"?s:o:gk(i,e,()=>{let{focusNode:a,focusOffset:h,anchorNode:c,anchorOffset:f}=i.domSelectionRange(),u=l.caretBidiLevel;l.modify("move",t,"character");let d=n.depth?i.docView.domAfterPos(n.before()):i.dom,{focusNode:p,focusOffset:m}=i.domSelectionRange(),g=p&&!d.contains(p.nodeType==1?p:p.parentNode)||a==p&&h==m;try{l.collapse(c,f),a&&(a!=c||h!=f)&&l.extend&&l.extend(a,h)}catch{}return u!=null&&(l.caretBidiLevel=u),g})}let Yg=null,jg=null,_g=!1;function HQ(i,e,t){return Yg==e&&jg==t?_g:(Yg=e,jg=t,_g=t=="up"||t=="down"?FQ(i,e,t):GQ(i,e,t))}const Ft=0,Fg=1,gr=2,Vn=3;class Fl{constructor(e,t,n,r){this.parent=e,this.children=t,this.dom=n,this.contentDOM=r,this.dirty=Ft,n.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,n){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,n=this.posAtStart;;t++){let r=this.children[t];if(r==e)return n;n+=r.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,n){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(n<0){let s,o;if(e==this.contentDOM)s=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.previousSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.previousSibling;return s?this.posBeforeChild(o)+o.size:this.posAtStart}else{let s,o;if(e==this.contentDOM)s=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.nextSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.nextSibling;return s?this.posBeforeChild(o):this.posAtEnd}let r;if(e==this.dom&&this.contentDOM)r=t>qe(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))r=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let s=e;;s=s.parentNode){if(s==this.dom){r=!1;break}if(s.previousSibling)break}if(r==null&&t==e.childNodes.length)for(let s=e;;s=s.parentNode){if(s==this.dom){r=!0;break}if(s.nextSibling)break}}return r??n>0?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let n=!0,r=e;r;r=r.parentNode){let s=this.getDesc(r),o;if(s&&(!t||s.node))if(n&&(o=s.nodeDOM)&&!(o.nodeType==1?o.contains(e.nodeType==1?e:e.parentNode):o==e))n=!1;else return s}}getDesc(e){let t=e.pmViewDesc;for(let n=t;n;n=n.parent)if(n==this)return t}posFromDOM(e,t,n){for(let r=e;r;r=r.parentNode){let s=this.getDesc(r);if(s)return s.localPosFromDOM(e,t,n)}return-1}descAt(e){for(let t=0,n=0;t<this.children.length;t++){let r=this.children[t],s=n+r.size;if(n==e&&s!=n){for(;!r.border&&r.children.length;)r=r.children[0];return r}if(e<s)return r.descAt(e-n-r.border);n=s}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let n=0,r=0;for(let s=0;n<this.children.length;n++){let o=this.children[n],l=s+o.size;if(l>e||o instanceof yk){r=e-s;break}s=l}if(r)return this.children[n].domFromPos(r-this.children[n].border,t);for(let s;n&&!(s=this.children[n-1]).size&&s instanceof Ok&&s.side>=0;n--);if(t<=0){let s,o=!0;for(;s=n?this.children[n-1]:null,!(!s||s.dom.parentNode==this.contentDOM);n--,o=!1);return s&&t&&o&&!s.border&&!s.domAtom?s.domFromPos(s.size,t):{node:this.contentDOM,offset:s?qe(s.dom)+1:0}}else{let s,o=!0;for(;s=n<this.children.length?this.children[n]:null,!(!s||s.dom.parentNode==this.contentDOM);n++,o=!1);return s&&o&&!s.border&&!s.domAtom?s.domFromPos(0,t):{node:this.contentDOM,offset:s?qe(s.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,n=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let r=-1,s=-1;for(let o=n,l=0;;l++){let a=this.children[l],h=o+a.size;if(r==-1&&e<=h){let c=o+a.border;if(e>=c&&t<=h-a.border&&a.node&&a.contentDOM&&this.contentDOM.contains(a.contentDOM))return a.parseRange(e,t,c);e=o;for(let f=l;f>0;f--){let u=this.children[f-1];if(u.size&&u.dom.parentNode==this.contentDOM&&!u.emptyChildAt(1)){r=qe(u.dom)+1;break}e-=u.size}r==-1&&(r=0)}if(r>-1&&(h>t||l==this.children.length-1)){t=h;for(let c=l+1;c<this.children.length;c++){let f=this.children[c];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(-1)){s=qe(f.dom);break}t+=f.size}s==-1&&(s=this.contentDOM.childNodes.length);break}o=h}return{node:this.contentDOM,from:e,to:t,fromOffset:r,toOffset:s}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:n}=this.domFromPos(e,0);if(t.nodeType!=1||n==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[n]}setSelection(e,t,n,r=!1){let s=Math.min(e,t),o=Math.max(e,t);for(let u=0,d=0;u<this.children.length;u++){let p=this.children[u],m=d+p.size;if(s>d&&o<m)return p.setSelection(e-d-p.border,t-d-p.border,n,r);d=m}let l=this.domFromPos(e,e?-1:1),a=t==e?l:this.domFromPos(t,t?-1:1),h=n.getSelection(),c=!1;if((fn||ft)&&e==t){let{node:u,offset:d}=l;if(u.nodeType==3){if(c=!!(d&&u.nodeValue[d-1]==`
`),c&&d==u.nodeValue.length)for(let p=u,m;p;p=p.parentNode){if(m=p.nextSibling){m.nodeName=="BR"&&(l=a={node:m.parentNode,offset:qe(m)+1});break}let g=p.pmViewDesc;if(g&&g.node&&g.node.isBlock)break}}else{let p=u.childNodes[d-1];c=p&&(p.nodeName=="BR"||p.contentEditable=="false")}}if(fn&&h.focusNode&&h.focusNode!=a.node&&h.focusNode.nodeType==1){let u=h.focusNode.childNodes[h.focusOffset];u&&u.contentEditable=="false"&&(r=!0)}if(!(r||c&&ft)&&Er(l.node,l.offset,h.anchorNode,h.anchorOffset)&&Er(a.node,a.offset,h.focusNode,h.focusOffset))return;let f=!1;if((h.extend||e==t)&&!c){h.collapse(l.node,l.offset);try{e!=t&&h.extend(a.node,a.offset),f=!0}catch{}}if(!f){if(e>t){let d=l;l=a,a=d}let u=document.createRange();u.setEnd(a.node,a.offset),u.setStart(l.node,l.offset),h.removeAllRanges(),h.addRange(u)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let n=0,r=0;r<this.children.length;r++){let s=this.children[r],o=n+s.size;if(n==o?e<=o&&t>=n:e<o&&t>n){let l=n+s.border,a=o-s.border;if(e>=l&&t<=a){this.dirty=e==n||t==o?gr:Fg,e==l&&t==a&&(s.contentLost||s.dom.parentNode!=this.contentDOM)?s.dirty=Vn:s.markDirty(e-l,t-l);return}else s.dirty=s.dom==s.contentDOM&&s.dom.parentNode==this.contentDOM&&!s.children.length?gr:Vn}n=o}this.dirty=gr}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let n=e==1?gr:Fg;t.dirty<n&&(t.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}isText(e){return!1}}class Ok extends Fl{constructor(e,t,n,r){let s,o=t.type.toDOM;if(typeof o=="function"&&(o=o(n,()=>{if(!s)return r;if(s.parent)return s.parent.posBeforeChild(s)})),!t.type.spec.raw){if(o.nodeType!=1){let l=document.createElement("span");l.appendChild(o),o=l}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=t,this.widget=t,s=this}matchesWidget(e){return this.dirty==Ft&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class KQ extends Fl{constructor(e,t,n,r){super(e,[],t,null),this.textDOM=n,this.text=r}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class Nr extends Fl{constructor(e,t,n,r){super(e,[],n,r),this.mark=t}static create(e,t,n,r){let s=r.nodeViews[t.type.name],o=s&&s(t,r,n);return(!o||!o.dom)&&(o=Zn.renderSpec(document,t.type.spec.toDOM(t,n))),new Nr(e,t,o.dom,o.contentDOM||o.dom)}parseRule(){return this.dirty&Vn||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Vn&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=Ft){let n=this.parent;for(;!n.node;)n=n.parent;n.dirty<this.dirty&&(n.dirty=this.dirty),this.dirty=Ft}}slice(e,t,n){let r=Nr.create(this.parent,this.mark,!0,n),s=this.children,o=this.size;t<o&&(s=Bu(s,t,o,n)),e>0&&(s=Bu(s,0,e,n));for(let l=0;l<s.length;l++)s[l].parent=r;return r.children=s,r}}class Vi extends Fl{constructor(e,t,n,r,s,o,l,a,h){super(e,[],s,o),this.node=t,this.outerDeco=n,this.innerDeco=r,this.nodeDOM=l}static create(e,t,n,r,s,o){let l=s.nodeViews[t.type.name],a,h=l&&l(t,s,()=>{if(!a)return o;if(a.parent)return a.parent.posBeforeChild(a)},n,r),c=h&&h.dom,f=h&&h.contentDOM;if(t.isText){if(!c)c=document.createTextNode(t.text);else if(c.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else c||({dom:c,contentDOM:f}=Zn.renderSpec(document,t.type.spec.toDOM(t)));!f&&!t.isText&&c.nodeName!="BR"&&(c.hasAttribute("contenteditable")||(c.contentEditable="false"),t.type.spec.draggable&&(c.draggable=!0));let u=c;return c=Sk(c,n,t),h?a=new JQ(e,t,n,r,c,f||null,u,h,s,o+1):t.isText?new Cc(e,t,n,r,c,u,s):new Vi(e,t,n,r,c,f||null,u,s,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){let n=this.children[t];if(this.dom.contains(n.dom.parentNode)){e.contentElement=n.dom.parentNode;break}}e.contentElement||(e.getContent=()=>P.empty)}return e}matchesNode(e,t,n){return this.dirty==Ft&&e.eq(this.node)&&Xu(t,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let n=this.node.inlineContent,r=t,s=e.composing?this.localCompositionInfo(e,t):null,o=s&&s.pos>-1?s:null,l=s&&s.pos<0,a=new tC(this,o&&o.node,e);rC(this.node,this.innerDeco,(h,c,f)=>{h.spec.marks?a.syncToMarks(h.spec.marks,n,e):h.type.side>=0&&!f&&a.syncToMarks(c==this.node.childCount?G.none:this.node.child(c).marks,n,e),a.placeWidget(h,e,r)},(h,c,f,u)=>{a.syncToMarks(h.marks,n,e);let d;a.findNodeMatch(h,c,f,u)||l&&e.state.selection.from>r&&e.state.selection.to<r+h.nodeSize&&(d=a.findIndexWithChild(s.node))>-1&&a.updateNodeAt(h,c,f,d,e)||a.updateNextNode(h,c,f,e,u,r)||a.addNode(h,c,f,e,r),r+=h.nodeSize}),a.syncToMarks([],n,e),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||this.dirty==gr)&&(o&&this.protectLocalComposition(e,o),kk(this.contentDOM,this.children,e),Es&&sC(this.dom))}localCompositionInfo(e,t){let{from:n,to:r}=e.state.selection;if(!(e.state.selection instanceof J)||n<t||r>t+this.node.content.size)return null;let s=e.input.compositionNode;if(!s||!this.dom.contains(s.parentNode))return null;if(this.node.inlineContent){let o=s.nodeValue,l=oC(this.node.content,o,n-t,r-t);return l<0?null:{node:s,pos:l,text:o}}else return{node:s,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:n,text:r}){if(this.getDesc(t))return;let s=t;for(;s.parentNode!=this.contentDOM;s=s.parentNode){for(;s.previousSibling;)s.parentNode.removeChild(s.previousSibling);for(;s.nextSibling;)s.parentNode.removeChild(s.nextSibling);s.pmViewDesc&&(s.pmViewDesc=void 0)}let o=new KQ(this,s,t,r);e.input.compositionNodes.push(o),this.children=Bu(this.children,n,n+r.length,e,o)}update(e,t,n,r){return this.dirty==Vn||!e.sameMarkup(this.node)?!1:(this.updateInner(e,t,n,r),!0)}updateInner(e,t,n,r){this.updateOuterDeco(t),this.node=e,this.innerDeco=n,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=Ft}updateOuterDeco(e){if(Xu(e,this.outerDeco))return;let t=this.nodeDOM.nodeType!=1,n=this.dom;this.dom=bk(this.dom,this.nodeDOM,Wu(this.outerDeco,this.node,t),Wu(e,this.node,t)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}}function Ug(i,e,t,n,r){Sk(n,e,i);let s=new Vi(void 0,i,e,t,n,n,n,r,0);return s.contentDOM&&s.updateChildren(r,0),s}class Cc extends Vi{constructor(e,t,n,r,s,o,l){super(e,t,n,r,s,null,o,l,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,n,r){return this.dirty==Vn||this.dirty!=Ft&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(t),(this.dirty!=Ft||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,r.trackWrites==this.nodeDOM&&(r.trackWrites=null)),this.node=e,this.dirty=Ft,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,n){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,n)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,t,n){let r=this.node.cut(e,t),s=document.createTextNode(r.text);return new Cc(this.parent,r,this.outerDeco,this.innerDeco,s,s,n)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=Vn)}get domAtom(){return!1}isText(e){return this.node.text==e}}class yk extends Fl{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==Ft&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class JQ extends Vi{constructor(e,t,n,r,s,o,l,a,h,c){super(e,t,n,r,s,o,l,h,c),this.spec=a}update(e,t,n,r){if(this.dirty==Vn)return!1;if(this.spec.update){let s=this.spec.update(e,t,n);return s&&this.updateInner(e,t,n,r),s}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,t,n,r)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,n,r){this.spec.setSelection?this.spec.setSelection(e,t,n):super.setSelection(e,t,n,r)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function kk(i,e,t){let n=i.firstChild,r=!1;for(let s=0;s<e.length;s++){let o=e[s],l=o.dom;if(l.parentNode==i){for(;l!=n;)n=Gg(n),r=!0;n=n.nextSibling}else r=!0,i.insertBefore(l,n);if(o instanceof Nr){let a=n?n.previousSibling:i.lastChild;kk(o.contentDOM,o.children,t),n=a?a.nextSibling:i.firstChild}}for(;n;)n=Gg(n),r=!0;r&&t.trackWrites==i&&(t.trackWrites=null)}const Ho=function(i){i&&(this.nodeName=i)};Ho.prototype=Object.create(null);const Or=[new Ho];function Wu(i,e,t){if(i.length==0)return Or;let n=t?Or[0]:new Ho,r=[n];for(let s=0;s<i.length;s++){let o=i[s].type.attrs;if(o){o.nodeName&&r.push(n=new Ho(o.nodeName));for(let l in o){let a=o[l];a!=null&&(t&&r.length==1&&r.push(n=new Ho(e.isInline?"span":"div")),l=="class"?n.class=(n.class?n.class+" ":"")+a:l=="style"?n.style=(n.style?n.style+";":"")+a:l!="nodeName"&&(n[l]=a))}}}return r}function bk(i,e,t,n){if(t==Or&&n==Or)return e;let r=e;for(let s=0;s<n.length;s++){let o=n[s],l=t[s];if(s){let a;l&&l.nodeName==o.nodeName&&r!=i&&(a=r.parentNode)&&a.nodeName.toLowerCase()==o.nodeName||(a=document.createElement(o.nodeName),a.pmIsDeco=!0,a.appendChild(r),l=Or[0]),r=a}eC(r,l||Or[0],o)}return r}function eC(i,e,t){for(let n in e)n!="class"&&n!="style"&&n!="nodeName"&&!(n in t)&&i.removeAttribute(n);for(let n in t)n!="class"&&n!="style"&&n!="nodeName"&&t[n]!=e[n]&&i.setAttribute(n,t[n]);if(e.class!=t.class){let n=e.class?e.class.split(" ").filter(Boolean):[],r=t.class?t.class.split(" ").filter(Boolean):[];for(let s=0;s<n.length;s++)r.indexOf(n[s])==-1&&i.classList.remove(n[s]);for(let s=0;s<r.length;s++)n.indexOf(r[s])==-1&&i.classList.add(r[s]);i.classList.length==0&&i.removeAttribute("class")}if(e.style!=t.style){if(e.style){let n=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,r;for(;r=n.exec(e.style);)i.style.removeProperty(r[1])}t.style&&(i.style.cssText+=t.style)}}function Sk(i,e,t){return bk(i,i,Or,Wu(e,t,i.nodeType!=1))}function Xu(i,e){if(i.length!=e.length)return!1;for(let t=0;t<i.length;t++)if(!i[t].type.eq(e[t].type))return!1;return!0}function Gg(i){let e=i.nextSibling;return i.parentNode.removeChild(i),e}class tC{constructor(e,t,n){this.lock=t,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=nC(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let n=e;n<t;n++)this.top.children[n].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,n){let r=0,s=this.stack.length>>1,o=Math.min(s,e.length);for(;r<o&&(r==s-1?this.top:this.stack[r+1<<1]).matchesMark(e[r])&&e[r].type.spec.spanning!==!1;)r++;for(;r<s;)this.destroyRest(),this.top.dirty=Ft,this.index=this.stack.pop(),this.top=this.stack.pop(),s--;for(;s<e.length;){this.stack.push(this.top,this.index+1);let l=-1;for(let a=this.index;a<Math.min(this.index+3,this.top.children.length);a++){let h=this.top.children[a];if(h.matchesMark(e[s])&&!this.isLocked(h.dom)){l=a;break}}if(l>-1)l>this.index&&(this.changed=!0,this.destroyBetween(this.index,l)),this.top=this.top.children[this.index];else{let a=Nr.create(this.top,e[s],t,n);this.top.children.splice(this.index,0,a),this.top=a,this.changed=!0}this.index=0,s++}}findNodeMatch(e,t,n,r){let s=-1,o;if(r>=this.preMatch.index&&(o=this.preMatch.matches[r-this.preMatch.index]).parent==this.top&&o.matchesNode(e,t,n))s=this.top.children.indexOf(o,this.index);else for(let l=this.index,a=Math.min(this.top.children.length,l+5);l<a;l++){let h=this.top.children[l];if(h.matchesNode(e,t,n)&&!this.preMatch.matched.has(h)){s=l;break}}return s<0?!1:(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(e,t,n,r,s){let o=this.top.children[r];return o.dirty==Vn&&o.dom==o.contentDOM&&(o.dirty=gr),o.update(e,t,n,s)?(this.destroyBetween(this.index,r),this.index++,!0):!1}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let n=e.pmViewDesc;if(n){for(let r=this.index;r<this.top.children.length;r++)if(this.top.children[r]==n)return r}return-1}e=t}}updateNextNode(e,t,n,r,s,o){for(let l=this.index;l<this.top.children.length;l++){let a=this.top.children[l];if(a instanceof Vi){let h=this.preMatch.matched.get(a);if(h!=null&&h!=s)return!1;let c=a.dom,f,u=this.isLocked(c)&&!(e.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==e.text&&a.dirty!=Vn&&Xu(t,a.outerDeco));if(!u&&a.update(e,t,n,r))return this.destroyBetween(this.index,l),a.dom!=c&&(this.changed=!0),this.index++,!0;if(!u&&(f=this.recreateWrapper(a,e,t,n,r,o)))return this.top.children[this.index]=f,f.contentDOM&&(f.dirty=gr,f.updateChildren(r,o+1),f.dirty=Ft),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,n,r,s,o){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content))return null;let l=Vi.create(this.top,t,n,r,s,o);if(l.contentDOM){l.children=e.children,e.children=[];for(let a of l.children)a.parent=l}return e.destroy(),l}addNode(e,t,n,r,s){let o=Vi.create(this.top,e,t,n,r,s);o.contentDOM&&o.updateChildren(r,s+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(e,t,n){let r=this.index<this.top.children.length?this.top.children[this.index]:null;if(r&&r.matchesWidget(e)&&(e==r.widget||!r.widget.type.toDOM.parentNode))this.index++;else{let s=new Ok(this.top,e,t,n);this.top.children.splice(this.index++,0,s),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof Nr;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof Cc)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((ft||ot)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let n=document.createElement(e);e=="IMG"&&(n.className="ProseMirror-separator",n.alt=""),e=="BR"&&(n.className="ProseMirror-trailingBreak");let r=new yk(this.top,[],n,null);t!=this.top?t.children.push(r):t.children.splice(this.index++,0,r),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function nC(i,e){let t=e,n=t.children.length,r=i.childCount,s=new Map,o=[];e:for(;r>0;){let l;for(;;)if(n){let h=t.children[n-1];if(h instanceof Nr)t=h,n=h.children.length;else{l=h,n--;break}}else{if(t==e)break e;n=t.parent.children.indexOf(t),t=t.parent}let a=l.node;if(a){if(a!=i.child(r-1))break;--r,s.set(l,r),o.push(l)}}return{index:r,matched:s,matches:o.reverse()}}function iC(i,e){return i.type.side-e.type.side}function rC(i,e,t,n){let r=e.locals(i),s=0;if(r.length==0){for(let h=0;h<i.childCount;h++){let c=i.child(h);n(c,r,e.forChild(s,c),h),s+=c.nodeSize}return}let o=0,l=[],a=null;for(let h=0;;){let c,f;for(;o<r.length&&r[o].to==s;){let g=r[o++];g.widget&&(c?(f||(f=[c])).push(g):c=g)}if(c)if(f){f.sort(iC);for(let g=0;g<f.length;g++)t(f[g],h,!!a)}else t(c,h,!!a);let u,d;if(a)d=-1,u=a,a=null;else if(h<i.childCount)d=h,u=i.child(h++);else break;for(let g=0;g<l.length;g++)l[g].to<=s&&l.splice(g--,1);for(;o<r.length&&r[o].from<=s&&r[o].to>s;)l.push(r[o++]);let p=s+u.nodeSize;if(u.isText){let g=p;o<r.length&&r[o].from<g&&(g=r[o].from);for(let y=0;y<l.length;y++)l[y].to<g&&(g=l[y].to);g<p&&(a=u.cut(g-s),u=u.cut(0,g-s),p=g,d=-1)}else for(;o<r.length&&r[o].to<p;)o++;let m=u.isInline&&!u.isLeaf?l.filter(g=>!g.inline):l.slice();n(u,m,e.forChild(s,u),d),s=p}}function sC(i){if(i.nodeName=="UL"||i.nodeName=="OL"){let e=i.style.cssText;i.style.cssText=e+"; list-style: square !important",window.getComputedStyle(i).listStyle,i.style.cssText=e}}function oC(i,e,t,n){for(let r=0,s=0;r<i.childCount&&s<=n;){let o=i.child(r++),l=s;if(s+=o.nodeSize,!o.isText)continue;let a=o.text;for(;r<i.childCount;){let h=i.child(r++);if(s+=h.nodeSize,!h.isText)break;a+=h.text}if(s>=t){if(s>=n&&a.slice(n-e.length-l,n-l)==e)return n-e.length;let h=l<n?a.lastIndexOf(e,n-l-1):-1;if(h>=0&&h+e.length+l>=t)return l+h;if(t==n&&a.length>=n+e.length-l&&a.slice(n-l,n-l+e.length)==e)return n}}return-1}function Bu(i,e,t,n,r){let s=[];for(let o=0,l=0;o<i.length;o++){let a=i[o],h=l,c=l+=a.size;h>=t||c<=e?s.push(a):(h<e&&s.push(a.slice(0,e-h,n)),r&&(s.push(r),r=void 0),c>t&&s.push(a.slice(t-h,a.size,n)))}return s}function Op(i,e=null){let t=i.domSelectionRange(),n=i.state.doc;if(!t.focusNode)return null;let r=i.docView.nearestDesc(t.focusNode),s=r&&r.size==0,o=i.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(o<0)return null;let l=n.resolve(o),a,h;if(Qc(t)){for(a=l;r&&!r.node;)r=r.parent;let c=r.node;if(r&&c.isAtom&&V.isSelectable(c)&&r.parent&&!(c.isInline&&AQ(t.focusNode,t.focusOffset,r.dom))){let f=r.posBefore;h=new V(o==f?l:n.resolve(f))}}else{let c=i.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(c<0)return null;a=n.resolve(c)}if(!h){let c=e=="pointer"||i.state.selection.head<l.pos&&!s?1:-1;h=yp(i,a,l,c)}return h}function wk(i){return i.editable?i.hasFocus():vk(i)&&document.activeElement&&document.activeElement.contains(i.dom)}function si(i,e=!1){let t=i.state.selection;if(xk(i,t),!!wk(i)){if(!e&&i.input.mouseDown&&i.input.mouseDown.allowDefault&&ot){let n=i.domSelectionRange(),r=i.domObserver.currentSelection;if(n.anchorNode&&r.anchorNode&&Er(n.anchorNode,n.anchorOffset,r.anchorNode,r.anchorOffset)){i.input.mouseDown.delayedSelectionSync=!0,i.domObserver.setCurSelection();return}}if(i.domObserver.disconnectSelection(),i.cursorWrapper)aC(i);else{let{anchor:n,head:r}=t,s,o;Hg&&!(t instanceof J)&&(t.$from.parent.inlineContent||(s=Kg(i,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(o=Kg(i,t.to))),i.docView.setSelection(n,r,i.root,e),Hg&&(s&&Jg(s),o&&Jg(o)),t.visible?i.dom.classList.remove("ProseMirror-hideselection"):(i.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&lC(i))}i.domObserver.setCurSelection(),i.domObserver.connectSelection()}}const Hg=ft||ot&&EQ<63;function Kg(i,e){let{node:t,offset:n}=i.docView.domFromPos(e,0),r=n<t.childNodes.length?t.childNodes[n]:null,s=n?t.childNodes[n-1]:null;if(ft&&r&&r.contentEditable=="false")return bf(r);if((!r||r.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(r)return bf(r);if(s)return bf(s)}}function bf(i){return i.contentEditable="true",ft&&i.draggable&&(i.draggable=!1,i.wasDraggable=!0),i}function Jg(i){i.contentEditable="false",i.wasDraggable&&(i.draggable=!0,i.wasDraggable=null)}function lC(i){let e=i.dom.ownerDocument;e.removeEventListener("selectionchange",i.input.hideSelectionGuard);let t=i.domSelectionRange(),n=t.anchorNode,r=t.anchorOffset;e.addEventListener("selectionchange",i.input.hideSelectionGuard=()=>{(t.anchorNode!=n||t.anchorOffset!=r)&&(e.removeEventListener("selectionchange",i.input.hideSelectionGuard),setTimeout(()=>{(!wk(i)||i.state.selection.visible)&&i.dom.classList.remove("ProseMirror-hideselection")},20))})}function aC(i){let e=i.domSelection(),t=document.createRange(),n=i.cursorWrapper.dom,r=n.nodeName=="IMG";r?t.setEnd(n.parentNode,qe(n)+1):t.setEnd(n,0),t.collapse(!1),e.removeAllRanges(),e.addRange(t),!r&&!i.state.selection.visible&&bt&&Bi<=11&&(n.disabled=!0,n.disabled=!1)}function xk(i,e){if(e instanceof V){let t=i.docView.descAt(e.from);t!=i.lastSelectedViewDesc&&(eO(i),t&&t.selectNode(),i.lastSelectedViewDesc=t)}else eO(i)}function eO(i){i.lastSelectedViewDesc&&(i.lastSelectedViewDesc.parent&&i.lastSelectedViewDesc.deselectNode(),i.lastSelectedViewDesc=void 0)}function yp(i,e,t,n){return i.someProp("createSelectionBetween",r=>r(i,e,t))||J.between(e,t,n)}function tO(i){return i.editable&&!i.hasFocus()?!1:vk(i)}function vk(i){let e=i.domSelectionRange();if(!e.anchorNode)return!1;try{return i.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(i.editable||i.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function hC(i){let e=i.docView.domFromPos(i.state.selection.anchor,0),t=i.domSelectionRange();return Er(e.node,e.offset,t.anchorNode,t.anchorOffset)}function Vu(i,e){let{$anchor:t,$head:n}=i.selection,r=e>0?t.max(n):t.min(n),s=r.parent.inlineContent?r.depth?i.doc.resolve(e>0?r.after():r.before()):null:r;return s&&_.findFrom(s,e)}function vi(i,e){return i.dispatch(i.state.tr.setSelection(e).scrollIntoView()),!0}function nO(i,e,t){let n=i.state.selection;if(n instanceof J)if(t.indexOf("s")>-1){let{$head:r}=n,s=r.textOffset?null:e<0?r.nodeBefore:r.nodeAfter;if(!s||s.isText||!s.isLeaf)return!1;let o=i.state.doc.resolve(r.pos+s.nodeSize*(e<0?-1:1));return vi(i,new J(n.$anchor,o))}else if(n.empty){if(i.endOfTextblock(e>0?"forward":"backward")){let r=Vu(i.state,e);return r&&r instanceof V?vi(i,r):!1}else if(!(Vt&&t.indexOf("m")>-1)){let r=n.$head,s=r.textOffset?null:e<0?r.nodeBefore:r.nodeAfter,o;if(!s||s.isText)return!1;let l=e<0?r.pos-s.nodeSize:r.pos;return s.isAtom||(o=i.docView.descAt(l))&&!o.contentDOM?V.isSelectable(s)?vi(i,new V(e<0?i.state.doc.resolve(r.pos-s.nodeSize):r)):_l?vi(i,new J(i.state.doc.resolve(e<0?l:l+s.nodeSize))):!1:!1}}else return!1;else{if(n instanceof V&&n.node.isInline)return vi(i,new J(e>0?n.$to:n.$from));{let r=Vu(i.state,e);return r?vi(i,r):!1}}}function Vh(i){return i.nodeType==3?i.nodeValue.length:i.childNodes.length}function Ko(i,e){let t=i.pmViewDesc;return t&&t.size==0&&(e<0||i.nextSibling||i.nodeName!="BR")}function Ur(i,e){return e<0?cC(i):fC(i)}function cC(i){let e=i.domSelectionRange(),t=e.focusNode,n=e.focusOffset;if(!t)return;let r,s,o=!1;for(fn&&t.nodeType==1&&n<Vh(t)&&Ko(t.childNodes[n],-1)&&(o=!0);;)if(n>0){if(t.nodeType!=1)break;{let l=t.childNodes[n-1];if(Ko(l,-1))r=t,s=--n;else if(l.nodeType==3)t=l,n=t.nodeValue.length;else break}}else{if($k(t))break;{let l=t.previousSibling;for(;l&&Ko(l,-1);)r=t.parentNode,s=qe(l),l=l.previousSibling;if(l)t=l,n=Vh(t);else{if(t=t.parentNode,t==i.dom)break;n=0}}}o?qu(i,t,n):r&&qu(i,r,s)}function fC(i){let e=i.domSelectionRange(),t=e.focusNode,n=e.focusOffset;if(!t)return;let r=Vh(t),s,o;for(;;)if(n<r){if(t.nodeType!=1)break;let l=t.childNodes[n];if(Ko(l,1))s=t,o=++n;else break}else{if($k(t))break;{let l=t.nextSibling;for(;l&&Ko(l,1);)s=l.parentNode,o=qe(l)+1,l=l.nextSibling;if(l)t=l,n=0,r=Vh(t);else{if(t=t.parentNode,t==i.dom)break;n=r=0}}}s&&qu(i,s,o)}function $k(i){let e=i.pmViewDesc;return e&&e.node&&e.node.isBlock}function uC(i,e){for(;i&&e==i.childNodes.length&&!jl(i);)e=qe(i)+1,i=i.parentNode;for(;i&&e<i.childNodes.length;){let t=i.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;i=t,e=0}}function dC(i,e){for(;i&&!e&&!jl(i);)e=qe(i),i=i.parentNode;for(;i&&e;){let t=i.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;i=t,e=i.childNodes.length}}function qu(i,e,t){if(e.nodeType!=3){let s,o;(o=uC(e,t))?(e=o,t=0):(s=dC(e,t))&&(e=s,t=s.nodeValue.length)}let n=i.domSelection();if(Qc(n)){let s=document.createRange();s.setEnd(e,t),s.setStart(e,t),n.removeAllRanges(),n.addRange(s)}else n.extend&&n.extend(e,t);i.domObserver.setCurSelection();let{state:r}=i;setTimeout(()=>{i.state==r&&si(i)},50)}function iO(i,e){let t=i.state.doc.resolve(e);if(!(ot||NQ)&&t.parent.inlineContent){let r=i.coordsAtPos(e);if(e>t.start()){let s=i.coordsAtPos(e-1),o=(s.top+s.bottom)/2;if(o>r.top&&o<r.bottom&&Math.abs(s.left-r.left)>1)return s.left<r.left?"ltr":"rtl"}if(e<t.end()){let s=i.coordsAtPos(e+1),o=(s.top+s.bottom)/2;if(o>r.top&&o<r.bottom&&Math.abs(s.left-r.left)>1)return s.left>r.left?"ltr":"rtl"}}return getComputedStyle(i.dom).direction=="rtl"?"rtl":"ltr"}function rO(i,e,t){let n=i.state.selection;if(n instanceof J&&!n.empty||t.indexOf("s")>-1||Vt&&t.indexOf("m")>-1)return!1;let{$from:r,$to:s}=n;if(!r.parent.inlineContent||i.endOfTextblock(e<0?"up":"down")){let o=Vu(i.state,e);if(o&&o instanceof V)return vi(i,o)}if(!r.parent.inlineContent){let o=e<0?r:s,l=n instanceof Nt?_.near(o,e):_.findFrom(o,e);return l?vi(i,l):!1}return!1}function sO(i,e){if(!(i.state.selection instanceof J))return!0;let{$head:t,$anchor:n,empty:r}=i.state.selection;if(!t.sameParent(n))return!0;if(!r)return!1;if(i.endOfTextblock(e>0?"forward":"backward"))return!0;let s=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(s&&!s.isText){let o=i.state.tr;return e<0?o.delete(t.pos-s.nodeSize,t.pos):o.delete(t.pos,t.pos+s.nodeSize),i.dispatch(o),!0}return!1}function oO(i,e,t){i.domObserver.stop(),e.contentEditable=t,i.domObserver.start()}function pC(i){if(!ft||i.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=i.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let n=e.firstChild;oO(i,n,"true"),setTimeout(()=>oO(i,n,"false"),20)}return!1}function mC(i){let e="";return i.ctrlKey&&(e+="c"),i.metaKey&&(e+="m"),i.altKey&&(e+="a"),i.shiftKey&&(e+="s"),e}function gC(i,e){let t=e.keyCode,n=mC(e);if(t==8||Vt&&t==72&&n=="c")return sO(i,-1)||Ur(i,-1);if(t==46&&!e.shiftKey||Vt&&t==68&&n=="c")return sO(i,1)||Ur(i,1);if(t==13||t==27)return!0;if(t==37||Vt&&t==66&&n=="c"){let r=t==37?iO(i,i.state.selection.from)=="ltr"?-1:1:-1;return nO(i,r,n)||Ur(i,r)}else if(t==39||Vt&&t==70&&n=="c"){let r=t==39?iO(i,i.state.selection.from)=="ltr"?1:-1:1;return nO(i,r,n)||Ur(i,r)}else{if(t==38||Vt&&t==80&&n=="c")return rO(i,-1,n)||Ur(i,-1);if(t==40||Vt&&t==78&&n=="c")return pC(i)||rO(i,1,n)||Ur(i,1);if(n==(Vt?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function Pk(i,e){i.someProp("transformCopied",d=>{e=d(e,i)});let t=[],{content:n,openStart:r,openEnd:s}=e;for(;r>1&&s>1&&n.childCount==1&&n.firstChild.childCount==1;){r--,s--;let d=n.firstChild;t.push(d.type.name,d.attrs!=d.type.defaultAttrs?d.attrs:null),n=d.content}let o=i.someProp("clipboardSerializer")||Zn.fromSchema(i.state.schema),l=Zk(),a=l.createElement("div");a.appendChild(o.serializeFragment(n,{document:l}));let h=a.firstChild,c,f=0;for(;h&&h.nodeType==1&&(c=Ak[h.nodeName.toLowerCase()]);){for(let d=c.length-1;d>=0;d--){let p=l.createElement(c[d]);for(;a.firstChild;)p.appendChild(a.firstChild);a.appendChild(p),f++}h=a.firstChild}h&&h.nodeType==1&&h.setAttribute("data-pm-slice",`${r} ${s}${f?` -${f}`:""} ${JSON.stringify(t)}`);let u=i.someProp("clipboardTextSerializer",d=>d(e,i))||e.content.textBetween(0,e.content.size,`

`);return{dom:a,text:u}}function Qk(i,e,t,n,r){let s=r.parent.type.spec.code,o,l;if(!t&&!e)return null;let a=e&&(n||s||!t);if(a){if(i.someProp("transformPastedText",u=>{e=u(e,s||n,i)}),s)return e?new Z(P.from(i.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):Z.empty;let f=i.someProp("clipboardTextParser",u=>u(e,r,n,i));if(f)l=f;else{let u=r.marks(),{schema:d}=i.state,p=Zn.fromSchema(d);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(m=>{let g=o.appendChild(document.createElement("p"));m&&g.appendChild(p.serializeNode(d.text(m,u)))})}}else i.someProp("transformPastedHTML",f=>{t=f(t,i)}),o=kC(t),_l&&bC(o);let h=o&&o.querySelector("[data-pm-slice]"),c=h&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(h.getAttribute("data-pm-slice")||"");if(c&&c[3])for(let f=+c[3];f>0;f--){let u=o.firstChild;for(;u&&u.nodeType!=1;)u=u.nextSibling;if(!u)break;o=u}if(l||(l=(i.someProp("clipboardParser")||i.someProp("domParser")||Rr.fromSchema(i.state.schema)).parseSlice(o,{preserveWhitespace:!!(a||c),context:r,ruleFromNode(u){return u.nodeName=="BR"&&!u.nextSibling&&u.parentNode&&!OC.test(u.parentNode.nodeName)?{ignore:!0}:null}})),c)l=SC(lO(l,+c[1],+c[2]),c[4]);else if(l=Z.maxOpen(yC(l.content,r),!0),l.openStart||l.openEnd){let f=0,u=0;for(let d=l.content.firstChild;f<l.openStart&&!d.type.spec.isolating;f++,d=d.firstChild);for(let d=l.content.lastChild;u<l.openEnd&&!d.type.spec.isolating;u++,d=d.lastChild);l=lO(l,f,u)}return i.someProp("transformPasted",f=>{l=f(l,i)}),l}const OC=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function yC(i,e){if(i.childCount<2)return i;for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.index(t)),s,o=[];if(i.forEach(l=>{if(!o)return;let a=r.findWrapping(l.type),h;if(!a)return o=null;if(h=o.length&&s.length&&Tk(a,s,l,o[o.length-1],0))o[o.length-1]=h;else{o.length&&(o[o.length-1]=Mk(o[o.length-1],s.length));let c=Ck(l,a);o.push(c),r=r.matchType(c.type),s=a}}),o)return P.from(o)}return i}function Ck(i,e,t=0){for(let n=e.length-1;n>=t;n--)i=e[n].create(null,P.from(i));return i}function Tk(i,e,t,n,r){if(r<i.length&&r<e.length&&i[r]==e[r]){let s=Tk(i,e,t,n.lastChild,r+1);if(s)return n.copy(n.content.replaceChild(n.childCount-1,s));if(n.contentMatchAt(n.childCount).matchType(r==i.length-1?t.type:i[r+1]))return n.copy(n.content.append(P.from(Ck(t,i,r+1))))}}function Mk(i,e){if(e==0)return i;let t=i.content.replaceChild(i.childCount-1,Mk(i.lastChild,e-1)),n=i.contentMatchAt(i.childCount).fillBefore(P.empty,!0);return i.copy(t.append(n))}function Lu(i,e,t,n,r,s){let o=e<0?i.firstChild:i.lastChild,l=o.content;return i.childCount>1&&(s=0),r<n-1&&(l=Lu(l,e,t,n,r+1,s)),r>=t&&(l=e<0?o.contentMatchAt(0).fillBefore(l,s<=r).append(l):l.append(o.contentMatchAt(o.childCount).fillBefore(P.empty,!0))),i.replaceChild(e<0?0:i.childCount-1,o.copy(l))}function lO(i,e,t){return e<i.openStart&&(i=new Z(Lu(i.content,-1,e,i.openStart,0,i.openEnd),e,i.openEnd)),t<i.openEnd&&(i=new Z(Lu(i.content,1,t,i.openEnd,0,0),i.openStart,t)),i}const Ak={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let aO=null;function Zk(){return aO||(aO=document.implementation.createHTMLDocument("title"))}function kC(i){let e=/^(\s*<meta [^>]*>)*/.exec(i);e&&(i=i.slice(e[0].length));let t=Zk().createElement("div"),n=/<([a-z][^>\s]+)/i.exec(i),r;if((r=n&&Ak[n[1].toLowerCase()])&&(i=r.map(s=>"<"+s+">").join("")+i+r.map(s=>"</"+s+">").reverse().join("")),t.innerHTML=i,r)for(let s=0;s<r.length;s++)t=t.querySelector(r[s])||t;return t}function bC(i){let e=i.querySelectorAll(ot?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let n=e[t];n.childNodes.length==1&&n.textContent==""&&n.parentNode&&n.parentNode.replaceChild(i.ownerDocument.createTextNode(" "),n)}}function SC(i,e){if(!i.size)return i;let t=i.content.firstChild.type.schema,n;try{n=JSON.parse(e)}catch{return i}let{content:r,openStart:s,openEnd:o}=i;for(let l=n.length-2;l>=0;l-=2){let a=t.nodes[n[l]];if(!a||a.hasRequiredAttrs())break;r=P.from(a.create(n[l+1],r)),s++,o++}return new Z(r,s,o)}const ut={},dt={},wC={touchstart:!0,touchmove:!0};let xC=class{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}};function vC(i){for(let e in ut){let t=ut[e];i.dom.addEventListener(e,i.input.eventHandlers[e]=n=>{PC(i,n)&&!kp(i,n)&&(i.editable||!(n.type in dt))&&t(i,n)},wC[e]?{passive:!0}:void 0)}ft&&i.dom.addEventListener("input",()=>null),zu(i)}function Zi(i,e){i.input.lastSelectionOrigin=e,i.input.lastSelectionTime=Date.now()}function $C(i){i.domObserver.stop();for(let e in i.input.eventHandlers)i.dom.removeEventListener(e,i.input.eventHandlers[e]);clearTimeout(i.input.composingTimeout),clearTimeout(i.input.lastIOSEnterFallbackTimeout)}function zu(i){i.someProp("handleDOMEvents",e=>{for(let t in e)i.input.eventHandlers[t]||i.dom.addEventListener(t,i.input.eventHandlers[t]=n=>kp(i,n))})}function kp(i,e){return i.someProp("handleDOMEvents",t=>{let n=t[e.type];return n?n(i,e)||e.defaultPrevented:!1})}function PC(i,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target;t!=i.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function QC(i,e){!kp(i,e)&&ut[e.type]&&(i.editable||!(e.type in dt))&&ut[e.type](i,e)}dt.keydown=(i,e)=>{let t=e;if(i.input.shiftKey=t.keyCode==16||t.shiftKey,!Ek(i,t)&&(i.input.lastKeyCode=t.keyCode,i.input.lastKeyCodeTime=Date.now(),!(rn&&ot&&t.keyCode==13)))if(t.keyCode!=229&&i.domObserver.forceFlush(),Es&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let n=Date.now();i.input.lastIOSEnter=n,i.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{i.input.lastIOSEnter==n&&(i.someProp("handleKeyDown",r=>r(i,cr(13,"Enter"))),i.input.lastIOSEnter=0)},200)}else i.someProp("handleKeyDown",n=>n(i,t))||gC(i,t)?t.preventDefault():Zi(i,"key")};dt.keyup=(i,e)=>{e.keyCode==16&&(i.input.shiftKey=!1)};dt.keypress=(i,e)=>{let t=e;if(Ek(i,t)||!t.charCode||t.ctrlKey&&!t.altKey||Vt&&t.metaKey)return;if(i.someProp("handleKeyPress",r=>r(i,t))){t.preventDefault();return}let n=i.state.selection;if(!(n instanceof J)||!n.$from.sameParent(n.$to)){let r=String.fromCharCode(t.charCode);!/[\r\n]/.test(r)&&!i.someProp("handleTextInput",s=>s(i,n.$from.pos,n.$to.pos,r))&&i.dispatch(i.state.tr.insertText(r).scrollIntoView()),t.preventDefault()}};function Tc(i){return{left:i.clientX,top:i.clientY}}function CC(i,e){let t=e.x-i.clientX,n=e.y-i.clientY;return t*t+n*n<100}function bp(i,e,t,n,r){if(n==-1)return!1;let s=i.state.doc.resolve(n);for(let o=s.depth+1;o>0;o--)if(i.someProp(e,l=>o>s.depth?l(i,t,s.nodeAfter,s.before(o),r,!0):l(i,t,s.node(o),s.before(o),r,!1)))return!0;return!1}function Os(i,e,t){i.focused||i.focus();let n=i.state.tr.setSelection(e);t=="pointer"&&n.setMeta("pointer",!0),i.dispatch(n)}function TC(i,e){if(e==-1)return!1;let t=i.state.doc.resolve(e),n=t.nodeAfter;return n&&n.isAtom&&V.isSelectable(n)?(Os(i,new V(t),"pointer"),!0):!1}function MC(i,e){if(e==-1)return!1;let t=i.state.selection,n,r;t instanceof V&&(n=t.node);let s=i.state.doc.resolve(e);for(let o=s.depth+1;o>0;o--){let l=o>s.depth?s.nodeAfter:s.node(o);if(V.isSelectable(l)){n&&t.$from.depth>0&&o>=t.$from.depth&&s.before(t.$from.depth+1)==t.$from.pos?r=s.before(t.$from.depth):r=s.before(o);break}}return r!=null?(Os(i,V.create(i.state.doc,r),"pointer"),!0):!1}function AC(i,e,t,n,r){return bp(i,"handleClickOn",e,t,n)||i.someProp("handleClick",s=>s(i,e,n))||(r?MC(i,t):TC(i,t))}function ZC(i,e,t,n){return bp(i,"handleDoubleClickOn",e,t,n)||i.someProp("handleDoubleClick",r=>r(i,e,n))}function RC(i,e,t,n){return bp(i,"handleTripleClickOn",e,t,n)||i.someProp("handleTripleClick",r=>r(i,e,n))||EC(i,t,n)}function EC(i,e,t){if(t.button!=0)return!1;let n=i.state.doc;if(e==-1)return n.inlineContent?(Os(i,J.create(n,0,n.content.size),"pointer"),!0):!1;let r=n.resolve(e);for(let s=r.depth+1;s>0;s--){let o=s>r.depth?r.nodeAfter:r.node(s),l=r.before(s);if(o.inlineContent)Os(i,J.create(n,l+1,l+1+o.content.size),"pointer");else if(V.isSelectable(o))Os(i,V.create(n,l),"pointer");else continue;return!0}}function Sp(i){return qh(i)}const Rk=Vt?"metaKey":"ctrlKey";ut.mousedown=(i,e)=>{let t=e;i.input.shiftKey=t.shiftKey;let n=Sp(i),r=Date.now(),s="singleClick";r-i.input.lastClick.time<500&&CC(t,i.input.lastClick)&&!t[Rk]&&(i.input.lastClick.type=="singleClick"?s="doubleClick":i.input.lastClick.type=="doubleClick"&&(s="tripleClick")),i.input.lastClick={time:r,x:t.clientX,y:t.clientY,type:s};let o=i.posAtCoords(Tc(t));o&&(s=="singleClick"?(i.input.mouseDown&&i.input.mouseDown.done(),i.input.mouseDown=new NC(i,o,t,!!n)):(s=="doubleClick"?ZC:RC)(i,o.pos,o.inside,t)?t.preventDefault():Zi(i,"pointer"))};class NC{constructor(e,t,n,r){this.view=e,this.pos=t,this.event=n,this.flushed=r,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!n[Rk],this.allowDefault=n.shiftKey;let s,o;if(t.inside>-1)s=e.state.doc.nodeAt(t.inside),o=t.inside;else{let c=e.state.doc.resolve(t.pos);s=c.parent,o=c.depth?c.before():0}const l=r?null:n.target,a=l?e.docView.nearestDesc(l,!0):null;this.target=a?a.dom:null;let{selection:h}=e.state;(n.button==0&&s.type.spec.draggable&&s.type.spec.selectable!==!1||h instanceof V&&h.from<=o&&h.to>o)&&(this.mightDrag={node:s,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&fn&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Zi(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>si(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(Tc(e))),this.updateAllowDefault(e),this.allowDefault||!t?Zi(this.view,"pointer"):AC(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||ft&&this.mightDrag&&!this.mightDrag.node.isAtom||ot&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(Os(this.view,_.near(this.view.state.doc.resolve(t.pos)),"pointer"),e.preventDefault()):Zi(this.view,"pointer")}move(e){this.updateAllowDefault(e),Zi(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}ut.touchstart=i=>{i.input.lastTouch=Date.now(),Sp(i),Zi(i,"pointer")};ut.touchmove=i=>{i.input.lastTouch=Date.now(),Zi(i,"pointer")};ut.contextmenu=i=>Sp(i);function Ek(i,e){return i.composing?!0:ft&&Math.abs(e.timeStamp-i.input.compositionEndedAt)<500?(i.input.compositionEndedAt=-2e8,!0):!1}const DC=rn?5e3:-1;dt.compositionstart=dt.compositionupdate=i=>{if(!i.composing){i.domObserver.flush();let{state:e}=i,t=e.selection.$from;if(e.selection.empty&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(n=>n.type.spec.inclusive===!1)))i.markCursor=i.state.storedMarks||t.marks(),qh(i,!0),i.markCursor=null;else if(qh(i),fn&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let n=i.domSelectionRange();for(let r=n.focusNode,s=n.focusOffset;r&&r.nodeType==1&&s!=0;){let o=s<0?r.lastChild:r.childNodes[s-1];if(!o)break;if(o.nodeType==3){i.domSelection().collapse(o,o.nodeValue.length);break}else r=o,s=-1}}i.input.composing=!0}Nk(i,DC)};dt.compositionend=(i,e)=>{i.composing&&(i.input.composing=!1,i.input.compositionEndedAt=e.timeStamp,i.input.compositionPendingChanges=i.domObserver.pendingRecords().length?i.input.compositionID:0,i.input.compositionNode=null,i.input.compositionPendingChanges&&Promise.resolve().then(()=>i.domObserver.flush()),i.input.compositionID++,Nk(i,20))};function Nk(i,e){clearTimeout(i.input.composingTimeout),e>-1&&(i.input.composingTimeout=setTimeout(()=>qh(i),e))}function Dk(i){for(i.composing&&(i.input.composing=!1,i.input.compositionEndedAt=WC());i.input.compositionNodes.length>0;)i.input.compositionNodes.pop().markParentsDirty()}function IC(i){let e=i.domSelectionRange();if(!e.focusNode)return null;let t=TQ(e.focusNode,e.focusOffset),n=MQ(e.focusNode,e.focusOffset);if(t&&n&&t!=n){let r=n.pmViewDesc;if(!r||!r.isText(n.nodeValue))return n;if(i.input.compositionNode==n){let s=t.pmViewDesc;if(!(!s||!s.isText(t.nodeValue)))return n}}return t}function WC(){let i=document.createEvent("Event");return i.initEvent("event",!0,!0),i.timeStamp}function qh(i,e=!1){if(!(rn&&i.domObserver.flushingSoon>=0)){if(i.domObserver.forceFlush(),Dk(i),e||i.docView&&i.docView.dirty){let t=Op(i);return t&&!t.eq(i.state.selection)?i.dispatch(i.state.tr.setSelection(t)):i.updateState(i.state),!0}return!1}}function XC(i,e){if(!i.dom.parentNode)return;let t=i.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let n=getSelection(),r=document.createRange();r.selectNodeContents(e),i.dom.blur(),n.removeAllRanges(),n.addRange(r),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),i.focus()},50)}const ml=bt&&Bi<15||Es&&DQ<604;ut.copy=dt.cut=(i,e)=>{let t=e,n=i.state.selection,r=t.type=="cut";if(n.empty)return;let s=ml?null:t.clipboardData,o=n.content(),{dom:l,text:a}=Pk(i,o);s?(t.preventDefault(),s.clearData(),s.setData("text/html",l.innerHTML),s.setData("text/plain",a)):XC(i,l),r&&i.dispatch(i.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function BC(i){return i.openStart==0&&i.openEnd==0&&i.content.childCount==1?i.content.firstChild:null}function VC(i,e){if(!i.dom.parentNode)return;let t=i.input.shiftKey||i.state.selection.$from.parent.type.spec.code,n=i.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(n.contentEditable="true"),n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus();let r=i.input.shiftKey&&i.input.lastKeyCode!=45;setTimeout(()=>{i.focus(),n.parentNode&&n.parentNode.removeChild(n),t?gl(i,n.value,null,r,e):gl(i,n.textContent,n.innerHTML,r,e)},50)}function gl(i,e,t,n,r){let s=Qk(i,e,t,n,i.state.selection.$from);if(i.someProp("handlePaste",a=>a(i,r,s||Z.empty)))return!0;if(!s)return!1;let o=BC(s),l=o?i.state.tr.replaceSelectionWith(o,n):i.state.tr.replaceSelection(s);return i.dispatch(l.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function Ik(i){let e=i.getData("text/plain")||i.getData("Text");if(e)return e;let t=i.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}dt.paste=(i,e)=>{let t=e;if(i.composing&&!rn)return;let n=ml?null:t.clipboardData,r=i.input.shiftKey&&i.input.lastKeyCode!=45;n&&gl(i,Ik(n),n.getData("text/html"),r,t)?t.preventDefault():VC(i,t)};class Wk{constructor(e,t,n){this.slice=e,this.move=t,this.node=n}}const Xk=Vt?"altKey":"ctrlKey";ut.dragstart=(i,e)=>{let t=e,n=i.input.mouseDown;if(n&&n.done(),!t.dataTransfer)return;let r=i.state.selection,s=r.empty?null:i.posAtCoords(Tc(t)),o;if(!(s&&s.pos>=r.from&&s.pos<=(r instanceof V?r.to-1:r.to))){if(n&&n.mightDrag)o=V.create(i.state.doc,n.mightDrag.pos);else if(t.target&&t.target.nodeType==1){let c=i.docView.nearestDesc(t.target,!0);c&&c.node.type.spec.draggable&&c!=i.docView&&(o=V.create(i.state.doc,c.posBefore))}}let l=(o||i.state.selection).content(),{dom:a,text:h}=Pk(i,l);t.dataTransfer.clearData(),t.dataTransfer.setData(ml?"Text":"text/html",a.innerHTML),t.dataTransfer.effectAllowed="copyMove",ml||t.dataTransfer.setData("text/plain",h),i.dragging=new Wk(l,!t[Xk],o)};ut.dragend=i=>{let e=i.dragging;window.setTimeout(()=>{i.dragging==e&&(i.dragging=null)},50)};dt.dragover=dt.dragenter=(i,e)=>e.preventDefault();dt.drop=(i,e)=>{let t=e,n=i.dragging;if(i.dragging=null,!t.dataTransfer)return;let r=i.posAtCoords(Tc(t));if(!r)return;let s=i.state.doc.resolve(r.pos),o=n&&n.slice;o?i.someProp("transformPasted",p=>{o=p(o,i)}):o=Qk(i,Ik(t.dataTransfer),ml?null:t.dataTransfer.getData("text/html"),!1,s);let l=!!(n&&!t[Xk]);if(i.someProp("handleDrop",p=>p(i,t,o||Z.empty,l))){t.preventDefault();return}if(!o)return;t.preventDefault();let a=o?nk(i.state.doc,s.pos,o):s.pos;a==null&&(a=s.pos);let h=i.state.tr;if(l){let{node:p}=n;p?p.replace(h):h.deleteSelection()}let c=h.mapping.map(a),f=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,u=h.doc;if(f?h.replaceRangeWith(c,c,o.content.firstChild):h.replaceRange(c,c,o),h.doc.eq(u))return;let d=h.doc.resolve(c);if(f&&V.isSelectable(o.content.firstChild)&&d.nodeAfter&&d.nodeAfter.sameMarkup(o.content.firstChild))h.setSelection(new V(d));else{let p=h.mapping.map(a);h.mapping.maps[h.mapping.maps.length-1].forEach((m,g,y,k)=>p=k),h.setSelection(yp(i,d,h.doc.resolve(p)))}i.focus(),i.dispatch(h.setMeta("uiEvent","drop"))};ut.focus=i=>{i.input.lastFocus=Date.now(),i.focused||(i.domObserver.stop(),i.dom.classList.add("ProseMirror-focused"),i.domObserver.start(),i.focused=!0,setTimeout(()=>{i.docView&&i.hasFocus()&&!i.domObserver.currentSelection.eq(i.domSelectionRange())&&si(i)},20))};ut.blur=(i,e)=>{let t=e;i.focused&&(i.domObserver.stop(),i.dom.classList.remove("ProseMirror-focused"),i.domObserver.start(),t.relatedTarget&&i.dom.contains(t.relatedTarget)&&i.domObserver.currentSelection.clear(),i.focused=!1)};ut.beforeinput=(i,e)=>{if(ot&&rn&&e.inputType=="deleteContentBackward"){i.domObserver.flushSoon();let{domChangeCount:n}=i.input;setTimeout(()=>{if(i.input.domChangeCount!=n||(i.dom.blur(),i.focus(),i.someProp("handleKeyDown",s=>s(i,cr(8,"Backspace")))))return;let{$cursor:r}=i.state.selection;r&&r.pos>0&&i.dispatch(i.state.tr.delete(r.pos-1,r.pos).scrollIntoView())},50)}};for(let i in dt)ut[i]=dt[i];function Ol(i,e){if(i==e)return!0;for(let t in i)if(i[t]!==e[t])return!1;for(let t in e)if(!(t in i))return!1;return!0}let hO=class Bk{constructor(e,t){this.toDOM=e,this.spec=t||Pr,this.side=this.spec.side||0}map(e,t,n,r){let{pos:s,deleted:o}=e.mapResult(t.from+r,this.side<0?-1:1);return o?null:new qn(s-n,s-n,this)}valid(){return!0}eq(e){return this==e||e instanceof Bk&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Ol(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}};class qi{constructor(e,t){this.attrs=e,this.spec=t||Pr}map(e,t,n,r){let s=e.map(t.from+r,this.spec.inclusiveStart?-1:1)-n,o=e.map(t.to+r,this.spec.inclusiveEnd?1:-1)-n;return s>=o?null:new qn(s,o,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof qi&&Ol(this.attrs,e.attrs)&&Ol(this.spec,e.spec)}static is(e){return e.type instanceof qi}destroy(){}}let qC=class Vk{constructor(e,t){this.attrs=e,this.spec=t||Pr}map(e,t,n,r){let s=e.mapResult(t.from+r,1);if(s.deleted)return null;let o=e.mapResult(t.to+r,-1);return o.deleted||o.pos<=s.pos?null:new qn(s.pos-n,o.pos-n,this)}valid(e,t){let{index:n,offset:r}=e.content.findIndex(t.from),s;return r==t.from&&!(s=e.child(n)).isText&&r+s.nodeSize==t.to}eq(e){return this==e||e instanceof Vk&&Ol(this.attrs,e.attrs)&&Ol(this.spec,e.spec)}destroy(){}},qn=class Io{constructor(e,t,n){this.from=e,this.to=t,this.type=n}copy(e,t){return new Io(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,n){return this.type.map(e,this,t,n)}static widget(e,t,n){return new Io(e,e,new hO(t,n))}static inline(e,t,n,r){return new Io(e,t,new qi(n,r))}static node(e,t,n,r){return new Io(e,t,new qC(n,r))}get spec(){return this.type.spec}get inline(){return this.type instanceof qi}get widget(){return this.type instanceof hO}};const ts=[],Pr={};class Pe{constructor(e,t){this.local=e.length?e:ts,this.children=t.length?t:ts}static create(e,t){return t.length?Lh(t,e,0,Pr):Fe}find(e,t,n){let r=[];return this.findInner(e??0,t??1e9,r,0,n),r}findInner(e,t,n,r,s){for(let o=0;o<this.local.length;o++){let l=this.local[o];l.from<=t&&l.to>=e&&(!s||s(l.spec))&&n.push(l.copy(l.from+r,l.to+r))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<t&&this.children[o+1]>e){let l=this.children[o]+1;this.children[o+2].findInner(e-l,t-l,n,r+l,s)}}map(e,t,n){return this==Fe||e.maps.length==0?this:this.mapInner(e,t,0,0,n||Pr)}mapInner(e,t,n,r,s){let o;for(let l=0;l<this.local.length;l++){let a=this.local[l].map(e,n,r);a&&a.type.valid(t,a)?(o||(o=[])).push(a):s.onRemove&&s.onRemove(this.local[l].spec)}return this.children.length?LC(this.children,o||[],e,t,n,r,s):o?new Pe(o.sort(Qr),ts):Fe}add(e,t){return t.length?this==Fe?Pe.create(e,t):this.addInner(e,t,0):this}addInner(e,t,n){let r,s=0;e.forEach((l,a)=>{let h=a+n,c;if(c=Lk(t,l,h)){for(r||(r=this.children.slice());s<r.length&&r[s]<a;)s+=3;r[s]==a?r[s+2]=r[s+2].addInner(l,c,h+1):r.splice(s,0,a,a+l.nodeSize,Lh(c,l,h+1,Pr)),s+=3}});let o=qk(s?zk(t):t,-n);for(let l=0;l<o.length;l++)o[l].type.valid(e,o[l])||o.splice(l--,1);return new Pe(o.length?this.local.concat(o).sort(Qr):this.local,r||this.children)}remove(e){return e.length==0||this==Fe?this:this.removeInner(e,0)}removeInner(e,t){let n=this.children,r=this.local;for(let s=0;s<n.length;s+=3){let o,l=n[s]+t,a=n[s+1]+t;for(let c=0,f;c<e.length;c++)(f=e[c])&&f.from>l&&f.to<a&&(e[c]=null,(o||(o=[])).push(f));if(!o)continue;n==this.children&&(n=this.children.slice());let h=n[s+2].removeInner(o,l+1);h!=Fe?n[s+2]=h:(n.splice(s,3),s-=3)}if(r.length){for(let s=0,o;s<e.length;s++)if(o=e[s])for(let l=0;l<r.length;l++)r[l].eq(o,t)&&(r==this.local&&(r=this.local.slice()),r.splice(l--,1))}return n==this.children&&r==this.local?this:r.length||n.length?new Pe(r,n):Fe}forChild(e,t){if(this==Fe)return this;if(t.isLeaf)return Pe.empty;let n,r;for(let l=0;l<this.children.length;l+=3)if(this.children[l]>=e){this.children[l]==e&&(n=this.children[l+2]);break}let s=e+1,o=s+t.content.size;for(let l=0;l<this.local.length;l++){let a=this.local[l];if(a.from<o&&a.to>s&&a.type instanceof qi){let h=Math.max(s,a.from)-s,c=Math.min(o,a.to)-s;h<c&&(r||(r=[])).push(a.copy(h,c))}}if(r){let l=new Pe(r.sort(Qr),ts);return n?new Ci([l,n]):l}return n||Fe}eq(e){if(this==e)return!0;if(!(e instanceof Pe)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return wp(this.localsInner(e))}localsInner(e){if(this==Fe)return ts;if(e.inlineContent||!this.local.some(qi.is))return this.local;let t=[];for(let n=0;n<this.local.length;n++)this.local[n].type instanceof qi||t.push(this.local[n]);return t}}Pe.empty=new Pe([],[]);Pe.removeOverlap=wp;const Fe=Pe.empty;class Ci{constructor(e){this.members=e}map(e,t){const n=this.members.map(r=>r.map(e,t,Pr));return Ci.from(n)}forChild(e,t){if(t.isLeaf)return Pe.empty;let n=[];for(let r=0;r<this.members.length;r++){let s=this.members[r].forChild(e,t);s!=Fe&&(s instanceof Ci?n=n.concat(s.members):n.push(s))}return Ci.from(n)}eq(e){if(!(e instanceof Ci)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,n=!0;for(let r=0;r<this.members.length;r++){let s=this.members[r].localsInner(e);if(s.length)if(!t)t=s;else{n&&(t=t.slice(),n=!1);for(let o=0;o<s.length;o++)t.push(s[o])}}return t?wp(n?t:t.sort(Qr)):ts}static from(e){switch(e.length){case 0:return Fe;case 1:return e[0];default:return new Ci(e.every(t=>t instanceof Pe)?e:e.reduce((t,n)=>t.concat(n instanceof Pe?n:n.members),[]))}}}function LC(i,e,t,n,r,s,o){let l=i.slice();for(let h=0,c=s;h<t.maps.length;h++){let f=0;t.maps[h].forEach((u,d,p,m)=>{let g=m-p-(d-u);for(let y=0;y<l.length;y+=3){let k=l[y+1];if(k<0||u>k+c-f)continue;let v=l[y]+c-f;d>=v?l[y+1]=u<=v?-2:-1:u>=c&&g&&(l[y]+=g,l[y+1]+=g)}f+=g}),c=t.maps[h].map(c,-1)}let a=!1;for(let h=0;h<l.length;h+=3)if(l[h+1]<0){if(l[h+1]==-2){a=!0,l[h+1]=-1;continue}let c=t.map(i[h]+s),f=c-r;if(f<0||f>=n.content.size){a=!0;continue}let u=t.map(i[h+1]+s,-1),d=u-r,{index:p,offset:m}=n.content.findIndex(f),g=n.maybeChild(p);if(g&&m==f&&m+g.nodeSize==d){let y=l[h+2].mapInner(t,g,c+1,i[h]+s+1,o);y!=Fe?(l[h]=f,l[h+1]=d,l[h+2]=y):(l[h+1]=-2,a=!0)}else a=!0}if(a){let h=zC(l,i,e,t,r,s,o),c=Lh(h,n,0,o);e=c.local;for(let f=0;f<l.length;f+=3)l[f+1]<0&&(l.splice(f,3),f-=3);for(let f=0,u=0;f<c.children.length;f+=3){let d=c.children[f];for(;u<l.length&&l[u]<d;)u+=3;l.splice(u,0,c.children[f],c.children[f+1],c.children[f+2])}}return new Pe(e.sort(Qr),l)}function qk(i,e){if(!e||!i.length)return i;let t=[];for(let n=0;n<i.length;n++){let r=i[n];t.push(new qn(r.from+e,r.to+e,r.type))}return t}function zC(i,e,t,n,r,s,o){function l(a,h){for(let c=0;c<a.local.length;c++){let f=a.local[c].map(n,r,h);f?t.push(f):o.onRemove&&o.onRemove(a.local[c].spec)}for(let c=0;c<a.children.length;c+=3)l(a.children[c+2],a.children[c]+h+1)}for(let a=0;a<i.length;a+=3)i[a+1]==-1&&l(i[a+2],e[a]+s+1);return t}function Lk(i,e,t){if(e.isLeaf)return null;let n=t+e.nodeSize,r=null;for(let s=0,o;s<i.length;s++)(o=i[s])&&o.from>t&&o.to<n&&((r||(r=[])).push(o),i[s]=null);return r}function zk(i){let e=[];for(let t=0;t<i.length;t++)i[t]!=null&&e.push(i[t]);return e}function Lh(i,e,t,n){let r=[],s=!1;e.forEach((l,a)=>{let h=Lk(i,l,a+t);if(h){s=!0;let c=Lh(h,l,t+a+1,n);c!=Fe&&r.push(a,a+l.nodeSize,c)}});let o=qk(s?zk(i):i,-t).sort(Qr);for(let l=0;l<o.length;l++)o[l].type.valid(e,o[l])||(n.onRemove&&n.onRemove(o[l].spec),o.splice(l--,1));return o.length||r.length?new Pe(o,r):Fe}function Qr(i,e){return i.from-e.from||i.to-e.to}function wp(i){let e=i;for(let t=0;t<e.length-1;t++){let n=e[t];if(n.from!=n.to)for(let r=t+1;r<e.length;r++){let s=e[r];if(s.from==n.from){s.to!=n.to&&(e==i&&(e=i.slice()),e[r]=s.copy(s.from,n.to),cO(e,r+1,s.copy(n.to,s.to)));continue}else{s.from<n.to&&(e==i&&(e=i.slice()),e[t]=n.copy(n.from,s.from),cO(e,r,n.copy(s.from,n.to)));break}}}return e}function cO(i,e,t){for(;e<i.length&&Qr(t,i[e])>0;)e++;i.splice(e,0,t)}function Sf(i){let e=[];return i.someProp("decorations",t=>{let n=t(i.state);n&&n!=Fe&&e.push(n)}),i.cursorWrapper&&e.push(Pe.create(i.state.doc,[i.cursorWrapper.deco])),Ci.from(e)}const YC={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},jC=bt&&Bi<=11;class _C{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}let FC=class{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new _C,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver(n=>{for(let r=0;r<n.length;r++)this.queue.push(n[r]);bt&&Bi<=11&&n.some(r=>r.type=="childList"&&r.removedNodes.length||r.type=="characterData"&&r.oldValue.length>r.target.nodeValue.length)?this.flushSoon():this.flush()}),jC&&(this.onCharData=n=>{this.queue.push({target:n.target,type:"characterData",oldValue:n.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,YC)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(tO(this.view)){if(this.suppressingSelectionUpdates)return si(this.view);if(bt&&Bi<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Er(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,n;for(let s=e.focusNode;s;s=pl(s))t.add(s);for(let s=e.anchorNode;s;s=pl(s))if(t.has(s)){n=s;break}let r=n&&this.view.docView.nearestDesc(n);if(r&&r.ignoreMutation({type:"selection",target:n.nodeType==3?n.parentNode:n}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let n=e.domSelectionRange(),r=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&tO(e)&&!this.ignoreSelectionChange(n),s=-1,o=-1,l=!1,a=[];if(e.editable)for(let c=0;c<t.length;c++){let f=this.registerMutation(t[c],a);f&&(s=s<0?f.from:Math.min(f.from,s),o=o<0?f.to:Math.max(f.to,o),f.typeOver&&(l=!0))}if(fn&&a.length>1){let c=a.filter(f=>f.nodeName=="BR");if(c.length==2){let f=c[0],u=c[1];f.parentNode&&f.parentNode.parentNode==u.parentNode?u.remove():f.remove()}}let h=null;s<0&&r&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Qc(n)&&(h=Op(e))&&h.eq(_.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,si(e),this.currentSelection.set(n),e.scrollToSelection()):(s>-1||r)&&(s>-1&&(e.docView.markDirty(s,o),UC(e)),this.handleDOMChange(s,o,l,a),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(n)||si(e),this.currentSelection.set(n))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let n=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(n==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!n||n.ignoreMutation(e))return null;if(e.type=="childList"){for(let c=0;c<e.addedNodes.length;c++)t.push(e.addedNodes[c]);if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(e.target))return{from:n.posBefore,to:n.posAfter};let r=e.previousSibling,s=e.nextSibling;if(bt&&Bi<=11&&e.addedNodes.length)for(let c=0;c<e.addedNodes.length;c++){let{previousSibling:f,nextSibling:u}=e.addedNodes[c];(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(r=f),(!u||Array.prototype.indexOf.call(e.addedNodes,u)<0)&&(s=u)}let o=r&&r.parentNode==e.target?qe(r)+1:0,l=n.localPosFromDOM(e.target,o,-1),a=s&&s.parentNode==e.target?qe(s):e.target.childNodes.length,h=n.localPosFromDOM(e.target,a,1);return{from:l,to:h}}else return e.type=="attributes"?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}}},fO=new WeakMap,uO=!1;function UC(i){if(!fO.has(i)&&(fO.set(i,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(i.dom).whiteSpace)!==-1)){if(i.requiresGeckoHackNode=fn,uO)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),uO=!0}}function dO(i,e){let t=e.startContainer,n=e.startOffset,r=e.endContainer,s=e.endOffset,o=i.domAtPos(i.state.selection.anchor);return Er(o.node,o.offset,r,s)&&([t,n,r,s]=[r,s,t,n]),{anchorNode:t,anchorOffset:n,focusNode:r,focusOffset:s}}function GC(i,e){if(e.getComposedRanges){let r=e.getComposedRanges(i.root)[0];if(r)return dO(i,r)}let t;function n(r){r.preventDefault(),r.stopImmediatePropagation(),t=r.getTargetRanges()[0]}return i.dom.addEventListener("beforeinput",n,!0),document.execCommand("indent"),i.dom.removeEventListener("beforeinput",n,!0),t?dO(i,t):null}function HC(i,e,t){let{node:n,fromOffset:r,toOffset:s,from:o,to:l}=i.docView.parseRange(e,t),a=i.domSelectionRange(),h,c=a.anchorNode;if(c&&i.dom.contains(c.nodeType==1?c:c.parentNode)&&(h=[{node:c,offset:a.anchorOffset}],Qc(a)||h.push({node:a.focusNode,offset:a.focusOffset})),ot&&i.input.lastKeyCode===8)for(let g=s;g>r;g--){let y=n.childNodes[g-1],k=y.pmViewDesc;if(y.nodeName=="BR"&&!k){s=g;break}if(!k||k.size)break}let f=i.state.doc,u=i.someProp("domParser")||Rr.fromSchema(i.state.schema),d=f.resolve(o),p=null,m=u.parse(n,{topNode:d.parent,topMatch:d.parent.contentMatchAt(d.index()),topOpen:!0,from:r,to:s,preserveWhitespace:d.parent.type.whitespace=="pre"?"full":!0,findPositions:h,ruleFromNode:KC,context:d});if(h&&h[0].pos!=null){let g=h[0].pos,y=h[1]&&h[1].pos;y==null&&(y=g),p={anchor:g+o,head:y+o}}return{doc:m,sel:p,from:o,to:l}}function KC(i){let e=i.pmViewDesc;if(e)return e.parseRule();if(i.nodeName=="BR"&&i.parentNode){if(ft&&/^(ul|ol)$/i.test(i.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(i.parentNode.lastChild==i||ft&&/^(tr|table)$/i.test(i.parentNode.nodeName))return{ignore:!0}}else if(i.nodeName=="IMG"&&i.getAttribute("mark-placeholder"))return{ignore:!0};return null}const JC=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function eT(i,e,t,n,r){let s=i.input.compositionPendingChanges||(i.composing?i.input.compositionID:0);if(i.input.compositionPendingChanges=0,e<0){let A=i.input.lastSelectionTime>Date.now()-50?i.input.lastSelectionOrigin:null,L=Op(i,A);if(L&&!i.state.selection.eq(L)){if(ot&&rn&&i.input.lastKeyCode===13&&Date.now()-100<i.input.lastKeyCodeTime&&i.someProp("handleKeyDown",Y=>Y(i,cr(13,"Enter"))))return;let z=i.state.tr.setSelection(L);A=="pointer"?z.setMeta("pointer",!0):A=="key"&&z.scrollIntoView(),s&&z.setMeta("composition",s),i.dispatch(z)}return}let o=i.state.doc.resolve(e),l=o.sharedDepth(t);e=o.before(l+1),t=i.state.doc.resolve(t).after(l+1);let a=i.state.selection,h=HC(i,e,t),c=i.state.doc,f=c.slice(h.from,h.to),u,d;i.input.lastKeyCode===8&&Date.now()-100<i.input.lastKeyCodeTime?(u=i.state.selection.to,d="end"):(u=i.state.selection.from,d="start"),i.input.lastKeyCode=null;let p=iT(f.content,h.doc.content,h.from,u,d);if((Es&&i.input.lastIOSEnter>Date.now()-225||rn)&&r.some(A=>A.nodeType==1&&!JC.test(A.nodeName))&&(!p||p.endA>=p.endB)&&i.someProp("handleKeyDown",A=>A(i,cr(13,"Enter")))){i.input.lastIOSEnter=0;return}if(!p)if(n&&a instanceof J&&!a.empty&&a.$head.sameParent(a.$anchor)&&!i.composing&&!(h.sel&&h.sel.anchor!=h.sel.head))p={start:a.from,endA:a.to,endB:a.to};else{if(h.sel){let A=pO(i,i.state.doc,h.sel);if(A&&!A.eq(i.state.selection)){let L=i.state.tr.setSelection(A);s&&L.setMeta("composition",s),i.dispatch(L)}}return}i.input.domChangeCount++,i.state.selection.from<i.state.selection.to&&p.start==p.endB&&i.state.selection instanceof J&&(p.start>i.state.selection.from&&p.start<=i.state.selection.from+2&&i.state.selection.from>=h.from?p.start=i.state.selection.from:p.endA<i.state.selection.to&&p.endA>=i.state.selection.to-2&&i.state.selection.to<=h.to&&(p.endB+=i.state.selection.to-p.endA,p.endA=i.state.selection.to)),bt&&Bi<=11&&p.endB==p.start+1&&p.endA==p.start&&p.start>h.from&&h.doc.textBetween(p.start-h.from-1,p.start-h.from+1)==" "&&(p.start--,p.endA--,p.endB--);let m=h.doc.resolveNoCache(p.start-h.from),g=h.doc.resolveNoCache(p.endB-h.from),y=c.resolve(p.start),k=m.sameParent(g)&&m.parent.inlineContent&&y.end()>=p.endA,v;if((Es&&i.input.lastIOSEnter>Date.now()-225&&(!k||r.some(A=>A.nodeName=="DIV"||A.nodeName=="P"))||!k&&m.pos<h.doc.content.size&&!m.sameParent(g)&&(v=_.findFrom(h.doc.resolve(m.pos+1),1,!0))&&v.head==g.pos)&&i.someProp("handleKeyDown",A=>A(i,cr(13,"Enter")))){i.input.lastIOSEnter=0;return}if(i.state.selection.anchor>p.start&&nT(c,p.start,p.endA,m,g)&&i.someProp("handleKeyDown",A=>A(i,cr(8,"Backspace")))){rn&&ot&&i.domObserver.suppressSelectionUpdates();return}ot&&rn&&p.endB==p.start&&(i.input.lastAndroidDelete=Date.now()),rn&&!k&&m.start()!=g.start()&&g.parentOffset==0&&m.depth==g.depth&&h.sel&&h.sel.anchor==h.sel.head&&h.sel.head==p.endA&&(p.endB-=2,g=h.doc.resolveNoCache(p.endB-h.from),setTimeout(()=>{i.someProp("handleKeyDown",function(A){return A(i,cr(13,"Enter"))})},20));let $=p.start,S=p.endA,x,Q,X;if(k){if(m.pos==g.pos)bt&&Bi<=11&&m.parentOffset==0&&(i.domObserver.suppressSelectionUpdates(),setTimeout(()=>si(i),20)),x=i.state.tr.delete($,S),Q=c.resolve(p.start).marksAcross(c.resolve(p.endA));else if(p.endA==p.endB&&(X=tT(m.parent.content.cut(m.parentOffset,g.parentOffset),y.parent.content.cut(y.parentOffset,p.endA-y.start()))))x=i.state.tr,X.type=="add"?x.addMark($,S,X.mark):x.removeMark($,S,X.mark);else if(m.parent.child(m.index()).isText&&m.index()==g.index()-(g.textOffset?0:1)){let A=m.parent.textBetween(m.parentOffset,g.parentOffset);if(i.someProp("handleTextInput",L=>L(i,$,S,A)))return;x=i.state.tr.insertText(A,$,S)}}if(x||(x=i.state.tr.replace($,S,h.doc.slice(p.start-h.from,p.endB-h.from))),h.sel){let A=pO(i,x.doc,h.sel);A&&!(ot&&rn&&i.composing&&A.empty&&(p.start!=p.endB||i.input.lastAndroidDelete<Date.now()-100)&&(A.head==$||A.head==x.mapping.map(S)-1)||bt&&A.empty&&A.head==$)&&x.setSelection(A)}Q&&x.ensureMarks(Q),s&&x.setMeta("composition",s),i.dispatch(x.scrollIntoView())}function pO(i,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:yp(i,e.resolve(t.anchor),e.resolve(t.head))}function tT(i,e){let t=i.firstChild.marks,n=e.firstChild.marks,r=t,s=n,o,l,a;for(let c=0;c<n.length;c++)r=n[c].removeFromSet(r);for(let c=0;c<t.length;c++)s=t[c].removeFromSet(s);if(r.length==1&&s.length==0)l=r[0],o="add",a=c=>c.mark(l.addToSet(c.marks));else if(r.length==0&&s.length==1)l=s[0],o="remove",a=c=>c.mark(l.removeFromSet(c.marks));else return null;let h=[];for(let c=0;c<e.childCount;c++)h.push(a(e.child(c)));if(P.from(h).eq(i))return{mark:l,type:o}}function nT(i,e,t,n,r){if(t-e<=r.pos-n.pos||wf(n,!0,!1)<r.pos)return!1;let s=i.resolve(e);if(!n.parent.isTextblock){let l=s.nodeAfter;return l!=null&&t==e+l.nodeSize}if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let o=i.resolve(wf(s,!0,!0));return!o.parent.isTextblock||o.pos>t||wf(o,!0,!1)<t?!1:n.parent.content.cut(n.parentOffset).eq(o.parent.content)}function wf(i,e,t){let n=i.depth,r=e?i.end():i.pos;for(;n>0&&(e||i.indexAfter(n)==i.node(n).childCount);)n--,r++,e=!1;if(t){let s=i.node(n).maybeChild(i.indexAfter(n));for(;s&&!s.isLeaf;)s=s.firstChild,r++}return r}function iT(i,e,t,n,r){let s=i.findDiffStart(e,t);if(s==null)return null;let{a:o,b:l}=i.findDiffEnd(e,t+i.size,t+e.size);if(r=="end"){let a=Math.max(0,s-Math.min(o,l));n-=o+a-s}if(o<s&&i.size<e.size){let a=n<=s&&n>=o?s-n:0;s-=a,s&&s<e.size&&mO(e.textBetween(s-1,s+1))&&(s+=a?1:-1),l=s+(l-o),o=s}else if(l<s){let a=n<=s&&n>=l?s-n:0;s-=a,s&&s<i.size&&mO(i.textBetween(s-1,s+1))&&(s+=a?1:-1),o=s+(o-l),l=s}return{start:s,endA:o,endB:l}}function mO(i){if(i.length!=2)return!1;let e=i.charCodeAt(0),t=i.charCodeAt(1);return e>=56320&&e<=57343&&t>=55296&&t<=56319}let rT=class{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new xC,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(bO),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=yO(this),OO(this),this.nodeViews=kO(this),this.docView=Ug(this.state.doc,gO(this),Sf(this),this.dom,this),this.domObserver=new FC(this,(n,r,s,o)=>eT(this,n,r,s,o)),this.domObserver.start(),vC(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&zu(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(bO),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let n in this._props)t[n]=this._props[n];t.state=this.state;for(let n in e)t[n]=e[n];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var n;let r=this.state,s=!1,o=!1;e.storedMarks&&this.composing&&(Dk(this),o=!0),this.state=e;let l=r.plugins!=e.plugins||this._props.plugins!=t.plugins;if(l||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let d=kO(this);oT(d,this.nodeViews)&&(this.nodeViews=d,s=!0)}(l||t.handleDOMEvents!=this._props.handleDOMEvents)&&zu(this),this.editable=yO(this),OO(this);let a=Sf(this),h=gO(this),c=r.plugins!=e.plugins&&!r.doc.eq(e.doc)?"reset":e.scrollToSelection>r.scrollToSelection?"to selection":"preserve",f=s||!this.docView.matchesNode(e.doc,h,a);(f||!e.selection.eq(r.selection))&&(o=!0);let u=c=="preserve"&&o&&this.dom.style.overflowAnchor==null&&XQ(this);if(o){this.domObserver.stop();let d=f&&(bt||ot)&&!this.composing&&!r.selection.empty&&!e.selection.empty&&sT(r.selection,e.selection);if(f){let p=ot?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=IC(this)),(s||!this.docView.update(e.doc,h,a,this))&&(this.docView.updateOuterDeco(h),this.docView.destroy(),this.docView=Ug(e.doc,h,a,this.dom,this)),p&&!this.trackWrites&&(d=!0)}d||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&hC(this))?si(this,d):(xk(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(r),!((n=this.dragging)===null||n===void 0)&&n.node&&!r.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,r),c=="reset"?this.dom.scrollTop=0:c=="to selection"?this.scrollToSelection():u&&BQ(u)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!this.someProp("handleScrollToSelection",t=>t(this)))if(this.state.selection instanceof V){let t=this.docView.domAfterPos(this.state.selection.from);t.nodeType==1&&Lg(this,t.getBoundingClientRect(),e)}else Lg(this,this.coordsAtPos(this.state.selection.head,1),e)}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let n=this.directPlugins[t];n.spec.view&&this.pluginViews.push(n.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let n=this.state.plugins[t];n.spec.view&&this.pluginViews.push(n.spec.view(this))}}else for(let t=0;t<this.pluginViews.length;t++){let n=this.pluginViews[t];n.update&&n.update(this,e)}}updateDraggedNode(e,t){let n=e.node,r=-1;if(this.state.doc.nodeAt(n.from)==n.node)r=n.from;else{let s=n.from+(this.state.doc.content.size-t.doc.content.size);(s>0&&this.state.doc.nodeAt(s))==n.node&&(r=s)}this.dragging=new Wk(e.slice,e.move,r<0?void 0:V.create(this.state.doc,r))}someProp(e,t){let n=this._props&&this._props[e],r;if(n!=null&&(r=t?t(n):n))return r;for(let o=0;o<this.directPlugins.length;o++){let l=this.directPlugins[o].props[e];if(l!=null&&(r=t?t(l):l))return r}let s=this.state.plugins;if(s)for(let o=0;o<s.length;o++){let l=s[o].props[e];if(l!=null&&(r=t?t(l):l))return r}}hasFocus(){if(bt){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&VQ(this.dom),si(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t}return e||document}updateRoot(){this._root=null}posAtCoords(e){return jQ(this,e)}coordsAtPos(e,t=1){return mk(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,n=-1){let r=this.docView.posFromDOM(e,t,n);if(r==null)throw new RangeError("DOM position not inside the editor");return r}endOfTextblock(e,t){return HQ(this,t||this.state,e)}pasteHTML(e,t){return gl(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return gl(this,e,null,!0,t||new ClipboardEvent("paste"))}destroy(){this.docView&&($C(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Sf(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,QQ())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return QC(this,e)}dispatch(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){let e=this.domSelection();return ft&&this.root.nodeType===11&&ZQ(this.dom.ownerDocument)==this.dom&&GC(this,e)||e}domSelection(){return this.root.getSelection()}};function gO(i){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(i.editable),i.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(i.state)),t)for(let n in t)n=="class"?e.class+=" "+t[n]:n=="style"?e.style=(e.style?e.style+";":"")+t[n]:!e[n]&&n!="contenteditable"&&n!="nodeName"&&(e[n]=String(t[n]))}),e.translate||(e.translate="no"),[qn.node(0,i.state.doc.content.size,e)]}function OO(i){if(i.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),i.cursorWrapper={dom:e,deco:qn.widget(i.state.selection.head,e,{raw:!0,marks:i.markCursor})}}else i.cursorWrapper=null}function yO(i){return!i.someProp("editable",e=>e(i.state)===!1)}function sT(i,e){let t=Math.min(i.$anchor.sharedDepth(i.head),e.$anchor.sharedDepth(e.head));return i.$anchor.start(t)!=e.$anchor.start(t)}function kO(i){let e=Object.create(null);function t(n){for(let r in n)Object.prototype.hasOwnProperty.call(e,r)||(e[r]=n[r])}return i.someProp("nodeViews",t),i.someProp("markViews",t),e}function oT(i,e){let t=0,n=0;for(let r in i){if(i[r]!=e[r])return!0;t++}for(let r in e)n++;return t!=n}function bO(i){if(i.spec.state||i.spec.filterTransaction||i.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}class gn{constructor(e,t,n={}){this.match=e,this.match=e,this.handler=typeof t=="string"?lT(t):t,this.undoable=n.undoable!==!1,this.inCode=n.inCode||!1}}function lT(i){return function(e,t,n,r){let s=i;if(t[1]){let o=t[0].lastIndexOf(t[1]);s+=t[0].slice(o+t[1].length),n+=o;let l=n-r;l>0&&(s=t[0].slice(o-l,o)+s,n=r)}return e.tr.insertText(s,n,r)}}const aT=(i,e)=>{let t=i.plugins;for(let n=0;n<t.length;n++){let r=t[n],s;if(r.spec.isInputRules&&(s=r.getState(i))){if(e){let o=i.tr,l=s.transform;for(let a=l.steps.length-1;a>=0;a--)o.step(l.steps[a].invert(l.docs[a]));if(s.text){let a=o.doc.resolve(s.from).marks();o.replaceWith(s.from,s.to,i.schema.text(s.text,a))}else o.delete(s.from,s.to);e(o)}return!0}}return!1};new gn(/--$/,"");new gn(/\.\.\.$/,"");new gn(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"");new gn(/"$/,"");new gn(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"");new gn(/'$/,"");function xp(i,e,t=null,n){return new gn(i,(r,s,o,l)=>{let a=t instanceof Function?t(s):t,h=r.tr.delete(o,l),c=h.doc.resolve(o),f=c.blockRange(),u=f&&tk(f,e,a);if(!u)return null;h.wrap(f,u);let d=h.doc.resolve(o-1).nodeBefore;return d&&d.type==e&&$c(h.doc,o-1)&&(!n||n(s,d))&&h.join(o-1),h})}function Yk(i,e,t=null){return new gn(i,(n,r,s,o)=>{let l=n.doc.resolve(s),a=t instanceof Function?t(r):t;return l.node(-1).canReplaceWith(l.index(-1),l.indexAfter(-1),e)?n.tr.delete(s,o).setBlockType(s,s,e,a):null})}const ji=typeof navigator<"u"?navigator:null,SO=typeof document<"u"?document:null,Yr=ji&&ji.userAgent||"",Yu=/Edge\/(\d+)/.exec(Yr),jk=/MSIE \d/.exec(Yr),ju=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Yr),vp=!!(jk||ju||Yu);jk?document.documentMode:ju?+ju[1]:Yu&&+Yu[1];const hT=!vp&&/gecko\/(\d+)/i.test(Yr);hT&&+(/Firefox\/(\d+)/.exec(Yr)||[0,0])[1];const wO=!vp&&/Chrome\/(\d+)/.exec(Yr);wO&&+wO[1];const cT=!vp&&!!ji&&/Apple Computer/.test(ji.vendor),fT=cT&&(/Mobile\/\w+/.test(Yr)||!!ji&&ji.maxTouchPoints>2);fT||ji&&/Mac/.test(ji.platform);const uT=!!SO&&"webkitFontSmoothing"in SO.documentElement.style;uT&&+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1];function xf(i,e,t,n,r,s){if(i.composing)return!1;const o=i.state,l=o.doc.resolve(e);if(l.parent.type.spec.code)return!1;const a=l.parent.textBetween(Math.max(0,l.parentOffset-500),l.parentOffset,void 0,"")+n;for(let h=0;h<r.length;h++){const c=r[h].match.exec(a),f=c&&c[0]&&r[h].handler(o,c,e-(c[0].length-n.length),t);if(f)return i.dispatch(f.setMeta(s,{transform:f,from:e,to:t,text:n})),!0}return!1}const dT=new Ht("MILKDOWN_CUSTOM_INPUTRULES");function pT({rules:i}){const e=new wt({key:dT,isInputRules:!0,state:{init(){return null},apply(t,n){const r=t.getMeta(this);return r||(t.selectionSet||t.docChanged?null:n)}},props:{handleTextInput(t,n,r,s){return xf(t,n,r,s,i,e)},handleDOMEvents:{compositionend:t=>(setTimeout(()=>{const{$cursor:n}=t.state.selection;n&&xf(t,n.pos,n.pos,"",i,e)}),!1)},handleKeyDown(t,n){if(n.key!=="Enter")return!1;const{$cursor:r}=t.state.selection;return r?xf(t,r.pos,r.pos,`
`,i,e):!1}}});return e}function Mc(i,e,t={}){return new gn(i,(n,r,s,o)=>{var l,a,h,c;const{tr:f}=n,u=r.length;let d=r[u-1],p=r[0],m=[],g=o;const y={group:d,fullMatch:p,start:s,end:o},k=(l=t.updateCaptured)==null?void 0:l.call(t,y);if(Object.assign(y,k),{group:d,fullMatch:p,start:s,end:o}=y,p===null||(d==null?void 0:d.trim())==="")return null;if(d){const v=p.search(/\S/),$=s+p.indexOf(d),S=$+d.length;m=(a=f.storedMarks)!=null?a:[],S<o&&f.delete(S,o),$>s&&f.delete(s+v,$),g=s+v+d.length;const x=(h=t.getAttr)==null?void 0:h.call(t,r);f.addMark(s,g,e.create(x)),f.setStoredMarks(m),(c=t.beforeDispatch)==null||c.call(t,{match:r,start:s,end:o,tr:f})}return f})}function mT(i,e){return Array.isArray(i)&&i.includes(e.type)||e.type===i}function gT(i,e){const t=e.nodes[i];if(!t)throw dP("node",i);return t}function OT(i,e){if(!(i instanceof V))return;const{node:t,$from:n}=i;if(mT(e,t))return{node:t,pos:n.pos,start:n.start(n.depth),depth:n.depth}}const $p=(i,e)=>i.selection.empty?!1:(e&&e(i.tr.deleteSelection().scrollIntoView()),!0);function yT(i,e){let{$cursor:t}=i.selection;return!t||(e?!e.endOfTextblock("backward",i):t.parentOffset>0)?null:t}const _k=(i,e,t)=>{let n=yT(i,t);if(!n)return!1;let r=Uk(n);if(!r){let o=n.blockRange(),l=o&&vc(o);return l==null?!1:(e&&e(i.tr.lift(o,l).scrollIntoView()),!0)}let s=r.nodeBefore;if(!s.type.spec.isolating&&Hk(i,r,e))return!0;if(n.parent.content.size==0&&(Ns(s,"end")||V.isSelectable(s))){let o=pp(i.doc,n.before(),n.after(),Z.empty);if(o&&o.slice.size<o.to-o.from){if(e){let l=i.tr.step(o);l.setSelection(Ns(s,"end")?_.findFrom(l.doc.resolve(l.mapping.map(r.pos,-1)),-1):V.create(l.doc,r.pos-s.nodeSize)),e(l.scrollIntoView())}return!0}}return s.isAtom&&r.depth==n.depth-1?(e&&e(i.tr.delete(r.pos-s.nodeSize,r.pos).scrollIntoView()),!0):!1};function Ns(i,e,t=!1){for(let n=i;n;n=e=="start"?n.firstChild:n.lastChild){if(n.isTextblock)return!0;if(t&&n.childCount!=1)return!1}return!1}const Fk=(i,e,t)=>{let{$head:n,empty:r}=i.selection,s=n;if(!r)return!1;if(n.parent.isTextblock){if(t?!t.endOfTextblock("backward",i):n.parentOffset>0)return!1;s=Uk(n)}let o=s&&s.nodeBefore;return!o||!V.isSelectable(o)?!1:(e&&e(i.tr.setSelection(V.create(i.doc,s.pos-o.nodeSize)).scrollIntoView()),!0)};function Uk(i){if(!i.parent.type.spec.isolating)for(let e=i.depth-1;e>=0;e--){if(i.index(e)>0)return i.doc.resolve(i.before(e+1));if(i.node(e).type.spec.isolating)break}return null}function kT(i,e){let{$cursor:t}=i.selection;return!t||(e?!e.endOfTextblock("forward",i):t.parentOffset<t.parent.content.size)?null:t}const bT=(i,e,t)=>{let n=kT(i,t);if(!n)return!1;let r=Gk(n);if(!r)return!1;let s=r.nodeAfter;if(Hk(i,r,e))return!0;if(n.parent.content.size==0&&(Ns(s,"start")||V.isSelectable(s))){let o=pp(i.doc,n.before(),n.after(),Z.empty);if(o&&o.slice.size<o.to-o.from){if(e){let l=i.tr.step(o);l.setSelection(Ns(s,"start")?_.findFrom(l.doc.resolve(l.mapping.map(r.pos)),1):V.create(l.doc,l.mapping.map(r.pos))),e(l.scrollIntoView())}return!0}}return s.isAtom&&r.depth==n.depth-1?(e&&e(i.tr.delete(r.pos,r.pos+s.nodeSize).scrollIntoView()),!0):!1},ST=(i,e,t)=>{let{$head:n,empty:r}=i.selection,s=n;if(!r)return!1;if(n.parent.isTextblock){if(t?!t.endOfTextblock("forward",i):n.parentOffset<n.parent.content.size)return!1;s=Gk(n)}let o=s&&s.nodeAfter;return!o||!V.isSelectable(o)?!1:(e&&e(i.tr.setSelection(V.create(i.doc,s.pos)).scrollIntoView()),!0)};function Gk(i){if(!i.parent.type.spec.isolating)for(let e=i.depth-1;e>=0;e--){let t=i.node(e);if(i.index(e)+1<t.childCount)return i.doc.resolve(i.after(e+1));if(t.type.spec.isolating)break}return null}const wT=(i,e)=>{let{$head:t,$anchor:n}=i.selection;return!t.parent.type.spec.code||!t.sameParent(n)?!1:(e&&e(i.tr.insertText(`
`).scrollIntoView()),!0)};function Pp(i){for(let e=0;e<i.edgeCount;e++){let{type:t}=i.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const xT=(i,e)=>{let{$head:t,$anchor:n}=i.selection;if(!t.parent.type.spec.code||!t.sameParent(n))return!1;let r=t.node(-1),s=t.indexAfter(-1),o=Pp(r.contentMatchAt(s));if(!o||!r.canReplaceWith(s,s,o))return!1;if(e){let l=t.after(),a=i.tr.replaceWith(l,l,o.createAndFill());a.setSelection(_.near(a.doc.resolve(l),1)),e(a.scrollIntoView())}return!0},vT=(i,e)=>{let t=i.selection,{$from:n,$to:r}=t;if(t instanceof Nt||n.parent.inlineContent||r.parent.inlineContent)return!1;let s=Pp(r.parent.contentMatchAt(r.indexAfter()));if(!s||!s.isTextblock)return!1;if(e){let o=(!n.parentOffset&&r.index()<r.parent.childCount?n:r).pos,l=i.tr.insert(o,s.createAndFill());l.setSelection(J.create(l.doc,o+1)),e(l.scrollIntoView())}return!0},$T=(i,e)=>{let{$cursor:t}=i.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let s=t.before();if(Go(i.doc,s))return e&&e(i.tr.split(s).scrollIntoView()),!0}let n=t.blockRange(),r=n&&vc(n);return r==null?!1:(e&&e(i.tr.lift(n,r).scrollIntoView()),!0)};function PT(i){return(e,t)=>{let{$from:n,$to:r}=e.selection;if(e.selection instanceof V&&e.selection.node.isBlock)return!n.parentOffset||!Go(e.doc,n.pos)?!1:(t&&t(e.tr.split(n.pos).scrollIntoView()),!0);if(!n.parent.isBlock)return!1;if(t){let s=r.parentOffset==r.parent.content.size,o=e.tr;(e.selection instanceof J||e.selection instanceof Nt)&&o.deleteSelection();let l=n.depth==0?null:Pp(n.node(-1).contentMatchAt(n.indexAfter(-1))),a=i&&i(r.parent,s),h=a?[a]:s&&l?[{type:l}]:void 0,c=Go(o.doc,o.mapping.map(n.pos),1,h);if(!h&&!c&&Go(o.doc,o.mapping.map(n.pos),1,l?[{type:l}]:void 0)&&(l&&(h=[{type:l}]),c=!0),c&&(o.split(o.mapping.map(n.pos),1,h),!s&&!n.parentOffset&&n.parent.type!=l)){let f=o.mapping.map(n.before()),u=o.doc.resolve(f);l&&n.node(-1).canReplaceWith(u.index(),u.index()+1,l)&&o.setNodeMarkup(o.mapping.map(n.before()),l)}t(o.scrollIntoView())}return!0}}const QT=PT(),CT=(i,e)=>(e&&e(i.tr.setSelection(new Nt(i.doc))),!0);function TT(i,e,t){let n=e.nodeBefore,r=e.nodeAfter,s=e.index();return!n||!r||!n.type.compatibleContent(r.type)?!1:!n.content.size&&e.parent.canReplace(s-1,s)?(t&&t(i.tr.delete(e.pos-n.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(s,s+1)||!(r.isTextblock||$c(i.doc,e.pos))?!1:(t&&t(i.tr.clearIncompatible(e.pos,n.type,n.contentMatchAt(n.childCount)).join(e.pos).scrollIntoView()),!0)}function Hk(i,e,t){let n=e.nodeBefore,r=e.nodeAfter,s,o;if(n.type.spec.isolating||r.type.spec.isolating)return!1;if(TT(i,e,t))return!0;let l=e.parent.canReplace(e.index(),e.index()+1);if(l&&(s=(o=n.contentMatchAt(n.childCount)).findWrapping(r.type))&&o.matchType(s[0]||r.type).validEnd){if(t){let f=e.pos+r.nodeSize,u=P.empty;for(let m=s.length-1;m>=0;m--)u=P.from(s[m].create(null,u));u=P.from(n.copy(u));let d=i.tr.step(new He(e.pos-1,f,e.pos,f,new Z(u,1,0),s.length,!0)),p=f+2*s.length;$c(d.doc,p)&&d.join(p),t(d.scrollIntoView())}return!0}let a=_.findFrom(e,1),h=a&&a.$from.blockRange(a.$to),c=h&&vc(h);if(c!=null&&c>=e.depth)return t&&t(i.tr.lift(h,c).scrollIntoView()),!0;if(l&&Ns(r,"start",!0)&&Ns(n,"end")){let f=n,u=[];for(;u.push(f),!f.isTextblock;)f=f.lastChild;let d=r,p=1;for(;!d.isTextblock;d=d.firstChild)p++;if(f.canReplace(f.childCount,f.childCount,d.content)){if(t){let m=P.empty;for(let y=u.length-1;y>=0;y--)m=P.from(u[y].copy(m));let g=i.tr.step(new He(e.pos-u.length,e.pos+r.nodeSize,e.pos+p,e.pos+r.nodeSize-p,new Z(m,u.length,0),0,!0));t(g.scrollIntoView())}return!0}}return!1}function Kk(i){return function(e,t){let n=e.selection,r=i<0?n.$from:n.$to,s=r.depth;for(;r.node(s).isInline;){if(!s)return!1;s--}return r.node(s).isTextblock?(t&&t(e.tr.setSelection(J.create(e.doc,i<0?r.start(s):r.end(s)))),!0):!1}}const MT=Kk(-1),AT=Kk(1);function Qp(i,e=null){return function(t,n){let{$from:r,$to:s}=t.selection,o=r.blockRange(s),l=o&&tk(o,i,e);return l?(n&&n(t.tr.wrap(o,l).scrollIntoView()),!0):!1}}function yl(i,e=null){return function(t,n){let r=!1;for(let s=0;s<t.selection.ranges.length&&!r;s++){let{$from:{pos:o},$to:{pos:l}}=t.selection.ranges[s];t.doc.nodesBetween(o,l,(a,h)=>{if(r)return!1;if(!(!a.isTextblock||a.hasMarkup(i,e)))if(a.type==i)r=!0;else{let c=t.doc.resolve(h),f=c.index();r=c.parent.canReplaceWith(f,f+1,i)}})}if(!r)return!1;if(n){let s=t.tr;for(let o=0;o<t.selection.ranges.length;o++){let{$from:{pos:l},$to:{pos:a}}=t.selection.ranges[o];s.setBlockType(l,a,i,e)}n(s.scrollIntoView())}return!0}}function ZT(i,e,t){for(let n=0;n<e.length;n++){let{$from:r,$to:s}=e[n],o=r.depth==0?i.inlineContent&&i.type.allowsMarkType(t):!1;if(i.nodesBetween(r.pos,s.pos,l=>{if(o)return!1;o=l.inlineContent&&l.type.allowsMarkType(t)}),o)return!0}return!1}function Cp(i,e=null){return function(t,n){let{empty:r,$cursor:s,ranges:o}=t.selection;if(r&&!s||!ZT(t.doc,o,i))return!1;if(n)if(s)i.isInSet(t.storedMarks||s.marks())?n(t.tr.removeStoredMark(i)):n(t.tr.addStoredMark(i.create(e)));else{let l=!1,a=t.tr;for(let h=0;!l&&h<o.length;h++){let{$from:c,$to:f}=o[h];l=t.doc.rangeHasMark(c.pos,f.pos,i)}for(let h=0;h<o.length;h++){let{$from:c,$to:f}=o[h];if(l)a.removeMark(c.pos,f.pos,i);else{let u=c.pos,d=f.pos,p=c.nodeAfter,m=f.nodeBefore,g=p&&p.isText?/^\s*/.exec(p.text)[0].length:0,y=m&&m.isText?/\s*$/.exec(m.text)[0].length:0;u+g<d&&(u+=g,d-=y),a.addMark(u,d,i.create(e))}}n(a.scrollIntoView())}return!0}}function Ac(...i){return function(e,t,n){for(let r=0;r<i.length;r++)if(i[r](e,t,n))return!0;return!1}}let vf=Ac($p,_k,Fk),xO=Ac($p,bT,ST);const Kn={Enter:Ac(wT,vT,$T,QT),"Mod-Enter":xT,Backspace:vf,"Mod-Backspace":vf,"Shift-Backspace":vf,Delete:xO,"Mod-Delete":xO,"Mod-a":CT},Jk={"Ctrl-h":Kn.Backspace,"Alt-Backspace":Kn["Mod-Backspace"],"Ctrl-d":Kn.Delete,"Ctrl-Alt-Backspace":Kn["Mod-Delete"],"Alt-Delete":Kn["Mod-Delete"],"Alt-d":Kn["Mod-Delete"],"Ctrl-a":MT,"Ctrl-e":AT};for(let i in Kn)Jk[i]=Kn[i];const RT=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform?os.platform()=="darwin":!1,ET=RT?Jk:Kn;var ai={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},kl={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},NT=typeof navigator<"u"&&/Mac/.test(navigator.platform),DT=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Le=0;Le<10;Le++)ai[48+Le]=ai[96+Le]=String(Le);for(var Le=1;Le<=24;Le++)ai[Le+111]="F"+Le;for(var Le=65;Le<=90;Le++)ai[Le]=String.fromCharCode(Le+32),kl[Le]=String.fromCharCode(Le);for(var $f in ai)kl.hasOwnProperty($f)||(kl[$f]=ai[$f]);function eb(i){var e=NT&&i.metaKey&&i.shiftKey&&!i.ctrlKey&&!i.altKey||DT&&i.shiftKey&&i.key&&i.key.length==1||i.key=="Unidentified",t=!e&&i.key||(i.shiftKey?kl:ai)[i.keyCode]||i.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}const IT=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function WT(i){let e=i.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let n,r,s,o;for(let l=0;l<e.length-1;l++){let a=e[l];if(/^(cmd|meta|m)$/i.test(a))o=!0;else if(/^a(lt)?$/i.test(a))n=!0;else if(/^(c|ctrl|control)$/i.test(a))r=!0;else if(/^s(hift)?$/i.test(a))s=!0;else if(/^mod$/i.test(a))IT?o=!0:r=!0;else throw new Error("Unrecognized modifier name: "+a)}return n&&(t="Alt-"+t),r&&(t="Ctrl-"+t),o&&(t="Meta-"+t),s&&(t="Shift-"+t),t}function XT(i){let e=Object.create(null);for(let t in i)e[WT(t)]=i[t];return e}function Pf(i,e,t=!0){return e.altKey&&(i="Alt-"+i),e.ctrlKey&&(i="Ctrl-"+i),e.metaKey&&(i="Meta-"+i),t&&e.shiftKey&&(i="Shift-"+i),i}function tb(i){return new wt({props:{handleKeyDown:nb(i)}})}function nb(i){let e=XT(i);return function(t,n){let r=eb(n),s,o=e[Pf(r,n)];if(o&&o(t.state,t.dispatch,t))return!0;if(r.length==1&&r!=" "){if(n.shiftKey){let l=e[Pf(r,n,!1)];if(l&&l(t.state,t.dispatch,t))return!0}if((n.shiftKey||n.altKey||n.metaKey||r.charCodeAt(0)>127)&&(s=ai[n.keyCode])&&s!=r){let l=e[Pf(s,n)];if(l&&l(t.state,t.dispatch,t))return!0}}return!1}}var ib=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)},W=(i,e,t)=>(ib(i,e,"read from private field"),t?t.call(i):e.get(i)),We=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},Se=(i,e,t,n)=>(ib(i,e,"write to private field"),n?n.call(i,t):e.set(i,t),t);function er(i,e){return i.meta={package:"@milkdown/core",group:"System",...e},i}const rb={strong:(i,e,t,n)=>{const r=i.marker||t.options.strong||"*",s=t.enter("strong"),o=t.createTracker(n);let l=o.move(r+r);return l+=o.move(t.containerPhrasing(i,{before:l,after:r,...o.current()})),l+=o.move(r+r),s(),l},emphasis:(i,e,t,n)=>{const r=i.marker||t.options.emphasis||"*",s=t.enter("emphasis"),o=t.createTracker(n);let l=o.move(r);return l+=o.move(t.containerPhrasing(i,{before:l,after:r,...o.current()})),l+=o.move(r),s(),l}},rh=Ki("ConfigReady");function BT(i){const e=t=>(t.record(rh),async()=>(await i(t),t.done(rh),()=>{t.clearTimer(rh)}));return er(e,{displayName:"Config"}),e}const Cr=Ki("InitReady"),Qf=ne([],"initTimer"),vO=ne({},"editor"),bl=ne([],"inputRules"),un=ne([],"prosePlugins"),Sl=ne([],"remarkPlugins"),wl=ne([],"nodeView"),xl=ne([],"markView"),Tr=ne(vu().use($u).use(Cu),"remark"),Jo=ne({handlers:rb},"remarkStringifyOptions");function VT(i){const e=t=>(t.inject(vO,i).inject(un,[]).inject(Sl,[]).inject(bl,[]).inject(wl,[]).inject(xl,[]).inject(Jo,{handlers:rb}).inject(Tr,vu().use($u).use(Cu)).inject(Qf,[rh]).record(Cr),async()=>{await t.waitTimers(Qf);const n=t.get(Jo);return t.set(Tr,vu().use($u).use(Cu,n)),t.done(Cr),()=>{t.remove(vO).remove(un).remove(Sl).remove(bl).remove(wl).remove(xl).remove(Jo).remove(Tr).remove(Qf).clearTimer(Cr)}});return er(e,{displayName:"Init"}),e}const cn=Ki("SchemaReady"),Cf=ne([],"schemaTimer"),In=ne({},"schema"),ys=ne([],"nodes"),ks=ne([],"marks");function $O(i){var e;return{...i,parseDOM:(e=i.parseDOM)==null?void 0:e.map(t=>({priority:i.priority,...t}))}}const sb=i=>(i.inject(In,{}).inject(ys,[]).inject(ks,[]).inject(Cf,[Cr]).record(cn),async()=>{await i.waitTimers(Cf);const e=i.get(Tr),t=i.get(Sl).reduce((o,l)=>o.use(l.plugin,l.options),e);i.set(Tr,t);const n=Object.fromEntries(i.get(ys).map(([o,l])=>[o,$O(l)])),r=Object.fromEntries(i.get(ks).map(([o,l])=>[o,$O(l)])),s=new BP({nodes:n,marks:r});return i.set(In,s),i.done(cn),()=>{i.remove(In).remove(ys).remove(ks).remove(Cf).clearTimer(cn)}});er(sb,{displayName:"Schema"});const sh=Ki("ParserReady"),ob=()=>{throw up()},bs=ne(ob,"parser"),Tf=ne([],"parserTimer"),lb=i=>(i.inject(bs,ob).inject(Tf,[cn]).record(sh),async()=>{await i.waitTimers(Tf);const e=i.get(Tr),t=i.get(In);return i.set(bs,GP.create(t,e)),i.done(sh),()=>{i.remove(bs).remove(Tf).clearTimer(sh)}});er(lb,{displayName:"Parser"});const el=Ki("SerializerReady"),Mf=ne([],"serializerTimer"),ab=()=>{throw up()},tl=ne(ab,"serializer"),hb=i=>(i.inject(tl,ab).inject(Mf,[cn]).record(el),async()=>{await i.waitTimers(Mf);const e=i.get(Tr),t=i.get(In);return i.set(tl,KP.create(t,e)),i.done(el),()=>{i.remove(tl).remove(Mf).clearTimer(el)}});er(hb,{displayName:"Serializer"});const oh=ne("","defaultValue"),Wo=ne({},"editorState"),lh=ne(i=>i,"stateOptions"),Af=ne([],"editorStateTimer"),ah=Ki("EditorStateReady");function qT(i,e,t){if(typeof i=="string")return e(i);if(i.type==="html")return Rr.fromSchema(t).parse(i.dom);if(i.type==="json")return hn.fromJSON(t,i.value);throw lP(i)}const LT=new Ht("MILKDOWN_STATE_TRACKER");function zT(i){const e=Ac(aT,$p,_k,Fk);return i.Backspace=e,i}const cb=i=>(i.inject(oh,"").inject(Wo,{}).inject(lh,e=>e).inject(Af,[sh,el,il]).record(ah),async()=>{await i.waitTimers(Af);const e=i.get(In),t=i.get(bs),n=i.get(bl),r=i.get(lh),s=i.get(un),o=i.get(oh),l=qT(o,t,e),a=[...s,new wt({key:LT,state:{init:()=>{},apply:(f,u,d,p)=>{i.set(Wo,p)}}}),pT({rules:n}),tb(zT(ET))];i.set(un,a);const h=r({schema:e,doc:l,plugins:a}),c=lk.create(h);return i.set(Wo,c),i.done(ah),()=>{i.remove(oh).remove(Wo).remove(lh).remove(Af).clearTimer(ah)}});er(cb,{displayName:"EditorState"});const hh=Ki("EditorViewReady"),Ss=ne({},"editorView"),Zf=ne([],"editorViewTimer"),nl=ne({},"editorViewOptions"),ch=ne(null,"root"),_u=ne(null,"rootDOM"),Fu=ne({},"rootAttrs");function YT(i,e){const t=document.createElement("div");t.className="milkdown",i.appendChild(t),e.set(_u,t);const n=e.get(Fu);return Object.entries(n).forEach(([r,s])=>t.setAttribute(r,s)),t}function jT(i){i.classList.add("editor"),i.setAttribute("role","textbox")}const _T=new Ht("MILKDOWN_VIEW_CLEAR"),fb=i=>(i.inject(ch,document.body).inject(Ss,{}).inject(nl,{}).inject(_u,null).inject(Fu,{}).inject(Zf,[ah]).record(hh),async()=>{await i.wait(Cr);const e=i.get(ch)||document.body,t=typeof e=="string"?document.querySelector(e):e;i.update(un,a=>[new wt({key:_T,view:h=>{const c=t?YT(t,i):void 0;return(()=>{if(c&&t){const f=h.dom;t.replaceChild(c,f),c.appendChild(f)}})(),{destroy:()=>{c!=null&&c.parentNode&&(c==null||c.parentNode.replaceChild(h.dom,c)),c==null||c.remove()}}}}),...a]),await i.waitTimers(Zf);const n=i.get(Wo),r=i.get(nl),s=Object.fromEntries(i.get(wl)),o=Object.fromEntries(i.get(xl)),l=new rT(t,{state:n,nodeViews:s,markViews:o,...r});return jT(l.dom),i.set(Ss,l),i.done(hh),()=>{l==null||l.destroy(),i.remove(ch).remove(Ss).remove(nl).remove(_u).remove(Fu).remove(Zf).clearTimer(hh)}});er(fb,{displayName:"EditorView"});var ns,ar;let ub=class{constructor(){We(this,ns,void 0),We(this,ar,void 0),Se(this,ns,new Q1),Se(this,ar,null),this.setCtx=e=>{Se(this,ar,e)}}get ctx(){return W(this,ar)}create(e,t){const n=e.create(W(this,ns).sliceMap);return n.set(t),n}get(e){return W(this,ns).get(e).get()}remove(e){return W(this,ns).remove(e)}call(e,t){if(W(this,ar)==null)throw pP();const n=this.get(e)(t),r=W(this,ar).get(Ss);return n(r.state,r.dispatch,r)}};ns=new WeakMap,ar=new WeakMap;function FT(i="cmdKey"){return ne(()=>()=>!1,i)}const re=ne(new ub,"commands"),Rf=ne([cn],"commandsTimer"),il=Ki("CommandsReady"),db=i=>{const e=new ub;return e.setCtx(i),i.inject(re,e).inject(Rf,[cn]).record(il),async()=>(await i.waitTimers(Rf),i.done(il),()=>{i.remove(re).remove(Rf).clearTimer(il)})};er(db,{displayName:"Commands"});var is,Bt,wi,Xo,fh,uh,Qt,xi,rs,dh,ss,Bo,ph,hr,Vo;const UT=class pb{constructor(){We(this,is,void 0),We(this,Bt,void 0),We(this,wi,void 0),We(this,Xo,void 0),We(this,fh,void 0),We(this,uh,void 0),We(this,Qt,void 0),We(this,xi,void 0),We(this,rs,void 0),We(this,dh,void 0),We(this,ss,void 0),We(this,Bo,void 0),We(this,ph,void 0),We(this,hr,void 0),We(this,Vo,void 0),Se(this,is,!1),Se(this,Bt,"Idle"),Se(this,wi,[]),Se(this,Xo,()=>{}),Se(this,fh,new Q1),Se(this,uh,new wP),Se(this,Qt,new Map),Se(this,xi,new Map),Se(this,rs,new SP(W(this,fh),W(this,uh))),Se(this,dh,()=>{const e=BT(async n=>{await Promise.all(W(this,wi).map(r=>r(n)))}),t=[sb,lb,hb,db,cb,fb,VT(this),e];W(this,ss).call(this,t,W(this,xi))}),Se(this,ss,(e,t)=>{e.forEach(n=>{const r=W(this,rs).produce(W(this,is)?n.meta:void 0),s=n(r);t.set(n,{ctx:r,handler:s,cleanup:void 0})})}),Se(this,Bo,(e,t=!1)=>Promise.all([e].flat().map(n=>{const r=W(this,Qt).get(n),s=r==null?void 0:r.cleanup;return t?W(this,Qt).delete(n):W(this,Qt).set(n,{ctx:void 0,handler:void 0,cleanup:void 0}),typeof s=="function"?s():s}))),Se(this,ph,async()=>{await Promise.all([...W(this,xi).entries()].map(([e,{cleanup:t}])=>typeof t=="function"?t():t)),W(this,xi).clear()}),Se(this,hr,e=>{Se(this,Bt,e),W(this,Xo).call(this,e)}),Se(this,Vo,e=>[...e.entries()].map(async([t,n])=>{const{ctx:r,handler:s}=n;if(!s)return;const o=await s();e.set(t,{ctx:r,handler:s,cleanup:o})})),this.enableInspector=(e=!0)=>(Se(this,is,e),this),this.onStatusChange=e=>(Se(this,Xo,e),this),this.config=e=>(W(this,wi).push(e),this),this.removeConfig=e=>(Se(this,wi,W(this,wi).filter(t=>t!==e)),this),this.use=e=>{const t=[e].flat();return t.flat().forEach(n=>{W(this,Qt).set(n,{ctx:void 0,handler:void 0,cleanup:void 0})}),W(this,Bt)==="Created"&&W(this,ss).call(this,t,W(this,Qt)),this},this.remove=async e=>W(this,Bt)==="OnCreate"?(console.warn("[Milkdown]: You are trying to remove plugins when the editor is creating, this is not recommended, please check your code."),new Promise(t=>{setTimeout(()=>{t(this.remove(e))},50)})):(await W(this,Bo).call(this,[e].flat(),!0),this),this.create=async()=>W(this,Bt)==="OnCreate"?this:(W(this,Bt)==="Created"&&await this.destroy(),W(this,hr).call(this,"OnCreate"),W(this,dh).call(this),W(this,ss).call(this,[...W(this,Qt).keys()],W(this,Qt)),await Promise.all([W(this,Vo).call(this,W(this,xi)),W(this,Vo).call(this,W(this,Qt))].flat()),W(this,hr).call(this,"Created"),this),this.destroy=async(e=!1)=>W(this,Bt)==="Destroyed"||W(this,Bt)==="OnDestroy"?this:W(this,Bt)==="OnCreate"?new Promise(t=>{setTimeout(()=>{t(this.destroy(e))},50)}):(e&&Se(this,wi,[]),W(this,hr).call(this,"OnDestroy"),await W(this,Bo).call(this,[...W(this,Qt).keys()],e),await W(this,ph).call(this),W(this,hr).call(this,"Destroyed"),this),this.action=e=>e(W(this,rs)),this.inspect=()=>W(this,is)?[...W(this,xi).values(),...W(this,Qt).values()].map(({ctx:e})=>{var t;return(t=e==null?void 0:e.inspector)==null?void 0:t.read()}).filter(e=>!!e):(console.warn("[Milkdown]: You are trying to collect inspection when inspector is disabled, please enable inspector by `editor.enableInspector()` first."),[])}static make(){return new pb}get ctx(){return W(this,rs)}get status(){return W(this,Bt)}};is=new WeakMap,Bt=new WeakMap,wi=new WeakMap,Xo=new WeakMap,fh=new WeakMap,uh=new WeakMap,Qt=new WeakMap,xi=new WeakMap,rs=new WeakMap,dh=new WeakMap,ss=new WeakMap,Bo=new WeakMap,ph=new WeakMap,hr=new WeakMap,Vo=new WeakMap;let GT=UT,HT=i=>crypto.getRandomValues(new Uint8Array(i)),KT=(i,e,t)=>{let n=(2<<Math.log(i.length-1)/Math.LN2)-1,r=-~(1.6*n*e/i.length);return(s=e)=>{let o="";for(;;){let l=t(r),a=r;for(;a--;)if(o+=i[l[a]&n]||"",o.length===s)return o}}},JT=(i,e=21)=>KT(i,e,HT);JT("abcedfghicklmn",10);function ue(i,e){const t=FT(i),n=r=>async()=>{n.key=t,await r.wait(il);const s=e(r);return r.get(re).create(t,s),n.run=o=>r.get(re).call(i,o),()=>{r.get(re).remove(t)}};return n}function pt(i){const e=t=>async()=>{await t.wait(cn);const n=i(t);return t.update(bl,r=>[...r,n]),e.inputRule=n,()=>{t.update(bl,r=>r.filter(s=>s!==n))}};return e}function eM(i,e){const t=n=>async()=>{const r=e(n);return n.update(ks,s=>[...s.filter(o=>o[0]!==i),[i,r]]),t.id=i,t.schema=r,()=>{n.update(ks,s=>s.filter(([o])=>o!==i))}};return t.type=n=>{const r=n.get(In).marks[i];if(!r)throw gP(i);return r},t}function Tp(i,e){const t=n=>async()=>{const r=e(n);return n.update(ys,s=>[...s.filter(o=>o[0]!==i),[i,r]]),t.id=i,t.schema=r,()=>{n.update(ys,s=>s.filter(([o])=>o!==i))}};return t.type=n=>{const r=n.get(In).nodes[i];if(!r)throw mP(i);return r},t}function fi(i){let e;const t=n=>async()=>(await n.wait(cn),e=i(n),n.update(un,r=>[...r,e]),()=>{n.update(un,r=>r.filter(s=>s!==e))});return t.plugin=()=>e,t.key=()=>e.spec.key,t}function tM(i){const e=t=>async()=>{await t.wait(cn);const n=i(t),r=tb(n);return t.update(un,s=>[...s,r]),e.keymap=n,()=>{t.update(un,s=>s.filter(o=>o!==r))}};return e}function nM(i,e){const t=n=>async()=>{await n.wait(cn);const r=e(n);return i.type(n)instanceof Wh?n.update(wl,s=>[...s,[i.id,r]]):n.update(xl,s=>[...s,[i.id,r]]),t.view=r,t.type=i,()=>{i.type(n)instanceof Wh?n.update(wl,s=>s.filter(o=>o[0]!==i.id)):n.update(xl,s=>s.filter(o=>o[0]!==i.id))}};return t}function jn(i,e){const t=ne(i,e),n=r=>(r.inject(t),()=>()=>{r.remove(t)});return n.key=t,n}function et(i,e){const t=jn(e,i),n=Tp(i,s=>s.get(t.key)(s)),r=[t,n];return r.id=n.id,r.node=n,r.type=s=>n.type(s),r.schema=n.schema,r.ctx=t,r.key=t.key,r.extendSchema=s=>o=>()=>{const l=o.get(t.key),a=s(l)(o);o.update(ys,h=>[...h.filter(c=>c[0]!==i),[i,a]]),r.schema=a},r}function Zc(i,e){const t=jn(e,i),n=eM(i,s=>s.get(t.key)(s)),r=[t,n];return r.id=n.id,r.mark=n,r.type=n.type,r.schema=n.schema,r.ctx=t,r.key=t.key,r.extendSchema=s=>o=>()=>{const l=o.get(t.key),a=s(l)(o);o.update(ks,h=>[...h.filter(c=>c[0]!==i),[i,a]]),r.schema=a},r}function Kt(i,e){const t=Object.fromEntries(Object.entries(e).map(([o,{shortcuts:l}])=>[o,l])),n=jn(t,`${i}Keymap`),r=tM(o=>{const l=o.get(n.key),a=Object.entries(e).flatMap(([h,{command:c}])=>[l[h]].flat().map(f=>[f,c(o)]));return Object.fromEntries(a)}),s=[n,r];return s.ctx=n,s.shortcuts=r,s.key=n.key,s.keymap=r.keymap,s}const tt=(i,e=()=>({}))=>jn(e,`${i}Attr`),Rc=(i,e=()=>({}))=>jn(e,`${i}Attr`);function ui(i,e,t){const n=jn(t??{},i),r=o=>async()=>{await o.wait(Cr);const l={plugin:e(o),options:o.get(n.key)};return o.update(Sl,a=>[...a,l]),()=>{o.update(Sl,a=>a.filter(h=>h!==l))}},s=[n,r];return s.id=i,s.plugin=r,s.options=n,s}function iM(i,e){return t=>t.get(re).call(i,e)}function rM(i,e=!1){return t=>{const n=t.get(Ss),r=t.get(bs)(i);if(!r)return;if(!e){const{state:h}=n;return n.dispatch(h.tr.replace(0,h.doc.content.size,new Z(r.content,0,0)))}const s=t.get(In),o=t.get(lh),l=t.get(un),a=lk.create({schema:s,doc:r,plugins:l,...o});n.updateState(a)}}function Uu(i){if(!i)return!1;if(Array.isArray(i))return i.length>1?!1:Uu(i[0]);const e=i.content;return e?Uu(e):i.type==="text"}function sM(i){if(i.content.childCount===1){const e=i.content.firstChild;if((e==null?void 0:e.type.name)==="text"&&e.marks.length===0)return e;if((e==null?void 0:e.type.name)==="paragraph"&&e.childCount===1){const t=e.firstChild;if((t==null?void 0:t.type.name)==="text"&&t.marks.length===0)return t}}return!1}const mb=fi(i=>{const e=i.get(In);i.update(nl,n=>({...n,editable:n.editable??(()=>!0)}));const t=new Ht("MILKDOWN_CLIPBOARD");return new wt({key:t,props:{handlePaste:(n,r)=>{var s,o;const l=i.get(bs),a=(o=(s=n.props).editable)==null?void 0:o.call(s,n.state),{clipboardData:h}=r;if(!a||!h||n.state.selection.$from.node().type.spec.code)return!1;const c=h.getData("text/plain"),f=h.getData("vscode-editor-data");if(f){const y=JSON.parse(f),k=y==null?void 0:y.mode;if(c&&k){const{tr:v}=n.state,$=gT("code_block",e);return v.replaceSelectionWith($.create({language:k})).setSelection(J.near(v.doc.resolve(Math.max(0,v.selection.from-2)))).insertText(c.replace(/\r\n?/g,`
`)),n.dispatch(v),!0}}const u=h.getData("text/html");if(u.length===0&&c.length===0)return!1;const d=Rr.fromSchema(e);let p;if(u.length===0){const y=l(c);if(!y||typeof y=="string")return!1;p=Zn.fromSchema(e).serializeFragment(y.content)}else{const y=document.createElement("template");y.innerHTML=u,p=y.content.cloneNode(!0),y.remove()}const m=d.parseSlice(p),g=sM(m);return g?(n.dispatch(n.state.tr.replaceSelectionWith(g,!0)),!0):(n.dispatch(n.state.tr.replaceSelection(m)),!0)},clipboardTextSerializer:n=>{const r=i.get(tl);if(Uu(n.content.toJSON()))return n.content.textBetween(0,n.content.size,`

`);const s=e.topNodeType.createAndFill(void 0,n.content);return s?r(s):""}}})});mb.meta={displayName:"Prose<clipboard>",package:"@milkdown/plugin-clipboard"};function oM(i={}){return new wt({view(e){return new lM(e,i)}})}class lM{constructor(e,t){var n;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(n=t.width)!==null&&n!==void 0?n:1,this.color=t.color===!1?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(r=>{let s=o=>{this[r](o)};return e.dom.addEventListener(r,s),{name:r,handler:s}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){this.cursorPos!=null&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),t=!e.parent.inlineContent,n;if(t){let l=e.nodeBefore,a=e.nodeAfter;if(l||a){let h=this.editorView.nodeDOM(this.cursorPos-(l?l.nodeSize:0));if(h){let c=h.getBoundingClientRect(),f=l?c.bottom:c.top;l&&a&&(f=(f+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),n={left:c.left,right:c.right,top:f-this.width/2,bottom:f+this.width/2}}}}if(!n){let l=this.editorView.coordsAtPos(this.cursorPos);n={left:l.left-this.width/2,right:l.left+this.width/2,top:l.top,bottom:l.bottom}}let r=this.editorView.dom.offsetParent;this.element||(this.element=r.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",t),this.element.classList.toggle("prosemirror-dropcursor-inline",!t);let s,o;if(!r||r==document.body&&getComputedStyle(r).position=="static")s=-pageXOffset,o=-pageYOffset;else{let l=r.getBoundingClientRect();s=l.left-r.scrollLeft,o=l.top-r.scrollTop}this.element.style.left=n.left-s+"px",this.element.style.top=n.top-o+"px",this.element.style.width=n.right-n.left+"px",this.element.style.height=n.bottom-n.top+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),n=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),r=n&&n.type.spec.disableDropCursor,s=typeof r=="function"?r(this.editorView,t,e):r;if(t&&!s){let o=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let l=nk(this.editorView.state.doc,o,this.editorView.dragging.slice);l!=null&&(o=l)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){(e.target==this.editorView.dom||!this.editorView.dom.contains(e.relatedTarget))&&this.setCursor(null)}}class xe extends _{constructor(e){super(e,e)}map(e,t){let n=e.resolve(t.map(this.head));return xe.valid(n)?new xe(n):_.near(n)}content(){return Z.empty}eq(e){return e instanceof xe&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new xe(e.resolve(t.pos))}getBookmark(){return new Mp(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!aM(e)||!hM(e))return!1;let n=t.type.spec.allowGapCursor;if(n!=null)return n;let r=t.contentMatchAt(e.index()).defaultType;return r&&r.isTextblock}static findGapCursorFrom(e,t,n=!1){e:for(;;){if(!n&&xe.valid(e))return e;let r=e.pos,s=null;for(let o=e.depth;;o--){let l=e.node(o);if(t>0?e.indexAfter(o)<l.childCount:e.index(o)>0){s=l.child(t>0?e.indexAfter(o):e.index(o)-1);break}else if(o==0)return null;r+=t;let a=e.doc.resolve(r);if(xe.valid(a))return a}for(;;){let o=t>0?s.firstChild:s.lastChild;if(!o){if(s.isAtom&&!s.isText&&!V.isSelectable(s)){e=e.doc.resolve(r+s.nodeSize*t),n=!1;continue e}break}s=o,r+=t;let l=e.doc.resolve(r);if(xe.valid(l))return l}return null}}}xe.prototype.visible=!1;xe.findFrom=xe.findGapCursorFrom;_.jsonID("gapcursor",xe);class Mp{constructor(e){this.pos=e}map(e){return new Mp(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return xe.valid(t)?new xe(t):_.near(t)}}function aM(i){for(let e=i.depth;e>=0;e--){let t=i.index(e),n=i.node(e);if(t==0){if(n.type.spec.isolating)return!0;continue}for(let r=n.child(t-1);;r=r.lastChild){if(r.childCount==0&&!r.inlineContent||r.isAtom||r.type.spec.isolating)return!0;if(r.inlineContent)return!1}}return!0}function hM(i){for(let e=i.depth;e>=0;e--){let t=i.indexAfter(e),n=i.node(e);if(t==n.childCount){if(n.type.spec.isolating)return!0;continue}for(let r=n.child(t);;r=r.firstChild){if(r.childCount==0&&!r.inlineContent||r.isAtom||r.type.spec.isolating)return!0;if(r.inlineContent)return!1}}return!0}function cM(){return new wt({props:{decorations:pM,createSelectionBetween(i,e,t){return e.pos==t.pos&&xe.valid(t)?new xe(t):null},handleClick:uM,handleKeyDown:fM,handleDOMEvents:{beforeinput:dM}}})}const fM=nb({ArrowLeft:ma("horiz",-1),ArrowRight:ma("horiz",1),ArrowUp:ma("vert",-1),ArrowDown:ma("vert",1)});function ma(i,e){const t=i=="vert"?e>0?"down":"up":e>0?"right":"left";return function(n,r,s){let o=n.selection,l=e>0?o.$to:o.$from,a=o.empty;if(o instanceof J){if(!s.endOfTextblock(t)||l.depth==0)return!1;a=!1,l=n.doc.resolve(e>0?l.after():l.before())}let h=xe.findGapCursorFrom(l,e,a);return h?(r&&r(n.tr.setSelection(new xe(h))),!0):!1}}function uM(i,e,t){if(!i||!i.editable)return!1;let n=i.state.doc.resolve(e);if(!xe.valid(n))return!1;let r=i.posAtCoords({left:t.clientX,top:t.clientY});return r&&r.inside>-1&&V.isSelectable(i.state.doc.nodeAt(r.inside))?!1:(i.dispatch(i.state.tr.setSelection(new xe(n))),!0)}function dM(i,e){if(e.inputType!="insertCompositionText"||!(i.state.selection instanceof xe))return!1;let{$from:t}=i.state.selection,n=t.parent.contentMatchAt(t.index()).findWrapping(i.state.schema.nodes.text);if(!n)return!1;let r=P.empty;for(let o=n.length-1;o>=0;o--)r=P.from(n[o].createAndFill(null,r));let s=i.state.tr.replace(t.pos,t.pos,new Z(r,0,0));return s.setSelection(J.near(s.doc.resolve(t.pos+1))),i.dispatch(s),!1}function pM(i){if(!(i.selection instanceof xe))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",Pe.create(i.doc,[qn.widget(i.selection.head,e,{key:"gapcursor"})])}function Ap(i,e){return Object.assign(i,{meta:{package:"@milkdown/plugin-cursor",...e}}),i}const Zp=jn({},"dropCursorConfig");Ap(Zp,{displayName:"Ctx<dropCursor>"});const gb=fi(i=>oM(i.get(Zp.key)));Ap(gb,{displayName:"Prose<dropCursor>"});const Ob=fi(()=>cM());Ap(Ob,{displayName:"Prose<gapCursor>"});const mM=[Zp,gb,Ob];var zh=200,Ie=function(){};Ie.prototype.append=function(e){return e.length?(e=Ie.from(e),!this.length&&e||e.length<zh&&this.leafAppend(e)||this.length<zh&&e.leafPrepend(this)||this.appendInner(e)):this};Ie.prototype.prepend=function(e){return e.length?Ie.from(e).append(this):this};Ie.prototype.appendInner=function(e){return new gM(this,e)};Ie.prototype.slice=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=this.length),e>=t?Ie.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))};Ie.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};Ie.prototype.forEach=function(e,t,n){t===void 0&&(t=0),n===void 0&&(n=this.length),t<=n?this.forEachInner(e,t,n,0):this.forEachInvertedInner(e,t,n,0)};Ie.prototype.map=function(e,t,n){t===void 0&&(t=0),n===void 0&&(n=this.length);var r=[];return this.forEach(function(s,o){return r.push(e(s,o))},t,n),r};Ie.from=function(e){return e instanceof Ie?e:e&&e.length?new yb(e):Ie.empty};var yb=function(i){function e(n){i.call(this),this.values=n}i&&(e.__proto__=i),e.prototype=Object.create(i&&i.prototype),e.prototype.constructor=e;var t={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(r,s){return r==0&&s==this.length?this:new e(this.values.slice(r,s))},e.prototype.getInner=function(r){return this.values[r]},e.prototype.forEachInner=function(r,s,o,l){for(var a=s;a<o;a++)if(r(this.values[a],l+a)===!1)return!1},e.prototype.forEachInvertedInner=function(r,s,o,l){for(var a=s-1;a>=o;a--)if(r(this.values[a],l+a)===!1)return!1},e.prototype.leafAppend=function(r){if(this.length+r.length<=zh)return new e(this.values.concat(r.flatten()))},e.prototype.leafPrepend=function(r){if(this.length+r.length<=zh)return new e(r.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(e.prototype,t),e}(Ie);Ie.empty=new yb([]);var gM=function(i){function e(t,n){i.call(this),this.left=t,this.right=n,this.length=t.length+n.length,this.depth=Math.max(t.depth,n.depth)+1}return i&&(e.__proto__=i),e.prototype=Object.create(i&&i.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(n){return n<this.left.length?this.left.get(n):this.right.get(n-this.left.length)},e.prototype.forEachInner=function(n,r,s,o){var l=this.left.length;if(r<l&&this.left.forEachInner(n,r,Math.min(s,l),o)===!1||s>l&&this.right.forEachInner(n,Math.max(r-l,0),Math.min(this.length,s)-l,o+l)===!1)return!1},e.prototype.forEachInvertedInner=function(n,r,s,o){var l=this.left.length;if(r>l&&this.right.forEachInvertedInner(n,r-l,Math.max(s,l)-l,o+l)===!1||s<l&&this.left.forEachInvertedInner(n,Math.min(r,l),s,o)===!1)return!1},e.prototype.sliceInner=function(n,r){if(n==0&&r==this.length)return this;var s=this.left.length;return r<=s?this.left.slice(n,r):n>=s?this.right.slice(n-s,r-s):this.left.slice(n,s).append(this.right.slice(0,r-s))},e.prototype.leafAppend=function(n){var r=this.right.leafAppend(n);if(r)return new e(this.left,r)},e.prototype.leafPrepend=function(n){var r=this.left.leafPrepend(n);if(r)return new e(r,this.right)},e.prototype.appendInner=function(n){return this.left.depth>=Math.max(this.right.depth,n.depth)+1?new e(this.left,new e(this.right,n)):new e(this,n)},e}(Ie);const OM=500;class on{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(this.eventCount==0)return null;let n=this.items.length;for(;;n--)if(this.items.get(n-1).selection){--n;break}let r,s;t&&(r=this.remapping(n,this.items.length),s=r.maps.length);let o=e.tr,l,a,h=[],c=[];return this.items.forEach((f,u)=>{if(!f.step){r||(r=this.remapping(n,u+1),s=r.maps.length),s--,c.push(f);return}if(r){c.push(new Qn(f.map));let d=f.step.map(r.slice(s)),p;d&&o.maybeStep(d).doc&&(p=o.mapping.maps[o.mapping.maps.length-1],h.push(new Qn(p,void 0,void 0,h.length+c.length))),s--,p&&r.appendMap(p,s)}else o.maybeStep(f.step);if(f.selection)return l=r?f.selection.map(r.slice(s)):f.selection,a=new on(this.items.slice(0,n).append(c.reverse().concat(h)),this.eventCount-1),!1},this.items.length,0),{remaining:a,transform:o,selection:l}}addTransform(e,t,n,r){let s=[],o=this.eventCount,l=this.items,a=!r&&l.length?l.get(l.length-1):null;for(let c=0;c<e.steps.length;c++){let f=e.steps[c].invert(e.docs[c]),u=new Qn(e.mapping.maps[c],f,t),d;(d=a&&a.merge(u))&&(u=d,c?s.pop():l=l.slice(0,l.length-1)),s.push(u),t&&(o++,t=void 0),r||(a=u)}let h=o-n.depth;return h>kM&&(l=yM(l,h),o-=h),new on(l.append(s),o)}remapping(e,t){let n=new ms;return this.items.forEach((r,s)=>{let o=r.mirrorOffset!=null&&s-r.mirrorOffset>=e?n.maps.length-r.mirrorOffset:void 0;n.appendMap(r.map,o)},e,t),n}addMaps(e){return this.eventCount==0?this:new on(this.items.append(e.map(t=>new Qn(t))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let n=[],r=Math.max(0,this.items.length-t),s=e.mapping,o=e.steps.length,l=this.eventCount;this.items.forEach(u=>{u.selection&&l--},r);let a=t;this.items.forEach(u=>{let d=s.getMirror(--a);if(d==null)return;o=Math.min(o,d);let p=s.maps[d];if(u.step){let m=e.steps[d].invert(e.docs[d]),g=u.selection&&u.selection.map(s.slice(a+1,d));g&&l++,n.push(new Qn(p,m,g))}else n.push(new Qn(p))},r);let h=[];for(let u=t;u<o;u++)h.push(new Qn(s.maps[u]));let c=this.items.slice(0,r).append(h).append(n),f=new on(c,l);return f.emptyItemCount()>OM&&(f=f.compress(this.items.length-n.length)),f}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),n=t.maps.length,r=[],s=0;return this.items.forEach((o,l)=>{if(l>=e)r.push(o),o.selection&&s++;else if(o.step){let a=o.step.map(t.slice(n)),h=a&&a.getMap();if(n--,h&&t.appendMap(h,n),a){let c=o.selection&&o.selection.map(t.slice(n));c&&s++;let f=new Qn(h.invert(),a,c),u,d=r.length-1;(u=r.length&&r[d].merge(f))?r[d]=u:r.push(f)}}else o.map&&n--},this.items.length,0),new on(Ie.from(r.reverse()),s)}}on.empty=new on(Ie.empty,0);function yM(i,e){let t;return i.forEach((n,r)=>{if(n.selection&&e--==0)return t=r,!1}),i.slice(t)}class Qn{constructor(e,t,n,r){this.map=e,this.step=t,this.selection=n,this.mirrorOffset=r}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new Qn(t.getMap().invert(),t,this.selection)}}}let $i=class{constructor(e,t,n,r,s){this.done=e,this.undone=t,this.prevRanges=n,this.prevTime=r,this.prevComposition=s}};const kM=20;function bM(i,e,t,n){let r=t.getMeta(Mr),s;if(r)return r.historyState;t.getMeta(xM)&&(i=new $i(i.done,i.undone,null,0,-1));let o=t.getMeta("appendedTransaction");if(t.steps.length==0)return i;if(o&&o.getMeta(Mr))return o.getMeta(Mr).redo?new $i(i.done.addTransform(t,void 0,n,mh(e)),i.undone,PO(t.mapping.maps[t.steps.length-1]),i.prevTime,i.prevComposition):new $i(i.done,i.undone.addTransform(t,void 0,n,mh(e)),null,i.prevTime,i.prevComposition);if(t.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let l=t.getMeta("composition"),a=i.prevTime==0||!o&&i.prevComposition!=l&&(i.prevTime<(t.time||0)-n.newGroupDelay||!SM(t,i.prevRanges)),h=o?Ef(i.prevRanges,t.mapping):PO(t.mapping.maps[t.steps.length-1]);return new $i(i.done.addTransform(t,a?e.selection.getBookmark():void 0,n,mh(e)),on.empty,h,t.time,l??i.prevComposition)}else return(s=t.getMeta("rebased"))?new $i(i.done.rebased(t,s),i.undone.rebased(t,s),Ef(i.prevRanges,t.mapping),i.prevTime,i.prevComposition):new $i(i.done.addMaps(t.mapping.maps),i.undone.addMaps(t.mapping.maps),Ef(i.prevRanges,t.mapping),i.prevTime,i.prevComposition)}function SM(i,e){if(!e)return!1;if(!i.docChanged)return!0;let t=!1;return i.mapping.maps[0].forEach((n,r)=>{for(let s=0;s<e.length;s+=2)n<=e[s+1]&&r>=e[s]&&(t=!0)}),t}function PO(i){let e=[];return i.forEach((t,n,r,s)=>e.push(r,s)),e}function Ef(i,e){if(!i)return null;let t=[];for(let n=0;n<i.length;n+=2){let r=e.map(i[n],1),s=e.map(i[n+1],-1);r<=s&&t.push(r,s)}return t}function wM(i,e,t){let n=mh(e),r=Mr.get(e).spec.config,s=(t?i.undone:i.done).popEvent(e,n);if(!s)return null;let o=s.selection.resolve(s.transform.doc),l=(t?i.done:i.undone).addTransform(s.transform,e.selection.getBookmark(),r,n),a=new $i(t?l:s.remaining,t?s.remaining:l,null,0,-1);return s.transform.setSelection(o).setMeta(Mr,{redo:t,historyState:a})}let Nf=!1,QO=null;function mh(i){let e=i.plugins;if(QO!=e){Nf=!1,QO=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){Nf=!0;break}}return Nf}const Mr=new Ht("history"),xM=new Ht("closeHistory");function vM(i={}){return i={depth:i.depth||100,newGroupDelay:i.newGroupDelay||500},new wt({key:Mr,state:{init(){return new $i(on.empty,on.empty,null,0,-1)},apply(e,t,n){return bM(t,n,e,i)}},config:i,props:{handleDOMEvents:{beforeinput(e,t){let n=t.inputType,r=n=="historyUndo"?bb:n=="historyRedo"?Sb:null;return r?(t.preventDefault(),r(e.state,e.dispatch)):!1}}}})}function kb(i,e){return(t,n)=>{let r=Mr.getState(t);if(!r||(i?r.undone:r.done).eventCount==0)return!1;if(n){let s=wM(r,t,i);s&&n(e?s.scrollIntoView():s)}return!0}}const bb=kb(!1,!0),Sb=kb(!0,!0);function Us(i,e){return Object.assign(i,{meta:{package:"@milkdown/plugin-history",...e}}),i}const Rp=ue("Undo",()=>()=>bb);Us(Rp,{displayName:"Command<undo>"});const Ep=ue("Redo",()=>()=>Sb);Us(Ep,{displayName:"Command<redo>"});const Np=jn({},"historyProviderConfig");Us(Np,{displayName:"Ctx<historyProviderConfig>"});const wb=fi(i=>vM(i.get(Np.key)));Us(wb,{displayName:"Ctx<historyProviderPlugin>"});const Dp=Kt("historyKeymap",{Undo:{shortcuts:"Mod-z",command:i=>{const e=i.get(re);return()=>e.call(Rp.key)}},Redo:{shortcuts:["Mod-y","Shift-Mod-z"],command:i=>{const e=i.get(re);return()=>e.call(Ep.key)}}});Us(Dp.ctx,{displayName:"KeymapCtx<history>"});Us(Dp.shortcuts,{displayName:"Keymap<history>"});const $M=[Np,wb,Dp,Rp,Ep].flat();function PM(){const{dom:i,loading:e,editor:t,editorFactory:n}=Fs(Ec,{});return S1(()=>{if(!i.value)return;const r=n.value(i.value);r&&(e.value=!0,r.create().then(s=>{t.value=s}).finally(()=>{e.value=!1}).catch(console.error))}),w1(()=>{var r;(r=t.value)==null||r.destroy()}),i}const Ec=Symbol("editorInfoCtxKey"),QM=Dt({name:"Milkdown",setup:()=>{const i=PM();return()=>ct("div",{"data-milkdown-root":!0,ref:i},null)}}),CM=Dt({name:"MilkdownProvider",setup:(i,{slots:e})=>{const t=zt(null),n=zt(void 0),r=zt(void 0),s=zt(!0);return Xi(Ec,{loading:s,dom:t,editor:r,editorFactory:n}),()=>{var o;return ct(hp,null,[(o=e.default)==null?void 0:o.call(e)])}}});function TM(i){const{editorFactory:e,loading:t,editor:n}=Fs(Ec);return e.value=i,{loading:t,get:()=>n.value}}function MM(){const i=Fs(Ec);return[i.loading,()=>i.editor.value]}var AM=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)},xb=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},Gu=(i,e,t)=>(AM(i,e,"access private method"),t),gh,Hu;let ZM=class{constructor({node:e,view:t,getPos:n,decorations:r,innerDecorations:s,options:o}){xb(this,gh),this.selected=!1,this.selectNode=()=>{var l,a;this.selected=!0,(a=(l=this.options).selectNode)==null||a.call(l)},this.deselectNode=()=>{var l,a;this.selected=!1,(a=(l=this.options).deselectNode)==null||a.call(l)},this.shouldUpdate=l=>!(l.type!==this.node.type||l.sameMarkup(this.node)&&l.content.eq(this.node.content)),this.update=(l,a,h)=>{var c,f;const u=this.options.update;let d;return u&&(d=u(l,a,h)),typeof d!="boolean"&&(d=this.shouldUpdate(l)),this.node=l,this.decorations=a,this.innerDecorations=h,d&&((f=(c=this.options).onUpdate)==null||f.call(c)),d},this.shouldIgnoreMutation=l=>!this.dom||!this.contentDOM||this.node.isLeaf||this.node.isAtom?!0:l.type==="selection"?!1:this.contentDOM===l.target&&l.type==="attributes"?!0:!this.contentDOM.contains(l.target),this.ignoreMutation=l=>{if(!this.dom||!this.contentDOM)return!0;let a;const h=this.options.ignoreMutation;return h&&(a=h(l)),typeof a!="boolean"&&(a=this.shouldIgnoreMutation(l)),a},this.destroy=()=>{var l,a,h;(a=(l=this.options).destroy)==null||a.call(l),this.dom.remove(),(h=this.contentDOM)==null||h.remove()},this.setAttrs=l=>{const{dispatch:a,state:h}=this.view,c=this.getPos();if(typeof c=="number")return a(h.tr.setNodeMarkup(c,void 0,{...this.node.attrs,...l}))},this.node=e,this.view=t,this.getPos=n,this.decorations=r,this.innerDecorations=s,this.options=o,this.dom=this.createDOM(o.as),this.contentDOM=e.isLeaf?null:this.createContentDOM(o.contentAs),this.dom.setAttribute("data-node-view-root","true"),this.contentDOM&&(this.contentDOM.setAttribute("data-node-view-content","true"),this.contentDOM.style.whiteSpace="inherit"),this.setSelection=o.setSelection,this.stopEvent=o.stopEvent}createDOM(e){return Gu(this,gh,Hu).call(this,e)}createContentDOM(e){return Gu(this,gh,Hu).call(this,e)}get component(){return this.options.component}};gh=new WeakSet,Hu=function(i){const{node:e}=this;return i==null?document.createElement(e.isInline?"span":"div"):i instanceof HTMLElement?i:i instanceof Function?i(e):document.createElement(i)};let RM=class{constructor(e){this.view=e.view,this.options=e.options}get component(){return this.options.component}get root(){var e,t;let n=(t=(e=this.options).root)==null?void 0:t.call(e,this.view.dom);return n||(n=this.view.dom.parentElement??document.body),n}update(e,t){var n,r;this.view=e,this.prevState=t,(r=(n=this.options).update)==null||r.call(n,e,t)}destroy(){var e,t;(t=(e=this.options).destroy)==null||t.call(e)}};var Ku,vb;let EM=class{constructor({pos:e,spec:t,options:n}){xb(this,Ku),this.pos=e,this.options=n,this.spec=t,this.dom=Gu(this,Ku,vb).call(this,n.as),this.dom.setAttribute("data-widget-view-root","true")}bind(e,t){this.view=e,this.getPos=t}get component(){return this.options.component}};Ku=new WeakSet,vb=function(i){return i instanceof HTMLElement?i:document.createElement(i)};let Ip=(i=21)=>crypto.getRandomValues(new Uint8Array(i)).reduce((e,t)=>(t&=63,t<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"");var NM=Object.defineProperty,DM=(i,e,t)=>e in i?NM(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Yt=(i,e,t)=>(DM(i,typeof e!="symbol"?e+"":e,t),t);const $b=Symbol("[ProsemirrorAdapter]nodeViewContext"),Wp=()=>Fs($b),Pb=Symbol("[ProsemirrorAdapter]useNodeViewFactory"),IM=()=>Fs(Pb);let WM=class extends ZM{constructor(){super(...arguments),Yt(this,"key",Ip()),Yt(this,"context",{contentRef:e=>{e&&e instanceof HTMLElement&&this.contentDOM&&e.firstChild!==this.contentDOM&&e.appendChild(this.contentDOM)},view:this.view,getPos:this.getPos,setAttrs:this.setAttrs,node:ni(this.node),selected:ni(this.selected),decorations:ni(this.decorations),innerDecorations:ni(this.innerDecorations)}),Yt(this,"updateContext",()=>{Object.entries({node:this.node,selected:this.selected,decorations:this.decorations,innerDecorations:this.innerDecorations}).forEach(([e,t])=>{const n=this.context[e];n.value!==t&&(n.value=t)})}),Yt(this,"render",()=>{const e=this.component;return wc(Dt({name:"ProsemirrorNodeView",setup:()=>(Xi($b,this.context),()=>ct(cp,{key:this.key,to:this.dom},{default:()=>[ct(e,null,null)]}))}))})}};const XM=(i,e)=>t=>(n,r,s,o,l)=>{const a=new WM({node:n,view:r,getPos:s,decorations:o,innerDecorations:l,options:{...t,onUpdate(){var h;(h=t.onUpdate)==null||h.call(t),a.updateContext()},selectNode(){var h;(h=t.selectNode)==null||h.call(t),a.updateContext()},deselectNode(){var h;(h=t.deselectNode)==null||h.call(t),a.updateContext()},destroy(){var h;(h=t.destroy)==null||h.call(t),e(a)}}});return i(a),a},BM=Symbol("[ProsemirrorAdapter]nodeViewContext"),VM=Symbol("[ProsemirrorAdapter]usePluginViewFactory");let qM=class extends RM{constructor(){super(...arguments),Yt(this,"key",Ip()),Yt(this,"context",{view:ni(this.view),prevState:ni(this.prevState)}),Yt(this,"updateContext",()=>{Object.entries({view:this.view,prevState:this.prevState}).forEach(([e,t])=>{const n=this.context[e];if(e==="view"){const r=Object.assign(Object.create(Object.getPrototypeOf(t)),t);n.value=r;return}n.value=t})}),Yt(this,"render",()=>{const e=this.component;return wc(Dt({name:"ProsemirrorNodeView",setup:()=>(Xi(BM,this.context),()=>ct(cp,{key:this.key,to:this.root},{default:()=>[ct(e,null,null)]}))}))})}};const LM=(i,e)=>t=>n=>{const r=new qM({view:n,options:{...t,update:(s,o)=>{var l;(l=t.update)==null||l.call(t,s,o),r.updateContext()},destroy:()=>{var s;(s=t.destroy)==null||s.call(t),e(r)}}});return i(r),r},zM=()=>{const i=zt({}),e=F$(),t=wc({});return _$(()=>{t.updater=()=>{e==null||e.update()}}),w1(()=>{t.updater=void 0}),{portals:i,renderVueRenderer:n=>{var r;i.value[n.key]=n.render(),(r=t.updater)==null||r.call(t)},removeVueRenderer:n=>{delete i.value[n.key]}}},YM=Symbol("[ProsemirrorAdapter]widgetViewContext"),jM=Symbol("[ProsemirrorAdapter]useWidgetViewFactory");let _M=class extends EM{constructor(){super(...arguments),Yt(this,"key",Ip()),Yt(this,"context",{view:this.view,getPos:this.getPos,spec:this.spec}),Yt(this,"updateContext",()=>{Object.assign(this.context,{view:this.view,getPos:this.getPos,spec:this.spec})}),Yt(this,"render",()=>{const e=this.component;return wc(Dt({name:"ProsemirrorWidgetView",setup:()=>(Xi(YM,this.context),()=>ct(cp,{key:this.key,to:this.dom},{default:()=>[ct(e,null,null)]}))}))})}};const FM=(i,e)=>t=>(n,r={})=>{const s=new _M({pos:n,options:t}),o={...r,destroy:l=>{var a;(a=r.destroy)==null||a.call(r,l),e(s)}};return s.spec=o,qn.widget(n,(l,a)=>(s.bind(l,a),s.updateContext(),i(s),s.dom),o)},UM=Dt({name:"ProsemirrorAdapterProvider",setup:(i,{slots:e})=>{const{portals:t,renderVueRenderer:n,removeVueRenderer:r}=zM(),s=XM(n,r),o=LM(n,r),l=FM(n,r);return Xi(Pb,s),Xi(VM,o),Xi(jM,l),()=>{var a;return ct(hp,null,[(a=e.default)==null?void 0:a.call(e),Object.values(t.value).map(h=>x1(h))])}}});class te{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,n){[e,t]=Ds(this,e,t);let r=[];return this.decompose(0,e,r,2),n.length&&n.decompose(0,n.length,r,3),this.decompose(t,this.length,r,1),Tn.from(r,this.length-(t-e)+n.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){[e,t]=Ds(this,e,t);let n=[];return this.decompose(e,t,n,0),Tn.from(n,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),n=this.length-this.scanIdentical(e,-1),r=new rl(this),s=new rl(e);for(let o=t,l=t;;){if(r.next(o),s.next(o),o=0,r.lineBreak!=s.lineBreak||r.done!=s.done||r.value!=s.value)return!1;if(l+=r.value.length,r.done||l>=n)return!0}}iter(e=1){return new rl(this,e)}iterRange(e,t=this.length){return new Qb(this,e,t)}iterLines(e,t){let n;if(e==null)n=this.iter();else{t==null&&(t=this.lines+1);let r=this.line(e).from;n=this.iterRange(r,Math.max(r,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new Cb(n)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?te.empty:e.length<=32?new $e(e):Tn.from($e.split(e,[]))}}class $e extends te{constructor(e,t=GM(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,n,r){for(let s=0;;s++){let o=this.text[s],l=r+o.length;if((t?n:l)>=e)return new HM(r,l,n,o);r=l+1,n++}}decompose(e,t,n,r){let s=e<=0&&t>=this.length?this:new $e(CO(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(r&1){let o=n.pop(),l=Oh(s.text,o.text.slice(),0,s.length);if(l.length<=32)n.push(new $e(l,o.length+s.length));else{let a=l.length>>1;n.push(new $e(l.slice(0,a)),new $e(l.slice(a)))}}else n.push(s)}replace(e,t,n){if(!(n instanceof $e))return super.replace(e,t,n);[e,t]=Ds(this,e,t);let r=Oh(this.text,Oh(n.text,CO(this.text,0,e)),t),s=this.length+n.length-(t-e);return r.length<=32?new $e(r,s):Tn.from($e.split(r,[]),s)}sliceString(e,t=this.length,n=`
`){[e,t]=Ds(this,e,t);let r="";for(let s=0,o=0;s<=t&&o<this.text.length;o++){let l=this.text[o],a=s+l.length;s>e&&o&&(r+=n),e<a&&t>s&&(r+=l.slice(Math.max(0,e-s),t-s)),s=a+1}return r}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let n=[],r=-1;for(let s of e)n.push(s),r+=s.length+1,n.length==32&&(t.push(new $e(n,r)),n=[],r=-1);return r>-1&&t.push(new $e(n,r)),t}}class Tn extends te{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let n of e)this.lines+=n.lines}lineInner(e,t,n,r){for(let s=0;;s++){let o=this.children[s],l=r+o.length,a=n+o.lines-1;if((t?a:l)>=e)return o.lineInner(e,t,n,r);r=l+1,n=a+1}}decompose(e,t,n,r){for(let s=0,o=0;o<=t&&s<this.children.length;s++){let l=this.children[s],a=o+l.length;if(e<=a&&t>=o){let h=r&((o<=e?1:0)|(a>=t?2:0));o>=e&&a<=t&&!h?n.push(l):l.decompose(e-o,t-o,n,h)}o=a+1}}replace(e,t,n){if([e,t]=Ds(this,e,t),n.lines<this.lines)for(let r=0,s=0;r<this.children.length;r++){let o=this.children[r],l=s+o.length;if(e>=s&&t<=l){let a=o.replace(e-s,t-s,n),h=this.lines-o.lines+a.lines;if(a.lines<h>>4&&a.lines>h>>6){let c=this.children.slice();return c[r]=a,new Tn(c,this.length-(t-e)+n.length)}return super.replace(s,l,a)}s=l+1}return super.replace(e,t,n)}sliceString(e,t=this.length,n=`
`){[e,t]=Ds(this,e,t);let r="";for(let s=0,o=0;s<this.children.length&&o<=t;s++){let l=this.children[s],a=o+l.length;o>e&&s&&(r+=n),e<a&&t>o&&(r+=l.sliceString(e-o,t-o,n)),o=a+1}return r}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof Tn))return 0;let n=0,[r,s,o,l]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;r+=t,s+=t){if(r==o||s==l)return n;let a=this.children[r],h=e.children[s];if(a!=h)return n+a.scanIdentical(h,t);n+=a.length+1}}static from(e,t=e.reduce((n,r)=>n+r.length+1,-1)){let n=0;for(let d of e)n+=d.lines;if(n<32){let d=[];for(let p of e)p.flatten(d);return new $e(d,t)}let r=Math.max(32,n>>5),s=r<<1,o=r>>1,l=[],a=0,h=-1,c=[];function f(d){let p;if(d.lines>s&&d instanceof Tn)for(let m of d.children)f(m);else d.lines>o&&(a>o||!a)?(u(),l.push(d)):d instanceof $e&&a&&(p=c[c.length-1])instanceof $e&&d.lines+p.lines<=32?(a+=d.lines,h+=d.length+1,c[c.length-1]=new $e(p.text.concat(d.text),p.length+1+d.length)):(a+d.lines>r&&u(),a+=d.lines,h+=d.length+1,c.push(d))}function u(){a!=0&&(l.push(c.length==1?c[0]:Tn.from(c,h)),h=-1,a=c.length=0)}for(let d of e)f(d);return u(),l.length==1?l[0]:new Tn(l,t)}}te.empty=new $e([""],0);function GM(i){let e=-1;for(let t of i)e+=t.length+1;return e}function Oh(i,e,t=0,n=1e9){for(let r=0,s=0,o=!0;s<i.length&&r<=n;s++){let l=i[s],a=r+l.length;a>=t&&(a>n&&(l=l.slice(0,n-r)),r<t&&(l=l.slice(t-r)),o?(e[e.length-1]+=l,o=!1):e.push(l)),r=a+1}return e}function CO(i,e,t){return Oh(i,[""],e,t)}class rl{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof $e?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let n=this.nodes.length-1,r=this.nodes[n],s=this.offsets[n],o=s>>1,l=r instanceof $e?r.text.length:r.children.length;if(o==(t>0?l:0)){if(n==0)return this.done=!0,this.value="",this;t>0&&this.offsets[n-1]++,this.nodes.pop(),this.offsets.pop()}else if((s&1)==(t>0?0:1)){if(this.offsets[n]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(r instanceof $e){let a=r.text[o+(t<0?-1:0)];if(this.offsets[n]+=t,a.length>Math.max(0,e))return this.value=e==0?a:t>0?a.slice(e):a.slice(0,a.length-e),this;e-=a.length}else{let a=r.children[o+(t<0?-1:0)];e>a.length?(e-=a.length,this.offsets[n]+=t):(t<0&&this.offsets[n]--,this.nodes.push(a),this.offsets.push(t>0?1:(a instanceof $e?a.text.length:a.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class Qb{constructor(e,t,n){this.value="",this.done=!1,this.cursor=new rl(e,t>n?-1:1),this.pos=t>n?e.length:0,this.from=Math.min(t,n),this.to=Math.max(t,n)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let n=t<0?this.pos-this.from:this.to-this.pos;e>n&&(e=n),n-=e;let{value:r}=this.cursor.next(e);return this.pos+=(r.length+e)*t,this.value=r.length<=n?r:t<0?r.slice(r.length-n):r.slice(0,n),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class Cb{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:n,value:r}=this.inner.next(e);return t&&this.afterBreak?(this.value="",this.afterBreak=!1):t?(this.done=!0,this.value=""):n?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=r,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(te.prototype[Symbol.iterator]=function(){return this.iter()},rl.prototype[Symbol.iterator]=Qb.prototype[Symbol.iterator]=Cb.prototype[Symbol.iterator]=function(){return this});let HM=class{constructor(e,t,n,r){this.from=e,this.to=t,this.number=n,this.text=r}get length(){return this.to-this.from}};function Ds(i,e,t){return e=Math.max(0,Math.min(i.length,e)),[e,Math.max(e,Math.min(i.length,t))]}let ws="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(i=>i?parseInt(i,36):1);for(let i=1;i<ws.length;i++)ws[i]+=ws[i-1];function KM(i){for(let e=1;e<ws.length;e+=2)if(ws[e]>i)return ws[e-1]<=i;return!1}function TO(i){return i>=127462&&i<=127487}const MO=8205;function _e(i,e,t=!0,n=!0){return(t?Tb:JM)(i,e,n)}function Tb(i,e,t){if(e==i.length)return e;e&&Mb(i.charCodeAt(e))&&Ab(i.charCodeAt(e-1))&&e--;let n=ze(i,e);for(e+=Lt(n);e<i.length;){let r=ze(i,e);if(n==MO||r==MO||t&&KM(r))e+=Lt(r),n=r;else if(TO(r)){let s=0,o=e-2;for(;o>=0&&TO(ze(i,o));)s++,o-=2;if(s%2==0)break;e+=2}else break}return e}function JM(i,e,t){for(;e>0;){let n=Tb(i,e-2,t);if(n<e)return n;e--}return 0}function Mb(i){return i>=56320&&i<57344}function Ab(i){return i>=55296&&i<56320}function ze(i,e){let t=i.charCodeAt(e);if(!Ab(t)||e+1==i.length)return t;let n=i.charCodeAt(e+1);return Mb(n)?(t-55296<<10)+(n-56320)+65536:t}function Xp(i){return i<=65535?String.fromCharCode(i):(i-=65536,String.fromCharCode((i>>10)+55296,(i&1023)+56320))}function Lt(i){return i<65536?1:2}const Ju=/\r\n?|\n/;var Ye=function(i){return i[i.Simple=0]="Simple",i[i.TrackDel=1]="TrackDel",i[i.TrackBefore=2]="TrackBefore",i[i.TrackAfter=3]="TrackAfter",i}(Ye||(Ye={}));class Wn{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let n=this.sections[t+1];e+=n<0?this.sections[t]:n}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,n=0,r=0;t<this.sections.length;){let s=this.sections[t++],o=this.sections[t++];o<0?(e(n,r,s),r+=s):r+=o,n+=s}}iterChangedRanges(e,t=!1){ed(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let n=this.sections[t++],r=this.sections[t++];r<0?e.push(n,r):e.push(r,n)}return new Wn(e)}composeDesc(e){return this.empty?e:e.empty?this:Zb(this,e)}mapDesc(e,t=!1){return e.empty?this:td(this,e,t)}mapPos(e,t=-1,n=Ye.Simple){let r=0,s=0;for(let o=0;o<this.sections.length;){let l=this.sections[o++],a=this.sections[o++],h=r+l;if(a<0){if(h>e)return s+(e-r);s+=l}else{if(n!=Ye.Simple&&h>=e&&(n==Ye.TrackDel&&r<e&&h>e||n==Ye.TrackBefore&&r<e||n==Ye.TrackAfter&&h>e))return null;if(h>e||h==e&&t<0&&!l)return e==r||t<0?s:s+a;s+=a}r=h}if(e>r)throw new RangeError(`Position ${e} is out of range for changeset of length ${r}`);return s}touchesRange(e,t=e){for(let n=0,r=0;n<this.sections.length&&r<=t;){let s=this.sections[n++],o=this.sections[n++],l=r+s;if(o>=0&&r<=t&&l>=e)return r<e&&l>t?"cover":!0;r=l}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let n=this.sections[t++],r=this.sections[t++];e+=(e?" ":"")+n+(r>=0?":"+r:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Wn(e)}static create(e){return new Wn(e)}}class Ne extends Wn{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return ed(this,(t,n,r,s,o)=>e=e.replace(r,r+(n-t),o),!1),e}mapDesc(e,t=!1){return td(this,e,t,!0)}invert(e){let t=this.sections.slice(),n=[];for(let r=0,s=0;r<t.length;r+=2){let o=t[r],l=t[r+1];if(l>=0){t[r]=l,t[r+1]=o;let a=r>>1;for(;n.length<a;)n.push(te.empty);n.push(o?e.slice(s,s+o):te.empty)}s+=o}return new Ne(t,n)}compose(e){return this.empty?e:e.empty?this:Zb(this,e,!0)}map(e,t=!1){return e.empty?this:td(this,e,t,!0)}iterChanges(e,t=!1){ed(this,e,t)}get desc(){return Wn.create(this.sections)}filter(e){let t=[],n=[],r=[],s=new vl(this);e:for(let o=0,l=0;;){let a=o==e.length?1e9:e[o++];for(;l<a||l==a&&s.len==0;){if(s.done)break e;let c=Math.min(s.len,a-l);Ue(r,c,-1);let f=s.ins==-1?-1:s.off==0?s.ins:0;Ue(t,c,f),f>0&&Ri(n,t,s.text),s.forward(c),l+=c}let h=e[o++];for(;l<h;){if(s.done)break e;let c=Math.min(s.len,h-l);Ue(t,c,-1),Ue(r,c,s.ins==-1?-1:s.off==0?s.ins:0),s.forward(c),l+=c}}return{changes:new Ne(t,n),filtered:Wn.create(r)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let n=this.sections[t],r=this.sections[t+1];r<0?e.push(n):r==0?e.push([n]):e.push([n].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,n){let r=[],s=[],o=0,l=null;function a(c=!1){if(!c&&!r.length)return;o<t&&Ue(r,t-o,-1);let f=new Ne(r,s);l=l?l.compose(f.map(l)):f,r=[],s=[],o=0}function h(c){if(Array.isArray(c))for(let f of c)h(f);else if(c instanceof Ne){if(c.length!=t)throw new RangeError(`Mismatched change set length (got ${c.length}, expected ${t})`);a(),l=l?l.compose(c.map(l)):c}else{let{from:f,to:u=f,insert:d}=c;if(f>u||f<0||u>t)throw new RangeError(`Invalid change range ${f} to ${u} (in doc of length ${t})`);let p=d?typeof d=="string"?te.of(d.split(n||Ju)):d:te.empty,m=p.length;if(f==u&&m==0)return;f<o&&a(),f>o&&Ue(r,f-o,-1),Ue(r,u-f,m),Ri(s,r,p),o=u}}return h(e),a(!l),l}static empty(e){return new Ne(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],n=[];for(let r=0;r<e.length;r++){let s=e[r];if(typeof s=="number")t.push(s,-1);else{if(!Array.isArray(s)||typeof s[0]!="number"||s.some((o,l)=>l&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(s.length==1)t.push(s[0],0);else{for(;n.length<r;)n.push(te.empty);n[r]=te.of(s.slice(1)),t.push(s[0],n[r].length)}}}return new Ne(t,n)}static createSet(e,t){return new Ne(e,t)}}function Ue(i,e,t,n=!1){if(e==0&&t<=0)return;let r=i.length-2;r>=0&&t<=0&&t==i[r+1]?i[r]+=e:e==0&&i[r]==0?i[r+1]+=t:n?(i[r]+=e,i[r+1]+=t):i.push(e,t)}function Ri(i,e,t){if(t.length==0)return;let n=e.length-2>>1;if(n<i.length)i[i.length-1]=i[i.length-1].append(t);else{for(;i.length<n;)i.push(te.empty);i.push(t)}}function ed(i,e,t){let n=i.inserted;for(let r=0,s=0,o=0;o<i.sections.length;){let l=i.sections[o++],a=i.sections[o++];if(a<0)r+=l,s+=l;else{let h=r,c=s,f=te.empty;for(;h+=l,c+=a,a&&n&&(f=f.append(n[o-2>>1])),!(t||o==i.sections.length||i.sections[o+1]<0);)l=i.sections[o++],a=i.sections[o++];e(r,h,s,c,f),r=h,s=c}}}function td(i,e,t,n=!1){let r=[],s=n?[]:null,o=new vl(i),l=new vl(e);for(let a=-1;;)if(o.ins==-1&&l.ins==-1){let h=Math.min(o.len,l.len);Ue(r,h,-1),o.forward(h),l.forward(h)}else if(l.ins>=0&&(o.ins<0||a==o.i||o.off==0&&(l.len<o.len||l.len==o.len&&!t))){let h=l.len;for(Ue(r,l.ins,-1);h;){let c=Math.min(o.len,h);o.ins>=0&&a<o.i&&o.len<=c&&(Ue(r,0,o.ins),s&&Ri(s,r,o.text),a=o.i),o.forward(c),h-=c}l.next()}else if(o.ins>=0){let h=0,c=o.len;for(;c;)if(l.ins==-1){let f=Math.min(c,l.len);h+=f,c-=f,l.forward(f)}else if(l.ins==0&&l.len<c)c-=l.len,l.next();else break;Ue(r,h,a<o.i?o.ins:0),s&&a<o.i&&Ri(s,r,o.text),a=o.i,o.forward(o.len-c)}else{if(o.done&&l.done)return s?Ne.createSet(r,s):Wn.create(r);throw new Error("Mismatched change set lengths")}}function Zb(i,e,t=!1){let n=[],r=t?[]:null,s=new vl(i),o=new vl(e);for(let l=!1;;){if(s.done&&o.done)return r?Ne.createSet(n,r):Wn.create(n);if(s.ins==0)Ue(n,s.len,0,l),s.next();else if(o.len==0&&!o.done)Ue(n,0,o.ins,l),r&&Ri(r,n,o.text),o.next();else{if(s.done||o.done)throw new Error("Mismatched change set lengths");{let a=Math.min(s.len2,o.len),h=n.length;if(s.ins==-1){let c=o.ins==-1?-1:o.off?0:o.ins;Ue(n,a,c,l),r&&c&&Ri(r,n,o.text)}else o.ins==-1?(Ue(n,s.off?0:s.len,a,l),r&&Ri(r,n,s.textBit(a))):(Ue(n,s.off?0:s.len,o.off?0:o.ins,l),r&&!o.off&&Ri(r,n,o.text));l=(s.ins>a||o.ins>=0&&o.len>a)&&(l||n.length>h),s.forward2(a),o.forward(a)}}}}class vl{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?te.empty:e[t]}textBit(e){let{inserted:t}=this.set,n=this.i-2>>1;return n>=t.length&&!e?te.empty:t[n].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class yr{constructor(e,t,n){this.from=e,this.to=t,this.flags=n}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,t=-1){let n,r;return this.empty?n=r=e.mapPos(this.from,t):(n=e.mapPos(this.from,1),r=e.mapPos(this.to,-1)),n==this.from&&r==this.to?this:new yr(n,r,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return b.range(e,t);let n=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return b.range(this.anchor,n)}eq(e,t=!1){return this.anchor==e.anchor&&this.head==e.head&&(!t||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return b.range(e.anchor,e.head)}static create(e,t,n){return new yr(e,t,n)}}class b{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:b.create(this.ranges.map(n=>n.map(e,t)),this.mainIndex)}eq(e,t=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let n=0;n<this.ranges.length;n++)if(!this.ranges[n].eq(e.ranges[n],t))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new b([this.main],0)}addRange(e,t=!0){return b.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let n=this.ranges.slice();return n[t]=e,b.create(n,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new b(e.ranges.map(t=>yr.fromJSON(t)),e.main)}static single(e,t=e){return new b([b.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let n=0,r=0;r<e.length;r++){let s=e[r];if(s.empty?s.from<=n:s.from<n)return b.normalized(e.slice(),t);n=s.to}return new b(e,t)}static cursor(e,t=0,n,r){return yr.create(e,e,(t==0?0:t<0?8:16)|(n==null?7:Math.min(6,n))|(r??16777215)<<6)}static range(e,t,n,r){let s=(n??16777215)<<6|(r==null?7:Math.min(6,r));return t<e?yr.create(t,e,48|s):yr.create(e,t,(t>e?8:0)|s)}static normalized(e,t=0){let n=e[t];e.sort((r,s)=>r.from-s.from),t=e.indexOf(n);for(let r=1;r<e.length;r++){let s=e[r],o=e[r-1];if(s.empty?s.from<=o.to:s.from<o.to){let l=o.from,a=Math.max(s.to,o.to);r<=t&&t--,e.splice(--r,2,s.anchor>s.head?b.range(a,l):b.range(l,a))}}return new b(e,t)}}function Rb(i,e){for(let t of i.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}let Bp=0;class R{constructor(e,t,n,r,s){this.combine=e,this.compareInput=t,this.compare=n,this.isStatic=r,this.id=Bp++,this.default=e([]),this.extensions=typeof s=="function"?s(this):s}get reader(){return this}static define(e={}){return new R(e.combine||(t=>t),e.compareInput||((t,n)=>t===n),e.compare||(e.combine?(t,n)=>t===n:Vp),!!e.static,e.enables)}of(e){return new yh([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new yh(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new yh(e,this,2,t)}from(e,t){return t||(t=n=>n),this.compute([e],n=>t(n.field(e)))}}function Vp(i,e){return i==e||i.length==e.length&&i.every((t,n)=>t===e[n])}class yh{constructor(e,t,n,r){this.dependencies=e,this.facet=t,this.type=n,this.value=r,this.id=Bp++}dynamicSlot(e){var t;let n=this.value,r=this.facet.compareInput,s=this.id,o=e[s]>>1,l=this.type==2,a=!1,h=!1,c=[];for(let f of this.dependencies)f=="doc"?a=!0:f=="selection"?h=!0:((t=e[f.id])!==null&&t!==void 0?t:1)&1||c.push(e[f.id]);return{create(f){return f.values[o]=n(f),1},update(f,u){if(a&&u.docChanged||h&&(u.docChanged||u.selection)||nd(f,c)){let d=n(f);if(l?!AO(d,f.values[o],r):!r(d,f.values[o]))return f.values[o]=d,1}return 0},reconfigure:(f,u)=>{let d,p=u.config.address[s];if(p!=null){let m=jh(u,p);if(this.dependencies.every(g=>g instanceof R?u.facet(g)===f.facet(g):g instanceof Ae?u.field(g,!1)==f.field(g,!1):!0)||(l?AO(d=n(f),m,r):r(d=n(f),m)))return f.values[o]=m,0}else d=n(f);return f.values[o]=d,1}}}}function AO(i,e,t){if(i.length!=e.length)return!1;for(let n=0;n<i.length;n++)if(!t(i[n],e[n]))return!1;return!0}function nd(i,e){let t=!1;for(let n of e)sl(i,n)&1&&(t=!0);return t}function eA(i,e,t){let n=t.map(a=>i[a.id]),r=t.map(a=>a.type),s=n.filter(a=>!(a&1)),o=i[e.id]>>1;function l(a){let h=[];for(let c=0;c<n.length;c++){let f=jh(a,n[c]);if(r[c]==2)for(let u of f)h.push(u);else h.push(f)}return e.combine(h)}return{create(a){for(let h of n)sl(a,h);return a.values[o]=l(a),1},update(a,h){if(!nd(a,s))return 0;let c=l(a);return e.compare(c,a.values[o])?0:(a.values[o]=c,1)},reconfigure(a,h){let c=nd(a,n),f=h.config.facets[e.id],u=h.facet(e);if(f&&!c&&Vp(t,f))return a.values[o]=u,0;let d=l(a);return e.compare(d,u)?(a.values[o]=u,0):(a.values[o]=d,1)}}}const ZO=R.define({static:!0});class Ae{constructor(e,t,n,r,s){this.id=e,this.createF=t,this.updateF=n,this.compareF=r,this.spec=s,this.provides=void 0}static define(e){let t=new Ae(Bp++,e.create,e.update,e.compare||((n,r)=>n===r),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(ZO).find(n=>n.field==this);return((t==null?void 0:t.create)||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:n=>(n.values[t]=this.create(n),1),update:(n,r)=>{let s=n.values[t],o=this.updateF(s,r);return this.compareF(s,o)?0:(n.values[t]=o,1)},reconfigure:(n,r)=>r.config.address[this.id]!=null?(n.values[t]=r.field(this),0):(n.values[t]=this.create(n),1)}}init(e){return[this,ZO.of({field:this,create:e})]}get extension(){return this}}const fr={lowest:4,low:3,default:2,high:1,highest:0};function ao(i){return e=>new Eb(e,i)}const di={highest:ao(fr.highest),high:ao(fr.high),default:ao(fr.default),low:ao(fr.low),lowest:ao(fr.lowest)};class Eb{constructor(e,t){this.inner=e,this.prec=t}}class Ul{of(e){return new id(this,e)}reconfigure(e){return Ul.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class id{constructor(e,t){this.compartment=e,this.inner=t}}class Yh{constructor(e,t,n,r,s,o){for(this.base=e,this.compartments=t,this.dynamicSlots=n,this.address=r,this.staticValues=s,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<n.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,n){let r=[],s=Object.create(null),o=new Map;for(let u of tA(e,t,o))u instanceof Ae?r.push(u):(s[u.facet.id]||(s[u.facet.id]=[])).push(u);let l=Object.create(null),a=[],h=[];for(let u of r)l[u.id]=h.length<<1,h.push(d=>u.slot(d));let c=n==null?void 0:n.config.facets;for(let u in s){let d=s[u],p=d[0].facet,m=c&&c[u]||[];if(d.every(g=>g.type==0))if(l[p.id]=a.length<<1|1,Vp(m,d))a.push(n.facet(p));else{let g=p.combine(d.map(y=>y.value));a.push(n&&p.compare(g,n.facet(p))?n.facet(p):g)}else{for(let g of d)g.type==0?(l[g.id]=a.length<<1|1,a.push(g.value)):(l[g.id]=h.length<<1,h.push(y=>g.dynamicSlot(y)));l[p.id]=h.length<<1,h.push(g=>eA(g,p,d))}}let f=h.map(u=>u(l));return new Yh(e,o,f,l,a,s)}}function tA(i,e,t){let n=[[],[],[],[],[]],r=new Map;function s(o,l){let a=r.get(o);if(a!=null){if(a<=l)return;let h=n[a].indexOf(o);h>-1&&n[a].splice(h,1),o instanceof id&&t.delete(o.compartment)}if(r.set(o,l),Array.isArray(o))for(let h of o)s(h,l);else if(o instanceof id){if(t.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let h=e.get(o.compartment)||o.inner;t.set(o.compartment,h),s(h,l)}else if(o instanceof Eb)s(o.inner,o.prec);else if(o instanceof Ae)n[l].push(o),o.provides&&s(o.provides,l);else if(o instanceof yh)n[l].push(o),o.facet.extensions&&s(o.facet.extensions,fr.default);else{let h=o.extension;if(!h)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(h,l)}}return s(i,fr.default),n.reduce((o,l)=>o.concat(l))}function sl(i,e){if(e&1)return 2;let t=e>>1,n=i.status[t];if(n==4)throw new Error("Cyclic dependency between fields and/or facets");if(n&2)return n;i.status[t]=4;let r=i.computeSlot(i,i.config.dynamicSlots[t]);return i.status[t]=2|r}function jh(i,e){return e&1?i.config.staticValues[e>>1]:i.values[e>>1]}const Nb=R.define(),rd=R.define({combine:i=>i.some(e=>e),static:!0}),Db=R.define({combine:i=>i.length?i[0]:void 0,static:!0}),Ib=R.define(),Wb=R.define(),Xb=R.define(),Bb=R.define({combine:i=>i.length?i[0]:!1});class pi{constructor(e,t){this.type=e,this.value=t}static define(){return new nA}}class nA{of(e){return new pi(this,e)}}class iA{constructor(e){this.map=e}of(e){return new q(this,e)}}class q{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new q(this.type,t)}is(e){return this.type==e}static define(e={}){return new iA(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let n=[];for(let r of e){let s=r.map(t);s&&n.push(s)}return n}}q.reconfigure=q.define();q.appendConfig=q.define();class Ce{constructor(e,t,n,r,s,o){this.startState=e,this.changes=t,this.selection=n,this.effects=r,this.annotations=s,this.scrollIntoView=o,this._doc=null,this._state=null,n&&Rb(n,t.newLength),s.some(l=>l.type==Ce.time)||(this.annotations=s.concat(Ce.time.of(Date.now())))}static create(e,t,n,r,s,o){return new Ce(e,t,n,r,s,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(Ce.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}}Ce.time=pi.define();Ce.userEvent=pi.define();Ce.addToHistory=pi.define();Ce.remote=pi.define();function rA(i,e){let t=[];for(let n=0,r=0;;){let s,o;if(n<i.length&&(r==e.length||e[r]>=i[n]))s=i[n++],o=i[n++];else if(r<e.length)s=e[r++],o=e[r++];else return t;!t.length||t[t.length-1]<s?t.push(s,o):t[t.length-1]<o&&(t[t.length-1]=o)}}function Vb(i,e,t){var n;let r,s,o;return t?(r=e.changes,s=Ne.empty(e.changes.length),o=i.changes.compose(e.changes)):(r=e.changes.map(i.changes),s=i.changes.mapDesc(e.changes,!0),o=i.changes.compose(r)),{changes:o,selection:e.selection?e.selection.map(s):(n=i.selection)===null||n===void 0?void 0:n.map(r),effects:q.mapEffects(i.effects,r).concat(q.mapEffects(e.effects,s)),annotations:i.annotations.length?i.annotations.concat(e.annotations):e.annotations,scrollIntoView:i.scrollIntoView||e.scrollIntoView}}function sd(i,e,t){let n=e.selection,r=xs(e.annotations);return e.userEvent&&(r=r.concat(Ce.userEvent.of(e.userEvent))),{changes:e.changes instanceof Ne?e.changes:Ne.of(e.changes||[],t,i.facet(Db)),selection:n&&(n instanceof b?n:b.single(n.anchor,n.head)),effects:xs(e.effects),annotations:r,scrollIntoView:!!e.scrollIntoView}}function qb(i,e,t){let n=sd(i,e.length?e[0]:{},i.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let s=1;s<e.length;s++){e[s].filter===!1&&(t=!1);let o=!!e[s].sequential;n=Vb(n,sd(i,e[s],o?n.changes.newLength:i.doc.length),o)}let r=Ce.create(i,n.changes,n.selection,n.effects,n.annotations,n.scrollIntoView);return oA(t?sA(r):r)}function sA(i){let e=i.startState,t=!0;for(let r of e.facet(Ib)){let s=r(i);if(s===!1){t=!1;break}Array.isArray(s)&&(t=t===!0?s:rA(t,s))}if(t!==!0){let r,s;if(t===!1)s=i.changes.invertedDesc,r=Ne.empty(e.doc.length);else{let o=i.changes.filter(t);r=o.changes,s=o.filtered.mapDesc(o.changes).invertedDesc}i=Ce.create(e,r,i.selection&&i.selection.map(s),q.mapEffects(i.effects,s),i.annotations,i.scrollIntoView)}let n=e.facet(Wb);for(let r=n.length-1;r>=0;r--){let s=n[r](i);s instanceof Ce?i=s:Array.isArray(s)&&s.length==1&&s[0]instanceof Ce?i=s[0]:i=qb(e,xs(s),!1)}return i}function oA(i){let e=i.startState,t=e.facet(Xb),n=i;for(let r=t.length-1;r>=0;r--){let s=t[r](i);s&&Object.keys(s).length&&(n=Vb(n,sd(e,s,i.changes.newLength),!0))}return n==i?i:Ce.create(e,i.changes,i.selection,n.effects,n.annotations,n.scrollIntoView)}const lA=[];function xs(i){return i==null?lA:Array.isArray(i)?i:[i]}var ke=function(i){return i[i.Word=0]="Word",i[i.Space=1]="Space",i[i.Other=2]="Other",i}(ke||(ke={}));const aA=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let od;try{od=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function hA(i){if(od)return od.test(i);for(let e=0;e<i.length;e++){let t=i[e];if(/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||aA.test(t)))return!0}return!1}function cA(i){return e=>{if(!/\S/.test(e))return ke.Space;if(hA(e))return ke.Word;for(let t=0;t<i.length;t++)if(e.indexOf(i[t])>-1)return ke.Word;return ke.Other}}class j{constructor(e,t,n,r,s,o){this.config=e,this.doc=t,this.selection=n,this.values=r,this.status=e.statusTemplate.slice(),this.computeSlot=s,o&&(o._state=this);for(let l=0;l<this.config.dynamicSlots.length;l++)sl(this,l<<1);this.computeSlot=null}field(e,t=!0){let n=this.config.address[e.id];if(n==null){if(t)throw new RangeError("Field is not present in this state");return}return sl(this,n),jh(this,n)}update(...e){return qb(this,e,!0)}applyTransaction(e){let t=this.config,{base:n,compartments:r}=t;for(let l of e.effects)l.is(Ul.reconfigure)?(t&&(r=new Map,t.compartments.forEach((a,h)=>r.set(h,a)),t=null),r.set(l.value.compartment,l.value.extension)):l.is(q.reconfigure)?(t=null,n=l.value):l.is(q.appendConfig)&&(t=null,n=xs(n).concat(l.value));let s;t?s=e.startState.values.slice():(t=Yh.resolve(n,r,this),s=new j(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(a,h)=>h.reconfigure(a,this),null).values);let o=e.startState.facet(rd)?e.newSelection:e.newSelection.asSingle();new j(t,e.newDoc,o,s,(l,a)=>a.update(l,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:b.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,n=e(t.ranges[0]),r=this.changes(n.changes),s=[n.range],o=xs(n.effects);for(let l=1;l<t.ranges.length;l++){let a=e(t.ranges[l]),h=this.changes(a.changes),c=h.map(r);for(let u=0;u<l;u++)s[u]=s[u].map(c);let f=r.mapDesc(h,!0);s.push(a.range.map(f)),r=r.compose(c),o=q.mapEffects(o,c).concat(q.mapEffects(xs(a.effects),f))}return{changes:r,selection:b.create(s,t.mainIndex),effects:o}}changes(e=[]){return e instanceof Ne?e:Ne.of(e,this.doc.length,this.facet(j.lineSeparator))}toText(e){return te.of(e.split(this.facet(j.lineSeparator)||Ju))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(sl(this,t),jh(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let n in e){let r=e[n];r instanceof Ae&&this.config.address[r.id]!=null&&(t[n]=r.spec.toJSON(this.field(e[n]),this))}return t}static fromJSON(e,t={},n){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let r=[];if(n){for(let s in n)if(Object.prototype.hasOwnProperty.call(e,s)){let o=n[s],l=e[s];r.push(o.init(a=>o.spec.fromJSON(l,a)))}}return j.create({doc:e.doc,selection:b.fromJSON(e.selection),extensions:t.extensions?r.concat([t.extensions]):r})}static create(e={}){let t=Yh.resolve(e.extensions||[],new Map),n=e.doc instanceof te?e.doc:te.of((e.doc||"").split(t.staticFacet(j.lineSeparator)||Ju)),r=e.selection?e.selection instanceof b?e.selection:b.single(e.selection.anchor,e.selection.head):b.single(0);return Rb(r,n.length),t.staticFacet(rd)||(r=r.asSingle()),new j(t,n,r,t.dynamicSlots.map(()=>null),(s,o)=>o.create(s),null)}get tabSize(){return this.facet(j.tabSize)}get lineBreak(){return this.facet(j.lineSeparator)||`
`}get readOnly(){return this.facet(Bb)}phrase(e,...t){for(let n of this.facet(j.phrases))if(Object.prototype.hasOwnProperty.call(n,e)){e=n[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(n,r)=>{if(r=="$")return"$";let s=+(r||1);return!s||s>t.length?n:t[s-1]})),e}languageDataAt(e,t,n=-1){let r=[];for(let s of this.facet(Nb))for(let o of s(this,t,n))Object.prototype.hasOwnProperty.call(o,e)&&r.push(o[e]);return r}charCategorizer(e){return cA(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:t,from:n,length:r}=this.doc.lineAt(e),s=this.charCategorizer(e),o=e-n,l=e-n;for(;o>0;){let a=_e(t,o,!1);if(s(t.slice(a,o))!=ke.Word)break;o=a}for(;l<r;){let a=_e(t,l);if(s(t.slice(l,a))!=ke.Word)break;l=a}return o==l?null:b.range(o+n,l+n)}}j.allowMultipleSelections=rd;j.tabSize=R.define({combine:i=>i.length?i[0]:4});j.lineSeparator=Db;j.readOnly=Bb;j.phrases=R.define({compare(i,e){let t=Object.keys(i),n=Object.keys(e);return t.length==n.length&&t.every(r=>i[r]==e[r])}});j.languageData=Nb;j.changeFilter=Ib;j.transactionFilter=Wb;j.transactionExtender=Xb;Ul.reconfigure=q.define();function On(i,e,t={}){let n={};for(let r of i)for(let s of Object.keys(r)){let o=r[s],l=n[s];if(l===void 0)n[s]=o;else if(!(l===o||o===void 0))if(Object.hasOwnProperty.call(t,s))n[s]=t[s](l,o);else throw new Error("Config merge conflict for field "+s)}for(let r in e)n[r]===void 0&&(n[r]=e[r]);return n}class Dr{eq(e){return this==e}range(e,t=e){return ld.create(e,t,this)}}Dr.prototype.startSide=Dr.prototype.endSide=0;Dr.prototype.point=!1;Dr.prototype.mapMode=Ye.TrackDel;let ld=class Lb{constructor(e,t,n){this.from=e,this.to=t,this.value=n}static create(e,t,n){return new Lb(e,t,n)}};function ad(i,e){return i.from-e.from||i.value.startSide-e.value.startSide}class qp{constructor(e,t,n,r){this.from=e,this.to=t,this.value=n,this.maxPoint=r}get length(){return this.to[this.to.length-1]}findIndex(e,t,n,r=0){let s=n?this.to:this.from;for(let o=r,l=s.length;;){if(o==l)return o;let a=o+l>>1,h=s[a]-e||(n?this.value[a].endSide:this.value[a].startSide)-t;if(a==o)return h>=0?o:l;h>=0?l=a:o=a+1}}between(e,t,n,r){for(let s=this.findIndex(t,-1e9,!0),o=this.findIndex(n,1e9,!1,s);s<o;s++)if(r(this.from[s]+e,this.to[s]+e,this.value[s])===!1)return!1}map(e,t){let n=[],r=[],s=[],o=-1,l=-1;for(let a=0;a<this.value.length;a++){let h=this.value[a],c=this.from[a]+e,f=this.to[a]+e,u,d;if(c==f){let p=t.mapPos(c,h.startSide,h.mapMode);if(p==null||(u=d=p,h.startSide!=h.endSide&&(d=t.mapPos(c,h.endSide),d<u)))continue}else if(u=t.mapPos(c,h.startSide),d=t.mapPos(f,h.endSide),u>d||u==d&&h.startSide>0&&h.endSide<=0)continue;(d-u||h.endSide-h.startSide)<0||(o<0&&(o=u),h.point&&(l=Math.max(l,d-u)),n.push(h),r.push(u-o),s.push(d-o))}return{mapped:n.length?new qp(r,s,n,l):null,pos:o}}}class H{constructor(e,t,n,r){this.chunkPos=e,this.chunk=t,this.nextLayer=n,this.maxPoint=r}static create(e,t,n,r){return new H(e,t,n,r)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:n=!1,filterFrom:r=0,filterTo:s=this.length}=e,o=e.filter;if(t.length==0&&!o)return this;if(n&&(t=t.slice().sort(ad)),this.isEmpty)return t.length?H.of(t):this;let l=new zb(this,null,-1).goto(0),a=0,h=[],c=new _i;for(;l.value||a<t.length;)if(a<t.length&&(l.from-t[a].from||l.startSide-t[a].value.startSide)>=0){let f=t[a++];c.addInner(f.from,f.to,f.value)||h.push(f)}else l.rangeIndex==1&&l.chunkIndex<this.chunk.length&&(a==t.length||this.chunkEnd(l.chunkIndex)<t[a].from)&&(!o||r>this.chunkEnd(l.chunkIndex)||s<this.chunkPos[l.chunkIndex])&&c.addChunk(this.chunkPos[l.chunkIndex],this.chunk[l.chunkIndex])?l.nextChunk():((!o||r>l.to||s<l.from||o(l.from,l.to,l.value))&&(c.addInner(l.from,l.to,l.value)||h.push(ld.create(l.from,l.to,l.value))),l.next());return c.finishInner(this.nextLayer.isEmpty&&!h.length?H.empty:this.nextLayer.update({add:h,filter:o,filterFrom:r,filterTo:s}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],n=[],r=-1;for(let o=0;o<this.chunk.length;o++){let l=this.chunkPos[o],a=this.chunk[o],h=e.touchesRange(l,l+a.length);if(h===!1)r=Math.max(r,a.maxPoint),t.push(a),n.push(e.mapPos(l));else if(h===!0){let{mapped:c,pos:f}=a.map(l,e);c&&(r=Math.max(r,c.maxPoint),t.push(c),n.push(f))}}let s=this.nextLayer.map(e);return t.length==0?s:new H(n,t,s||H.empty,r)}between(e,t,n){if(!this.isEmpty){for(let r=0;r<this.chunk.length;r++){let s=this.chunkPos[r],o=this.chunk[r];if(t>=s&&e<=s+o.length&&o.between(s,e-s,t-s,n)===!1)return}this.nextLayer.between(e,t,n)}}iter(e=0){return $l.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return $l.from(e).goto(t)}static compare(e,t,n,r,s=-1){let o=e.filter(f=>f.maxPoint>0||!f.isEmpty&&f.maxPoint>=s),l=t.filter(f=>f.maxPoint>0||!f.isEmpty&&f.maxPoint>=s),a=RO(o,l,n),h=new ho(o,a,s),c=new ho(l,a,s);n.iterGaps((f,u,d)=>EO(h,f,c,u,d,r)),n.empty&&n.length==0&&EO(h,0,c,0,0,r)}static eq(e,t,n=0,r){r==null&&(r=999999999);let s=e.filter(c=>!c.isEmpty&&t.indexOf(c)<0),o=t.filter(c=>!c.isEmpty&&e.indexOf(c)<0);if(s.length!=o.length)return!1;if(!s.length)return!0;let l=RO(s,o),a=new ho(s,l,0).goto(n),h=new ho(o,l,0).goto(n);for(;;){if(a.to!=h.to||!hd(a.active,h.active)||a.point&&(!h.point||!a.point.eq(h.point)))return!1;if(a.to>r)return!0;a.next(),h.next()}}static spans(e,t,n,r,s=-1){let o=new ho(e,null,s).goto(t),l=t,a=o.openStart;for(;;){let h=Math.min(o.to,n);if(o.point){let c=o.activeForPoint(o.to),f=o.pointFrom<t?c.length+1:o.point.startSide<0?c.length:Math.min(c.length,a);r.point(l,h,o.point,c,f,o.pointRank),a=Math.min(o.openEnd(h),c.length)}else h>l&&(r.span(l,h,o.active,a),a=o.openEnd(h));if(o.to>n)return a+(o.point&&o.to>n?1:0);l=o.to,o.next()}}static of(e,t=!1){let n=new _i;for(let r of e instanceof ld?[e]:t?fA(e):e)n.add(r.from,r.to,r.value);return n.finish()}static join(e){if(!e.length)return H.empty;let t=e[e.length-1];for(let n=e.length-2;n>=0;n--)for(let r=e[n];r!=H.empty;r=r.nextLayer)t=new H(r.chunkPos,r.chunk,t,Math.max(r.maxPoint,t.maxPoint));return t}}H.empty=new H([],[],null,-1);function fA(i){if(i.length>1)for(let e=i[0],t=1;t<i.length;t++){let n=i[t];if(ad(e,n)>0)return i.slice().sort(ad);e=n}return i}H.empty.nextLayer=H.empty;class _i{finishChunk(e){this.chunks.push(new qp(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,t,n){this.addInner(e,t,n)||(this.nextLayer||(this.nextLayer=new _i)).add(e,t,n)}addInner(e,t,n){let r=e-this.lastTo||n.startSide-this.last.endSide;if(r<=0&&(e-this.lastFrom||n.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return r<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=n,this.lastFrom=e,this.lastTo=t,this.value.push(n),n.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let n=t.value.length-1;return this.last=t.value[n],this.lastFrom=t.from[n]+e,this.lastTo=t.to[n]+e,!0}finish(){return this.finishInner(H.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=H.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function RO(i,e,t){let n=new Map;for(let s of i)for(let o=0;o<s.chunk.length;o++)s.chunk[o].maxPoint<=0&&n.set(s.chunk[o],s.chunkPos[o]);let r=new Set;for(let s of e)for(let o=0;o<s.chunk.length;o++){let l=n.get(s.chunk[o]);l!=null&&(t?t.mapPos(l):l)==s.chunkPos[o]&&!(t!=null&&t.touchesRange(l,l+s.chunk[o].length))&&r.add(s.chunk[o])}return r}class zb{constructor(e,t,n,r=0){this.layer=e,this.skip=t,this.minPoint=n,this.rank=r}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,n){for(;this.chunkIndex<this.layer.chunk.length;){let r=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(r)||this.layer.chunkEnd(this.chunkIndex)<e||r.maxPoint<this.minPoint))break;this.chunkIndex++,n=!1}if(this.chunkIndex<this.layer.chunk.length){let r=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!n||this.rangeIndex<r)&&this.setRangeIndex(r)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],n=e+t.from[this.rangeIndex];if(this.from=n,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class $l{constructor(e){this.heap=e}static from(e,t=null,n=-1){let r=[];for(let s=0;s<e.length;s++)for(let o=e[s];!o.isEmpty;o=o.nextLayer)o.maxPoint>=n&&r.push(new zb(o,t,n,s));return r.length==1?r[0]:new $l(r)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let n of this.heap)n.goto(e,t);for(let n=this.heap.length>>1;n>=0;n--)Df(this.heap,n);return this.next(),this}forward(e,t){for(let n of this.heap)n.forward(e,t);for(let n=this.heap.length>>1;n>=0;n--)Df(this.heap,n);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),Df(this.heap,0)}}}function Df(i,e){for(let t=i[e];;){let n=(e<<1)+1;if(n>=i.length)break;let r=i[n];if(n+1<i.length&&r.compare(i[n+1])>=0&&(r=i[n+1],n++),t.compare(r)<0)break;i[n]=t,i[e]=r,e=n}}class ho{constructor(e,t,n){this.minPoint=n,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=$l.from(e,t,n)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){ga(this.active,e),ga(this.activeTo,e),ga(this.activeRank,e),this.minActive=NO(this.active,this.activeTo)}addActive(e){let t=0,{value:n,to:r,rank:s}=this.cursor;for(;t<this.activeRank.length&&(s-this.activeRank[t]||r-this.activeTo[t])>0;)t++;Oa(this.active,t,n),Oa(this.activeTo,t,r),Oa(this.activeRank,t,s),e&&Oa(e,t,this.cursor.from),this.minActive=NO(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let n=this.openStart<0?[]:null;for(;;){let r=this.minActive;if(r>-1&&(this.activeTo[r]-this.cursor.from||this.active[r].endSide-this.cursor.startSide)<0){if(this.activeTo[r]>e){this.to=this.activeTo[r],this.endSide=this.active[r].endSide;break}this.removeActive(r),n&&ga(n,r)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let s=this.cursor.value;if(!s.point)this.addActive(n),this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=s,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=s.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(n){this.openStart=0;for(let r=n.length-1;r>=0&&n[r]<e;r--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let n=this.active.length-1;n>=0&&!(this.activeRank[n]<this.pointRank);n--)(this.activeTo[n]>e||this.activeTo[n]==e&&this.active[n].endSide>=this.point.endSide)&&t.push(this.active[n]);return t.reverse()}openEnd(e){let t=0;for(let n=this.activeTo.length-1;n>=0&&this.activeTo[n]>e;n--)t++;return t}}function EO(i,e,t,n,r,s){i.goto(e),t.goto(n);let o=n+r,l=n,a=n-e;for(;;){let h=i.to+a-t.to||i.endSide-t.endSide,c=h<0?i.to+a:t.to,f=Math.min(c,o);if(i.point||t.point?i.point&&t.point&&(i.point==t.point||i.point.eq(t.point))&&hd(i.activeForPoint(i.to),t.activeForPoint(t.to))||s.comparePoint(l,f,i.point,t.point):f>l&&!hd(i.active,t.active)&&s.compareRange(l,f,i.active,t.active),c>o)break;l=c,h<=0&&i.next(),h>=0&&t.next()}}function hd(i,e){if(i.length!=e.length)return!1;for(let t=0;t<i.length;t++)if(i[t]!=e[t]&&!i[t].eq(e[t]))return!1;return!0}function ga(i,e){for(let t=e,n=i.length-1;t<n;t++)i[t]=i[t+1];i.pop()}function Oa(i,e,t){for(let n=i.length-1;n>=e;n--)i[n+1]=i[n];i[e]=t}function NO(i,e){let t=-1,n=1e9;for(let r=0;r<e.length;r++)(e[r]-n||i[r].endSide-i[t].endSide)<0&&(t=r,n=e[r]);return t}function dn(i,e,t=i.length){let n=0;for(let r=0;r<t;)i.charCodeAt(r)==9?(n+=e-n%e,r++):(n++,r=_e(i,r));return n}function cd(i,e,t,n){for(let r=0,s=0;;){if(s>=e)return r;if(r==i.length)break;s+=i.charCodeAt(r)==9?t-s%t:1,r=_e(i,r)}return n===!0?-1:i.length}const fd="",DO=typeof Symbol>"u"?"__"+fd:Symbol.for(fd),ud=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),IO=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class Fi{constructor(e,t){this.rules=[];let{finish:n}=t||{};function r(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function s(o,l,a,h){let c=[],f=/^@(\w+)\b/.exec(o[0]),u=f&&f[1]=="keyframes";if(f&&l==null)return a.push(o[0]+";");for(let d in l){let p=l[d];if(/&/.test(d))s(d.split(/,\s*/).map(m=>o.map(g=>m.replace(/&/,g))).reduce((m,g)=>m.concat(g)),p,a);else if(p&&typeof p=="object"){if(!f)throw new RangeError("The value of a property ("+d+") should be a primitive value.");s(r(d),p,c,u)}else p!=null&&c.push(d.replace(/_.*/,"").replace(/[A-Z]/g,m=>"-"+m.toLowerCase())+": "+p+";")}(c.length||u)&&a.push((n&&!f&&!h?o.map(n):o).join(", ")+" {"+c.join(" ")+"}")}for(let o in e)s(r(o),e[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=IO[DO]||1;return IO[DO]=e+1,fd+e.toString(36)}static mount(e,t,n){let r=e[ud],s=n&&n.nonce;r?s&&r.setNonce(s):r=new uA(e,s),r.mount(Array.isArray(t)?t:[t],e)}}let WO=new Map;class uA{constructor(e,t){let n=e.ownerDocument||e,r=n.defaultView;if(!e.head&&e.adoptedStyleSheets&&r.CSSStyleSheet){let s=WO.get(n);if(s)return e[ud]=s;this.sheet=new r.CSSStyleSheet,WO.set(n,this)}else this.styleTag=n.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);this.modules=[],e[ud]=this}mount(e,t){let n=this.sheet,r=0,s=0;for(let o=0;o<e.length;o++){let l=e[o],a=this.modules.indexOf(l);if(a<s&&a>-1&&(this.modules.splice(a,1),s--,a=-1),a==-1){if(this.modules.splice(s++,0,l),n)for(let h=0;h<l.rules.length;h++)n.insertRule(l.rules[h],r++)}else{for(;s<a;)r+=this.modules[s++].rules.length;r+=l.rules.length,s++}}if(n)t.adoptedStyleSheets.indexOf(this.sheet)<0&&(t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets]);else{let o="";for(let a=0;a<this.modules.length;a++)o+=this.modules[a].getRules()+`
`;this.styleTag.textContent=o;let l=t.head||t;this.styleTag.parentNode!=l&&l.insertBefore(this.styleTag,l.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}function _h(i){let e;return i.nodeType==11?e=i.getSelection?i:i.ownerDocument:e=i,e.getSelection()}function dd(i,e){return e?i==e||i.contains(e.nodeType!=1?e.parentNode:e):!1}function dA(i){let e=i.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function kh(i,e){if(!e.anchorNode)return!1;try{return dd(i,e.anchorNode)}catch{return!1}}function Is(i){return i.nodeType==3?Wr(i,0,i.nodeValue.length).getClientRects():i.nodeType==1?i.getClientRects():[]}function ol(i,e,t,n){return t?XO(i,e,t,n,-1)||XO(i,e,t,n,1):!1}function Ir(i){for(var e=0;;e++)if(i=i.previousSibling,!i)return e}function Fh(i){return i.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(i.nodeName)}function XO(i,e,t,n,r){for(;;){if(i==t&&e==n)return!0;if(e==(r<0?0:hi(i))){if(i.nodeName=="DIV")return!1;let s=i.parentNode;if(!s||s.nodeType!=1)return!1;e=Ir(i)+(r<0?0:1),i=s}else if(i.nodeType==1){if(i=i.childNodes[e+(r<0?-1:0)],i.nodeType==1&&i.contentEditable=="false")return!1;e=r<0?hi(i):0}else return!1}}function hi(i){return i.nodeType==3?i.nodeValue.length:i.childNodes.length}function Nc(i,e){let t=e?i.left:i.right;return{left:t,right:t,top:i.top,bottom:i.bottom}}function pA(i){let e=i.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:i.innerWidth,top:0,bottom:i.innerHeight}}function Yb(i,e){let t=e.width/i.offsetWidth,n=e.height/i.offsetHeight;return(t>.995&&t<1.005||!isFinite(t)||Math.abs(e.width-i.offsetWidth)<1)&&(t=1),(n>.995&&n<1.005||!isFinite(n)||Math.abs(e.height-i.offsetHeight)<1)&&(n=1),{scaleX:t,scaleY:n}}function mA(i,e,t,n,r,s,o,l){let a=i.ownerDocument,h=a.defaultView||window;for(let c=i,f=!1;c&&!f;)if(c.nodeType==1){let u,d=c==a.body,p=1,m=1;if(d)u=pA(h);else{if(/^(fixed|sticky)$/.test(getComputedStyle(c).position)&&(f=!0),c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.assignedSlot||c.parentNode;continue}let k=c.getBoundingClientRect();({scaleX:p,scaleY:m}=Yb(c,k)),u={left:k.left,right:k.left+c.clientWidth*p,top:k.top,bottom:k.top+c.clientHeight*m}}let g=0,y=0;if(r=="nearest")e.top<u.top?(y=-(u.top-e.top+o),t>0&&e.bottom>u.bottom+y&&(y=e.bottom-u.bottom+y+o)):e.bottom>u.bottom&&(y=e.bottom-u.bottom+o,t<0&&e.top-y<u.top&&(y=-(u.top+y-e.top+o)));else{let k=e.bottom-e.top,v=u.bottom-u.top;y=(r=="center"&&k<=v?e.top+k/2-v/2:r=="start"||r=="center"&&t<0?e.top-o:e.bottom-v+o)-u.top}if(n=="nearest"?e.left<u.left?(g=-(u.left-e.left+s),t>0&&e.right>u.right+g&&(g=e.right-u.right+g+s)):e.right>u.right&&(g=e.right-u.right+s,t<0&&e.left<u.left+g&&(g=-(u.left+g-e.left+s))):g=(n=="center"?e.left+(e.right-e.left)/2-(u.right-u.left)/2:n=="start"==l?e.left-s:e.right-(u.right-u.left)+s)-u.left,g||y)if(d)h.scrollBy(g,y);else{let k=0,v=0;if(y){let $=c.scrollTop;c.scrollTop+=y/m,v=(c.scrollTop-$)*m}if(g){let $=c.scrollLeft;c.scrollLeft+=g/p,k=(c.scrollLeft-$)*p}e={left:e.left-k,top:e.top-v,right:e.right-k,bottom:e.bottom-v},k&&Math.abs(k-g)<1&&(n="nearest"),v&&Math.abs(v-y)<1&&(r="nearest")}if(d)break;c=c.assignedSlot||c.parentNode}else if(c.nodeType==11)c=c.host;else break}function gA(i){let e=i.ownerDocument;for(let t=i.parentNode;t&&t!=e.body;)if(t.nodeType==1){if(t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth)return t;t=t.assignedSlot||t.parentNode}else if(t.nodeType==11)t=t.host;else break;return null}class OA{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:n}=e;this.set(t,Math.min(e.anchorOffset,t?hi(t):0),n,Math.min(e.focusOffset,n?hi(n):0))}set(e,t,n,r){this.anchorNode=e,this.anchorOffset=t,this.focusNode=n,this.focusOffset=r}}let Gr=null;function jb(i){if(i.setActive)return i.setActive();if(Gr)return i.focus(Gr);let e=[];for(let t=i;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(i.focus(Gr==null?{get preventScroll(){return Gr={preventScroll:!0},!0}}:void 0),!Gr){Gr=!1;for(let t=0;t<e.length;){let n=e[t++],r=e[t++],s=e[t++];n.scrollTop!=r&&(n.scrollTop=r),n.scrollLeft!=s&&(n.scrollLeft=s)}}}let BO;function Wr(i,e,t=e){let n=BO||(BO=document.createRange());return n.setEnd(i,t),n.setStart(i,e),n}function vs(i,e,t,n){let r={key:e,code:e,keyCode:t,which:t,cancelable:!0};n&&({altKey:r.altKey,ctrlKey:r.ctrlKey,shiftKey:r.shiftKey,metaKey:r.metaKey}=n);let s=new KeyboardEvent("keydown",r);s.synthetic=!0,i.dispatchEvent(s);let o=new KeyboardEvent("keyup",r);return o.synthetic=!0,i.dispatchEvent(o),s.defaultPrevented||o.defaultPrevented}function yA(i){for(;i;){if(i&&(i.nodeType==9||i.nodeType==11&&i.host))return i;i=i.assignedSlot||i.parentNode}return null}function _b(i){for(;i.attributes.length;)i.removeAttributeNode(i.attributes[0])}function kA(i,e){let t=e.focusNode,n=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=n)return!1;for(n=Math.min(n,hi(t));;)if(n){if(t.nodeType!=1)return!1;let r=t.childNodes[n-1];r.contentEditable=="false"?n--:(t=r,n=hi(t))}else{if(t==i)return!0;n=Ir(t),t=t.parentNode}}function Fb(i){return i.scrollTop>Math.max(1,i.scrollHeight-i.clientHeight-4)}function Ub(i,e){for(let t=i,n=e;;){if(t.nodeType==3&&n>0)return{node:t,offset:n};if(t.nodeType==1&&n>0){if(t.contentEditable=="false")return null;t=t.childNodes[n-1],n=hi(t)}else if(t.parentNode&&!Fh(t))n=Ir(t),t=t.parentNode;else return null}}function Gb(i,e){for(let t=i,n=e;;){if(t.nodeType==3&&n<t.nodeValue.length)return{node:t,offset:n};if(t.nodeType==1&&n<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[n],n=0}else if(t.parentNode&&!Fh(t))n=Ir(t)+1,t=t.parentNode;else return null}}class Ge{constructor(e,t,n=!0){this.node=e,this.offset=t,this.precise=n}static before(e,t){return new Ge(e.parentNode,Ir(e),t)}static after(e,t){return new Ge(e.parentNode,Ir(e)+1,t)}}const Lp=[];class le{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let n of this.children){if(n==e)return t;t+=n.length+n.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,t){if(this.flags&2){let n=this.dom,r=null,s;for(let o of this.children){if(o.flags&7){if(!o.dom&&(s=r?r.nextSibling:n.firstChild)){let l=le.get(s);(!l||!l.parent&&l.canReuseDOM(o))&&o.reuseDOM(s)}o.sync(e,t),o.flags&=-8}if(s=r?r.nextSibling:n.firstChild,t&&!t.written&&t.node==n&&s!=o.dom&&(t.written=!0),o.dom.parentNode==n)for(;s&&s!=o.dom;)s=VO(s);else n.insertBefore(o.dom,s);r=o.dom}for(s=r?r.nextSibling:n.firstChild,s&&t&&t.node==n&&(t.written=!0);s;)s=VO(s)}else if(this.flags&1)for(let n of this.children)n.flags&7&&(n.sync(e,t),n.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,t){let n;if(e==this.dom)n=this.dom.childNodes[t];else{let r=hi(e)==0?0:t==0?-1:1;for(;;){let s=e.parentNode;if(s==this.dom)break;r==0&&s.firstChild!=s.lastChild&&(e==s.firstChild?r=-1:r=1),e=s}r<0?n=e:n=e.nextSibling}if(n==this.dom.firstChild)return 0;for(;n&&!le.get(n);)n=n.nextSibling;if(!n)return this.length;for(let r=0,s=0;;r++){let o=this.children[r];if(o.dom==n)return s;s+=o.length+o.breakAfter}}domBoundsAround(e,t,n=0){let r=-1,s=-1,o=-1,l=-1;for(let a=0,h=n,c=n;a<this.children.length;a++){let f=this.children[a],u=h+f.length;if(h<e&&u>t)return f.domBoundsAround(e,t,h);if(u>=e&&r==-1&&(r=a,s=h),h>t&&f.dom.parentNode==this.dom){o=a,l=c;break}c=u,h=u+f.breakAfter}return{from:s,to:l<0?n+this.length:l,startDOM:(r?this.children[r-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.flags|=2),t.flags&1)return;t.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,n=Lp){this.markDirty();for(let r=e;r<t;r++){let s=this.children[r];s.parent==this&&n.indexOf(s)<0&&s.destroy()}this.children.splice(e,t-e,...n);for(let r=0;r<n.length;r++)n[r].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new Hb(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,t,n,r,s,o){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}le.prototype.breakAfter=0;function VO(i){let e=i.nextSibling;return i.parentNode.removeChild(i),e}class Hb{constructor(e,t,n){this.children=e,this.pos=t,this.i=n,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let n=this.children[--this.i];this.pos-=n.length+n.breakAfter}}}function Kb(i,e,t,n,r,s,o,l,a){let{children:h}=i,c=h.length?h[e]:null,f=s.length?s[s.length-1]:null,u=f?f.breakAfter:o;if(!(e==n&&c&&!o&&!u&&s.length<2&&c.merge(t,r,s.length?f:null,t==0,l,a))){if(n<h.length){let d=h[n];d&&(r<d.length||d.breakAfter&&(f!=null&&f.breakAfter))?(e==n&&(d=d.split(r),r=0),!u&&f&&d.merge(0,r,f,!0,0,a)?s[s.length-1]=d:((r||d.children.length&&!d.children[0].length)&&d.merge(0,r,null,!1,0,a),s.push(d))):d!=null&&d.breakAfter&&(f?f.breakAfter=1:o=1),n++}for(c&&(c.breakAfter=o,t>0&&(!o&&s.length&&c.merge(t,c.length,s[0],!1,l,0)?c.breakAfter=s.shift().breakAfter:(t<c.length||c.children.length&&c.children[c.children.length-1].length==0)&&c.merge(t,c.length,null,!1,l,0),e++));e<n&&s.length;)if(h[n-1].become(s[s.length-1]))n--,s.pop(),a=s.length?0:l;else if(h[e].become(s[0]))e++,s.shift(),l=s.length?0:a;else break;!s.length&&e&&n<h.length&&!h[e-1].breakAfter&&h[n].merge(0,0,h[e-1],!1,l,a)&&e--,(e<n||s.length)&&i.replaceChildren(e,n,s)}}function Jb(i,e,t,n,r,s){let o=i.childCursor(),{i:l,off:a}=o.findPos(t,1),{i:h,off:c}=o.findPos(e,-1),f=e-t;for(let u of n)f+=u.length;i.length+=f,Kb(i,h,c,l,a,n,0,r,s)}let Mt=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},pd=typeof document<"u"?document:{documentElement:{style:{}}};const md=/Edge\/(\d+)/.exec(Mt.userAgent),eS=/MSIE \d/.test(Mt.userAgent),gd=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Mt.userAgent),Dc=!!(eS||gd||md),qO=!Dc&&/gecko\/(\d+)/i.test(Mt.userAgent),If=!Dc&&/Chrome\/(\d+)/.exec(Mt.userAgent),LO="webkitFontSmoothing"in pd.documentElement.style,tS=!Dc&&/Apple Computer/.test(Mt.vendor),zO=tS&&(/Mobile\/\w+/.test(Mt.userAgent)||Mt.maxTouchPoints>2);var E={mac:zO||/Mac/.test(Mt.platform),windows:/Win/.test(Mt.platform),linux:/Linux|X11/.test(Mt.platform),ie:Dc,ie_version:eS?pd.documentMode||6:gd?+gd[1]:md?+md[1]:0,gecko:qO,gecko_version:qO?+(/Firefox\/(\d+)/.exec(Mt.userAgent)||[0,0])[1]:0,chrome:!!If,chrome_version:If?+If[1]:0,ios:zO,android:/Android\b/.test(Mt.userAgent),webkit:LO,safari:tS,webkit_version:LO?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:pd.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const bA=256;class pn extends le{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,t,n){return this.flags&8||n&&(!(n instanceof pn)||this.length-(t-e)+n.length>bA||n.flags&8)?!1:(this.text=this.text.slice(0,e)+(n?n.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new pn(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t.flags|=this.flags&8,t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new Ge(this.dom,e)}domBoundsAround(e,t,n){return{from:n,to:n+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return SA(this.dom,e,t)}}class ci extends le{constructor(e,t=[],n=0){super(),this.mark=e,this.children=t,this.length=n;for(let r of t)r.setParent(this)}setAttrs(e){if(_b(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,t){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,t)}merge(e,t,n,r,s,o){return n&&(!(n instanceof ci&&n.mark.eq(this.mark))||e&&s<=0||t<this.length&&o<=0)?!1:(Jb(this,e,t,n?n.children.slice():[],s-1,o-1),this.markDirty(),!0)}split(e){let t=[],n=0,r=-1,s=0;for(let l of this.children){let a=n+l.length;a>e&&t.push(n<e?l.split(e-n):l),r<0&&n>=e&&(r=s),n=a,s++}let o=this.length-e;return this.length=e,r>-1&&(this.children.length=r,this.markDirty()),new ci(this.mark,t,o)}domAtPos(e){return nS(this,e)}coordsAt(e,t){return rS(this,e,t)}}function SA(i,e,t){let n=i.nodeValue.length;e>n&&(e=n);let r=e,s=e,o=0;e==0&&t<0||e==n&&t>=0?E.chrome||E.gecko||(e?(r--,o=1):s<n&&(s++,o=-1)):t<0?r--:s<n&&s++;let l=Wr(i,r,s).getClientRects();if(!l.length)return null;let a=l[(o?o<0:t>=0)?0:l.length-1];return E.safari&&!o&&a.width==0&&(a=Array.prototype.find.call(l,h=>h.width)||a),o?Nc(a,o<0):a||null}class Ei extends le{static create(e,t,n){return new Ei(e,t,n)}constructor(e,t,n){super(),this.widget=e,this.length=t,this.side=n,this.prevWidget=null}split(e){let t=Ei.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,t,n,r,s,o){return n&&(!(n instanceof Ei)||!this.widget.compare(n.widget)||e>0&&s<=0||t<this.length&&o<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-t),!0)}become(e){return e instanceof Ei&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return te.empty;let e=this;for(;e.parent;)e=e.parent;let{view:t}=e,n=t&&t.state.doc,r=this.posAtStart;return n?n.slice(r,r+this.length):te.empty}domAtPos(e){return(this.length?e==0:this.side>0)?Ge.before(this.dom):Ge.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let n=this.widget.coordsAt(this.dom,e,t);if(n)return n;let r=this.dom.getClientRects(),s=null;if(!r.length)return null;let o=this.side?this.side<0:e>0;for(let l=o?r.length-1:0;s=r[l],!(e>0?l==0:l==r.length-1||s.top<s.bottom);l+=o?-1:1);return Nc(s,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Ws extends le{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof Ws&&e.side==this.side}split(){return new Ws(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?Ge.before(this.dom):Ge.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return te.empty}get isHidden(){return!0}}pn.prototype.children=Ei.prototype.children=Ws.prototype.children=Lp;function nS(i,e){let t=i.dom,{children:n}=i,r=0;for(let s=0;r<n.length;r++){let o=n[r],l=s+o.length;if(!(l==s&&o.getSide()<=0)){if(e>s&&e<l&&o.dom.parentNode==t)return o.domAtPos(e-s);if(e<=s)break;s=l}}for(let s=r;s>0;s--){let o=n[s-1];if(o.dom.parentNode==t)return o.domAtPos(o.length)}for(let s=r;s<n.length;s++){let o=n[s];if(o.dom.parentNode==t)return o.domAtPos(0)}return new Ge(t,0)}function iS(i,e,t){let n,{children:r}=i;t>0&&e instanceof ci&&r.length&&(n=r[r.length-1])instanceof ci&&n.mark.eq(e.mark)?iS(n,e.children[0],t-1):(r.push(e),e.setParent(i)),i.length+=e.length}function rS(i,e,t){let n=null,r=-1,s=null,o=-1;function l(h,c){for(let f=0,u=0;f<h.children.length&&u<=c;f++){let d=h.children[f],p=u+d.length;p>=c&&(d.children.length?l(d,c-u):(!s||s.isHidden&&t>0)&&(p>c||u==p&&d.getSide()>0)?(s=d,o=c-u):(u<c||u==p&&d.getSide()<0&&!d.isHidden)&&(n=d,r=c-u)),u=p}}l(i,e);let a=(t<0?n:s)||n||s;return a?a.coordsAt(Math.max(0,a==n?r:o),t):wA(i)}function wA(i){let e=i.dom.lastChild;if(!e)return i.dom.getBoundingClientRect();let t=Is(e);return t[t.length-1]||null}function Od(i,e){for(let t in i)t=="class"&&e.class?e.class+=" "+i.class:t=="style"&&e.style?e.style+=";"+i.style:e[t]=i[t];return e}const YO=Object.create(null);function zp(i,e,t){if(i==e)return!0;i||(i=YO),e||(e=YO);let n=Object.keys(i),r=Object.keys(e);if(n.length-(t&&n.indexOf(t)>-1?1:0)!=r.length-(t&&r.indexOf(t)>-1?1:0))return!1;for(let s of n)if(s!=t&&(r.indexOf(s)==-1||i[s]!==e[s]))return!1;return!0}function yd(i,e,t){let n=!1;if(e)for(let r in e)t&&r in t||(n=!0,r=="style"?i.style.cssText="":i.removeAttribute(r));if(t)for(let r in t)e&&e[r]==t[r]||(n=!0,r=="style"?i.style.cssText=t[r]:i.setAttribute(r,t[r]));return n}function xA(i){let e=Object.create(null);for(let t=0;t<i.attributes.length;t++){let n=i.attributes[t];e[n.name]=n.value}return e}class Ee extends le{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,n,r,s,o){if(n){if(!(n instanceof Ee))return!1;this.dom||n.transferDOM(this)}return r&&this.setDeco(n?n.attrs:null),Jb(this,e,t,n?n.children.slice():[],s,o),!0}split(e){let t=new Ee;if(t.breakAfter=this.breakAfter,this.length==0)return t;let{i:n,off:r}=this.childPos(e);r&&(t.append(this.children[n].split(r),0),this.children[n].merge(r,this.children[n].length,null,!1,0,0),n++);for(let s=n;s<this.children.length;s++)t.append(this.children[s],0);for(;n>0&&this.children[n-1].length==0;)this.children[--n].destroy();return this.children.length=n,this.markDirty(),this.length=e,t}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){zp(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){iS(this,e,t)}addLineDeco(e){let t=e.spec.attributes,n=e.spec.class;t&&(this.attrs=Od(t,this.attrs||{})),n&&(this.attrs=Od({class:n},this.attrs||{}))}domAtPos(e){return nS(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,t){var n;this.dom?this.flags&4&&(_b(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(yd(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,t);let r=this.dom.lastChild;for(;r&&le.get(r)instanceof ci;)r=r.lastChild;if(!r||!this.length||r.nodeName!="BR"&&((n=le.get(r))===null||n===void 0?void 0:n.isEditable)==!1&&(!E.ios||!this.children.some(s=>s instanceof pn))){let s=document.createElement("BR");s.cmIgnore=!0,this.dom.appendChild(s)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,t;for(let n of this.children){if(!(n instanceof pn)||/[^ -~]/.test(n.text))return null;let r=Is(n.dom);if(r.length!=1)return null;e+=r[0].width,t=r[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(e,t){let n=rS(this,e,t);if(!this.children.length&&n&&this.parent){let{heightOracle:r}=this.parent.view.viewState,s=n.bottom-n.top;if(Math.abs(s-r.lineHeight)<2&&r.textHeight<s){let o=(s-r.textHeight)/2;return{top:n.top+o,bottom:n.bottom-o,left:n.left,right:n.left}}}return n}become(e){return!1}covers(){return!0}static find(e,t){for(let n=0,r=0;n<e.children.length;n++){let s=e.children[n],o=r+s.length;if(o>=t){if(s instanceof Ee)return s;if(o>t)break}r=o+s.breakAfter}return null}}class Li extends le{constructor(e,t,n){super(),this.widget=e,this.length=t,this.deco=n,this.breakAfter=0,this.prevWidget=null}merge(e,t,n,r,s,o){return n&&(!(n instanceof Li)||!this.widget.compare(n.widget)||e>0&&s<=0||t<this.length&&o<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-t),!0)}domAtPos(e){return e==0?Ge.before(this.dom):Ge.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let n=new Li(this.widget,t,this.deco);return n.breakAfter=this.breakAfter,n}get children(){return Lp}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):te.empty}domBoundsAround(){return null}become(e){return e instanceof Li&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,t){return this.widget.coordsAt(this.dom,e,t)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:t,endSide:n}=this.deco;return t==n?!1:e<0?t<0:n>0}}class _n{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,n){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var at=function(i){return i[i.Text=0]="Text",i[i.WidgetBefore=1]="WidgetBefore",i[i.WidgetAfter=2]="WidgetAfter",i[i.WidgetRange=3]="WidgetRange",i}(at||(at={}));class I extends Dr{constructor(e,t,n,r){super(),this.startSide=e,this.endSide=t,this.widget=n,this.spec=r}get heightRelevant(){return!1}static mark(e){return new Gl(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),n=!!e.block;return t+=n&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new Ui(e,t,t,n,e.widget||null,!1)}static replace(e){let t=!!e.block,n,r;if(e.isBlockGap)n=-5e8,r=4e8;else{let{start:s,end:o}=sS(e,t);n=(s?t?-3e8:-1:5e8)-1,r=(o?t?2e8:1:-6e8)+1}return new Ui(e,n,r,t,e.widget||null,!0)}static line(e){return new Hl(e)}static set(e,t=!1){return H.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}I.none=H.empty;class Gl extends I{constructor(e){let{start:t,end:n}=sS(e);super(t?-1:5e8,n?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var t,n;return this==e||e instanceof Gl&&this.tagName==e.tagName&&(this.class||((t=this.attrs)===null||t===void 0?void 0:t.class))==(e.class||((n=e.attrs)===null||n===void 0?void 0:n.class))&&zp(this.attrs,e.attrs,"class")}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}Gl.prototype.point=!1;class Hl extends I{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof Hl&&this.spec.class==e.spec.class&&zp(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}Hl.prototype.mapMode=Ye.TrackBefore;Hl.prototype.point=!0;class Ui extends I{constructor(e,t,n,r,s,o){super(t,n,s,e),this.block=r,this.isReplace=o,this.mapMode=r?t<=0?Ye.TrackBefore:Ye.TrackAfter:Ye.TrackDel}get type(){return this.startSide!=this.endSide?at.WidgetRange:this.startSide<=0?at.WidgetBefore:at.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof Ui&&vA(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}Ui.prototype.point=!0;function sS(i,e=!1){let{inclusiveStart:t,inclusiveEnd:n}=i;return t==null&&(t=i.inclusive),n==null&&(n=i.inclusive),{start:t??e,end:n??e}}function vA(i,e){return i==e||!!(i&&e&&i.compare(e))}function kd(i,e,t,n=0){let r=t.length-1;r>=0&&t[r]+n>=i?t[r]=Math.max(t[r],e):t.push(i,e)}class ll{constructor(e,t,n,r){this.doc=e,this.pos=t,this.end=n,this.disallowBlockEffectsFor=r,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof Li&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new Ee),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(ya(new Ws(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof Li)&&this.getLine()}buildText(e,t,n){for(;e>0;){if(this.textOff==this.text.length){let{value:s,lineBreak:o,done:l}=this.cursor.next(this.skip);if(this.skip=0,l)throw new Error("Ran out of text content when drawing inline views");if(o){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=s,this.textOff=0}let r=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(t.length-n)),this.getLine().append(ya(new pn(this.text.slice(this.textOff,this.textOff+r)),t),n),this.atCursorPos=!0,this.textOff+=r,e-=r,n=0}}span(e,t,n,r){this.buildText(t-e,n,r),this.pos=t,this.openStart<0&&(this.openStart=r)}point(e,t,n,r,s,o){if(this.disallowBlockEffectsFor[o]&&n instanceof Ui){if(n.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let l=t-e;if(n instanceof Ui)if(n.block)n.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new Li(n.widget||Xs.block,l,n));else{let a=Ei.create(n.widget||Xs.inline,l,l?0:n.startSide),h=this.atCursorPos&&!a.isEditable&&s<=r.length&&(e<t||n.startSide>0),c=!a.isEditable&&(e<t||s>r.length||n.startSide<=0),f=this.getLine();this.pendingBuffer==2&&!h&&!a.isEditable&&(this.pendingBuffer=0),this.flushBuffer(r),h&&(f.append(ya(new Ws(1),r),s),s=r.length+Math.max(0,s-r.length)),f.append(ya(a,r),s),this.atCursorPos=c,this.pendingBuffer=c?e<t||s>r.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=r.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(n);l&&(this.textOff+l<=this.text.length?this.textOff+=l:(this.skip+=l-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=s)}static build(e,t,n,r,s){let o=new ll(e,t,n,s);return o.openEnd=H.spans(r,t,n,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function ya(i,e){for(let t of e)i=new ci(t,[i],i.length);return i}class Xs extends _n{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}Xs.inline=new Xs("span");Xs.block=new Xs("div");var ge=function(i){return i[i.LTR=0]="LTR",i[i.RTL=1]="RTL",i}(ge||(ge={}));const Xr=ge.LTR,Yp=ge.RTL;function oS(i){let e=[];for(let t=0;t<i.length;t++)e.push(1<<+i[t]);return e}const $A=oS("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),PA=oS("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),bd=Object.create(null),Sn=[];for(let i of["()","[]","{}"]){let e=i.charCodeAt(0),t=i.charCodeAt(1);bd[e]=t,bd[t]=-e}function lS(i){return i<=247?$A[i]:1424<=i&&i<=1524?2:1536<=i&&i<=1785?PA[i-1536]:1774<=i&&i<=2220?4:8192<=i&&i<=8204?256:64336<=i&&i<=65023?4:1}const QA=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Ni{get dir(){return this.level%2?Yp:Xr}constructor(e,t,n){this.from=e,this.to=t,this.level=n}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,n,r){let s=-1;for(let o=0;o<e.length;o++){let l=e[o];if(l.from<=t&&l.to>=t){if(l.level==n)return o;(s<0||(r!=0?r<0?l.from<t:l.to>t:e[s].level>l.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}}function aS(i,e){if(i.length!=e.length)return!1;for(let t=0;t<i.length;t++){let n=i[t],r=e[t];if(n.from!=r.from||n.to!=r.to||n.direction!=r.direction||!aS(n.inner,r.inner))return!1}return!0}const oe=[];function CA(i,e,t,n,r){for(let s=0;s<=n.length;s++){let o=s?n[s-1].to:e,l=s<n.length?n[s].from:t,a=s?256:r;for(let h=o,c=a,f=a;h<l;h++){let u=lS(i.charCodeAt(h));u==512?u=c:u==8&&f==4&&(u=16),oe[h]=u==4?2:u,u&7&&(f=u),c=u}for(let h=o,c=a,f=a;h<l;h++){let u=oe[h];if(u==128)h<l-1&&c==oe[h+1]&&c&24?u=oe[h]=c:oe[h]=256;else if(u==64){let d=h+1;for(;d<l&&oe[d]==64;)d++;let p=h&&c==8||d<t&&oe[d]==8?f==1?1:8:256;for(let m=h;m<d;m++)oe[m]=p;h=d-1}else u==8&&f==1&&(oe[h]=1);c=u,u&7&&(f=u)}}}function TA(i,e,t,n,r){let s=r==1?2:1;for(let o=0,l=0,a=0;o<=n.length;o++){let h=o?n[o-1].to:e,c=o<n.length?n[o].from:t;for(let f=h,u,d,p;f<c;f++)if(d=bd[u=i.charCodeAt(f)])if(d<0){for(let m=l-3;m>=0;m-=3)if(Sn[m+1]==-d){let g=Sn[m+2],y=g&2?r:g&4?g&1?s:r:0;y&&(oe[f]=oe[Sn[m]]=y),l=m;break}}else{if(Sn.length==189)break;Sn[l++]=f,Sn[l++]=u,Sn[l++]=a}else if((p=oe[f])==2||p==1){let m=p==r;a=m?0:1;for(let g=l-3;g>=0;g-=3){let y=Sn[g+2];if(y&2)break;if(m)Sn[g+2]|=2;else{if(y&4)break;Sn[g+2]|=4}}}}}function MA(i,e,t,n){for(let r=0,s=n;r<=t.length;r++){let o=r?t[r-1].to:i,l=r<t.length?t[r].from:e;for(let a=o;a<l;){let h=oe[a];if(h==256){let c=a+1;for(;;)if(c==l){if(r==t.length)break;c=t[r++].to,l=r<t.length?t[r].from:e}else if(oe[c]==256)c++;else break;let f=s==1,u=(c<e?oe[c]:n)==1,d=f==u?f?1:2:n;for(let p=c,m=r,g=m?t[m-1].to:i;p>a;)p==g&&(p=t[--m].from,g=m?t[m-1].to:i),oe[--p]=d;a=c}else s=h,a++}}}function Sd(i,e,t,n,r,s,o){let l=n%2?2:1;if(n%2==r%2)for(let a=e,h=0;a<t;){let c=!0,f=!1;if(h==s.length||a<s[h].from){let m=oe[a];m!=l&&(c=!1,f=m==16)}let u=!c&&l==1?[]:null,d=c?n:n+1,p=a;e:for(;;)if(h<s.length&&p==s[h].from){if(f)break e;let m=s[h];if(!c)for(let g=m.to,y=h+1;;){if(g==t)break e;if(y<s.length&&s[y].from==g)g=s[y++].to;else{if(oe[g]==l)break e;break}}if(h++,u)u.push(m);else{m.from>a&&o.push(new Ni(a,m.from,d));let g=m.direction==Xr!=!(d%2);wd(i,g?n+1:n,r,m.inner,m.from,m.to,o),a=m.to}p=m.to}else{if(p==t||(c?oe[p]!=l:oe[p]==l))break;p++}u?Sd(i,a,p,n+1,r,u,o):a<p&&o.push(new Ni(a,p,d)),a=p}else for(let a=t,h=s.length;a>e;){let c=!0,f=!1;if(!h||a>s[h-1].to){let m=oe[a-1];m!=l&&(c=!1,f=m==16)}let u=!c&&l==1?[]:null,d=c?n:n+1,p=a;e:for(;;)if(h&&p==s[h-1].to){if(f)break e;let m=s[--h];if(!c)for(let g=m.from,y=h;;){if(g==e)break e;if(y&&s[y-1].to==g)g=s[--y].from;else{if(oe[g-1]==l)break e;break}}if(u)u.push(m);else{m.to<a&&o.push(new Ni(m.to,a,d));let g=m.direction==Xr!=!(d%2);wd(i,g?n+1:n,r,m.inner,m.from,m.to,o),a=m.from}p=m.from}else{if(p==e||(c?oe[p-1]!=l:oe[p-1]==l))break;p--}u?Sd(i,p,a,n+1,r,u,o):p<a&&o.push(new Ni(p,a,d)),a=p}}function wd(i,e,t,n,r,s,o){let l=e%2?2:1;CA(i,r,s,n,l),TA(i,r,s,n,l),MA(r,s,n,l),Sd(i,r,s,e,t,n,o)}function AA(i,e,t){if(!i)return[new Ni(0,0,e==Yp?1:0)];if(e==Xr&&!t.length&&!QA.test(i))return hS(i.length);if(t.length)for(;i.length>oe.length;)oe[oe.length]=256;let n=[],r=e==Xr?0:1;return wd(i,r,r,t,0,i.length,n),n}function hS(i){return[new Ni(0,i,0)]}let cS="";function ZA(i,e,t,n,r){var s;let o=n.head-i.from,l=Ni.find(e,o,(s=n.bidiLevel)!==null&&s!==void 0?s:-1,n.assoc),a=e[l],h=a.side(r,t);if(o==h){let u=l+=r?1:-1;if(u<0||u>=e.length)return null;a=e[l=u],o=a.side(!r,t),h=a.side(r,t)}let c=_e(i.text,o,a.forward(r,t));(c<a.from||c>a.to)&&(c=h),cS=i.text.slice(Math.min(o,c),Math.max(o,c));let f=l==(r?e.length-1:0)?null:e[l+(r?1:-1)];return f&&c==h&&f.level+(r?0:1)<a.level?b.cursor(f.side(!r,t)+i.from,f.forward(r,t)?1:-1,f.level):b.cursor(c+i.from,a.forward(r,t)?-1:1,a.level)}function RA(i,e,t){for(let n=e;n<t;n++){let r=lS(i.charCodeAt(n));if(r==1)return Xr;if(r==2||r==4)return Yp}return Xr}const fS=R.define(),uS=R.define(),dS=R.define(),pS=R.define(),xd=R.define(),mS=R.define(),gS=R.define(),OS=R.define({combine:i=>i.some(e=>e)}),yS=R.define({combine:i=>i.some(e=>e)}),kS=R.define();class $s{constructor(e,t="nearest",n="nearest",r=5,s=5,o=!1){this.range=e,this.y=t,this.x=n,this.yMargin=r,this.xMargin=s,this.isSnapshot=o}map(e){return e.empty?this:new $s(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new $s(b.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const ka=q.define({map:(i,e)=>i.map(e)});function lt(i,e,t){let n=i.facet(pS);n.length?n[0](e):window.onerror?window.onerror(String(e),t,void 0,void 0,e):t?console.error(t+":",e):console.error(e)}const Ic=R.define({combine:i=>i.length?i[0]:!0});let EA=0;const qo=R.define();class ve{constructor(e,t,n,r,s){this.id=e,this.create=t,this.domEventHandlers=n,this.domEventObservers=r,this.extension=s(this)}static define(e,t){const{eventHandlers:n,eventObservers:r,provide:s,decorations:o}=t||{};return new ve(EA++,e,n,r,l=>{let a=[qo.of(l)];return o&&a.push(Pl.of(h=>{let c=h.plugin(l);return c?o(c):I.none})),s&&a.push(s(l)),a})}static fromClass(e,t){return ve.define(n=>new e(n),t)}}class Wf{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(n){if(lt(t.state,n,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(t){lt(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(n){lt(e.state,n,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const bS=R.define(),jp=R.define(),Pl=R.define(),SS=R.define(),_p=R.define(),wS=R.define();function jO(i,e){let t=i.state.facet(wS);if(!t.length)return t;let n=t.map(s=>s instanceof Function?s(i):s),r=[];return H.spans(n,e.from,e.to,{point(){},span(s,o,l,a){let h=s-e.from,c=o-e.from,f=r;for(let u=l.length-1;u>=0;u--,a--){let d=l[u].spec.bidiIsolate,p;if(d==null&&(d=RA(e.text,h,c)),a>0&&f.length&&(p=f[f.length-1]).to==h&&p.direction==d)p.to=c,f=p.inner;else{let m={from:h,to:c,direction:d,inner:[]};f.push(m),f=m.inner}}}}),r}const xS=R.define();function vS(i){let e=0,t=0,n=0,r=0;for(let s of i.state.facet(xS)){let o=s(i);o&&(o.left!=null&&(e=Math.max(e,o.left)),o.right!=null&&(t=Math.max(t,o.right)),o.top!=null&&(n=Math.max(n,o.top)),o.bottom!=null&&(r=Math.max(r,o.bottom)))}return{left:e,right:t,top:n,bottom:r}}const Lo=R.define();class Ut{constructor(e,t,n,r){this.fromA=e,this.toA=t,this.fromB=n,this.toB=r}join(e){return new Ut(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,n=this;for(;t>0;t--){let r=e[t-1];if(!(r.fromA>n.toA)){if(r.toA<n.fromA)break;n=n.join(r),e.splice(t-1,1)}}return e.splice(t,0,n),e}static extendWithRanges(e,t){if(t.length==0)return e;let n=[];for(let r=0,s=0,o=0,l=0;;r++){let a=r==e.length?null:e[r],h=o-l,c=a?a.fromB:1e9;for(;s<t.length&&t[s]<c;){let f=t[s],u=t[s+1],d=Math.max(l,f),p=Math.min(c,u);if(d<=p&&new Ut(d+h,p+h,d,p).addToSet(n),u>c)break;s+=2}if(!a)return n;new Ut(a.fromA,a.toA,a.fromB,a.toB).addToSet(n),o=a.toA,l=a.toB}}}class Uh{constructor(e,t,n){this.view=e,this.state=t,this.transactions=n,this.flags=0,this.startState=e.state,this.changes=Ne.empty(this.startState.doc.length);for(let s of n)this.changes=this.changes.compose(s.changes);let r=[];this.changes.iterChangedRanges((s,o,l,a)=>r.push(new Ut(s,o,l,a))),this.changedRanges=r}static create(e,t,n){return new Uh(e,t,n)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class _O extends le{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new Ee],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Ut(0,0,0,e.state.doc.length)],0,null)}update(e){var t;let n=e.changedRanges;this.minWidth>0&&n.length&&(n.every(({fromA:h,toA:c})=>c<this.minWidthFrom||h>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0);let r=-1;this.view.inputState.composing>=0&&(!((t=this.domChanged)===null||t===void 0)&&t.newSel?r=this.domChanged.newSel.head:!VA(e.changes,this.hasComposition)&&!e.selectionSet&&(r=e.state.selection.main.head));let s=r>-1?DA(this.view,e.changes,r):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:h,to:c}=this.hasComposition;n=new Ut(h,c,e.changes.mapPos(h,-1),e.changes.mapPos(c,1)).addToSet(n.slice())}this.hasComposition=s?{from:s.range.fromB,to:s.range.toB}:null,(E.ie||E.chrome)&&!s&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let o=this.decorations,l=this.updateDeco(),a=XA(o,l,e.changes);return n=Ut.extendWithRanges(n,a),!(this.flags&7)&&n.length==0?!1:(this.updateInner(n,e.startState.doc.length,s),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t,n){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t,n);let{observer:r}=this.view;r.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let o=E.chrome||E.ios?{node:r.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,o),this.flags&=-8,o&&(o.written||r.selectionRange.focusNode!=o.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(o=>o.flags&=-9);let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let o of this.children)o instanceof Li&&o.widget instanceof FO&&s.push(o.dom);r.updateGaps(s)}updateChildren(e,t,n){let r=n?n.range.addToSet(e.slice()):e,s=this.childCursor(t);for(let o=r.length-1;;o--){let l=o>=0?r[o]:null;if(!l)break;let{fromA:a,toA:h,fromB:c,toB:f}=l,u,d,p,m;if(n&&n.range.fromB<f&&n.range.toB>c){let $=ll.build(this.view.state.doc,c,n.range.fromB,this.decorations,this.dynamicDecorationMap),S=ll.build(this.view.state.doc,n.range.toB,f,this.decorations,this.dynamicDecorationMap);d=$.breakAtStart,p=$.openStart,m=S.openEnd;let x=this.compositionView(n);S.breakAtStart?x.breakAfter=1:S.content.length&&x.merge(x.length,x.length,S.content[0],!1,S.openStart,0)&&(x.breakAfter=S.content[0].breakAfter,S.content.shift()),$.content.length&&x.merge(0,0,$.content[$.content.length-1],!0,0,$.openEnd)&&$.content.pop(),u=$.content.concat(x).concat(S.content)}else({content:u,breakAtStart:d,openStart:p,openEnd:m}=ll.build(this.view.state.doc,c,f,this.decorations,this.dynamicDecorationMap));let{i:g,off:y}=s.findPos(h,1),{i:k,off:v}=s.findPos(a,-1);Kb(this,k,v,g,y,u,d,p,m)}n&&this.fixCompositionDOM(n)}compositionView(e){let t=new pn(e.text.nodeValue);t.flags|=8;for(let{deco:r}of e.marks)t=new ci(r,[t],t.length);let n=new Ee;return n.append(t,0),n}fixCompositionDOM(e){let t=(s,o)=>{o.flags|=8|(o.children.some(a=>a.flags&7)?1:0),this.markedForComposition.add(o);let l=le.get(s);l&&l!=o&&(l.dom=null),o.setDOM(s)},n=this.childPos(e.range.fromB,1),r=this.children[n.i];t(e.line,r);for(let s=e.marks.length-1;s>=-1;s--)n=r.childPos(n.off,1),r=r.children[n.i],t(s>=0?e.marks[s].node:e.text,r)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let n=this.view.root.activeElement,r=n==this.dom,s=!r&&kh(this.dom,this.view.observer.selectionRange)&&!(n&&this.dom.contains(n));if(!(r||t||s))return;let o=this.forceSelection;this.forceSelection=!1;let l=this.view.state.selection.main,a=this.moveToLine(this.domAtPos(l.anchor)),h=l.empty?a:this.moveToLine(this.domAtPos(l.head));if(E.gecko&&l.empty&&!this.hasComposition&&NA(a)){let f=document.createTextNode("");this.view.observer.ignore(()=>a.node.insertBefore(f,a.node.childNodes[a.offset]||null)),a=h=new Ge(f,0),o=!0}let c=this.view.observer.selectionRange;(o||!c.focusNode||(!ol(a.node,a.offset,c.anchorNode,c.anchorOffset)||!ol(h.node,h.offset,c.focusNode,c.focusOffset))&&!this.suppressWidgetCursorChange(c,l))&&(this.view.observer.ignore(()=>{E.android&&E.chrome&&this.dom.contains(c.focusNode)&&BA(c.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let f=_h(this.view.root);if(f)if(l.empty){if(E.gecko){let u=IA(a.node,a.offset);if(u&&u!=3){let d=(u==1?Ub:Gb)(a.node,a.offset);d&&(a=new Ge(d.node,d.offset))}}f.collapse(a.node,a.offset),l.bidiLevel!=null&&f.caretBidiLevel!==void 0&&(f.caretBidiLevel=l.bidiLevel)}else if(f.extend){f.collapse(a.node,a.offset);try{f.extend(h.node,h.offset)}catch{}}else{let u=document.createRange();l.anchor>l.head&&([a,h]=[h,a]),u.setEnd(h.node,h.offset),u.setStart(a.node,a.offset),f.removeAllRanges(),f.addRange(u)}s&&this.view.root.activeElement==this.dom&&(this.dom.blur(),n&&n.focus())}),this.view.observer.setSelectionRange(a,h)),this.impreciseAnchor=a.precise?null:new Ge(c.anchorNode,c.anchorOffset),this.impreciseHead=h.precise?null:new Ge(c.focusNode,c.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&ol(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,n=_h(e.root),{anchorNode:r,anchorOffset:s}=e.observer.selectionRange;if(!n||!t.empty||!t.assoc||!n.modify)return;let o=Ee.find(this,t.head);if(!o)return;let l=o.posAtStart;if(t.head==l||t.head==l+o.length)return;let a=this.coordsAt(t.head,-1),h=this.coordsAt(t.head,1);if(!a||!h||a.bottom>h.top)return;let c=this.domAtPos(t.head+t.assoc);n.collapse(c.node,c.offset),n.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let f=e.observer.selectionRange;e.docView.posFromDOM(f.anchorNode,f.anchorOffset)!=t.from&&n.collapse(r,s)}moveToLine(e){let t=this.dom,n;if(e.node!=t)return e;for(let r=e.offset;!n&&r<t.childNodes.length;r++){let s=le.get(t.childNodes[r]);s instanceof Ee&&(n=s.domAtPos(0))}for(let r=e.offset-1;!n&&r>=0;r--){let s=le.get(t.childNodes[r]);s instanceof Ee&&(n=s.domAtPos(s.length))}return n?new Ge(n.node,n.offset,!0):e}nearest(e){for(let t=e;t;){let n=le.get(t);if(n&&n.rootView==this)return n;t=t.parentNode}return null}posFromDOM(e,t){let n=this.nearest(e);if(!n)throw new RangeError("Trying to find position for a DOM position outside of the document");return n.localPosFromDOM(e,t)+n.posAtStart}domAtPos(e){let{i:t,off:n}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let r=this.children[t];if(n<r.length||r instanceof Ee)break;t++,n=0}return this.children[t].domAtPos(n)}coordsAt(e,t){let n=null,r=0;for(let s=this.length,o=this.children.length-1;o>=0;o--){let l=this.children[o],a=s-l.breakAfter,h=a-l.length;if(a<e)break;h<=e&&(h<e||l.covers(-1))&&(a>e||l.covers(1))&&(!n||l instanceof Ee&&!(n instanceof Ee&&t>=0))&&(n=l,r=h),s=h}return n?n.coordsAt(e-r,t):null}coordsForChar(e){let{i:t,off:n}=this.childPos(e,1),r=this.children[t];if(!(r instanceof Ee))return null;for(;r.children.length;){let{i:l,off:a}=r.childPos(n,1);for(;;l++){if(l==r.children.length)return null;if((r=r.children[l]).length)break}n=a}if(!(r instanceof pn))return null;let s=_e(r.text,n);if(s==n)return null;let o=Wr(r.dom,n,s).getClientRects();for(let l=0;l<o.length;l++){let a=o[l];if(l==o.length-1||a.top<a.bottom&&a.left<a.right)return a}return null}measureVisibleLineHeights(e){let t=[],{from:n,to:r}=e,s=this.view.contentDOM.clientWidth,o=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,l=-1,a=this.view.textDirection==ge.LTR;for(let h=0,c=0;c<this.children.length;c++){let f=this.children[c],u=h+f.length;if(u>r)break;if(h>=n){let d=f.dom.getBoundingClientRect();if(t.push(d.height),o){let p=f.dom.lastChild,m=p?Is(p):[];if(m.length){let g=m[m.length-1],y=a?g.right-d.left:d.right-g.left;y>l&&(l=y,this.minWidth=s,this.minWidthFrom=h,this.minWidthTo=u)}}}h=u+f.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return getComputedStyle(this.children[t].dom).direction=="rtl"?ge.RTL:ge.LTR}measureTextSize(){for(let s of this.children)if(s instanceof Ee){let o=s.measureTextSize();if(o)return o}let e=document.createElement("div"),t,n,r;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let s=Is(e.firstChild)[0];t=e.getBoundingClientRect().height,n=s?s.width/27:7,r=s?s.height:t,e.remove()}),{lineHeight:t,charWidth:n,textHeight:r}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new Hb(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let n=0,r=0;;r++){let s=r==t.viewports.length?null:t.viewports[r],o=s?s.from-1:this.length;if(o>n){let l=(t.lineBlockAt(o).bottom-t.lineBlockAt(n).top)/this.view.scaleY;e.push(I.replace({widget:new FO(l),block:!0,inclusive:!0,isBlockGap:!0}).range(n,o))}if(!s)break;n=s.to+1}return I.set(e)}updateDeco(){let e=0,t=this.view.state.facet(Pl).map(s=>(this.dynamicDecorationMap[e++]=typeof s=="function")?s(this.view):s),n=!1,r=this.view.state.facet(SS).map((s,o)=>{let l=typeof s=="function";return l&&(n=!0),l?s(this.view):s});for(r.length&&(this.dynamicDecorationMap[e++]=n,t.push(H.join(r))),this.decorations=[...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let h=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=h.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let h of this.view.state.facet(kS))try{if(h(this.view,e.range,e))return!0}catch(c){lt(this.view.state,c,"scroll handler")}let{range:t}=e,n=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),r;if(!n)return;!t.empty&&(r=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(n={left:Math.min(n.left,r.left),top:Math.min(n.top,r.top),right:Math.max(n.right,r.right),bottom:Math.max(n.bottom,r.bottom)});let s=vS(this.view),o={left:n.left-s.left,top:n.top-s.top,right:n.right+s.right,bottom:n.bottom+s.bottom},{offsetWidth:l,offsetHeight:a}=this.view.scrollDOM;mA(this.view.scrollDOM,o,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,l),-l),Math.max(Math.min(e.yMargin,a),-a),this.view.textDirection==ge.LTR)}}function NA(i){return i.node.nodeType==1&&i.node.firstChild&&(i.offset==0||i.node.childNodes[i.offset-1].contentEditable=="false")&&(i.offset==i.node.childNodes.length||i.node.childNodes[i.offset].contentEditable=="false")}class FO extends _n{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}function $S(i,e){let t=i.observer.selectionRange;if(!t.focusNode)return null;let n=Ub(t.focusNode,t.focusOffset),r=Gb(t.focusNode,t.focusOffset),s=n||r;if(r&&n&&r.node!=n.node){let l=le.get(r.node);if(!l||l instanceof pn&&l.text!=r.node.nodeValue)s=r;else if(i.docView.lastCompositionAfterCursor){let a=le.get(n.node);!a||a instanceof pn&&a.text!=n.node.nodeValue||(s=r)}}if(i.docView.lastCompositionAfterCursor=s!=n,!s)return null;let o=e-s.offset;return{from:o,to:o+s.node.nodeValue.length,node:s.node}}function DA(i,e,t){let n=$S(i,t);if(!n)return null;let{node:r,from:s,to:o}=n,l=r.nodeValue;if(/[\n\r]/.test(l)||i.state.doc.sliceString(n.from,n.to)!=l)return null;let a=e.invertedDesc,h=new Ut(a.mapPos(s),a.mapPos(o),s,o),c=[];for(let f=r.parentNode;;f=f.parentNode){let u=le.get(f);if(u instanceof ci)c.push({node:f,deco:u.mark});else{if(u instanceof Ee||f.nodeName=="DIV"&&f.parentNode==i.contentDOM)return{range:h,text:r,marks:c,line:f};if(f!=i.contentDOM)c.push({node:f,deco:new Gl({inclusive:!0,attributes:xA(f),tagName:f.tagName.toLowerCase()})});else return null}}}function IA(i,e){return i.nodeType!=1?0:(e&&i.childNodes[e-1].contentEditable=="false"?1:0)|(e<i.childNodes.length&&i.childNodes[e].contentEditable=="false"?2:0)}let WA=class{constructor(){this.changes=[]}compareRange(e,t){kd(e,t,this.changes)}comparePoint(e,t){kd(e,t,this.changes)}};function XA(i,e,t){let n=new WA;return H.compare(i,e,t,n),n.changes}function BA(i,e){for(let t=i;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function VA(i,e){let t=!1;return e&&i.iterChangedRanges((n,r)=>{n<e.to&&r>e.from&&(t=!0)}),t}function qA(i,e,t=1){let n=i.charCategorizer(e),r=i.doc.lineAt(e),s=e-r.from;if(r.length==0)return b.cursor(e);s==0?t=1:s==r.length&&(t=-1);let o=s,l=s;t<0?o=_e(r.text,s,!1):l=_e(r.text,s);let a=n(r.text.slice(o,l));for(;o>0;){let h=_e(r.text,o,!1);if(n(r.text.slice(h,o))!=a)break;o=h}for(;l<r.length;){let h=_e(r.text,l);if(n(r.text.slice(l,h))!=a)break;l=h}return b.range(o+r.from,l+r.from)}function LA(i,e){return e.left>i?e.left-i:Math.max(0,i-e.right)}function zA(i,e){return e.top>i?e.top-i:Math.max(0,i-e.bottom)}function Xf(i,e){return i.top<e.bottom-1&&i.bottom>e.top+1}function UO(i,e){return e<i.top?{top:e,left:i.left,right:i.right,bottom:i.bottom}:i}function GO(i,e){return e>i.bottom?{top:i.top,left:i.left,right:i.right,bottom:e}:i}function vd(i,e,t){let n,r,s,o,l=!1,a,h,c,f;for(let p=i.firstChild;p;p=p.nextSibling){let m=Is(p);for(let g=0;g<m.length;g++){let y=m[g];r&&Xf(r,y)&&(y=UO(GO(y,r.bottom),r.top));let k=LA(e,y),v=zA(t,y);if(k==0&&v==0)return p.nodeType==3?HO(p,e,t):vd(p,e,t);if(!n||o>v||o==v&&s>k){n=p,r=y,s=k,o=v;let $=v?t<y.top?-1:1:k?e<y.left?-1:1:0;l=!$||($>0?g<m.length-1:g>0)}k==0?t>y.bottom&&(!c||c.bottom<y.bottom)?(a=p,c=y):t<y.top&&(!f||f.top>y.top)&&(h=p,f=y):c&&Xf(c,y)?c=GO(c,y.bottom):f&&Xf(f,y)&&(f=UO(f,y.top))}}if(c&&c.bottom>=t?(n=a,r=c):f&&f.top<=t&&(n=h,r=f),!n)return{node:i,offset:0};let u=Math.max(r.left,Math.min(r.right,e));if(n.nodeType==3)return HO(n,u,t);if(l&&n.contentEditable!="false")return vd(n,u,t);let d=Array.prototype.indexOf.call(i.childNodes,n)+(e>=(r.left+r.right)/2?1:0);return{node:i,offset:d}}function HO(i,e,t){let n=i.nodeValue.length,r=-1,s=1e9,o=0;for(let l=0;l<n;l++){let a=Wr(i,l,l+1).getClientRects();for(let h=0;h<a.length;h++){let c=a[h];if(c.top==c.bottom)continue;o||(o=e-c.left);let f=(c.top>t?c.top-t:t-c.bottom)-1;if(c.left-1<=e&&c.right+1>=e&&f<s){let u=e>=(c.left+c.right)/2,d=u;if((E.chrome||E.gecko)&&Wr(i,l).getBoundingClientRect().left==c.right&&(d=!u),f<=0)return{node:i,offset:l+(d?1:0)};r=l+(d?1:0),s=f}}}return{node:i,offset:r>-1?r:o>0?i.nodeValue.length:0}}function PS(i,e,t,n=-1){var r,s;let o=i.contentDOM.getBoundingClientRect(),l=o.top+i.viewState.paddingTop,a,{docHeight:h}=i.viewState,{x:c,y:f}=e,u=f-l;if(u<0)return 0;if(u>h)return i.state.doc.length;for(let $=i.viewState.heightOracle.textHeight/2,S=!1;a=i.elementAtHeight(u),a.type!=at.Text;)for(;u=n>0?a.bottom+$:a.top-$,!(u>=0&&u<=h);){if(S)return t?null:0;S=!0,n=-n}f=l+u;let d=a.from;if(d<i.viewport.from)return i.viewport.from==0?0:t?null:KO(i,o,a,c,f);if(d>i.viewport.to)return i.viewport.to==i.state.doc.length?i.state.doc.length:t?null:KO(i,o,a,c,f);let p=i.dom.ownerDocument,m=i.root.elementFromPoint?i.root:p,g=m.elementFromPoint(c,f);g&&!i.contentDOM.contains(g)&&(g=null),g||(c=Math.max(o.left+1,Math.min(o.right-1,c)),g=m.elementFromPoint(c,f),g&&!i.contentDOM.contains(g)&&(g=null));let y,k=-1;if(g&&((r=i.docView.nearest(g))===null||r===void 0?void 0:r.isEditable)!=!1){if(p.caretPositionFromPoint){let $=p.caretPositionFromPoint(c,f);$&&({offsetNode:y,offset:k}=$)}else if(p.caretRangeFromPoint){let $=p.caretRangeFromPoint(c,f);$&&({startContainer:y,startOffset:k}=$,(!i.contentDOM.contains(y)||E.safari&&YA(y,k,c)||E.chrome&&jA(y,k,c))&&(y=void 0))}}if(!y||!i.docView.dom.contains(y)){let $=Ee.find(i.docView,d);if(!$)return u>a.top+a.height/2?a.to:a.from;({node:y,offset:k}=vd($.dom,c,f))}let v=i.docView.nearest(y);if(!v)return null;if(v.isWidget&&((s=v.dom)===null||s===void 0?void 0:s.nodeType)==1){let $=v.dom.getBoundingClientRect();return e.y<$.top||e.y<=$.bottom&&e.x<=($.left+$.right)/2?v.posAtStart:v.posAtEnd}else return v.localPosFromDOM(y,k)+v.posAtStart}function KO(i,e,t,n,r){let s=Math.round((n-e.left)*i.defaultCharacterWidth);if(i.lineWrapping&&t.height>i.defaultLineHeight*1.5){let l=i.viewState.heightOracle.textHeight,a=Math.floor((r-t.top-(i.defaultLineHeight-l)*.5)/l);s+=a*i.viewState.heightOracle.lineLength}let o=i.state.sliceDoc(t.from,t.to);return t.from+cd(o,s,i.state.tabSize)}function YA(i,e,t){let n;if(i.nodeType!=3||e!=(n=i.nodeValue.length))return!1;for(let r=i.nextSibling;r;r=r.nextSibling)if(r.nodeType!=1||r.nodeName!="BR")return!1;return Wr(i,n-1,n).getBoundingClientRect().left>t}function jA(i,e,t){if(e!=0)return!1;for(let r=i;;){let s=r.parentNode;if(!s||s.nodeType!=1||s.firstChild!=r)return!1;if(s.classList.contains("cm-line"))break;r=s}let n=i.nodeType==1?i.getBoundingClientRect():Wr(i,0,Math.max(i.nodeValue.length,1)).getBoundingClientRect();return t-n.left>5}function $d(i,e){let t=i.lineBlockAt(e);if(Array.isArray(t.type)){for(let n of t.type)if(n.to>e||n.to==e&&(n.to==t.to||n.type==at.Text))return n}return t}function _A(i,e,t,n){let r=$d(i,e.head),s=!n||r.type!=at.Text||!(i.lineWrapping||r.widgetLineBreaks)?null:i.coordsAtPos(e.assoc<0&&e.head>r.from?e.head-1:e.head);if(s){let o=i.dom.getBoundingClientRect(),l=i.textDirectionAt(r.from),a=i.posAtCoords({x:t==(l==ge.LTR)?o.right-1:o.left+1,y:(s.top+s.bottom)/2});if(a!=null)return b.cursor(a,t?-1:1)}return b.cursor(t?r.to:r.from,t?-1:1)}function JO(i,e,t,n){let r=i.state.doc.lineAt(e.head),s=i.bidiSpans(r),o=i.textDirectionAt(r.from);for(let l=e,a=null;;){let h=ZA(r,s,o,l,t),c=cS;if(!h){if(r.number==(t?i.state.doc.lines:1))return l;c=`
`,r=i.state.doc.line(r.number+(t?1:-1)),s=i.bidiSpans(r),h=i.visualLineSide(r,!t)}if(a){if(!a(c))return l}else{if(!n)return h;a=n(c)}l=h}}function FA(i,e,t){let n=i.state.charCategorizer(e),r=n(t);return s=>{let o=n(s);return r==ke.Space&&(r=o),r==o}}function UA(i,e,t,n){let r=e.head,s=t?1:-1;if(r==(t?i.state.doc.length:0))return b.cursor(r,e.assoc);let o=e.goalColumn,l,a=i.contentDOM.getBoundingClientRect(),h=i.coordsAtPos(r,e.assoc||-1),c=i.documentTop;if(h)o==null&&(o=h.left-a.left),l=s<0?h.top:h.bottom;else{let d=i.viewState.lineBlockAt(r);o==null&&(o=Math.min(a.right-a.left,i.defaultCharacterWidth*(r-d.from))),l=(s<0?d.top:d.bottom)+c}let f=a.left+o,u=n??i.viewState.heightOracle.textHeight>>1;for(let d=0;;d+=10){let p=l+(u+d)*s,m=PS(i,{x:f,y:p},!1,s);if(p<a.top||p>a.bottom||(s<0?m<r:m>r)){let g=i.docView.coordsForChar(m),y=!g||p<g.top?-1:1;return b.cursor(m,y,void 0,o)}}}function bh(i,e,t){for(;;){let n=0;for(let r of i)r.between(e-1,e+1,(s,o,l)=>{if(e>s&&e<o){let a=n||t||(e-s<o-e?-1:1);e=a<0?s:o,n=a}});if(!n)return e}}function Bf(i,e,t){let n=bh(i.state.facet(_p).map(r=>r(i)),t.from,e.head>t.from?-1:1);return n==t.from?t:b.cursor(n,n<t.from?1:-1)}class GA{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,E.safari&&e.contentDOM.addEventListener("input",()=>null),E.gecko&&uZ(e.contentDOM.ownerDocument)}handleEvent(e){!rZ(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||this.runHandlers(e.type,e)}runHandlers(e,t){let n=this.handlers[e];if(n){for(let r of n.observers)r(this.view,t);for(let r of n.handlers){if(t.defaultPrevented)break;if(r(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=HA(e),n=this.handlers,r=this.view.contentDOM;for(let s in t)if(s!="scroll"){let o=!t[s].handlers.length,l=n[s];l&&o!=!l.handlers.length&&(r.removeEventListener(s,this.handleEvent),l=null),l||r.addEventListener(s,this.handleEvent,{passive:o})}for(let s in n)s!="scroll"&&!t[s]&&r.removeEventListener(s,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&Date.now()<this.lastEscPress+2e3)return!0;if(e.keyCode!=27&&CS.indexOf(e.keyCode)<0&&(this.view.inputState.lastEscPress=0),E.android&&E.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return E.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=QS.find(n=>n.keyCode==e.keyCode))&&!e.ctrlKey||KA.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let t=this.pendingIOSKey;return!t||t.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,vs(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0))}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:E.safari&&!E.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function e0(i,e){return(t,n)=>{try{return e.call(i,n,t)}catch(r){lt(t.state,r)}}}function HA(i){let e=Object.create(null);function t(n){return e[n]||(e[n]={observers:[],handlers:[]})}for(let n of i){let r=n.spec;if(r&&r.domEventHandlers)for(let s in r.domEventHandlers){let o=r.domEventHandlers[s];o&&t(s).handlers.push(e0(n.value,o))}if(r&&r.domEventObservers)for(let s in r.domEventObservers){let o=r.domEventObservers[s];o&&t(s).observers.push(e0(n.value,o))}}for(let n in mn)t(n).handlers.push(mn[n]);for(let n in Gt)t(n).observers.push(Gt[n]);return e}const QS=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],KA="dthko",CS=[16,17,18,20,91,92,224,225],ba=6;function Sa(i){return Math.max(0,i)*.7+8}function JA(i,e){return Math.max(Math.abs(i.clientX-e.clientX),Math.abs(i.clientY-e.clientY))}class eZ{constructor(e,t,n,r){this.view=e,this.startEvent=t,this.style=n,this.mustSelect=r,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParent=gA(e.contentDOM),this.atoms=e.state.facet(_p).map(o=>o(e));let s=e.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(j.allowMultipleSelections)&&tZ(e,t),this.dragging=iZ(e,t)&&ZS(t)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){var t;if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&JA(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let n=0,r=0,s=((t=this.scrollParent)===null||t===void 0?void 0:t.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight},o=vS(this.view);e.clientX-o.left<=s.left+ba?n=-Sa(s.left-e.clientX):e.clientX+o.right>=s.right-ba&&(n=Sa(e.clientX-s.right)),e.clientY-o.top<=s.top+ba?r=-Sa(s.top-e.clientY):e.clientY+o.bottom>=s.bottom-ba&&(r=Sa(e.clientY-s.bottom)),this.setScrollSpeed(n,r)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){this.scrollParent?(this.scrollParent.scrollLeft+=this.scrollSpeed.x,this.scrollParent.scrollTop+=this.scrollSpeed.y):this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let t=null;for(let n=0;n<e.ranges.length;n++){let r=e.ranges[n],s=null;if(r.empty){let o=bh(this.atoms,r.from,0);o!=r.from&&(s=b.cursor(o,-1))}else{let o=bh(this.atoms,r.from,-1),l=bh(this.atoms,r.to,1);(o!=r.from||l!=r.to)&&(s=b.range(r.from==r.anchor?o:l,r.from==r.head?o:l))}s&&(t||(t=e.ranges.slice()),t[n]=s)}return t?b.create(t,e.mainIndex):e}select(e){let{view:t}=this,n=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!n.eq(t.state.selection,this.dragging===!1))&&this.view.dispatch({selection:n,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function tZ(i,e){let t=i.state.facet(fS);return t.length?t[0](e):E.mac?e.metaKey:e.ctrlKey}function nZ(i,e){let t=i.state.facet(uS);return t.length?t[0](e):E.mac?!e.altKey:!e.ctrlKey}function iZ(i,e){let{main:t}=i.state.selection;if(t.empty)return!1;let n=_h(i.root);if(!n||n.rangeCount==0)return!0;let r=n.getRangeAt(0).getClientRects();for(let s=0;s<r.length;s++){let o=r[s];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}function rZ(i,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,n;t!=i.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(n=le.get(t))&&n.ignoreEvent(e))return!1;return!0}const mn=Object.create(null),Gt=Object.create(null),TS=E.ie&&E.ie_version<15||E.ios&&E.webkit_version<604;function sZ(i){let e=i.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{i.focus(),t.remove(),MS(i,t.value)},50)}function MS(i,e){let{state:t}=i,n,r=1,s=t.toText(e),o=s.lines==t.selection.ranges.length;if(Pd!=null&&t.selection.ranges.every(a=>a.empty)&&Pd==s.toString()){let a=-1;n=t.changeByRange(h=>{let c=t.doc.lineAt(h.from);if(c.from==a)return{range:h};a=c.from;let f=t.toText((o?s.line(r++).text:e)+t.lineBreak);return{changes:{from:c.from,insert:f},range:b.cursor(h.from+f.length)}})}else o?n=t.changeByRange(a=>{let h=s.line(r++);return{changes:{from:a.from,to:a.to,insert:h.text},range:b.cursor(a.from+h.length)}}):n=t.replaceSelection(s);i.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0})}Gt.scroll=i=>{i.inputState.lastScrollTop=i.scrollDOM.scrollTop,i.inputState.lastScrollLeft=i.scrollDOM.scrollLeft};mn.keydown=(i,e)=>(i.inputState.setSelectionOrigin("select"),e.keyCode==27&&(i.inputState.lastEscPress=Date.now()),!1);Gt.touchstart=(i,e)=>{i.inputState.lastTouchTime=Date.now(),i.inputState.setSelectionOrigin("select.pointer")};Gt.touchmove=i=>{i.inputState.setSelectionOrigin("select.pointer")};mn.mousedown=(i,e)=>{if(i.observer.flush(),i.inputState.lastTouchTime>Date.now()-2e3)return!1;let t=null;for(let n of i.state.facet(dS))if(t=n(i,e),t)break;if(!t&&e.button==0&&(t=aZ(i,e)),t){let n=!i.hasFocus;i.inputState.startMouseSelection(new eZ(i,e,t,n)),n&&i.observer.ignore(()=>jb(i.contentDOM));let r=i.inputState.mouseSelection;if(r)return r.start(e),r.dragging===!1}return!1};function t0(i,e,t,n){if(n==1)return b.cursor(e,t);if(n==2)return qA(i.state,e,t);{let r=Ee.find(i.docView,e),s=i.state.doc.lineAt(r?r.posAtEnd:e),o=r?r.posAtStart:s.from,l=r?r.posAtEnd:s.to;return l<i.state.doc.length&&l==s.to&&l++,b.range(o,l)}}let AS=(i,e)=>i>=e.top&&i<=e.bottom,n0=(i,e,t)=>AS(e,t)&&i>=t.left&&i<=t.right;function oZ(i,e,t,n){let r=Ee.find(i.docView,e);if(!r)return 1;let s=e-r.posAtStart;if(s==0)return 1;if(s==r.length)return-1;let o=r.coordsAt(s,-1);if(o&&n0(t,n,o))return-1;let l=r.coordsAt(s,1);return l&&n0(t,n,l)?1:o&&AS(n,o)?-1:1}function i0(i,e){let t=i.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:oZ(i,t,e.clientX,e.clientY)}}const lZ=E.ie&&E.ie_version<=11;let r0=null,s0=0,o0=0;function ZS(i){if(!lZ)return i.detail;let e=r0,t=o0;return r0=i,o0=Date.now(),s0=!e||t>Date.now()-400&&Math.abs(e.clientX-i.clientX)<2&&Math.abs(e.clientY-i.clientY)<2?(s0+1)%3:1}function aZ(i,e){let t=i0(i,e),n=ZS(e),r=i.state.selection;return{update(s){s.docChanged&&(t.pos=s.changes.mapPos(t.pos),r=r.map(s.changes))},get(s,o,l){let a=i0(i,s),h,c=t0(i,a.pos,a.bias,n);if(t.pos!=a.pos&&!o){let f=t0(i,t.pos,t.bias,n),u=Math.min(f.from,c.from),d=Math.max(f.to,c.to);c=u<c.from?b.range(u,d):b.range(d,u)}return o?r.replaceRange(r.main.extend(c.from,c.to)):l&&n==1&&r.ranges.length>1&&(h=hZ(r,a.pos))?h:l?r.addRange(c):b.create([c])}}}function hZ(i,e){for(let t=0;t<i.ranges.length;t++){let{from:n,to:r}=i.ranges[t];if(n<=e&&r>=e)return b.create(i.ranges.slice(0,t).concat(i.ranges.slice(t+1)),i.mainIndex==t?0:i.mainIndex-(i.mainIndex>t?1:0))}return null}mn.dragstart=(i,e)=>{let{selection:{main:t}}=i.state;if(e.target.draggable){let r=i.docView.nearest(e.target);if(r&&r.isWidget){let s=r.posAtStart,o=s+r.length;(s>=t.to||o<=t.from)&&(t=b.range(s,o))}}let{inputState:n}=i;return n.mouseSelection&&(n.mouseSelection.dragging=!0),n.draggedContent=t,e.dataTransfer&&(e.dataTransfer.setData("Text",i.state.sliceDoc(t.from,t.to)),e.dataTransfer.effectAllowed="copyMove"),!1};mn.dragend=i=>(i.inputState.draggedContent=null,!1);function l0(i,e,t,n){if(!t)return;let r=i.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:s}=i.inputState,o=n&&s&&nZ(i,e)?{from:s.from,to:s.to}:null,l={from:r,insert:t},a=i.state.changes(o?[o,l]:l);i.focus(),i.dispatch({changes:a,selection:{anchor:a.mapPos(r,-1),head:a.mapPos(r,1)},userEvent:o?"move.drop":"input.drop"}),i.inputState.draggedContent=null}mn.drop=(i,e)=>{if(!e.dataTransfer)return!1;if(i.state.readOnly)return!0;let t=e.dataTransfer.files;if(t&&t.length){let n=Array(t.length),r=0,s=()=>{++r==t.length&&l0(i,e,n.filter(o=>o!=null).join(i.state.lineBreak),!1)};for(let o=0;o<t.length;o++){let l=new FileReader;l.onerror=s,l.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(l.result)||(n[o]=l.result),s()},l.readAsText(t[o])}return!0}else{let n=e.dataTransfer.getData("Text");if(n)return l0(i,e,n,!0),!0}return!1};mn.paste=(i,e)=>{if(i.state.readOnly)return!0;i.observer.flush();let t=TS?null:e.clipboardData;return t?(MS(i,t.getData("text/plain")||t.getData("text/uri-list")),!0):(sZ(i),!1)};function cZ(i,e){let t=i.dom.parentNode;if(!t)return;let n=t.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout(()=>{n.remove(),i.focus()},50)}function fZ(i){let e=[],t=[],n=!1;for(let r of i.selection.ranges)r.empty||(e.push(i.sliceDoc(r.from,r.to)),t.push(r));if(!e.length){let r=-1;for(let{from:s}of i.selection.ranges){let o=i.doc.lineAt(s);o.number>r&&(e.push(o.text),t.push({from:o.from,to:Math.min(i.doc.length,o.to+1)})),r=o.number}n=!0}return{text:e.join(i.lineBreak),ranges:t,linewise:n}}let Pd=null;mn.copy=mn.cut=(i,e)=>{let{text:t,ranges:n,linewise:r}=fZ(i.state);if(!t&&!r)return!1;Pd=r?t:null,e.type=="cut"&&!i.state.readOnly&&i.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"});let s=TS?null:e.clipboardData;return s?(s.clearData(),s.setData("text/plain",t),!0):(cZ(i,t),!1)};const RS=pi.define();function ES(i,e){let t=[];for(let n of i.facet(gS)){let r=n(i,e);r&&t.push(r)}return t?i.update({effects:t,annotations:RS.of(!0)}):null}function NS(i){setTimeout(()=>{let e=i.hasFocus;if(e!=i.inputState.notifiedFocused){let t=ES(i.state,e);t?i.dispatch(t):i.update([])}},10)}Gt.focus=i=>{i.inputState.lastFocusTime=Date.now(),!i.scrollDOM.scrollTop&&(i.inputState.lastScrollTop||i.inputState.lastScrollLeft)&&(i.scrollDOM.scrollTop=i.inputState.lastScrollTop,i.scrollDOM.scrollLeft=i.inputState.lastScrollLeft),NS(i)};Gt.blur=i=>{i.observer.clearSelectionRange(),NS(i)};Gt.compositionstart=Gt.compositionupdate=i=>{i.inputState.compositionFirstChange==null&&(i.inputState.compositionFirstChange=!0),i.inputState.composing<0&&(i.inputState.composing=0)};Gt.compositionend=i=>{i.inputState.composing=-1,i.inputState.compositionEndedAt=Date.now(),i.inputState.compositionPendingKey=!0,i.inputState.compositionPendingChange=i.observer.pendingRecords().length>0,i.inputState.compositionFirstChange=null,E.chrome&&E.android?i.observer.flushSoon():i.inputState.compositionPendingChange?Promise.resolve().then(()=>i.observer.flush()):setTimeout(()=>{i.inputState.composing<0&&i.docView.hasComposition&&i.update([])},50)};Gt.contextmenu=i=>{i.inputState.lastContextMenu=Date.now()};mn.beforeinput=(i,e)=>{var t;let n;if(E.chrome&&E.android&&(n=QS.find(r=>r.inputType==e.inputType))&&(i.observer.delayAndroidKey(n.key,n.keyCode),n.key=="Backspace"||n.key=="Delete")){let r=((t=window.visualViewport)===null||t===void 0?void 0:t.height)||0;setTimeout(()=>{var s;(((s=window.visualViewport)===null||s===void 0?void 0:s.height)||0)>r+10&&i.hasFocus&&(i.contentDOM.blur(),i.focus())},100)}return E.ios&&e.inputType=="deleteContentForward"&&i.observer.flushSoon(),E.safari&&e.inputType=="insertText"&&i.inputState.composing>=0&&setTimeout(()=>Gt.compositionend(i,e),20),!1};const a0=new Set;function uZ(i){a0.has(i)||(a0.add(i),i.addEventListener("copy",()=>{}),i.addEventListener("cut",()=>{}))}const h0=["pre-wrap","normal","pre-line","break-spaces"];class dZ{constructor(e){this.lineWrapping=e,this.doc=te.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30,this.heightChanged=!1}heightForGap(e,t){let n=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(n+=Math.max(0,Math.ceil((t-e-n*this.lineLength*.5)/this.lineLength))),this.lineHeight*n}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return h0.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let n=0;n<e.length;n++){let r=e[n];r<0?n++:this.heightSamples[Math.floor(r*10)]||(t=!0,this.heightSamples[Math.floor(r*10)]=!0)}return t}refresh(e,t,n,r,s,o){let l=h0.indexOf(e)>-1,a=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=l;if(this.lineWrapping=l,this.lineHeight=t,this.charWidth=n,this.textHeight=r,this.lineLength=s,a){this.heightSamples={};for(let h=0;h<o.length;h++){let c=o[h];c<0?h++:this.heightSamples[Math.floor(c*10)]=!0}}return a}}class pZ{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class Mn{constructor(e,t,n,r,s){this.from=e,this.length=t,this.top=n,this.height=r,this._content=s}get type(){return typeof this._content=="number"?at.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof Ui?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new Mn(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var me=function(i){return i[i.ByPos=0]="ByPos",i[i.ByHeight=1]="ByHeight",i[i.ByPosNoHeight=2]="ByPosNoHeight",i}(me||(me={}));const Sh=.001;class ht{constructor(e,t,n=2){this.length=e,this.height=t,this.flags=n}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e,t){this.height!=t&&(Math.abs(this.height-t)>Sh&&(e.heightChanged=!0),this.height=t)}replace(e,t,n){return ht.of(n)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,n,r){let s=this,o=n.doc;for(let l=r.length-1;l>=0;l--){let{fromA:a,toA:h,fromB:c,toB:f}=r[l],u=s.lineAt(a,me.ByPosNoHeight,n.setDoc(t),0,0),d=u.to>=h?u:s.lineAt(h,me.ByPosNoHeight,n,0,0);for(f+=d.to-h,h=d.to;l>0&&u.from<=r[l-1].toA;)a=r[l-1].fromA,c=r[l-1].fromB,l--,a<u.from&&(u=s.lineAt(a,me.ByPosNoHeight,n,0,0));c+=u.from-a,a=u.from;let p=Fp.build(n.setDoc(o),e,c,f);s=s.replace(a,h,p)}return s.updateHeight(n,0)}static empty(){return new Ct(0,0)}static of(e){if(e.length==1)return e[0];let t=0,n=e.length,r=0,s=0;for(;;)if(t==n)if(r>s*2){let l=e[t-1];l.break?e.splice(--t,1,l.left,null,l.right):e.splice(--t,1,l.left,l.right),n+=1+l.break,r-=l.size}else if(s>r*2){let l=e[n];l.break?e.splice(n,1,l.left,null,l.right):e.splice(n,1,l.left,l.right),n+=2+l.break,s-=l.size}else break;else if(r<s){let l=e[t++];l&&(r+=l.size)}else{let l=e[--n];l&&(s+=l.size)}let o=0;return e[t-1]==null?(o=1,t--):e[t]==null&&(o=1,n++),new mZ(ht.of(e.slice(0,t)),o,ht.of(e.slice(n)))}}ht.prototype.size=1;class DS extends ht{constructor(e,t,n){super(e,t),this.deco=n}blockAt(e,t,n,r){return new Mn(r,this.length,n,this.height,this.deco||0)}lineAt(e,t,n,r,s){return this.blockAt(0,n,r,s)}forEachLine(e,t,n,r,s,o){e<=s+this.length&&t>=s&&o(this.blockAt(0,n,r,s))}updateHeight(e,t=0,n=!1,r){return r&&r.from<=t&&r.more&&this.setHeight(e,r.heights[r.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Ct extends DS{constructor(e,t){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,t,n,r){return new Mn(r,this.length,n,this.height,this.breaks)}replace(e,t,n){let r=n[0];return n.length==1&&(r instanceof Ct||r instanceof Be&&r.flags&4)&&Math.abs(this.length-r.length)<10?(r instanceof Be?r=new Ct(r.length,this.height):r.height=this.height,this.outdated||(r.outdated=!1),r):ht.of(n)}updateHeight(e,t=0,n=!1,r){return r&&r.from<=t&&r.more?this.setHeight(e,r.heights[r.index++]):(n||this.outdated)&&this.setHeight(e,Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Be extends ht{constructor(e){super(e,0)}heightMetrics(e,t){let n=e.doc.lineAt(t).number,r=e.doc.lineAt(t+this.length).number,s=r-n+1,o,l=0;if(e.lineWrapping){let a=Math.min(this.height,e.lineHeight*s);o=a/s,this.length>s+1&&(l=(this.height-a)/(this.length-s-1))}else o=this.height/s;return{firstLine:n,lastLine:r,perLine:o,perChar:l}}blockAt(e,t,n,r){let{firstLine:s,lastLine:o,perLine:l,perChar:a}=this.heightMetrics(t,r);if(t.lineWrapping){let h=r+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-n)/this.height))*this.length)),c=t.doc.lineAt(h),f=l+c.length*a,u=Math.max(n,e-f/2);return new Mn(c.from,c.length,u,f,0)}else{let h=Math.max(0,Math.min(o-s,Math.floor((e-n)/l))),{from:c,length:f}=t.doc.line(s+h);return new Mn(c,f,n+l*h,l,0)}}lineAt(e,t,n,r,s){if(t==me.ByHeight)return this.blockAt(e,n,r,s);if(t==me.ByPosNoHeight){let{from:d,to:p}=n.doc.lineAt(e);return new Mn(d,p-d,0,0,0)}let{firstLine:o,perLine:l,perChar:a}=this.heightMetrics(n,s),h=n.doc.lineAt(e),c=l+h.length*a,f=h.number-o,u=r+l*f+a*(h.from-s-f);return new Mn(h.from,h.length,Math.max(r,Math.min(u,r+this.height-c)),c,0)}forEachLine(e,t,n,r,s,o){e=Math.max(e,s),t=Math.min(t,s+this.length);let{firstLine:l,perLine:a,perChar:h}=this.heightMetrics(n,s);for(let c=e,f=r;c<=t;){let u=n.doc.lineAt(c);if(c==e){let p=u.number-l;f+=a*p+h*(e-s-p)}let d=a+h*u.length;o(new Mn(u.from,u.length,f,d,0)),f+=d,c=u.to+1}}replace(e,t,n){let r=this.length-t;if(r>0){let s=n[n.length-1];s instanceof Be?n[n.length-1]=new Be(s.length+r):n.push(null,new Be(r-1))}if(e>0){let s=n[0];s instanceof Be?n[0]=new Be(e+s.length):n.unshift(new Be(e-1),null)}return ht.of(n)}decomposeLeft(e,t){t.push(new Be(e-1),null)}decomposeRight(e,t){t.push(null,new Be(this.length-e-1))}updateHeight(e,t=0,n=!1,r){let s=t+this.length;if(r&&r.from<=t+this.length&&r.more){let o=[],l=Math.max(t,r.from),a=-1;for(r.from>t&&o.push(new Be(r.from-t-1).updateHeight(e,t));l<=s&&r.more;){let c=e.doc.lineAt(l).length;o.length&&o.push(null);let f=r.heights[r.index++];a==-1?a=f:Math.abs(f-a)>=Sh&&(a=-2);let u=new Ct(c,f);u.outdated=!1,o.push(u),l+=c+1}l<=s&&o.push(null,new Be(s-l).updateHeight(e,l));let h=ht.of(o);return(a<0||Math.abs(h.height-this.height)>=Sh||Math.abs(a-this.heightMetrics(e,t).perLine)>=Sh)&&(e.heightChanged=!0),h}else(n||this.outdated)&&(this.setHeight(e,e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class mZ extends ht{constructor(e,t,n){super(e.length+t+n.length,e.height+n.height,t|(e.outdated||n.outdated?2:0)),this.left=e,this.right=n,this.size=e.size+n.size}get break(){return this.flags&1}blockAt(e,t,n,r){let s=n+this.left.height;return e<s?this.left.blockAt(e,t,n,r):this.right.blockAt(e,t,s,r+this.left.length+this.break)}lineAt(e,t,n,r,s){let o=r+this.left.height,l=s+this.left.length+this.break,a=t==me.ByHeight?e<o:e<l,h=a?this.left.lineAt(e,t,n,r,s):this.right.lineAt(e,t,n,o,l);if(this.break||(a?h.to<l:h.from>l))return h;let c=t==me.ByPosNoHeight?me.ByPosNoHeight:me.ByPos;return a?h.join(this.right.lineAt(l,c,n,o,l)):this.left.lineAt(l,c,n,r,s).join(h)}forEachLine(e,t,n,r,s,o){let l=r+this.left.height,a=s+this.left.length+this.break;if(this.break)e<a&&this.left.forEachLine(e,t,n,r,s,o),t>=a&&this.right.forEachLine(e,t,n,l,a,o);else{let h=this.lineAt(a,me.ByPos,n,r,s);e<h.from&&this.left.forEachLine(e,h.from-1,n,r,s,o),h.to>=e&&h.from<=t&&o(h),t>h.to&&this.right.forEachLine(h.to+1,t,n,l,a,o)}}replace(e,t,n){let r=this.left.length+this.break;if(t<r)return this.balanced(this.left.replace(e,t,n),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-r,t-r,n));let s=[];e>0&&this.decomposeLeft(e,s);let o=s.length;for(let l of n)s.push(l);if(e>0&&c0(s,o-1),t<this.length){let l=s.length;this.decomposeRight(t,s),c0(s,l)}return ht.of(s)}decomposeLeft(e,t){let n=this.left.length;if(e<=n)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(n++,e>=n&&t.push(null)),e>n&&this.right.decomposeLeft(e-n,t)}decomposeRight(e,t){let n=this.left.length,r=n+this.break;if(e>=r)return this.right.decomposeRight(e-r,t);e<n&&this.left.decomposeRight(e,t),this.break&&e<r&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?ht.of(this.break?[e,null,t]:[e,t]):(this.left=e,this.right=t,this.height=e.height+t.height,this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,n=!1,r){let{left:s,right:o}=this,l=t+s.length+this.break,a=null;return r&&r.from<=t+s.length&&r.more?a=s=s.updateHeight(e,t,n,r):s.updateHeight(e,t,n),r&&r.from<=l+o.length&&r.more?a=o=o.updateHeight(e,l,n,r):o.updateHeight(e,l,n),a?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function c0(i,e){let t,n;i[e]==null&&(t=i[e-1])instanceof Be&&(n=i[e+1])instanceof Be&&i.splice(e-1,3,new Be(t.length+1+n.length))}const gZ=5;class Fp{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let n=Math.min(t,this.lineEnd),r=this.nodes[this.nodes.length-1];r instanceof Ct?r.length+=n-this.pos:(n>this.pos||!this.isCovered)&&this.nodes.push(new Ct(n-this.pos,-1)),this.writtenTo=n,t>n&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,n){if(e<t||n.heightRelevant){let r=n.widget?n.widget.estimatedHeight:0,s=n.widget?n.widget.lineBreaks:0;r<0&&(r=this.oracle.lineHeight);let o=t-e;n.block?this.addBlock(new DS(o,r,n)):(o||s||r>=gZ)&&this.addLineDeco(r,s,o)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Ct(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let n=new Be(t-e);return this.oracle.doc.lineAt(e).to==t&&(n.flags|=4),n}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Ct)return e;let t=new Ct(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,n){let r=this.ensureLine();r.length+=n,r.collapsed+=n,r.widgetHeight=Math.max(r.widgetHeight,e),r.breaks+=t,this.writtenTo=this.pos=this.pos+n}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof Ct)&&!this.isCovered?this.nodes.push(new Ct(0,-1)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let n=e;for(let r of this.nodes)r instanceof Ct&&r.updateHeight(this.oracle,n),n+=r?r.length:1;return this.nodes}static build(e,t,n,r){let s=new Fp(n,e);return H.spans(t,n,r,s,0),s.finish(n)}}function OZ(i,e,t){let n=new yZ;return H.compare(i,e,t,n,0),n.changes}class yZ{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,n,r){(e<t||n&&n.heightRelevant||r&&r.heightRelevant)&&kd(e,t,this.changes,5)}}function kZ(i,e){let t=i.getBoundingClientRect(),n=i.ownerDocument,r=n.defaultView||window,s=Math.max(0,t.left),o=Math.min(r.innerWidth,t.right),l=Math.max(0,t.top),a=Math.min(r.innerHeight,t.bottom);for(let h=i.parentNode;h&&h!=n.body;)if(h.nodeType==1){let c=h,f=window.getComputedStyle(c);if((c.scrollHeight>c.clientHeight||c.scrollWidth>c.clientWidth)&&f.overflow!="visible"){let u=c.getBoundingClientRect();s=Math.max(s,u.left),o=Math.min(o,u.right),l=Math.max(l,u.top),a=h==i.parentNode?u.bottom:Math.min(a,u.bottom)}h=f.position=="absolute"||f.position=="fixed"?c.offsetParent:c.parentNode}else if(h.nodeType==11)h=h.host;else break;return{left:s-t.left,right:Math.max(s,o)-t.left,top:l-(t.top+e),bottom:Math.max(l,a)-(t.top+e)}}function bZ(i,e){let t=i.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class Vf{constructor(e,t,n){this.from=e,this.to=t,this.size=n}static same(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++){let r=e[n],s=t[n];if(r.from!=s.from||r.to!=s.to||r.size!=s.size)return!1}return!0}draw(e,t){return I.replace({widget:new SZ(this.size*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class SZ extends _n{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class f0{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!0,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=u0,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=ge.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(jp).some(n=>typeof n!="function"&&n.class=="cm-lineWrapping");this.heightOracle=new dZ(t),this.stateDeco=e.facet(Pl).filter(n=>typeof n!="function"),this.heightMap=ht.empty().applyChanges(this.stateDeco,te.empty,this.heightOracle.setDoc(e.doc),[new Ut(0,0,0,e.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=I.set(this.lineGaps.map(n=>n.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let n=0;n<=1;n++){let r=n?t.head:t.anchor;if(!e.some(({from:s,to:o})=>r>=s&&r<=o)){let{from:s,to:o}=this.lineBlockAt(r);e.push(new wa(s,o))}}this.viewports=e.sort((n,r)=>n.from-r.from),this.scaler=this.heightMap.height<=7e6?u0:new vZ(this.heightOracle,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(this.scaler.scale==1?e:zo(e,this.scaler))})}update(e,t=null){this.state=e.state;let n=this.stateDeco;this.stateDeco=this.state.facet(Pl).filter(c=>typeof c!="function");let r=e.changedRanges,s=Ut.extendWithRanges(r,OZ(n,this.stateDeco,e?e.changes:Ne.empty(this.state.doc.length))),o=this.heightMap.height,l=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),s),this.heightMap.height!=o&&(e.flags|=2),l?(this.scrollAnchorPos=e.changes.mapPos(l.from,-1),this.scrollAnchorHeight=l.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let a=s.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<a.from||t.range.head>a.to)||!this.viewportIsAppropriate(a))&&(a=this.getViewport(0,t));let h=!e.changes.empty||e.flags&2||a.from!=this.viewport.from||a.to!=this.viewport.to;this.viewport=a,this.updateForViewport(),h&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(yS)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,n=window.getComputedStyle(t),r=this.heightOracle,s=n.whiteSpace;this.defaultTextDirection=n.direction=="rtl"?ge.RTL:ge.LTR;let o=this.heightOracle.mustRefreshForWrapping(s),l=t.getBoundingClientRect(),a=o||this.mustMeasureContent||this.contentDOMHeight!=l.height;this.contentDOMHeight=l.height,this.mustMeasureContent=!1;let h=0,c=0;if(l.width&&l.height){let{scaleX:$,scaleY:S}=Yb(t,l);($>.005&&Math.abs(this.scaleX-$)>.005||S>.005&&Math.abs(this.scaleY-S)>.005)&&(this.scaleX=$,this.scaleY=S,h|=8,o=a=!0)}let f=(parseInt(n.paddingTop)||0)*this.scaleY,u=(parseInt(n.paddingBottom)||0)*this.scaleY;(this.paddingTop!=f||this.paddingBottom!=u)&&(this.paddingTop=f,this.paddingBottom=u,h|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(r.lineWrapping&&(a=!0),this.editorWidth=e.scrollDOM.clientWidth,h|=8);let d=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=d&&(this.scrollAnchorHeight=-1,this.scrollTop=d),this.scrolledToBottom=Fb(e.scrollDOM);let p=(this.printing?bZ:kZ)(t,this.paddingTop),m=p.top-this.pixelViewport.top,g=p.bottom-this.pixelViewport.bottom;this.pixelViewport=p;let y=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(y!=this.inView&&(this.inView=y,y&&(a=!0)),!this.inView&&!this.scrollTarget)return 0;let k=l.width;if((this.contentDOMWidth!=k||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=l.width,this.editorHeight=e.scrollDOM.clientHeight,h|=8),a){let $=e.docView.measureVisibleLineHeights(this.viewport);if(r.mustRefreshForHeights($)&&(o=!0),o||r.lineWrapping&&Math.abs(k-this.contentDOMWidth)>r.charWidth){let{lineHeight:S,charWidth:x,textHeight:Q}=e.docView.measureTextSize();o=S>0&&r.refresh(s,S,x,Q,k/x,$),o&&(e.docView.minWidth=0,h|=8)}m>0&&g>0?c=Math.max(m,g):m<0&&g<0&&(c=Math.min(m,g)),r.heightChanged=!1;for(let S of this.viewports){let x=S.from==this.viewport.from?$:e.docView.measureVisibleLineHeights(S);this.heightMap=(o?ht.empty().applyChanges(this.stateDeco,te.empty,this.heightOracle,[new Ut(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(r,0,o,new pZ(S.from,x))}r.heightChanged&&(h|=2)}let v=!this.viewportIsAppropriate(this.viewport,c)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return v&&(this.viewport=this.getViewport(c,this.scrollTarget)),this.updateForViewport(),(h&2||v)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,e)),h|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),h}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let n=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),r=this.heightMap,s=this.heightOracle,{visibleTop:o,visibleBottom:l}=this,a=new wa(r.lineAt(o-n*1e3,me.ByHeight,s,0,0).from,r.lineAt(l+(1-n)*1e3,me.ByHeight,s,0,0).to);if(t){let{head:h}=t.range;if(h<a.from||h>a.to){let c=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),f=r.lineAt(h,me.ByPos,s,0,0),u;t.y=="center"?u=(f.top+f.bottom)/2-c/2:t.y=="start"||t.y=="nearest"&&h<a.from?u=f.top:u=f.bottom-c,a=new wa(r.lineAt(u-1e3/2,me.ByHeight,s,0,0).from,r.lineAt(u+c+1e3/2,me.ByHeight,s,0,0).to)}}return a}mapViewport(e,t){let n=t.mapPos(e.from,-1),r=t.mapPos(e.to,1);return new wa(this.heightMap.lineAt(n,me.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(r,me.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},n=0){if(!this.inView)return!0;let{top:r}=this.heightMap.lineAt(e,me.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(t,me.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:l}=this;return(e==0||r<=o-Math.max(10,Math.min(-n,250)))&&(t==this.state.doc.length||s>=l+Math.max(10,Math.min(n,250)))&&r>o-2*1e3&&s<l+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let n=[];for(let r of e)t.touchesRange(r.from,r.to)||n.push(new Vf(t.mapPos(r.from),t.mapPos(r.to),r.size));return n}ensureLineGaps(e,t){let n=this.heightOracle.lineWrapping,r=n?1e4:2e3,s=r>>1,o=r<<1;if(this.defaultTextDirection!=ge.LTR&&!n)return[];let l=[],a=(h,c,f,u)=>{if(c-h<s)return;let d=this.state.selection.main,p=[d.from];d.empty||p.push(d.to);for(let g of p)if(g>h&&g<c){a(h,g-10,f,u),a(g+10,c,f,u);return}let m=xZ(e,g=>g.from>=f.from&&g.to<=f.to&&Math.abs(g.from-h)<s&&Math.abs(g.to-c)<s&&!p.some(y=>g.from<y&&g.to>y));if(!m){if(c<f.to&&t&&n&&t.visibleRanges.some(g=>g.from<=c&&g.to>=c)){let g=t.moveToLineBoundary(b.cursor(c),!1,!0).head;g>h&&(c=g)}m=new Vf(h,c,this.gapSize(f,h,c,u))}l.push(m)};for(let h of this.viewportLines){if(h.length<o)continue;let c=wZ(h.from,h.to,this.stateDeco);if(c.total<o)continue;let f=this.scrollTarget?this.scrollTarget.range.head:null,u,d;if(n){let p=r/this.heightOracle.lineLength*this.heightOracle.lineHeight,m,g;if(f!=null){let y=va(c,f),k=((this.visibleBottom-this.visibleTop)/2+p)/h.height;m=y-k,g=y+k}else m=(this.visibleTop-h.top-p)/h.height,g=(this.visibleBottom-h.top+p)/h.height;u=xa(c,m),d=xa(c,g)}else{let p=c.total*this.heightOracle.charWidth,m=r*this.heightOracle.charWidth,g,y;if(f!=null){let k=va(c,f),v=((this.pixelViewport.right-this.pixelViewport.left)/2+m)/p;g=k-v,y=k+v}else g=(this.pixelViewport.left-m)/p,y=(this.pixelViewport.right+m)/p;u=xa(c,g),d=xa(c,y)}u>h.from&&a(h.from,u,h,c),d<h.to&&a(d,h.to,h,c)}return l}gapSize(e,t,n,r){let s=va(r,n)-va(r,t);return this.heightOracle.lineWrapping?e.height*s:r.total*this.heightOracle.charWidth*s}updateLineGaps(e){Vf.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=I.set(e.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let t=[];H.spans(e,this.viewport.from,this.viewport.to,{span(r,s){t.push({from:r,to:s})},point(){}},20);let n=t.length!=this.visibleRanges.length||this.visibleRanges.some((r,s)=>r.from!=t[s].from||r.to!=t[s].to);return this.visibleRanges=t,n?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||zo(this.heightMap.lineAt(e,me.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return zo(this.heightMap.lineAt(this.scaler.fromDOM(e),me.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return zo(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class wa{constructor(e,t){this.from=e,this.to=t}}function wZ(i,e,t){let n=[],r=i,s=0;return H.spans(t,i,e,{span(){},point(o,l){o>r&&(n.push({from:r,to:o}),s+=o-r),r=l}},20),r<e&&(n.push({from:r,to:e}),s+=e-r),{total:s,ranges:n}}function xa({total:i,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let n=Math.floor(i*t);for(let r=0;;r++){let{from:s,to:o}=e[r],l=o-s;if(n<=l)return s+n;n-=l}}function va(i,e){let t=0;for(let{from:n,to:r}of i.ranges){if(e<=r){t+=e-n;break}t+=r-n}return t/i.total}function xZ(i,e){for(let t of i)if(e(t))return t}const u0={toDOM(i){return i},fromDOM(i){return i},scale:1};class vZ{constructor(e,t,n){let r=0,s=0,o=0;this.viewports=n.map(({from:l,to:a})=>{let h=t.lineAt(l,me.ByPos,e,0,0).top,c=t.lineAt(a,me.ByPos,e,0,0).bottom;return r+=c-h,{from:l,to:a,top:h,bottom:c,domTop:0,domBottom:0}}),this.scale=(7e6-r)/(t.height-r);for(let l of this.viewports)l.domTop=o+(l.top-s)*this.scale,o=l.domBottom=l.domTop+(l.bottom-l.top),s=l.bottom}toDOM(e){for(let t=0,n=0,r=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.top)return r+(e-n)*this.scale;if(e<=s.bottom)return s.domTop+(e-s.top);n=s.bottom,r=s.domBottom}}fromDOM(e){for(let t=0,n=0,r=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.domTop)return n+(e-r)/this.scale;if(e<=s.domBottom)return s.top+(e-s.domTop);n=s.bottom,r=s.domBottom}}}function zo(i,e){if(e.scale==1)return i;let t=e.toDOM(i.top),n=e.toDOM(i.bottom);return new Mn(i.from,i.length,t,n-t,Array.isArray(i._content)?i._content.map(r=>zo(r,e)):i._content)}const $a=R.define({combine:i=>i.join(" ")}),Qd=R.define({combine:i=>i.indexOf(!0)>-1}),Cd=Fi.newName(),IS=Fi.newName(),WS=Fi.newName(),XS={"&light":"."+IS,"&dark":"."+WS};function Td(i,e,t){return new Fi(e,{finish(n){return/&/.test(n)?n.replace(/&\w*/,r=>{if(r=="&")return i;if(!t||!t[r])throw new RangeError(`Unsupported selector: ${r}`);return t[r]}):i+" "+n}})}const $Z=Td("."+Cd,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},XS),Yo="";class PZ{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(j.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Yo}readRange(e,t){if(!e)return this;let n=e.parentNode;for(let r=e;;){this.findPointBefore(n,r);let s=this.text.length;this.readNode(r);let o=r.nextSibling;if(o==t)break;let l=le.get(r),a=le.get(o);(l&&a?l.breakAfter:(l?l.breakAfter:Fh(r))||Fh(o)&&(r.nodeName!="BR"||r.cmIgnore)&&this.text.length>s)&&this.lineBreak(),r=o}return this.findPointBefore(n,t),this}readTextNode(e){let t=e.nodeValue;for(let n of this.points)n.node==e&&(n.pos=this.text.length+Math.min(n.offset,t.length));for(let n=0,r=this.lineSeparator?null:/\r\n?|\n/g;;){let s=-1,o=1,l;if(this.lineSeparator?(s=t.indexOf(this.lineSeparator,n),o=this.lineSeparator.length):(l=r.exec(t))&&(s=l.index,o=l[0].length),this.append(t.slice(n,s<0?t.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let a of this.points)a.node==e&&a.pos>this.text.length&&(a.pos-=o-1);n=s+o}}readNode(e){if(e.cmIgnore)return;let t=le.get(e),n=t&&t.overrideDOMText;if(n!=null){this.findPointInside(e,n.length);for(let r=n.iter();!r.next().done;)r.lineBreak?this.lineBreak():this.append(r.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let n of this.points)n.node==e&&e.childNodes[n.offset]==t&&(n.pos=this.text.length)}findPointInside(e,t){for(let n of this.points)(e.nodeType==3?n.node==e:e.contains(n.node))&&(n.pos=this.text.length+(QZ(e,n.node,n.offset)?t:0))}}function QZ(i,e,t){for(;;){if(!e||t<hi(e))return!1;if(e==i)return!0;t=Ir(e)+1,e=e.parentNode}}class d0{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class CZ{constructor(e,t,n,r){this.typeOver=r,this.bounds=null,this.text="";let{impreciseHead:s,impreciseAnchor:o}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=e.docView.domBoundsAround(t,n,0))){let l=s||o?[]:AZ(e),a=new PZ(l,e.state);a.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=a.text,this.newSel=ZZ(l,this.bounds.from)}else{let l=e.observer.selectionRange,a=s&&s.node==l.focusNode&&s.offset==l.focusOffset||!dd(e.contentDOM,l.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(l.focusNode,l.focusOffset),h=o&&o.node==l.anchorNode&&o.offset==l.anchorOffset||!dd(e.contentDOM,l.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(l.anchorNode,l.anchorOffset),c=e.viewport;if((E.ios||E.chrome)&&e.state.selection.main.empty&&a!=h&&(c.from>0||c.to<e.state.doc.length)){let f=Math.min(a,h),u=Math.max(a,h),d=c.from-f,p=c.to-u;(d==0||d==1||f==0)&&(p==0||p==-1||u==e.state.doc.length)&&(a=0,h=e.state.doc.length)}this.newSel=b.single(h,a)}}}function BS(i,e){let t,{newSel:n}=e,r=i.state.selection.main,s=i.inputState.lastKeyTime>Date.now()-100?i.inputState.lastKeyCode:-1;if(e.bounds){let{from:o,to:l}=e.bounds,a=r.from,h=null;(s===8||E.android&&e.text.length<l-o)&&(a=r.to,h="end");let c=MZ(i.state.doc.sliceString(o,l,Yo),e.text,a-o,h);c&&(E.chrome&&s==13&&c.toB==c.from+2&&e.text.slice(c.from,c.toB)==Yo+Yo&&c.toB--,t={from:o+c.from,to:o+c.toA,insert:te.of(e.text.slice(c.from,c.toB).split(Yo))})}else n&&(!i.hasFocus&&i.state.facet(Ic)||n.main.eq(r))&&(n=null);if(!t&&!n)return!1;if(!t&&e.typeOver&&!r.empty&&n&&n.main.empty?t={from:r.from,to:r.to,insert:i.state.doc.slice(r.from,r.to)}:t&&t.from>=r.from&&t.to<=r.to&&(t.from!=r.from||t.to!=r.to)&&r.to-r.from-(t.to-t.from)<=4?t={from:r.from,to:r.to,insert:i.state.doc.slice(r.from,t.from).append(t.insert).append(i.state.doc.slice(t.to,r.to))}:(E.mac||E.android)&&t&&t.from==t.to&&t.from==r.head-1&&/^\. ?$/.test(t.insert.toString())&&i.contentDOM.getAttribute("autocorrect")=="off"?(n&&t.insert.length==2&&(n=b.single(n.main.anchor-1,n.main.head-1)),t={from:r.from,to:r.to,insert:te.of([" "])}):E.chrome&&t&&t.from==t.to&&t.from==r.head&&t.insert.toString()==`
 `&&i.lineWrapping&&(n&&(n=b.single(n.main.anchor-1,n.main.head-1)),t={from:r.from,to:r.to,insert:te.of([" "])}),t){if(E.ios&&i.inputState.flushIOSKey(t)||E.android&&(t.to==r.to&&(t.from==r.from||t.from==r.from-1&&i.state.sliceDoc(t.from,r.from)==" ")&&t.insert.length==1&&t.insert.lines==2&&vs(i.contentDOM,"Enter",13)||(t.from==r.from-1&&t.to==r.to&&t.insert.length==0||s==8&&t.insert.length<t.to-t.from&&t.to>r.head)&&vs(i.contentDOM,"Backspace",8)||t.from==r.from&&t.to==r.to+1&&t.insert.length==0&&vs(i.contentDOM,"Delete",46)))return!0;let o=t.insert.toString();i.inputState.composing>=0&&i.inputState.composing++;let l,a=()=>l||(l=TZ(i,t,n));return i.state.facet(mS).some(h=>h(i,t.from,t.to,o,a))||i.dispatch(a()),!0}else if(n&&!n.main.eq(r)){let o=!1,l="select";return i.inputState.lastSelectionTime>Date.now()-50&&(i.inputState.lastSelectionOrigin=="select"&&(o=!0),l=i.inputState.lastSelectionOrigin),i.dispatch({selection:n,scrollIntoView:o,userEvent:l}),!0}else return!1}function TZ(i,e,t){let n,r=i.state,s=r.selection.main;if(e.from>=s.from&&e.to<=s.to&&e.to-e.from>=(s.to-s.from)/3&&(!t||t.main.empty&&t.main.from==e.from+e.insert.length)&&i.inputState.composing<0){let l=s.from<e.from?r.sliceDoc(s.from,e.from):"",a=s.to>e.to?r.sliceDoc(e.to,s.to):"";n=r.replaceSelection(i.state.toText(l+e.insert.sliceString(0,void 0,i.state.lineBreak)+a))}else{let l=r.changes(e),a=t&&t.main.to<=l.newLength?t.main:void 0;if(r.selection.ranges.length>1&&i.inputState.composing>=0&&e.to<=s.to&&e.to>=s.to-10){let h=i.state.sliceDoc(e.from,e.to),c,f=t&&$S(i,t.main.head);if(f){let p=e.insert.length-(e.to-e.from);c={from:f.from,to:f.to-p}}else c=i.state.doc.lineAt(s.head);let u=s.to-e.to,d=s.to-s.from;n=r.changeByRange(p=>{if(p.from==s.from&&p.to==s.to)return{changes:l,range:a||p.map(l)};let m=p.to-u,g=m-h.length;if(p.to-p.from!=d||i.state.sliceDoc(g,m)!=h||p.to>=c.from&&p.from<=c.to)return{range:p};let y=r.changes({from:g,to:m,insert:e.insert}),k=p.to-s.to;return{changes:y,range:a?b.range(Math.max(0,a.anchor+k),Math.max(0,a.head+k)):p.map(y)}})}else n={changes:l,selection:a&&r.selection.replaceRange(a)}}let o="input.type";return(i.composing||i.inputState.compositionPendingChange&&i.inputState.compositionEndedAt>Date.now()-50)&&(i.inputState.compositionPendingChange=!1,o+=".compose",i.inputState.compositionFirstChange&&(o+=".start",i.inputState.compositionFirstChange=!1)),r.update(n,{userEvent:o,scrollIntoView:!0})}function MZ(i,e,t,n){let r=Math.min(i.length,e.length),s=0;for(;s<r&&i.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==r&&i.length==e.length)return null;let o=i.length,l=e.length;for(;o>0&&l>0&&i.charCodeAt(o-1)==e.charCodeAt(l-1);)o--,l--;if(n=="end"){let a=Math.max(0,s-Math.min(o,l));t-=o+a-s}if(o<s&&i.length<e.length){let a=t<=s&&t>=o?s-t:0;s-=a,l=s+(l-o),o=s}else if(l<s){let a=t<=s&&t>=l?s-t:0;s-=a,o=s+(o-l),l=s}return{from:s,toA:o,toB:l}}function AZ(i){let e=[];if(i.root.activeElement!=i.contentDOM)return e;let{anchorNode:t,anchorOffset:n,focusNode:r,focusOffset:s}=i.observer.selectionRange;return t&&(e.push(new d0(t,n)),(r!=t||s!=n)&&e.push(new d0(r,s))),e}function ZZ(i,e){if(i.length==0)return null;let t=i[0].pos,n=i.length==2?i[1].pos:t;return t>-1&&n>-1?b.single(t+e,n+e):null}const RZ={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},qf=E.ie&&E.ie_version<=11;class EZ{constructor(e){this.view=e,this.active=!1,this.selectionRange=new OA,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let n of t)this.queue.push(n);(E.ie&&E.ie_version<=11||E.ios&&e.composing)&&t.some(n=>n.type=="childList"&&n.removedNodes.length||n.type=="characterData"&&n.oldValue.length>n.target.nodeValue.length)?this.flushSoon():this.flush()}),qf&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){e.type=="change"&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,n)=>t!=e[n]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:n}=this,r=this.selectionRange;if(n.state.facet(Ic)?n.root.activeElement!=this.dom:!kh(n.dom,r))return;let s=r.anchorNode&&n.docView.nearest(r.anchorNode);if(s&&s.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(E.ie&&E.ie_version<=11||E.android&&E.chrome)&&!n.state.selection.main.empty&&r.focusNode&&ol(r.focusNode,r.focusOffset,r.anchorNode,r.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=_h(e.root);if(!t)return!1;let n=E.safari&&e.root.nodeType==11&&dA(this.dom.ownerDocument)==this.dom&&NZ(this.view,t)||t;if(!n||this.selectionRange.eq(n))return!1;let r=kh(this.dom,n);return r&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&kA(this.dom,n)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(n),r&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let n=this.dom;n;)if(n.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==n?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(n),n=n.assignedSlot||n.parentNode;else if(n.nodeType==11)n=n.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);for(let n of this.scrollTargets=t)n.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,RZ),qf&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),qf&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var n;if(!this.delayedAndroidKey){let r=()=>{let s=this.delayedAndroidKey;s&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=s.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&s.force&&vs(this.dom,s.key,s.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(r)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((n=this.delayedAndroidKey)===null||n===void 0)&&n.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,n=-1,r=!1;for(let s of e){let o=this.readMutation(s);o&&(o.typeOver&&(r=!0),t==-1?{from:t,to:n}=o:(t=Math.min(o.from,t),n=Math.max(o.to,n)))}return{from:t,to:n,typeOver:r}}readChange(){let{from:e,to:t,typeOver:n}=this.processRecords(),r=this.selectionChanged&&kh(this.dom,this.selectionRange);if(e<0&&!r)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let s=new CZ(this.view,e,t,n);return this.view.docView.domChanged={newSel:s.newSel?s.newSel.main:null},s}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let n=this.view.state,r=BS(this.view,t);return this.view.state==n&&this.view.update([]),r}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty(e.type=="attributes"),e.type=="attributes"&&(t.flags|=4),e.type=="childList"){let n=p0(t,e.previousSibling||e.target.previousSibling,-1),r=p0(t,e.nextSibling||e.target.nextSibling,1);return{from:n?t.posAfter(n):t.posAtStart,to:r?t.posBefore(r):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener("change",this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener("change",this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}destroy(){var e,t,n;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(n=this.resizeScroll)===null||n===void 0||n.disconnect();for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey)}}function p0(i,e,t){for(;e;){let n=le.get(e);if(n&&n.parent==i)return n;let r=e.parentNode;e=r!=i.dom?r:t>0?e.nextSibling:e.previousSibling}return null}function m0(i,e){let t=e.startContainer,n=e.startOffset,r=e.endContainer,s=e.endOffset,o=i.docView.domAtPos(i.state.selection.main.anchor);return ol(o.node,o.offset,r,s)&&([t,n,r,s]=[r,s,t,n]),{anchorNode:t,anchorOffset:n,focusNode:r,focusOffset:s}}function NZ(i,e){if(e.getComposedRanges){let r=e.getComposedRanges(i.root)[0];if(r)return m0(i,r)}let t=null;function n(r){r.preventDefault(),r.stopImmediatePropagation(),t=r.getTargetRanges()[0]}return i.contentDOM.addEventListener("beforeinput",n,!0),i.dom.ownerDocument.execCommand("indent"),i.contentDOM.removeEventListener("beforeinput",n,!0),t?m0(i,t):null}class M{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:t}=e;this.dispatchTransactions=e.dispatchTransactions||t&&(n=>n.forEach(r=>t(r,this)))||(n=>this.update(n)),this.dispatch=this.dispatch.bind(this),this._root=e.root||yA(e.parent)||document,this.viewState=new f0(e.state||j.create(e)),e.scrollTo&&e.scrollTo.is(ka)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(qo).map(n=>new Wf(n));for(let n of this.plugins)n.update(this);this.observer=new EZ(this),this.inputState=new GA(this),this.inputState.ensureHandlers(this.plugins),this.docView=new _O(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure()}dispatch(...e){let t=e.length==1&&e[0]instanceof Ce?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,n=!1,r,s=this.state;for(let u of e){if(u.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=u.state}if(this.destroyed){this.viewState.state=s;return}let o=this.hasFocus,l=0,a=null;e.some(u=>u.annotation(RS))?(this.inputState.notifiedFocused=o,l=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,a=ES(s,o),a||(l=1));let h=this.observer.delayedAndroidKey,c=null;if(h?(this.observer.clearDelayedAndroidKey(),c=this.observer.readChange(),(c&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(c=null)):this.observer.clear(),s.facet(j.phrases)!=this.state.facet(j.phrases))return this.setState(s);r=Uh.create(this,s,e),r.flags|=l;let f=this.viewState.scrollTarget;try{this.updateState=2;for(let u of e){if(f&&(f=f.map(u.changes)),u.scrollIntoView){let{main:d}=u.state.selection;f=new $s(d.empty?d:b.cursor(d.head,d.head>d.anchor?-1:1))}for(let d of u.effects)d.is(ka)&&(f=d.value.clip(this.state))}this.viewState.update(r,f),this.bidiCache=Gh.update(this.bidiCache,r.changes),r.empty||(this.updatePlugins(r),this.inputState.update(r)),t=this.docView.update(r),this.state.facet(Lo)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(u=>u.isUserEvent("select.pointer")))}finally{this.updateState=0}if(r.startState.facet($a)!=r.state.facet($a)&&(this.viewState.mustMeasureContent=!0),(t||n||f||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),t&&this.docViewUpdate(),!r.empty)for(let u of this.state.facet(xd))try{u(r)}catch(d){lt(this.state,d,"update listener")}(a||c)&&Promise.resolve().then(()=>{a&&this.state==a.startState&&this.dispatch(a),c&&!BS(this,c)&&h.force&&vs(this.contentDOM,h.key,h.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let n of this.plugins)n.destroy(this);this.viewState=new f0(e),this.plugins=e.facet(qo).map(n=>new Wf(n)),this.pluginMap.clear();for(let n of this.plugins)n.update(this);this.docView.destroy(),this.docView=new _O(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(qo),n=e.state.facet(qo);if(t!=n){let r=[];for(let s of n){let o=t.indexOf(s);if(o<0)r.push(new Wf(s));else{let l=this.plugins[o];l.mustUpdate=e,r.push(l)}}for(let s of this.plugins)s.mustUpdate!=e&&s.destroy(this);this.plugins=r,this.pluginMap.clear()}else for(let r of this.plugins)r.mustUpdate=e;for(let r=0;r<this.plugins.length;r++)this.plugins[r].update(this);t!=n&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let t=e.value;if(t&&t.docViewUpdate)try{t.docViewUpdate(this)}catch(n){lt(this.state,n,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,n=this.scrollDOM,r=n.scrollTop*this.scaleY,{scrollAnchorPos:s,scrollAnchorHeight:o}=this.viewState;Math.abs(r-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let l=0;;l++){if(o<0)if(Fb(n))s=-1,o=this.viewState.heightMap.height;else{let d=this.viewState.scrollAnchorAt(r);s=d.from,o=d.top}this.updateState=1;let a=this.viewState.measure(this);if(!a&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(l>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let h=[];a&4||([this.measureRequests,h]=[h,this.measureRequests]);let c=h.map(d=>{try{return d.read(this)}catch(p){return lt(this.state,p),g0}}),f=Uh.create(this,this.state,[]),u=!1;f.flags|=a,t?t.flags|=a:t=f,this.updateState=2,f.empty||(this.updatePlugins(f),this.inputState.update(f),this.updateAttrs(),u=this.docView.update(f),u&&this.docViewUpdate());for(let d=0;d<h.length;d++)if(c[d]!=g0)try{let p=h[d];p.write&&p.write(c[d],this)}catch(p){lt(this.state,p)}if(u&&this.docView.updateSelection(!0),!f.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}else{let p=(s<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(s).top)-o;if(p>1||p<-1){r=r+p,n.scrollTop=r/this.scaleY,o=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let l of this.state.facet(xd))l(t)}get themeClasses(){return Cd+" "+(this.state.facet(Qd)?WS:IS)+" "+this.state.facet($a)}updateAttrs(){let e=O0(this,bS,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(Ic)?"true":"false",class:"cm-content",style:`${E.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),O0(this,jp,t);let n=this.observer.ignore(()=>{let r=yd(this.contentDOM,this.contentAttrs,t),s=yd(this.dom,this.editorAttrs,e);return r||s});return this.editorAttrs=e,this.contentAttrs=t,n}showAnnouncements(e){let t=!0;for(let n of e)for(let r of n.effects)if(r.is(M.announce)){t&&(this.announceDOM.textContent=""),t=!1;let s=this.announceDOM.appendChild(document.createElement("div"));s.textContent=r.value}}mountStyles(){this.styleModules=this.state.facet(Lo);let e=this.state.facet(M.cspNonce);Fi.mount(this.root,this.styleModules.concat($Z).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.spec!=e)&&this.pluginMap.set(e,t=this.plugins.find(n=>n.spec==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,n){return Bf(this,e,JO(this,e,t,n))}moveByGroup(e,t){return Bf(this,e,JO(this,e,t,n=>FA(this,e.head,n)))}visualLineSide(e,t){let n=this.bidiSpans(e),r=this.textDirectionAt(e.from),s=n[t?n.length-1:0];return b.cursor(s.side(t,r)+e.from,s.forward(!t,r)?1:-1)}moveToLineBoundary(e,t,n=!0){return _A(this,e,t,n)}moveVertically(e,t,n){return Bf(this,e,UA(this,e,t,n))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),PS(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let n=this.docView.coordsAt(e,t);if(!n||n.left==n.right)return n;let r=this.state.doc.lineAt(e),s=this.bidiSpans(r),o=s[Ni.find(s,e-r.from,-1,t)];return Nc(n,o.dir==ge.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(OS)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>DZ)return hS(e.length);let t=this.textDirectionAt(e.from),n;for(let s of this.bidiCache)if(s.from==e.from&&s.dir==t&&(s.fresh||aS(s.isolates,n=jO(this,e))))return s.order;n||(n=jO(this,e));let r=AA(e.text,t,n);return this.bidiCache.push(new Gh(e.from,e.to,t,n,!0,r)),r}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||E.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{jb(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return ka.of(new $s(typeof e=="number"?b.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,n=this.viewState.scrollAnchorAt(e);return ka.of(new $s(b.cursor(n.from),"start","start",n.top-e,t,!0))}static domEventHandlers(e){return ve.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return ve.define(()=>({}),{eventObservers:e})}static theme(e,t){let n=Fi.newName(),r=[$a.of(n),Lo.of(Td(`.${n}`,e))];return t&&t.dark&&r.push(Qd.of(!0)),r}static baseTheme(e){return di.lowest(Lo.of(Td("."+Cd,e,XS)))}static findFromDOM(e){var t;let n=e.querySelector(".cm-content"),r=n&&le.get(n)||le.get(e);return((t=r==null?void 0:r.rootView)===null||t===void 0?void 0:t.view)||null}}M.styleModule=Lo;M.inputHandler=mS;M.scrollHandler=kS;M.focusChangeEffect=gS;M.perLineTextDirection=OS;M.exceptionSink=pS;M.updateListener=xd;M.editable=Ic;M.mouseSelectionStyle=dS;M.dragMovesSelection=uS;M.clickAddsSelectionRange=fS;M.decorations=Pl;M.outerDecorations=SS;M.atomicRanges=_p;M.bidiIsolatedRanges=wS;M.scrollMargins=xS;M.darkTheme=Qd;M.cspNonce=R.define({combine:i=>i.length?i[0]:""});M.contentAttributes=jp;M.editorAttributes=bS;M.lineWrapping=M.contentAttributes.of({class:"cm-lineWrapping"});M.announce=q.define();const DZ=4096,g0={};class Gh{constructor(e,t,n,r,s,o){this.from=e,this.to=t,this.dir=n,this.isolates=r,this.fresh=s,this.order=o}static update(e,t){if(t.empty&&!e.some(s=>s.fresh))return e;let n=[],r=e.length?e[e.length-1].dir:ge.LTR;for(let s=Math.max(0,e.length-10);s<e.length;s++){let o=e[s];o.dir==r&&!t.touchesRange(o.from,o.to)&&n.push(new Gh(t.mapPos(o.from,1),t.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return n}}function O0(i,e,t){for(let n=i.state.facet(e),r=n.length-1;r>=0;r--){let s=n[r],o=typeof s=="function"?s(i):s;o&&Od(o,t)}return t}const IZ=E.mac?"mac":E.windows?"win":E.linux?"linux":"key";function WZ(i,e){const t=i.split(/-(?!$)/);let n=t[t.length-1];n=="Space"&&(n=" ");let r,s,o,l;for(let a=0;a<t.length-1;++a){const h=t[a];if(/^(cmd|meta|m)$/i.test(h))l=!0;else if(/^a(lt)?$/i.test(h))r=!0;else if(/^(c|ctrl|control)$/i.test(h))s=!0;else if(/^s(hift)?$/i.test(h))o=!0;else if(/^mod$/i.test(h))e=="mac"?l=!0:s=!0;else throw new Error("Unrecognized modifier name: "+h)}return r&&(n="Alt-"+n),s&&(n="Ctrl-"+n),l&&(n="Meta-"+n),o&&(n="Shift-"+n),n}function Pa(i,e,t){return e.altKey&&(i="Alt-"+i),e.ctrlKey&&(i="Ctrl-"+i),e.metaKey&&(i="Meta-"+i),t!==!1&&e.shiftKey&&(i="Shift-"+i),i}const XZ=di.default(M.domEventHandlers({keydown(i,e){return qS(VS(e.state),i,e,"editor")}})),Gs=R.define({enables:XZ}),y0=new WeakMap;function VS(i){let e=i.facet(Gs),t=y0.get(e);return t||y0.set(e,t=qZ(e.reduce((n,r)=>n.concat(r),[]))),t}function BZ(i,e,t){return qS(VS(i.state),e,i,t)}let Ti=null;const VZ=4e3;function qZ(i,e=IZ){let t=Object.create(null),n=Object.create(null),r=(o,l)=>{let a=n[o];if(a==null)n[o]=l;else if(a!=l)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},s=(o,l,a,h,c)=>{var f,u;let d=t[o]||(t[o]=Object.create(null)),p=l.split(/ (?!$)/).map(y=>WZ(y,e));for(let y=1;y<p.length;y++){let k=p.slice(0,y).join(" ");r(k,!0),d[k]||(d[k]={preventDefault:!0,stopPropagation:!1,run:[v=>{let $=Ti={view:v,prefix:k,scope:o};return setTimeout(()=>{Ti==$&&(Ti=null)},VZ),!0}]})}let m=p.join(" ");r(m,!1);let g=d[m]||(d[m]={preventDefault:!1,stopPropagation:!1,run:((u=(f=d._any)===null||f===void 0?void 0:f.run)===null||u===void 0?void 0:u.slice())||[]});a&&g.run.push(a),h&&(g.preventDefault=!0),c&&(g.stopPropagation=!0)};for(let o of i){let l=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let h of l){let c=t[h]||(t[h]=Object.create(null));c._any||(c._any={preventDefault:!1,stopPropagation:!1,run:[]});for(let f in c)c[f].run.push(o.any)}let a=o[e]||o.key;if(a)for(let h of l)s(h,a,o.run,o.preventDefault,o.stopPropagation),o.shift&&s(h,"Shift-"+a,o.shift,o.preventDefault,o.stopPropagation)}return t}function qS(i,e,t,n){let r=eb(e),s=ze(r,0),o=Lt(s)==r.length&&r!=" ",l="",a=!1,h=!1,c=!1;Ti&&Ti.view==t&&Ti.scope==n&&(l=Ti.prefix+" ",CS.indexOf(e.keyCode)<0&&(h=!0,Ti=null));let f=new Set,u=g=>{if(g){for(let y of g.run)if(!f.has(y)&&(f.add(y),y(t,e)))return g.stopPropagation&&(c=!0),!0;g.preventDefault&&(g.stopPropagation&&(c=!0),h=!0)}return!1},d=i[n],p,m;return d&&(u(d[l+Pa(r,e,!o)])?a=!0:o&&(e.altKey||e.metaKey||e.ctrlKey)&&!(E.windows&&e.ctrlKey&&e.altKey)&&(p=ai[e.keyCode])&&p!=r?(u(d[l+Pa(p,e,!0)])||e.shiftKey&&(m=kl[e.keyCode])!=r&&m!=p&&u(d[l+Pa(m,e,!1)]))&&(a=!0):o&&e.shiftKey&&u(d[l+Pa(r,e,!0)])&&(a=!0),!a&&u(d._any)&&(a=!0)),h&&(a=!0),a&&c&&e.stopPropagation(),a}class Kl{constructor(e,t,n,r,s){this.className=e,this.left=t,this.top=n,this.width=r,this.height=s}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,n){if(n.empty){let r=e.coordsAtPos(n.head,n.assoc||1);if(!r)return[];let s=LS(e);return[new Kl(t,r.left-s.left,r.top-s.top,null,r.bottom-r.top)]}else return LZ(e,t,n)}}function LS(i){let e=i.scrollDOM.getBoundingClientRect();return{left:(i.textDirection==ge.LTR?e.left:e.right-i.scrollDOM.clientWidth*i.scaleX)-i.scrollDOM.scrollLeft*i.scaleX,top:e.top-i.scrollDOM.scrollTop*i.scaleY}}function k0(i,e,t){let n=b.cursor(e);return{from:Math.max(t.from,i.moveToLineBoundary(n,!1,!0).from),to:Math.min(t.to,i.moveToLineBoundary(n,!0,!0).from),type:at.Text}}function LZ(i,e,t){if(t.to<=i.viewport.from||t.from>=i.viewport.to)return[];let n=Math.max(t.from,i.viewport.from),r=Math.min(t.to,i.viewport.to),s=i.textDirection==ge.LTR,o=i.contentDOM,l=o.getBoundingClientRect(),a=LS(i),h=o.querySelector(".cm-line"),c=h&&window.getComputedStyle(h),f=l.left+(c?parseInt(c.paddingLeft)+Math.min(0,parseInt(c.textIndent)):0),u=l.right-(c?parseInt(c.paddingRight):0),d=$d(i,n),p=$d(i,r),m=d.type==at.Text?d:null,g=p.type==at.Text?p:null;if(m&&(i.lineWrapping||d.widgetLineBreaks)&&(m=k0(i,n,m)),g&&(i.lineWrapping||p.widgetLineBreaks)&&(g=k0(i,r,g)),m&&g&&m.from==g.from)return k(v(t.from,t.to,m));{let S=m?v(t.from,null,m):$(d,!1),x=g?v(null,t.to,g):$(p,!0),Q=[];return(m||d).to<(g||p).from-(m&&g?1:0)||d.widgetLineBreaks>1&&S.bottom+i.defaultLineHeight/2<x.top?Q.push(y(f,S.bottom,u,x.top)):S.bottom<x.top&&i.elementAtHeight((S.bottom+x.top)/2).type==at.Text&&(S.bottom=x.top=(S.bottom+x.top)/2),k(S).concat(Q).concat(k(x))}function y(S,x,Q,X){return new Kl(e,S-a.left,x-a.top-.01,Q-S,X-x+.01)}function k({top:S,bottom:x,horizontal:Q}){let X=[];for(let A=0;A<Q.length;A+=2)X.push(y(Q[A],S,Q[A+1],x));return X}function v(S,x,Q){let X=1e9,A=-1e9,L=[];function z(ie,be,mt,gt,xt){let Wt=i.coordsAtPos(ie,ie==Q.to?-2:2),Ze=i.coordsAtPos(mt,mt==Q.from?2:-2);!Wt||!Ze||(X=Math.min(Wt.top,Ze.top,X),A=Math.max(Wt.bottom,Ze.bottom,A),xt==ge.LTR?L.push(s&&be?f:Wt.left,s&&gt?u:Ze.right):L.push(!s&&gt?f:Ze.left,!s&&be?u:Wt.right))}let Y=S??Q.from,se=x??Q.to;for(let ie of i.visibleRanges)if(ie.to>Y&&ie.from<se)for(let be=Math.max(ie.from,Y),mt=Math.min(ie.to,se);;){let gt=i.state.doc.lineAt(be);for(let xt of i.bidiSpans(gt)){let Wt=xt.from+gt.from,Ze=xt.to+gt.from;if(Wt>=mt)break;Ze>be&&z(Math.max(Wt,be),S==null&&Wt<=Y,Math.min(Ze,mt),x==null&&Ze>=se,xt.dir)}if(be=gt.to+1,be>=mt)break}return L.length==0&&z(Y,S==null,se,x==null,i.textDirection),{top:X,bottom:A,horizontal:L}}function $(S,x){let Q=l.top+(x?S.top:S.bottom);return{top:Q,bottom:Q,horizontal:[]}}}function zZ(i,e){return i.constructor==e.constructor&&i.eq(e)}class YZ{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(wh)!=e.state.facet(wh)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let t=0,n=e.facet(wh);for(;t<n.length&&n[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;(e!=this.scaleX||t!=this.scaleY)&&(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some((t,n)=>!zZ(t,this.drawn[n]))){let t=this.dom.firstChild,n=0;for(let r of e)r.update&&t&&r.constructor&&this.drawn[n].constructor&&r.update(t,this.drawn[n])?(t=t.nextSibling,n++):this.dom.insertBefore(r.draw(),t);for(;t;){let r=t.nextSibling;t.remove(),t=r}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const wh=R.define();function zS(i){return[ve.define(e=>new YZ(e,i)),wh.of(i)]}const YS=!E.ios,Ql=R.define({combine(i){return On(i,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function jZ(i={}){return[Ql.of(i),_Z,FZ,UZ,yS.of(!0)]}function jS(i){return i.startState.facet(Ql)!=i.state.facet(Ql)}const _Z=zS({above:!0,markers(i){let{state:e}=i,t=e.facet(Ql),n=[];for(let r of e.selection.ranges){let s=r==e.selection.main;if(r.empty?!s||YS:t.drawRangeCursor){let o=s?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",l=r.empty?r:b.cursor(r.head,r.head>r.anchor?-1:1);for(let a of Kl.forRange(i,o,l))n.push(a)}}return n},update(i,e){i.transactions.some(n=>n.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let t=jS(i);return t&&b0(i.state,e),i.docChanged||i.selectionSet||t},mount(i,e){b0(e.state,i)},class:"cm-cursorLayer"});function b0(i,e){e.style.animationDuration=i.facet(Ql).cursorBlinkRate+"ms"}const FZ=zS({above:!1,markers(i){return i.state.selection.ranges.map(e=>e.empty?[]:Kl.forRange(i,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t))},update(i,e){return i.docChanged||i.selectionSet||i.viewportChanged||jS(i)},class:"cm-selectionLayer"}),Md={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};YS&&(Md[".cm-line"].caretColor="transparent !important",Md[".cm-content"]={caretColor:"transparent !important"});const UZ=di.highest(M.theme(Md)),_S=q.define({map(i,e){return i==null?null:e.mapPos(i)}}),jo=Ae.define({create(){return null},update(i,e){return i!=null&&(i=e.changes.mapPos(i)),e.effects.reduce((t,n)=>n.is(_S)?n.value:t,i)}}),GZ=ve.fromClass(class{constructor(i){this.view=i,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(i){var e;let t=i.state.field(jo);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(i.startState.field(jo)!=t||i.docChanged||i.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:i}=this,e=i.state.field(jo),t=e!=null&&i.coordsAtPos(e);if(!t)return null;let n=i.scrollDOM.getBoundingClientRect();return{left:t.left-n.left+i.scrollDOM.scrollLeft*i.scaleX,top:t.top-n.top+i.scrollDOM.scrollTop*i.scaleY,height:t.bottom-t.top}}drawCursor(i){if(this.cursor){let{scaleX:e,scaleY:t}=this.view;i?(this.cursor.style.left=i.left/e+"px",this.cursor.style.top=i.top/t+"px",this.cursor.style.height=i.height/t+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(i){this.view.state.field(jo)!=i&&this.view.dispatch({effects:_S.of(i)})}},{eventObservers:{dragover(i){this.setDropPos(this.view.posAtCoords({x:i.clientX,y:i.clientY}))},dragleave(i){(i.target==this.view.contentDOM||!this.view.contentDOM.contains(i.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function HZ(){return[jo,GZ]}function S0(i,e,t,n,r){e.lastIndex=0;for(let s=i.iterRange(t,n),o=t,l;!s.next().done;o+=s.value.length)if(!s.lineBreak)for(;l=e.exec(s.value);)r(o+l.index,l)}function KZ(i,e){let t=i.visibleRanges;if(t.length==1&&t[0].from==i.viewport.from&&t[0].to==i.viewport.to)return t;let n=[];for(let{from:r,to:s}of t)r=Math.max(i.state.doc.lineAt(r).from,r-e),s=Math.min(i.state.doc.lineAt(s).to,s+e),n.length&&n[n.length-1].to>=r?n[n.length-1].to=s:n.push({from:r,to:s});return n}class JZ{constructor(e){const{regexp:t,decoration:n,decorate:r,boundary:s,maxLength:o=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,r)this.addMatch=(l,a,h,c)=>r(c,h,h+l[0].length,l,a);else if(typeof n=="function")this.addMatch=(l,a,h,c)=>{let f=n(l,a,h);f&&c(h,h+l[0].length,f)};else if(n)this.addMatch=(l,a,h,c)=>c(h,h+l[0].length,n);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=s,this.maxLength=o}createDeco(e){let t=new _i,n=t.add.bind(t);for(let{from:r,to:s}of KZ(e,this.maxLength))S0(e.state.doc,this.regexp,r,s,(o,l)=>this.addMatch(l,e,o,n));return t.finish()}updateDeco(e,t){let n=1e9,r=-1;return e.docChanged&&e.changes.iterChanges((s,o,l,a)=>{a>e.view.viewport.from&&l<e.view.viewport.to&&(n=Math.min(l,n),r=Math.max(a,r))}),e.viewportChanged||r-n>1e3?this.createDeco(e.view):r>-1?this.updateRange(e.view,t.map(e.changes),n,r):t}updateRange(e,t,n,r){for(let s of e.visibleRanges){let o=Math.max(s.from,n),l=Math.min(s.to,r);if(l>o){let a=e.state.doc.lineAt(o),h=a.to<l?e.state.doc.lineAt(l):a,c=Math.max(s.from,a.from),f=Math.min(s.to,h.to);if(this.boundary){for(;o>a.from;o--)if(this.boundary.test(a.text[o-1-a.from])){c=o;break}for(;l<h.to;l++)if(this.boundary.test(h.text[l-h.from])){f=l;break}}let u=[],d,p=(m,g,y)=>u.push(y.range(m,g));if(a==h)for(this.regexp.lastIndex=c-a.from;(d=this.regexp.exec(a.text))&&d.index<f-a.from;)this.addMatch(d,e,d.index+a.from,p);else S0(e.state.doc,this.regexp,c,f,(m,g)=>this.addMatch(g,e,m,p));t=t.update({filterFrom:c,filterTo:f,filter:(m,g)=>m<c||g>f,add:u})}}return t}}const Ad=/x/.unicode!=null?"gu":"g",eR=new RegExp(`[\0-\b
--\u2028\u2029\uFEFF-]`,Ad),tR={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let Lf=null;function nR(){var i;if(Lf==null&&typeof document<"u"&&document.body){let e=document.body.style;Lf=((i=e.tabSize)!==null&&i!==void 0?i:e.MozTabSize)!=null}return Lf||!1}const xh=R.define({combine(i){let e=On(i,{render:null,specialChars:eR,addSpecialChars:null});return(e.replaceTabs=!nR())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,Ad)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,Ad)),e}});function iR(i={}){return[xh.of(i),rR()]}let w0=null;function rR(){return w0||(w0=ve.fromClass(class{constructor(i){this.view=i,this.decorations=I.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(i.state.facet(xh)),this.decorations=this.decorator.createDeco(i)}makeDecorator(i){return new JZ({regexp:i.specialChars,decoration:(e,t,n)=>{let{doc:r}=t.state,s=ze(e[0],0);if(s==9){let o=r.lineAt(n),l=t.state.tabSize,a=dn(o.text,l,n-o.from);return I.replace({widget:new aR((l-a%l)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[s]||(this.decorationCache[s]=I.replace({widget:new lR(i,s)}))},boundary:i.replaceTabs?void 0:/[^]/})}update(i){let e=i.state.facet(xh);i.startState.facet(xh)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(i.view)):this.decorations=this.decorator.updateDeco(i,this.decorations)}},{decorations:i=>i.decorations}))}const sR="";function oR(i){return i>=32?sR:i==10?"":String.fromCharCode(9216+i)}class lR extends _n{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=oR(this.code),n=e.state.phrase("Control character")+" "+(tR[this.code]||"0x"+this.code.toString(16)),r=this.options.render&&this.options.render(this.code,n,t);if(r)return r;let s=document.createElement("span");return s.textContent=t,s.title=n,s.setAttribute("aria-label",n),s.className="cm-specialChar",s}ignoreEvent(){return!1}}class aR extends _n{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function hR(){return fR}const cR=I.line({class:"cm-activeLine"}),fR=ve.fromClass(class{constructor(i){this.decorations=this.getDeco(i)}update(i){(i.docChanged||i.selectionSet)&&(this.decorations=this.getDeco(i.view))}getDeco(i){let e=-1,t=[];for(let n of i.state.selection.ranges){let r=i.lineBlockAt(n.head);r.from>e&&(t.push(cR.range(r.from)),e=r.from)}return I.set(t)}},{decorations:i=>i.decorations});class uR extends _n{constructor(e){super(),this.content=e}toDOM(){let e=document.createElement("span");return e.className="cm-placeholder",e.style.pointerEvents="none",e.appendChild(typeof this.content=="string"?document.createTextNode(this.content):this.content),typeof this.content=="string"?e.setAttribute("aria-label","placeholder "+this.content):e.setAttribute("aria-hidden","true"),e}coordsAt(e){let t=e.firstChild?Is(e.firstChild):[];if(!t.length)return null;let n=window.getComputedStyle(e.parentNode),r=Nc(t[0],n.direction!="rtl"),s=parseInt(n.lineHeight);return r.bottom-r.top>s*1.5?{left:r.left,right:r.right,top:r.top,bottom:r.top+s}:r}ignoreEvent(){return!1}}function dR(i){return ve.fromClass(class{constructor(e){this.view=e,this.placeholder=i?I.set([I.widget({widget:new uR(i),side:1}).range(0)]):I.none}get decorations(){return this.view.state.doc.length?I.none:this.placeholder}},{decorations:e=>e.decorations})}const Zd=2e3;function pR(i,e,t){let n=Math.min(e.line,t.line),r=Math.max(e.line,t.line),s=[];if(e.off>Zd||t.off>Zd||e.col<0||t.col<0){let o=Math.min(e.off,t.off),l=Math.max(e.off,t.off);for(let a=n;a<=r;a++){let h=i.doc.line(a);h.length<=l&&s.push(b.range(h.from+o,h.to+l))}}else{let o=Math.min(e.col,t.col),l=Math.max(e.col,t.col);for(let a=n;a<=r;a++){let h=i.doc.line(a),c=cd(h.text,o,i.tabSize,!0);if(c<0)s.push(b.cursor(h.to));else{let f=cd(h.text,l,i.tabSize);s.push(b.range(h.from+c,h.from+f))}}}return s}function mR(i,e){let t=i.coordsAtPos(i.viewport.from);return t?Math.round(Math.abs((t.left-e)/i.defaultCharacterWidth)):-1}function x0(i,e){let t=i.posAtCoords({x:e.clientX,y:e.clientY},!1),n=i.state.doc.lineAt(t),r=t-n.from,s=r>Zd?-1:r==n.length?mR(i,e.clientX):dn(n.text,i.state.tabSize,t-n.from);return{line:n.number,col:s,off:r}}function gR(i,e){let t=x0(i,e),n=i.state.selection;return t?{update(r){if(r.docChanged){let s=r.changes.mapPos(r.startState.doc.line(t.line).from),o=r.state.doc.lineAt(s);t={line:o.number,col:t.col,off:Math.min(t.off,o.length)},n=n.map(r.changes)}},get(r,s,o){let l=x0(i,r);if(!l)return n;let a=pR(i.state,t,l);return a.length?o?b.create(a.concat(n.ranges)):b.create(a):n}}:null}function OR(i){let e=(i==null?void 0:i.eventFilter)||(t=>t.altKey&&t.button==0);return M.mouseSelectionStyle.of((t,n)=>e(n)?gR(t,n):null)}const yR={Alt:[18,i=>!!i.altKey],Control:[17,i=>!!i.ctrlKey],Shift:[16,i=>!!i.shiftKey],Meta:[91,i=>!!i.metaKey]},kR={style:"cursor: crosshair"};function bR(i={}){let[e,t]=yR[i.key||"Alt"],n=ve.fromClass(class{constructor(r){this.view=r,this.isDown=!1}set(r){this.isDown!=r&&(this.isDown=r,this.view.update([]))}},{eventObservers:{keydown(r){this.set(r.keyCode==e||t(r))},keyup(r){(r.keyCode==e||!t(r))&&this.set(!1)},mousemove(r){this.set(t(r))}}});return[n,M.contentAttributes.of(r=>{var s;return!((s=r.plugin(n))===null||s===void 0)&&s.isDown?kR:null})]}const co="-10000px";class FS{constructor(e,t,n,r){this.facet=t,this.createTooltipView=n,this.removeTooltipView=r,this.input=e.state.facet(t),this.tooltips=this.input.filter(o=>o);let s=null;this.tooltipViews=this.tooltips.map(o=>s=n(o,s))}update(e,t){var n;let r=e.state.facet(this.facet),s=r.filter(a=>a);if(r===this.input){for(let a of this.tooltipViews)a.update&&a.update(e);return!1}let o=[],l=t?[]:null;for(let a=0;a<s.length;a++){let h=s[a],c=-1;if(h){for(let f=0;f<this.tooltips.length;f++){let u=this.tooltips[f];u&&u.create==h.create&&(c=f)}if(c<0)o[a]=this.createTooltipView(h,a?o[a-1]:null),l&&(l[a]=!!h.above);else{let f=o[a]=this.tooltipViews[c];l&&(l[a]=t[c]),f.update&&f.update(e)}}}for(let a of this.tooltipViews)o.indexOf(a)<0&&(this.removeTooltipView(a),(n=a.destroy)===null||n===void 0||n.call(a));return t&&(l.forEach((a,h)=>t[h]=a),t.length=l.length),this.input=r,this.tooltips=s,this.tooltipViews=o,!0}}function SR(i){let{win:e}=i;return{top:0,left:0,bottom:e.innerHeight,right:e.innerWidth}}const zf=R.define({combine:i=>{var e,t,n;return{position:E.ios?"absolute":((e=i.find(r=>r.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=i.find(r=>r.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((n=i.find(r=>r.tooltipSpace))===null||n===void 0?void 0:n.tooltipSpace)||SR}}}),v0=new WeakMap,Up=ve.fromClass(class{constructor(i){this.view=i,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=i.state.facet(zf);this.position=e.position,this.parent=e.parent,this.classes=i.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new FS(i,Wc,(t,n)=>this.createTooltip(t,n),t=>{this.resizeObserver&&this.resizeObserver.unobserve(t.dom),t.dom.remove()}),this.above=this.manager.tooltips.map(t=>!!t.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),i.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let i of this.manager.tooltipViews)this.intersectionObserver.observe(i.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(i){i.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(i,this.above);e&&this.observeIntersection();let t=e||i.geometryChanged,n=i.state.facet(zf);if(n.position!=this.position&&!this.madeAbsolute){this.position=n.position;for(let r of this.manager.tooltipViews)r.dom.style.position=this.position;t=!0}if(n.parent!=this.parent){this.parent&&this.container.remove(),this.parent=n.parent,this.createContainer();for(let r of this.manager.tooltipViews)this.container.appendChild(r.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(i,e){let t=i.create(this.view),n=e?e.dom:null;if(t.dom.classList.add("cm-tooltip"),i.arrow&&!t.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let r=document.createElement("div");r.className="cm-tooltip-arrow",t.dom.insertBefore(r,n)}return t.dom.style.position=this.position,t.dom.style.top=co,t.dom.style.left="0px",this.container.insertBefore(t.dom,n),t.mount&&t.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(t.dom),t}destroy(){var i,e,t;this.view.win.removeEventListener("resize",this.measureSoon);for(let n of this.manager.tooltipViews)n.dom.remove(),(i=n.destroy)===null||i===void 0||i.call(n);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(t=this.intersectionObserver)===null||t===void 0||t.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let i=this.view.dom.getBoundingClientRect(),e=1,t=1,n=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:r}=this.manager.tooltipViews[0];if(E.gecko)n=r.offsetParent!=this.container.ownerDocument.body;else if(r.style.top==co&&r.style.left=="0px"){let s=r.getBoundingClientRect();n=Math.abs(s.top+1e4)>1||Math.abs(s.left)>1}}if(n||this.position=="absolute")if(this.parent){let r=this.parent.getBoundingClientRect();r.width&&r.height&&(e=r.width/this.parent.offsetWidth,t=r.height/this.parent.offsetHeight)}else({scaleX:e,scaleY:t}=this.view.viewState);return{editor:i,parent:this.parent?this.container.getBoundingClientRect():i,pos:this.manager.tooltips.map((r,s)=>{let o=this.manager.tooltipViews[s];return o.getCoords?o.getCoords(r.pos):this.view.coordsAtPos(r.pos)}),size:this.manager.tooltipViews.map(({dom:r})=>r.getBoundingClientRect()),space:this.view.state.facet(zf).tooltipSpace(this.view),scaleX:e,scaleY:t,makeAbsolute:n}}writeMeasure(i){var e;if(i.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let l of this.manager.tooltipViews)l.dom.style.position="absolute"}let{editor:t,space:n,scaleX:r,scaleY:s}=i,o=[];for(let l=0;l<this.manager.tooltips.length;l++){let a=this.manager.tooltips[l],h=this.manager.tooltipViews[l],{dom:c}=h,f=i.pos[l],u=i.size[l];if(!f||f.bottom<=Math.max(t.top,n.top)||f.top>=Math.min(t.bottom,n.bottom)||f.right<Math.max(t.left,n.left)-.1||f.left>Math.min(t.right,n.right)+.1){c.style.top=co;continue}let d=a.arrow?h.dom.querySelector(".cm-tooltip-arrow"):null,p=d?7:0,m=u.right-u.left,g=(e=v0.get(h))!==null&&e!==void 0?e:u.bottom-u.top,y=h.offset||xR,k=this.view.textDirection==ge.LTR,v=u.width>n.right-n.left?k?n.left:n.right-u.width:k?Math.min(f.left-(d?14:0)+y.x,n.right-m):Math.max(n.left,f.left-m+(d?14:0)-y.x),$=this.above[l];!a.strictSide&&($?f.top-(u.bottom-u.top)-y.y<n.top:f.bottom+(u.bottom-u.top)+y.y>n.bottom)&&$==n.bottom-f.bottom>f.top-n.top&&($=this.above[l]=!$);let S=($?f.top-n.top:n.bottom-f.bottom)-p;if(S<g&&h.resize!==!1){if(S<this.view.defaultLineHeight){c.style.top=co;continue}v0.set(h,g),c.style.height=(g=S)/s+"px"}else c.style.height&&(c.style.height="");let x=$?f.top-g-p-y.y:f.bottom+p+y.y,Q=v+m;if(h.overlap!==!0)for(let X of o)X.left<Q&&X.right>v&&X.top<x+g&&X.bottom>x&&(x=$?X.top-g-2-p:X.bottom+p+2);if(this.position=="absolute"?(c.style.top=(x-i.parent.top)/s+"px",c.style.left=(v-i.parent.left)/r+"px"):(c.style.top=x/s+"px",c.style.left=v/r+"px"),d){let X=f.left+(k?y.x:-y.x)-(v+14-7);d.style.left=X/r+"px"}h.overlap!==!0&&o.push({left:v,top:x,right:Q,bottom:x+g}),c.classList.toggle("cm-tooltip-above",$),c.classList.toggle("cm-tooltip-below",!$),h.positioned&&h.positioned(i.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let i of this.manager.tooltipViews)i.dom.style.top=co}},{eventObservers:{scroll(){this.maybeMeasure()}}}),wR=M.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),xR={x:0,y:0},Wc=R.define({enables:[Up,wR]}),Hh=R.define({combine:i=>i.reduce((e,t)=>e.concat(t),[])});class Xc{static create(e){return new Xc(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new FS(e,Hh,(t,n)=>this.createHostedView(t,n),t=>t.dom.remove())}createHostedView(e,t){let n=e.create(this.view);return n.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(n.dom,t?t.dom.nextSibling:this.dom.firstChild),this.mounted&&n.mount&&n.mount(this.view),n}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let t of this.manager.tooltipViews)(e=t.destroy)===null||e===void 0||e.call(t)}passProp(e){let t;for(let n of this.manager.tooltipViews){let r=n[e];if(r!==void 0){if(t===void 0)t=r;else if(t!==r)return}}return t}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const vR=Wc.compute([Hh],i=>{let e=i.facet(Hh);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.map(t=>{var n;return(n=t.end)!==null&&n!==void 0?n:t.pos})),create:Xc.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class $R{constructor(e,t,n,r,s){this.view=e,this.source=t,this.field=n,this.setHover=r,this.hoverTime=s,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:t}=this,n=e.docView.nearest(t.target);if(!n)return;let r,s=1;if(n instanceof Ei)r=n.posAtStart;else{if(r=e.posAtCoords(t),r==null)return;let l=e.coordsAtPos(r);if(!l||t.y<l.top||t.y>l.bottom||t.x<l.left-e.defaultCharacterWidth||t.x>l.right+e.defaultCharacterWidth)return;let a=e.bidiSpans(e.state.doc.lineAt(r)).find(c=>c.from<=r&&c.to>=r),h=a&&a.dir==ge.RTL?-1:1;s=t.x<l.left?-h:h}let o=this.source(e,r,s);if(o!=null&&o.then){let l=this.pending={pos:r};o.then(a=>{this.pending==l&&(this.pending=null,a&&!(Array.isArray(a)&&!a.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(a)?a:[a])}))},a=>lt(e.state,a,"hover tooltip"))}else o&&!(Array.isArray(o)&&!o.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(o)?o:[o])})}get tooltip(){let e=this.view.plugin(Up),t=e?e.manager.tooltips.findIndex(n=>n.create==Xc.create):-1;return t>-1?e.manager.tooltipViews[t]:null}mousemove(e){var t,n;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:r,tooltip:s}=this;if(r.length&&s&&!PR(s.dom,e)||this.pending){let{pos:o}=r[0]||this.pending,l=(n=(t=r[0])===null||t===void 0?void 0:t.end)!==null&&n!==void 0?n:o;(o==l?this.view.posAtCoords(this.lastMove)!=o:!QR(this.view,o,l,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:t}=this;if(t.length){let{tooltip:n}=this;n&&n.dom.contains(e.relatedTarget)?this.watchTooltipLeave(n.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let t=n=>{e.removeEventListener("mouseleave",t),this.active.length&&!this.view.dom.contains(n.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",t)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const Qa=4;function PR(i,e){let t=i.getBoundingClientRect();return e.clientX>=t.left-Qa&&e.clientX<=t.right+Qa&&e.clientY>=t.top-Qa&&e.clientY<=t.bottom+Qa}function QR(i,e,t,n,r,s){let o=i.scrollDOM.getBoundingClientRect(),l=i.documentTop+i.documentPadding.top+i.contentHeight;if(o.left>n||o.right<n||o.top>r||Math.min(o.bottom,l)<r)return!1;let a=i.posAtCoords({x:n,y:r},!1);return a>=e&&a<=t}function CR(i,e={}){let t=q.define(),n=Ae.define({create(){return[]},update(r,s){if(r.length&&(e.hideOnChange&&(s.docChanged||s.selection)?r=[]:e.hideOn&&(r=r.filter(o=>!e.hideOn(s,o))),s.docChanged)){let o=[];for(let l of r){let a=s.changes.mapPos(l.pos,-1,Ye.TrackDel);if(a!=null){let h=Object.assign(Object.create(null),l);h.pos=a,h.end!=null&&(h.end=s.changes.mapPos(h.end)),o.push(h)}}r=o}for(let o of s.effects)o.is(t)&&(r=o.value),o.is(TR)&&(r=[]);return r},provide:r=>Hh.from(r)});return[n,ve.define(r=>new $R(r,i,n,t,e.hoverTime||300)),vR]}function US(i,e){let t=i.plugin(Up);if(!t)return null;let n=t.manager.tooltips.indexOf(e);return n<0?null:t.manager.tooltipViews[n]}const TR=q.define(),$0=R.define({combine(i){let e,t;for(let n of i)e=e||n.topContainer,t=t||n.bottomContainer;return{topContainer:e,bottomContainer:t}}});function Cl(i,e){let t=i.plugin(GS),n=t?t.specs.indexOf(e):-1;return n>-1?t.panels[n]:null}const GS=ve.fromClass(class{constructor(i){this.input=i.state.facet(Tl),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(i));let e=i.state.facet($0);this.top=new Ca(i,!0,e.topContainer),this.bottom=new Ca(i,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(i){let e=i.state.facet($0);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new Ca(i.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new Ca(i.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=i.state.facet(Tl);if(t!=this.input){let n=t.filter(a=>a),r=[],s=[],o=[],l=[];for(let a of n){let h=this.specs.indexOf(a),c;h<0?(c=a(i.view),l.push(c)):(c=this.panels[h],c.update&&c.update(i)),r.push(c),(c.top?s:o).push(c)}this.specs=n,this.panels=r,this.top.sync(s),this.bottom.sync(o);for(let a of l)a.dom.classList.add("cm-panel"),a.mount&&a.mount()}else for(let n of this.panels)n.update&&n.update(i)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:i=>M.scrollMargins.of(e=>{let t=e.plugin(i);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class Ca{constructor(e,t,n){this.view=e,this.top=t,this.container=n,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=P0(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=P0(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function P0(i){let e=i.nextSibling;return i.remove(),e}const Tl=R.define({enables:GS});class Ln extends Dr{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}Ln.prototype.elementClass="";Ln.prototype.toDOM=void 0;Ln.prototype.mapMode=Ye.TrackBefore;Ln.prototype.startSide=Ln.prototype.endSide=-1;Ln.prototype.point=!0;const vh=R.define(),MR={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>H.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},al=R.define();function HS(i){return[KS(),al.of(Object.assign(Object.assign({},MR),i))]}const Rd=R.define({combine:i=>i.some(e=>e)});function KS(i){let e=[AR];return i&&i.fixed===!1&&e.push(Rd.of(!0)),e}const AR=ve.fromClass(class{constructor(i){this.view=i,this.prevViewport=i.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=i.state.facet(al).map(e=>new C0(i,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!i.state.facet(Rd),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),i.scrollDOM.insertBefore(this.dom,i.contentDOM)}update(i){if(this.updateGutters(i)){let e=this.prevViewport,t=i.view.viewport,n=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(n<(t.to-t.from)*.8)}i.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px"),this.view.state.facet(Rd)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=i.view.viewport}syncGutters(i){let e=this.dom.nextSibling;i&&this.dom.remove();let t=H.iter(this.view.state.facet(vh),this.view.viewport.from),n=[],r=this.gutters.map(s=>new ZR(s,this.view.viewport,-this.view.documentPadding.top));for(let s of this.view.viewportLineBlocks)if(n.length&&(n=[]),Array.isArray(s.type)){let o=!0;for(let l of s.type)if(l.type==at.Text&&o){Ed(t,n,l.from);for(let a of r)a.line(this.view,l,n);o=!1}else if(l.widget)for(let a of r)a.widget(this.view,l)}else if(s.type==at.Text){Ed(t,n,s.from);for(let o of r)o.line(this.view,s,n)}else if(s.widget)for(let o of r)o.widget(this.view,s);for(let s of r)s.finish();i&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(i){let e=i.startState.facet(al),t=i.state.facet(al),n=i.docChanged||i.heightChanged||i.viewportChanged||!H.eq(i.startState.facet(vh),i.state.facet(vh),i.view.viewport.from,i.view.viewport.to);if(e==t)for(let r of this.gutters)r.update(i)&&(n=!0);else{n=!0;let r=[];for(let s of t){let o=e.indexOf(s);o<0?r.push(new C0(this.view,s)):(this.gutters[o].update(i),r.push(this.gutters[o]))}for(let s of this.gutters)s.dom.remove(),r.indexOf(s)<0&&s.destroy();for(let s of r)this.dom.appendChild(s.dom);this.gutters=r}return n}destroy(){for(let i of this.gutters)i.destroy();this.dom.remove()}},{provide:i=>M.scrollMargins.of(e=>{let t=e.plugin(i);return!t||t.gutters.length==0||!t.fixed?null:e.textDirection==ge.LTR?{left:t.dom.offsetWidth*e.scaleX}:{right:t.dom.offsetWidth*e.scaleX}})});function Q0(i){return Array.isArray(i)?i:[i]}function Ed(i,e,t){for(;i.value&&i.from<=t;)i.from==t&&e.push(i.value),i.next()}class ZR{constructor(e,t,n){this.gutter=e,this.height=n,this.i=0,this.cursor=H.iter(e.markers,t.from)}addElement(e,t,n){let{gutter:r}=this,s=(t.top-this.height)/e.scaleY,o=t.height/e.scaleY;if(this.i==r.elements.length){let l=new JS(e,o,s,n);r.elements.push(l),r.dom.appendChild(l.dom)}else r.elements[this.i].update(e,o,s,n);this.height=t.bottom,this.i++}line(e,t,n){let r=[];Ed(this.cursor,r,t.from),n.length&&(r=r.concat(n));let s=this.gutter.config.lineMarker(e,t,r);s&&r.unshift(s);let o=this.gutter;r.length==0&&!o.config.renderEmptyElements||this.addElement(e,t,r)}widget(e,t){let n=this.gutter.config.widgetMarker(e,t.widget,t);n&&this.addElement(e,t,[n])}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class C0{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let n in t.domEventHandlers)this.dom.addEventListener(n,r=>{let s=r.target,o;if(s!=this.dom&&this.dom.contains(s)){for(;s.parentNode!=this.dom;)s=s.parentNode;let a=s.getBoundingClientRect();o=(a.top+a.bottom)/2}else o=r.clientY;let l=e.lineBlockAtHeight(o-e.documentTop);t.domEventHandlers[n](e,l,r)&&r.preventDefault()});this.markers=Q0(t.markers(e)),t.initialSpacer&&(this.spacer=new JS(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=Q0(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let r=this.config.updateSpacer(this.spacer.markers[0],e);r!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[r])}let n=e.view.viewport;return!H.eq(this.markers,t,n.from,n.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class JS{constructor(e,t,n,r){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,n,r)}update(e,t,n,r){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),RR(this.markers,r)||this.setMarkers(e,r)}setMarkers(e,t){let n="cm-gutterElement",r=this.dom.firstChild;for(let s=0,o=0;;){let l=o,a=s<t.length?t[s++]:null,h=!1;if(a){let c=a.elementClass;c&&(n+=" "+c);for(let f=o;f<this.markers.length;f++)if(this.markers[f].compare(a)){l=f,h=!0;break}}else l=this.markers.length;for(;o<l;){let c=this.markers[o++];if(c.toDOM){c.destroy(r);let f=r.nextSibling;r.remove(),r=f}}if(!a)break;a.toDOM&&(h?r=r.nextSibling:this.dom.insertBefore(a.toDOM(e),r)),h&&o++}this.dom.className=n,this.markers=t}destroy(){this.setMarkers(null,[])}}function RR(i,e){if(i.length!=e.length)return!1;for(let t=0;t<i.length;t++)if(!i[t].compare(e[t]))return!1;return!0}const ER=R.define(),us=R.define({combine(i){return On(i,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let n=Object.assign({},e);for(let r in t){let s=n[r],o=t[r];n[r]=s?(l,a,h)=>s(l,a,h)||o(l,a,h):o}return n}})}});class Yf extends Ln{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function jf(i,e){return i.state.facet(us).formatNumber(e,i.state)}const NR=al.compute([us],i=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(ER)},lineMarker(e,t,n){return n.some(r=>r.toDOM)?null:new Yf(jf(e,e.state.doc.lineAt(t.from).number))},widgetMarker:()=>null,lineMarkerChange:e=>e.startState.facet(us)!=e.state.facet(us),initialSpacer(e){return new Yf(jf(e,T0(e.state.doc.lines)))},updateSpacer(e,t){let n=jf(t.view,T0(t.view.state.doc.lines));return n==e.number?e:new Yf(n)},domEventHandlers:i.facet(us).domEventHandlers}));function DR(i={}){return[us.of(i),KS(),NR]}function T0(i){let e=9;for(;e<i;)e=e*10+9;return e}const IR=new class extends Ln{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},WR=vh.compute(["selection"],i=>{let e=[],t=-1;for(let n of i.selection.ranges){let r=i.doc.lineAt(n.head).from;r>t&&(t=r,e.push(IR.range(r)))}return H.of(e)});function XR(){return WR}const ew=1024;let BR=0;class jt{constructor(e,t){this.from=e,this.to=t}}class B{constructor(e={}){this.id=BR++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Me.match(e)),t=>{let n=e(t);return n===void 0?null:[this,n]}}}B.closedBy=new B({deserialize:i=>i.split(" ")});B.openedBy=new B({deserialize:i=>i.split(" ")});B.group=new B({deserialize:i=>i.split(" ")});B.isolate=new B({deserialize:i=>{if(i&&i!="rtl"&&i!="ltr"&&i!="auto")throw new RangeError("Invalid value for isolate: "+i);return i||"auto"}});B.contextHash=new B({perNode:!0});B.lookAhead=new B({perNode:!0});B.mounted=new B({perNode:!0});class Ml{constructor(e,t,n){this.tree=e,this.overlay=t,this.parser=n}static get(e){return e&&e.props&&e.props[B.mounted.id]}}const VR=Object.create(null);class Me{constructor(e,t,n,r=0){this.name=e,this.props=t,this.id=n,this.flags=r}static define(e){let t=e.props&&e.props.length?Object.create(null):VR,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),r=new Me(e.name||"",t,e.id,n);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(r)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return r}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(B.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let n in e)for(let r of n.split(" "))t[r]=e[n];return n=>{for(let r=n.prop(B.group),s=-1;s<(r?r.length:0);s++){let o=t[s<0?n.name:r[s]];if(o)return o}}}}Me.none=new Me("",Object.create(null),0,8);class Hs{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let n of this.types){let r=null;for(let s of e){let o=s(n);o&&(r||(r=Object.assign({},n.props)),r[o[0].id]=o[1])}t.push(r?new Me(n.name,r,n.id,n.flags):n)}return new Hs(t)}}const Ta=new WeakMap,M0=new WeakMap;var ce;(function(i){i[i.ExcludeBuffers=1]="ExcludeBuffers",i[i.IncludeAnonymous=2]="IncludeAnonymous",i[i.IgnoreMounts=4]="IgnoreMounts",i[i.IgnoreOverlays=8]="IgnoreOverlays"})(ce||(ce={}));class F{constructor(e,t,n,r,s){if(this.type=e,this.children=t,this.positions=n,this.length=r,this.props=null,s&&s.length){this.props=Object.create(null);for(let[o,l]of s)this.props[typeof o=="number"?o:o.id]=l}}toString(){let e=Ml.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let n of this.children){let r=n.toString();r&&(t&&(t+=","),t+=r)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new Kh(this.topNode,e)}cursorAt(e,t=0,n=0){let r=Ta.get(this)||this.topNode,s=new Kh(r);return s.moveTo(e,t),Ta.set(this,s._tree),s}get topNode(){return new Ke(this,0,0,null)}resolve(e,t=0){let n=Al(Ta.get(this)||this.topNode,e,t,!1);return Ta.set(this,n),n}resolveInner(e,t=0){let n=Al(M0.get(this)||this.topNode,e,t,!0);return M0.set(this,n),n}resolveStack(e,t=0){return zR(this,e,t)}iterate(e){let{enter:t,leave:n,from:r=0,to:s=this.length}=e,o=e.mode||0,l=(o&ce.IncludeAnonymous)>0;for(let a=this.cursor(o|ce.IncludeAnonymous);;){let h=!1;if(a.from<=s&&a.to>=r&&(!l&&a.type.isAnonymous||t(a)!==!1)){if(a.firstChild())continue;h=!0}for(;h&&n&&(l||!a.type.isAnonymous)&&n(a),!a.nextSibling();){if(!a.parent())return;h=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:Kp(Me.none,this.children,this.positions,0,this.children.length,0,this.length,(t,n,r)=>new F(this.type,t,n,r,this.propValues),e.makeTree||((t,n,r)=>new F(Me.none,t,n,r)))}static build(e){return YR(e)}}F.empty=new F(Me.none,[],[],0);class Gp{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Gp(this.buffer,this.index)}}class Gi{constructor(e,t,n){this.buffer=e,this.length=t,this.set=n}get type(){return Me.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],n=this.buffer[e+3],r=this.set.types[t],s=r.name;if(/\W/.test(s)&&!r.isError&&(s=JSON.stringify(s)),e+=4,n==e)return s;let o=[];for(;e<n;)o.push(this.childString(e)),e=this.buffer[e+3];return s+"("+o.join(",")+")"}findChild(e,t,n,r,s){let{buffer:o}=this,l=-1;for(let a=e;a!=t&&!(tw(s,r,o[a+1],o[a+2])&&(l=a,n>0));a=o[a+3]);return l}slice(e,t,n){let r=this.buffer,s=new Uint16Array(t-e),o=0;for(let l=e,a=0;l<t;){s[a++]=r[l++],s[a++]=r[l++]-n;let h=s[a++]=r[l++]-n;s[a++]=r[l++]-e,o=Math.max(o,h)}return new Gi(s,o,this.set)}}function tw(i,e,t,n){switch(i){case-2:return t<e;case-1:return n>=e&&t<e;case 0:return t<e&&n>e;case 1:return t<=e&&n>e;case 2:return n>e;case 4:return!0}}function Al(i,e,t,n){for(var r;i.from==i.to||(t<1?i.from>=e:i.from>e)||(t>-1?i.to<=e:i.to<e);){let o=!n&&i instanceof Ke&&i.index<0?null:i.parent;if(!o)return i;i=o}let s=n?0:ce.IgnoreOverlays;if(n)for(let o=i,l=o.parent;l;o=l,l=o.parent)o instanceof Ke&&o.index<0&&((r=l.enter(e,t,s))===null||r===void 0?void 0:r.from)!=o.from&&(i=l);for(;;){let o=i.enter(e,t,s);if(!o)return i;i=o}}class nw{cursor(e=0){return new Kh(this,e)}getChild(e,t=null,n=null){let r=A0(this,e,t,n);return r.length?r[0]:null}getChildren(e,t=null,n=null){return A0(this,e,t,n)}resolve(e,t=0){return Al(this,e,t,!1)}resolveInner(e,t=0){return Al(this,e,t,!0)}matchContext(e){return Nd(this,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),n=this;for(;t;){let r=t.lastChild;if(!r||r.to!=t.to)break;r.type.isError&&r.from==r.to?(n=t,t=r.prevSibling):t=r}return n}get node(){return this}get next(){return this.parent}}class Ke extends nw{constructor(e,t,n,r){super(),this._tree=e,this.from=t,this.index=n,this._parent=r}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,n,r,s=0){for(let o=this;;){for(let{children:l,positions:a}=o._tree,h=t>0?l.length:-1;e!=h;e+=t){let c=l[e],f=a[e]+o.from;if(tw(r,n,f,f+c.length)){if(c instanceof Gi){if(s&ce.ExcludeBuffers)continue;let u=c.findChild(0,c.buffer.length,t,n-f,r);if(u>-1)return new En(new qR(o,c,e,f),null,u)}else if(s&ce.IncludeAnonymous||!c.type.isAnonymous||Hp(c)){let u;if(!(s&ce.IgnoreMounts)&&(u=Ml.get(c))&&!u.overlay)return new Ke(u.tree,f,e,o);let d=new Ke(c,f,e,o);return s&ce.IncludeAnonymous||!d.type.isAnonymous?d:d.nextChild(t<0?c.children.length-1:0,t,n,r)}}}if(s&ce.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?e=o.index+t:e=t<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,n=0){let r;if(!(n&ce.IgnoreOverlays)&&(r=Ml.get(this._tree))&&r.overlay){let s=e-this.from;for(let{from:o,to:l}of r.overlay)if((t>0?o<=s:o<s)&&(t<0?l>=s:l>s))return new Ke(r.tree,r.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,n)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function A0(i,e,t,n){let r=i.cursor(),s=[];if(!r.firstChild())return s;if(t!=null){for(let o=!1;!o;)if(o=r.type.is(t),!r.nextSibling())return s}for(;;){if(n!=null&&r.type.is(n))return s;if(r.type.is(e)&&s.push(r.node),!r.nextSibling())return n==null?s:[]}}function Nd(i,e,t=e.length-1){for(let n=i.parent;t>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[t]&&e[t]!=n.name)return!1;t--}}return!0}class qR{constructor(e,t,n,r){this.parent=e,this.buffer=t,this.index=n,this.start=r}}class En extends nw{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,n){super(),this.context=e,this._parent=t,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(e,t,n){let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],e,t-this.context.start,n);return s<0?null:new En(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,n=0){if(n&ce.ExcludeBuffers)return null;let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new En(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new En(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new En(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:n}=this.context,r=this.index+4,s=n.buffer[this.index+3];if(s>r){let o=n.buffer[this.index+1];e.push(n.slice(r,s,o)),t.push(0)}return new F(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function iw(i){if(!i.length)return null;let e=0,t=i[0];for(let s=1;s<i.length;s++){let o=i[s];(o.from>t.from||o.to<t.to)&&(t=o,e=s)}let n=t instanceof Ke&&t.index<0?null:t.parent,r=i.slice();return n?r[e]=n:r.splice(e,1),new LR(r,t)}class LR{constructor(e,t){this.heads=e,this.node=t}get next(){return iw(this.heads)}}function zR(i,e,t){let n=i.resolveInner(e,t),r=null;for(let s=n instanceof Ke?n:n.context.parent;s;s=s.parent)if(s.index<0){let o=s.parent;(r||(r=[n])).push(o.resolve(e,t)),s=o}else{let o=Ml.get(s.tree);if(o&&o.overlay&&o.overlay[0].from<=e&&o.overlay[o.overlay.length-1].to>=e){let l=new Ke(o.tree,o.overlay[0].from+s.from,-1,s);(r||(r=[n])).push(Al(l,e,t,!1))}}return r?iw(r):n}class Kh{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Ke)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let n=e._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:n,buffer:r}=this.buffer;return this.type=t||r.set.types[r.buffer[e]],this.from=n+r.buffer[e+1],this.to=n+r.buffer[e+2],!0}yield(e){return e?e instanceof Ke?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,n,this.mode));let{buffer:r}=this.buffer,s=r.findChild(this.index+4,r.buffer[this.index+3],e,t-this.buffer.start,n);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,n=this.mode){return this.buffer?n&ce.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&ce.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&ce.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,n=this.stack.length-1;if(e<0){let r=n<0?0:this.stack[n]+4;if(this.index!=r)return this.yieldBuf(t.findChild(r,this.index,-1,0,4))}else{let r=t.buffer[this.index+3];if(r<(n<0?t.buffer.length:t.buffer[this.stack[n]+3]))return this.yieldBuf(r)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,n,{buffer:r}=this;if(r){if(e>0){if(this.index<r.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(r.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:n}=r)}else({index:t,_parent:n}=this._tree);for(;n;{index:t,_parent:n}=n)if(t>-1)for(let s=t+e,o=e<0?-1:n._tree.children.length;s!=o;s+=e){let l=n._tree.children[s];if(this.mode&ce.IncludeAnonymous||l instanceof Gi||!l.type.isAnonymous||Hp(l))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,n=0;if(e&&e.context==this.buffer)e:for(let r=this.index,s=this.stack.length;s>=0;){for(let o=e;o;o=o._parent)if(o.index==r){if(r==this.index)return o;t=o,n=s+1;break e}r=this.stack[--s]}for(let r=n;r<this.stack.length;r++)t=new En(this.buffer,t,this.stack[r]);return this.bufferNode=new En(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let n=0;;){let r=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(r=!0)}for(;r&&t&&t(this),r=this.type.isAnonymous,!this.nextSibling();){if(!n)return;this.parent(),n--,r=!0}}}matchContext(e){if(!this.buffer)return Nd(this.node,e);let{buffer:t}=this.buffer,{types:n}=t.set;for(let r=e.length-1,s=this.stack.length-1;r>=0;s--){if(s<0)return Nd(this.node,e,r);let o=n[t.buffer[this.stack[s]]];if(!o.isAnonymous){if(e[r]&&e[r]!=o.name)return!1;r--}}return!0}}function Hp(i){return i.children.some(e=>e instanceof Gi||!e.type.isAnonymous||Hp(e))}function YR(i){var e;let{buffer:t,nodeSet:n,maxBufferLength:r=ew,reused:s=[],minRepeatType:o=n.types.length}=i,l=Array.isArray(t)?new Gp(t,t.length):t,a=n.types,h=0,c=0;function f(S,x,Q,X,A,L){let{id:z,start:Y,end:se,size:ie}=l,be=c;for(;ie<0;)if(l.next(),ie==-1){let Ze=s[z];Q.push(Ze),X.push(Y-S);return}else if(ie==-3){h=z;return}else if(ie==-4){c=z;return}else throw new RangeError(`Unrecognized record size: ${ie}`);let mt=a[z],gt,xt,Wt=Y-S;if(se-Y<=r&&(xt=g(l.pos-x,A))){let Ze=new Uint16Array(xt.size-xt.skip),Xt=l.pos-xt.size,bn=Ze.length;for(;l.pos>Xt;)bn=y(xt.start,Ze,bn);gt=new Gi(Ze,se-xt.start,n),Wt=xt.start-S}else{let Ze=l.pos-ie;l.next();let Xt=[],bn=[],ir=z>=o?z:-1,_r=0,ha=se;for(;l.pos>Ze;)ir>=0&&l.id==ir&&l.size>=0?(l.end<=ha-r&&(p(Xt,bn,Y,_r,l.end,ha,ir,be),_r=Xt.length,ha=l.end),l.next()):L>2500?u(Y,Ze,Xt,bn):f(Y,Ze,Xt,bn,ir,L+1);if(ir>=0&&_r>0&&_r<Xt.length&&p(Xt,bn,Y,_r,Y,ha,ir,be),Xt.reverse(),bn.reverse(),ir>-1&&_r>0){let xg=d(mt);gt=Kp(mt,Xt,bn,0,Xt.length,0,se-Y,xg,xg)}else gt=m(mt,Xt,bn,se-Y,be-se)}Q.push(gt),X.push(Wt)}function u(S,x,Q,X){let A=[],L=0,z=-1;for(;l.pos>x;){let{id:Y,start:se,end:ie,size:be}=l;if(be>4)l.next();else{if(z>-1&&se<z)break;z<0&&(z=ie-r),A.push(Y,se,ie),L++,l.next()}}if(L){let Y=new Uint16Array(L*4),se=A[A.length-2];for(let ie=A.length-3,be=0;ie>=0;ie-=3)Y[be++]=A[ie],Y[be++]=A[ie+1]-se,Y[be++]=A[ie+2]-se,Y[be++]=be;Q.push(new Gi(Y,A[2]-se,n)),X.push(se-S)}}function d(S){return(x,Q,X)=>{let A=0,L=x.length-1,z,Y;if(L>=0&&(z=x[L])instanceof F){if(!L&&z.type==S&&z.length==X)return z;(Y=z.prop(B.lookAhead))&&(A=Q[L]+z.length+Y)}return m(S,x,Q,X,A)}}function p(S,x,Q,X,A,L,z,Y){let se=[],ie=[];for(;S.length>X;)se.push(S.pop()),ie.push(x.pop()+Q-A);S.push(m(n.types[z],se,ie,L-A,Y-L)),x.push(A-Q)}function m(S,x,Q,X,A=0,L){if(h){let z=[B.contextHash,h];L=L?[z].concat(L):[z]}if(A>25){let z=[B.lookAhead,A];L=L?[z].concat(L):[z]}return new F(S,x,Q,X,L)}function g(S,x){let Q=l.fork(),X=0,A=0,L=0,z=Q.end-r,Y={size:0,start:0,skip:0};e:for(let se=Q.pos-S;Q.pos>se;){let ie=Q.size;if(Q.id==x&&ie>=0){Y.size=X,Y.start=A,Y.skip=L,L+=4,X+=4,Q.next();continue}let be=Q.pos-ie;if(ie<0||be<se||Q.start<z)break;let mt=Q.id>=o?4:0,gt=Q.start;for(Q.next();Q.pos>be;){if(Q.size<0)if(Q.size==-3)mt+=4;else break e;else Q.id>=o&&(mt+=4);Q.next()}A=gt,X+=ie,L+=mt}return(x<0||X==S)&&(Y.size=X,Y.start=A,Y.skip=L),Y.size>4?Y:void 0}function y(S,x,Q){let{id:X,start:A,end:L,size:z}=l;if(l.next(),z>=0&&X<o){let Y=Q;if(z>4){let se=l.pos-(z-4);for(;l.pos>se;)Q=y(S,x,Q)}x[--Q]=Y,x[--Q]=L-S,x[--Q]=A-S,x[--Q]=X}else z==-3?h=X:z==-4&&(c=X);return Q}let k=[],v=[];for(;l.pos>0;)f(i.start||0,i.bufferStart||0,k,v,-1,0);let $=(e=i.length)!==null&&e!==void 0?e:k.length?v[0]+k[0].length:0;return new F(a[i.topID],k.reverse(),v.reverse(),$)}const Z0=new WeakMap;function $h(i,e){if(!i.isAnonymous||e instanceof Gi||e.type!=i)return 1;let t=Z0.get(e);if(t==null){t=1;for(let n of e.children){if(n.type!=i||!(n instanceof F)){t=1;break}t+=$h(i,n)}Z0.set(e,t)}return t}function Kp(i,e,t,n,r,s,o,l,a){let h=0;for(let p=n;p<r;p++)h+=$h(i,e[p]);let c=Math.ceil(h*1.5/8),f=[],u=[];function d(p,m,g,y,k){for(let v=g;v<y;){let $=v,S=m[v],x=$h(i,p[v]);for(v++;v<y;v++){let Q=$h(i,p[v]);if(x+Q>=c)break;x+=Q}if(v==$+1){if(x>c){let Q=p[$];d(Q.children,Q.positions,0,Q.children.length,m[$]+k);continue}f.push(p[$])}else{let Q=m[v-1]+p[v-1].length-S;f.push(Kp(i,p,m,$,v,S,Q,null,a))}u.push(S+k-s)}}return d(e,t,n,r,0),(l||a)(f,u,o)}class rw{constructor(){this.map=new WeakMap}setBuffer(e,t,n){let r=this.map.get(e);r||this.map.set(e,r=new Map),r.set(t,n)}getBuffer(e,t){let n=this.map.get(e);return n&&n.get(t)}set(e,t){e instanceof En?this.setBuffer(e.context.buffer,e.index,t):e instanceof Ke&&this.map.set(e.tree,t)}get(e){return e instanceof En?this.getBuffer(e.context.buffer,e.index):e instanceof Ke?this.map.get(e.tree):void 0}cursorSet(e,t){e.buffer?this.setBuffer(e.buffer.buffer,e.index,t):this.map.set(e.tree,t)}cursorGet(e){return e.buffer?this.getBuffer(e.buffer.buffer,e.index):this.map.get(e.tree)}}class oi{constructor(e,t,n,r,s=!1,o=!1){this.from=e,this.to=t,this.tree=n,this.offset=r,this.open=(s?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],n=!1){let r=[new oi(0,e.length,e,0,!1,n)];for(let s of t)s.to>e.length&&r.push(s);return r}static applyChanges(e,t,n=128){if(!t.length)return e;let r=[],s=1,o=e.length?e[0]:null;for(let l=0,a=0,h=0;;l++){let c=l<t.length?t[l]:null,f=c?c.fromA:1e9;if(f-a>=n)for(;o&&o.from<f;){let u=o;if(a>=u.from||f<=u.to||h){let d=Math.max(u.from,a)-h,p=Math.min(u.to,f)-h;u=d>=p?null:new oi(d,p,u.tree,u.offset+h,l>0,!!c)}if(u&&r.push(u),o.to>f)break;o=s<e.length?e[s++]:null}if(!c)break;a=c.toA,h=c.toA-c.toB}return r}}class Bc{startParse(e,t,n){return typeof e=="string"&&(e=new jR(e)),n=n?n.length?n.map(r=>new jt(r.from,r.to)):[new jt(0,0)]:[new jt(0,e.length)],this.createParse(e,t||[],n)}parse(e,t,n){let r=this.startParse(e,t,n);for(;;){let s=r.advance();if(s)return s}}}class jR{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}function sw(i){return(e,t,n,r)=>new FR(e,i,t,n,r)}class R0{constructor(e,t,n,r,s){this.parser=e,this.parse=t,this.overlay=n,this.target=r,this.from=s}}function E0(i){if(!i.length||i.some(e=>e.from>=e.to))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(i))}class _R{constructor(e,t,n,r,s,o,l){this.parser=e,this.predicate=t,this.mounts=n,this.index=r,this.start=s,this.target=o,this.prev=l,this.depth=0,this.ranges=[]}}const Dd=new B({perNode:!0});class FR{constructor(e,t,n,r,s){this.nest=t,this.input=n,this.fragments=r,this.ranges=s,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=e}advance(){if(this.baseParse){let n=this.baseParse.advance();if(!n)return null;if(this.baseParse=null,this.baseTree=n,this.startInner(),this.stoppedAt!=null)for(let r of this.inner)r.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let n=this.baseTree;return this.stoppedAt!=null&&(n=new F(n.type,n.children,n.positions,n.length,n.propValues.concat([[Dd,this.stoppedAt]]))),n}let e=this.inner[this.innerDone],t=e.parse.advance();if(t){this.innerDone++;let n=Object.assign(Object.create(null),e.target.props);n[B.mounted.id]=new Ml(t,e.overlay,e.parser),e.target.props=n}return null}get parsedPos(){if(this.baseParse)return 0;let e=this.input.length;for(let t=this.innerDone;t<this.inner.length;t++)this.inner[t].from<e&&(e=Math.min(e,this.inner[t].parse.parsedPos));return e}stopAt(e){if(this.stoppedAt=e,this.baseParse)this.baseParse.stopAt(e);else for(let t=this.innerDone;t<this.inner.length;t++)this.inner[t].parse.stopAt(e)}startInner(){let e=new HR(this.fragments),t=null,n=null,r=new Kh(new Ke(this.baseTree,this.ranges[0].from,0,null),ce.IncludeAnonymous|ce.IgnoreMounts);e:for(let s,o;;){let l=!0,a;if(this.stoppedAt!=null&&r.from>=this.stoppedAt)l=!1;else if(e.hasNode(r)){if(t){let h=t.mounts.find(c=>c.frag.from<=r.from&&c.frag.to>=r.to&&c.mount.overlay);if(h)for(let c of h.mount.overlay){let f=c.from+h.pos,u=c.to+h.pos;f>=r.from&&u<=r.to&&!t.ranges.some(d=>d.from<u&&d.to>f)&&t.ranges.push({from:f,to:u})}}l=!1}else if(n&&(o=UR(n.ranges,r.from,r.to)))l=o!=2;else if(!r.type.isAnonymous&&(s=this.nest(r,this.input))&&(r.from<r.to||!s.overlay)){r.tree||GR(r);let h=e.findMounts(r.from,s.parser);if(typeof s.overlay=="function")t=new _R(s.parser,s.overlay,h,this.inner.length,r.from,r.tree,t);else{let c=I0(this.ranges,s.overlay||(r.from<r.to?[new jt(r.from,r.to)]:[]));c.length&&E0(c),(c.length||!s.overlay)&&this.inner.push(new R0(s.parser,c.length?s.parser.startParse(this.input,W0(h,c),c):s.parser.startParse(""),s.overlay?s.overlay.map(f=>new jt(f.from-r.from,f.to-r.from)):null,r.tree,c.length?c[0].from:r.from)),s.overlay?c.length&&(n={ranges:c,depth:0,prev:n}):l=!1}}else t&&(a=t.predicate(r))&&(a===!0&&(a=new jt(r.from,r.to)),a.from<a.to&&t.ranges.push(a));if(l&&r.firstChild())t&&t.depth++,n&&n.depth++;else for(;!r.nextSibling();){if(!r.parent())break e;if(t&&!--t.depth){let h=I0(this.ranges,t.ranges);h.length&&(E0(h),this.inner.splice(t.index,0,new R0(t.parser,t.parser.startParse(this.input,W0(t.mounts,h),h),t.ranges.map(c=>new jt(c.from-t.start,c.to-t.start)),t.target,h[0].from))),t=t.prev}n&&!--n.depth&&(n=n.prev)}}}}function UR(i,e,t){for(let n of i){if(n.from>=t)break;if(n.to>e)return n.from<=e&&n.to>=t?2:1}return 0}function N0(i,e,t,n,r,s){if(e<t){let o=i.buffer[e+1];n.push(i.slice(e,t,o)),r.push(o-s)}}function GR(i){let{node:e}=i,t=[],n=e.context.buffer;do t.push(i.index),i.parent();while(!i.tree);let r=i.tree,s=r.children.indexOf(n),o=r.children[s],l=o.buffer,a=[s];function h(c,f,u,d,p,m){let g=t[m],y=[],k=[];N0(o,c,g,y,k,d);let v=l[g+1],$=l[g+2];a.push(y.length);let S=m?h(g+4,l[g+3],o.set.types[l[g]],v,$-v,m-1):e.toTree();return y.push(S),k.push(v-d),N0(o,l[g+3],f,y,k,d),new F(u,y,k,p)}r.children[s]=h(0,l.length,Me.none,0,o.length,t.length-1);for(let c of a){let f=i.tree.children[c],u=i.tree.positions[c];i.yield(new Ke(f,u+i.from,c,i._tree))}}class D0{constructor(e,t){this.offset=t,this.done=!1,this.cursor=e.cursor(ce.IncludeAnonymous|ce.IgnoreMounts)}moveTo(e){let{cursor:t}=this,n=e-this.offset;for(;!this.done&&t.from<n;)t.to>=e&&t.enter(n,1,ce.IgnoreOverlays|ce.ExcludeBuffers)||t.next(!1)||(this.done=!0)}hasNode(e){if(this.moveTo(e.from),!this.done&&this.cursor.from+this.offset==e.from&&this.cursor.tree)for(let t=this.cursor.tree;;){if(t==e.tree)return!0;if(t.children.length&&t.positions[0]==0&&t.children[0]instanceof F)t=t.children[0];else break}return!1}}let HR=class{constructor(e){var t;if(this.fragments=e,this.curTo=0,this.fragI=0,e.length){let n=this.curFrag=e[0];this.curTo=(t=n.tree.prop(Dd))!==null&&t!==void 0?t:n.to,this.inner=new D0(n.tree,-n.offset)}else this.curFrag=this.inner=null}hasNode(e){for(;this.curFrag&&e.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=e.from&&this.curTo>=e.to&&this.inner.hasNode(e)}nextFrag(){var e;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let t=this.curFrag=this.fragments[this.fragI];this.curTo=(e=t.tree.prop(Dd))!==null&&e!==void 0?e:t.to,this.inner=new D0(t.tree,-t.offset)}}findMounts(e,t){var n;let r=[];if(this.inner){this.inner.cursor.moveTo(e,1);for(let s=this.inner.cursor.node;s;s=s.parent){let o=(n=s.tree)===null||n===void 0?void 0:n.prop(B.mounted);if(o&&o.parser==t)for(let l=this.fragI;l<this.fragments.length;l++){let a=this.fragments[l];if(a.from>=s.to)break;a.tree==this.curFrag.tree&&r.push({frag:a,pos:s.from-a.offset,mount:o})}}}return r}};function I0(i,e){let t=null,n=e;for(let r=1,s=0;r<i.length;r++){let o=i[r-1].to,l=i[r].from;for(;s<n.length;s++){let a=n[s];if(a.from>=l)break;a.to<=o||(t||(n=t=e.slice()),a.from<o?(t[s]=new jt(a.from,o),a.to>l&&t.splice(s+1,0,new jt(l,a.to))):a.to>l?t[s--]=new jt(l,a.to):t.splice(s--,1))}}return n}function KR(i,e,t,n){let r=0,s=0,o=!1,l=!1,a=-1e9,h=[];for(;;){let c=r==i.length?1e9:o?i[r].to:i[r].from,f=s==e.length?1e9:l?e[s].to:e[s].from;if(o!=l){let u=Math.max(a,t),d=Math.min(c,f,n);u<d&&h.push(new jt(u,d))}if(a=Math.min(c,f),a==1e9)break;c==a&&(o?(o=!1,r++):o=!0),f==a&&(l?(l=!1,s++):l=!0)}return h}function W0(i,e){let t=[];for(let{pos:n,mount:r,frag:s}of i){let o=n+(r.overlay?r.overlay[0].from:0),l=o+r.tree.length,a=Math.max(s.from,o),h=Math.min(s.to,l);if(r.overlay){let c=r.overlay.map(u=>new jt(u.from+n,u.to+n)),f=KR(e,c,a,h);for(let u=0,d=a;;u++){let p=u==f.length,m=p?h:f[u].from;if(m>d&&t.push(new oi(d,m,r.tree,-o,s.from>=d||s.openStart,s.to<=m||s.openEnd)),p)break;d=f[u].to}}else t.push(new oi(a,h,r.tree,-o,s.from>=o||s.openStart,s.to<=l||s.openEnd))}return t}let JR=0;class sn{constructor(e,t,n){this.set=e,this.base=t,this.modified=n,this.id=JR++}static define(e){if(e!=null&&e.base)throw new Error("Can not derive from a modified tag");let t=new sn([],null,[]);if(t.set.push(t),e)for(let n of e.set)t.set.push(n);return t}static defineModifier(){let e=new Jh;return t=>t.modified.indexOf(e)>-1?t:Jh.get(t.base||t,t.modified.concat(e).sort((n,r)=>n.id-r.id))}}let e2=0;class Jh{constructor(){this.instances=[],this.id=e2++}static get(e,t){if(!t.length)return e;let n=t[0].instances.find(l=>l.base==e&&t2(t,l.modified));if(n)return n;let r=[],s=new sn(r,e,t);for(let l of t)l.instances.push(s);let o=n2(t);for(let l of e.set)if(!l.modified.length)for(let a of o)r.push(Jh.get(l,a));return s}}function t2(i,e){return i.length==e.length&&i.every((t,n)=>t==e[n])}function n2(i){let e=[[]];for(let t=0;t<i.length;t++)for(let n=0,r=e.length;n<r;n++)e.push(e[n].concat(i[t]));return e.sort((t,n)=>n.length-t.length)}function Ks(i){let e=Object.create(null);for(let t in i){let n=i[t];Array.isArray(n)||(n=[n]);for(let r of t.split(" "))if(r){let s=[],o=2,l=r;for(let f=0;;){if(l=="..."&&f>0&&f+3==r.length){o=1;break}let u=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(l);if(!u)throw new RangeError("Invalid path: "+r);if(s.push(u[0]=="*"?"":u[0][0]=='"'?JSON.parse(u[0]):u[0]),f+=u[0].length,f==r.length)break;let d=r[f++];if(f==r.length&&d=="!"){o=0;break}if(d!="/")throw new RangeError("Invalid path: "+r);l=r.slice(f)}let a=s.length-1,h=s[a];if(!h)throw new RangeError("Invalid path: "+r);let c=new ec(n,o,a>0?s.slice(0,a):null);e[h]=c.sort(e[h])}}return ow.add(e)}const ow=new B;class ec{constructor(e,t,n,r){this.tags=e,this.mode=t,this.context=n,this.next=r}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}ec.empty=new ec([],2,null);function lw(i,e){let t=Object.create(null);for(let s of i)if(!Array.isArray(s.tag))t[s.tag.id]=s.class;else for(let o of s.tag)t[o.id]=s.class;let{scope:n,all:r=null}=e||{};return{style:s=>{let o=r;for(let l of s)for(let a of l.set){let h=t[a.id];if(h){o=o?o+" "+h:h;break}}return o},scope:n}}function i2(i,e){let t=null;for(let n of i){let r=n.style(e);r&&(t=t?t+" "+r:r)}return t}function r2(i,e,t,n=0,r=i.length){let s=new s2(n,Array.isArray(e)?e:[e],t);s.highlightRange(i.cursor(),n,r,"",s.highlighters),s.flush(r)}class s2{constructor(e,t,n){this.at=e,this.highlighters=t,this.span=n,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,n,r,s){let{type:o,from:l,to:a}=e;if(l>=n||a<=t)return;o.isTop&&(s=this.highlighters.filter(d=>!d.scope||d.scope(o)));let h=r,c=o2(e)||ec.empty,f=i2(s,c.tags);if(f&&(h&&(h+=" "),h+=f,c.mode==1&&(r+=(r?" ":"")+f)),this.startSpan(Math.max(t,l),h),c.opaque)return;let u=e.tree&&e.tree.prop(B.mounted);if(u&&u.overlay){let d=e.node.enter(u.overlay[0].from+l,1),p=this.highlighters.filter(g=>!g.scope||g.scope(u.tree.type)),m=e.firstChild();for(let g=0,y=l;;g++){let k=g<u.overlay.length?u.overlay[g]:null,v=k?k.from+l:a,$=Math.max(t,y),S=Math.min(n,v);if($<S&&m)for(;e.from<S&&(this.highlightRange(e,$,S,r,s),this.startSpan(Math.min(S,e.to),h),!(e.to>=v||!e.nextSibling())););if(!k||v>n)break;y=k.to+l,y>t&&(this.highlightRange(d.cursor(),Math.max(t,k.from+l),Math.min(n,y),"",p),this.startSpan(Math.min(n,y),h))}m&&e.parent()}else if(e.firstChild()){u&&(r="");do if(!(e.to<=t)){if(e.from>=n)break;this.highlightRange(e,t,n,r,s),this.startSpan(Math.min(n,e.to),h)}while(e.nextSibling());e.parent()}}}function o2(i){let e=i.type.prop(ow);for(;e&&e.context&&!i.matchContext(e.context);)e=e.next;return e||null}const T=sn.define,Ma=T(),Pi=T(),X0=T(Pi),B0=T(Pi),Qi=T(),Aa=T(Qi),_f=T(Qi),Pn=T(),rr=T(Pn),wn=T(),xn=T(),Id=T(),fo=T(Id),Za=T(),O={comment:Ma,lineComment:T(Ma),blockComment:T(Ma),docComment:T(Ma),name:Pi,variableName:T(Pi),typeName:X0,tagName:T(X0),propertyName:B0,attributeName:T(B0),className:T(Pi),labelName:T(Pi),namespace:T(Pi),macroName:T(Pi),literal:Qi,string:Aa,docString:T(Aa),character:T(Aa),attributeValue:T(Aa),number:_f,integer:T(_f),float:T(_f),bool:T(Qi),regexp:T(Qi),escape:T(Qi),color:T(Qi),url:T(Qi),keyword:wn,self:T(wn),null:T(wn),atom:T(wn),unit:T(wn),modifier:T(wn),operatorKeyword:T(wn),controlKeyword:T(wn),definitionKeyword:T(wn),moduleKeyword:T(wn),operator:xn,derefOperator:T(xn),arithmeticOperator:T(xn),logicOperator:T(xn),bitwiseOperator:T(xn),compareOperator:T(xn),updateOperator:T(xn),definitionOperator:T(xn),typeOperator:T(xn),controlOperator:T(xn),punctuation:Id,separator:T(Id),bracket:fo,angleBracket:T(fo),squareBracket:T(fo),paren:T(fo),brace:T(fo),content:Pn,heading:rr,heading1:T(rr),heading2:T(rr),heading3:T(rr),heading4:T(rr),heading5:T(rr),heading6:T(rr),contentSeparator:T(Pn),list:T(Pn),quote:T(Pn),emphasis:T(Pn),strong:T(Pn),link:T(Pn),monospace:T(Pn),strikethrough:T(Pn),inserted:T(),deleted:T(),changed:T(),invalid:T(),meta:Za,documentMeta:T(Za),annotation:T(Za),processingInstruction:T(Za),definition:sn.defineModifier(),constant:sn.defineModifier(),function:sn.defineModifier(),standard:sn.defineModifier(),local:sn.defineModifier(),special:sn.defineModifier()};lw([{tag:O.link,class:"tok-link"},{tag:O.heading,class:"tok-heading"},{tag:O.emphasis,class:"tok-emphasis"},{tag:O.strong,class:"tok-strong"},{tag:O.keyword,class:"tok-keyword"},{tag:O.atom,class:"tok-atom"},{tag:O.bool,class:"tok-bool"},{tag:O.url,class:"tok-url"},{tag:O.labelName,class:"tok-labelName"},{tag:O.inserted,class:"tok-inserted"},{tag:O.deleted,class:"tok-deleted"},{tag:O.literal,class:"tok-literal"},{tag:O.string,class:"tok-string"},{tag:O.number,class:"tok-number"},{tag:[O.regexp,O.escape,O.special(O.string)],class:"tok-string2"},{tag:O.variableName,class:"tok-variableName"},{tag:O.local(O.variableName),class:"tok-variableName tok-local"},{tag:O.definition(O.variableName),class:"tok-variableName tok-definition"},{tag:O.special(O.variableName),class:"tok-variableName2"},{tag:O.definition(O.propertyName),class:"tok-propertyName tok-definition"},{tag:O.typeName,class:"tok-typeName"},{tag:O.namespace,class:"tok-namespace"},{tag:O.className,class:"tok-className"},{tag:O.macroName,class:"tok-macroName"},{tag:O.propertyName,class:"tok-propertyName"},{tag:O.operator,class:"tok-operator"},{tag:O.comment,class:"tok-comment"},{tag:O.meta,class:"tok-meta"},{tag:O.invalid,class:"tok-invalid"},{tag:O.punctuation,class:"tok-punctuation"}]);var Ff;const Di=new B;function Vc(i){return R.define({combine:i?e=>e.concat(i):void 0})}const Jp=new B;class Zt{constructor(e,t,n=[],r=""){this.data=e,this.name=r,j.prototype.hasOwnProperty("tree")||Object.defineProperty(j.prototype,"tree",{get(){return ae(this)}}),this.parser=t,this.extension=[Hi.of(this),j.languageData.of((s,o,l)=>{let a=V0(s,o,l),h=a.type.prop(Di);if(!h)return[];let c=s.facet(h),f=a.type.prop(Jp);if(f){let u=a.resolve(o-a.from,l);for(let d of f)if(d.test(u,s)){let p=s.facet(d.facet);return d.type=="replace"?p:p.concat(c)}}return c})].concat(n)}isActiveAt(e,t,n=-1){return V0(e,t,n).type.prop(Di)==this.data}findRegions(e){let t=e.facet(Hi);if((t==null?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let n=[],r=(s,o)=>{if(s.prop(Di)==this.data){n.push({from:o,to:o+s.length});return}let l=s.prop(B.mounted);if(l){if(l.tree.prop(Di)==this.data){if(l.overlay)for(let a of l.overlay)n.push({from:a.from+o,to:a.to+o});else n.push({from:o,to:o+s.length});return}else if(l.overlay){let a=n.length;if(r(l.tree,l.overlay[0].from+o),n.length>a)return}}for(let a=0;a<s.children.length;a++){let h=s.children[a];h instanceof F&&r(h,s.positions[a]+o)}};return r(ae(e),0),n}get allowsNesting(){return!0}}Zt.setState=q.define();function V0(i,e,t){let n=i.facet(Hi),r=ae(i).topNode;if(!n||n.allowsNesting)for(let s=r;s;s=s.enter(e,t,ce.ExcludeBuffers))s.type.isTop&&(r=s);return r}class Bs extends Zt{constructor(e,t,n){super(e,t,[],n),this.parser=t}static define(e){let t=Vc(e.languageData);return new Bs(t,e.parser.configure({props:[Di.add(n=>n.isTop?t:void 0)]}),e.name)}configure(e,t){return new Bs(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function ae(i){let e=i.field(Zt.state,!1);return e?e.tree:F.empty}class l2{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let n=this.cursorPos-this.string.length;return e<n||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-n,t-n)}}let uo=null;class Br{constructor(e,t,n=[],r,s,o,l,a){this.parser=e,this.state=t,this.fragments=n,this.tree=r,this.treeLen=s,this.viewport=o,this.skipped=l,this.scheduleOn=a,this.parse=null,this.tempSkipped=[]}static create(e,t,n){return new Br(e,t,[],F.empty,0,n,[],null)}startParse(){return this.parser.startParse(new l2(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=F.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if(typeof e=="number"){let r=Date.now()+e;e=()=>Date.now()>r}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let r=this.parse.advance();if(r)if(this.fragments=this.withoutTempSkipped(oi.addTree(r,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(n=this.parse.stoppedAt)!==null&&n!==void 0?n:this.state.doc.length,this.tree=r,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(oi.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=uo;uo=this;try{return e()}finally{uo=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=q0(e,t.from,t.to);return e}changes(e,t){let{fragments:n,tree:r,treeLen:s,viewport:o,skipped:l}=this;if(this.takeTree(),!e.empty){let a=[];if(e.iterChangedRanges((h,c,f,u)=>a.push({fromA:h,toA:c,fromB:f,toB:u})),n=oi.applyChanges(n,a),r=F.empty,s=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){l=[];for(let h of this.skipped){let c=e.mapPos(h.from,1),f=e.mapPos(h.to,-1);c<f&&l.push({from:c,to:f})}}}return new Br(this.parser,t,n,r,s,o,l,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let n=0;n<this.skipped.length;n++){let{from:r,to:s}=this.skipped[n];r<e.to&&s>e.from&&(this.fragments=q0(this.fragments,r,s),this.skipped.splice(n--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends Bc{createParse(t,n,r){let s=r[0].from,o=r[r.length-1].to;return{parsedPos:s,advance(){let a=uo;if(a){for(let h of r)a.tempSkipped.push(h);e&&(a.scheduleOn=a.scheduleOn?Promise.all([a.scheduleOn,e]):e)}return this.parsedPos=o,new F(Me.none,[],[],o-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return uo}}function q0(i,e,t){return oi.applyChanges(i,[{fromA:e,toA:t,fromB:e,toB:t}])}class Vs{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),n=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,n)||t.takeTree(),new Vs(t)}static init(e){let t=Math.min(3e3,e.doc.length),n=Br.create(e.facet(Hi).parser,e,{from:0,to:t});return n.work(20,t)||n.takeTree(),new Vs(n)}}Zt.state=Ae.define({create:Vs.init,update(i,e){for(let t of e.effects)if(t.is(Zt.setState))return t.value;return e.startState.facet(Hi)!=e.state.facet(Hi)?Vs.init(e.state):i.apply(e)}});let aw=i=>{let e=setTimeout(()=>i(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(aw=i=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(i,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const Uf=typeof navigator<"u"&&(!((Ff=navigator.scheduling)===null||Ff===void 0)&&Ff.isInputPending)?()=>navigator.scheduling.isInputPending():null,a2=ve.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(Zt.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(Zt.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=aw(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:r}}=this.view,s=n.field(Zt.state);if(s.tree==s.context.tree&&s.context.isDone(r+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!Uf?Math.max(25,e.timeRemaining()-5):1e9),l=s.context.treeLen<r&&n.doc.length>r+1e3,a=s.context.work(()=>Uf&&Uf()||Date.now()>o,r+(l?0:1e5));this.chunkBudget-=Date.now()-t,(a||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:Zt.setState.of(new Vs(s.context))})),this.chunkBudget>0&&!(a&&!l)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>lt(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Hi=R.define({combine(i){return i.length?i[0]:null},enables:i=>[Zt.state,a2,M.contentAttributes.compute([i],e=>{let t=e.facet(i);return t&&t.name?{"data-language":t.name}:{}})]});class Zl{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}}class tc{constructor(e,t,n,r,s,o=void 0){this.name=e,this.alias=t,this.extensions=n,this.filename=r,this.loadFunc=s,this.support=o,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then(e=>this.support=e,e=>{throw this.loading=null,e}))}static of(e){let{load:t,support:n}=e;if(!t){if(!n)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");t=()=>Promise.resolve(n)}return new tc(e.name,(e.alias||[]).concat(e.name).map(r=>r.toLowerCase()),e.extensions||[],e.filename,t,n)}static matchFilename(e,t){for(let r of e)if(r.filename&&r.filename.test(t))return r;let n=/\.([^.]+)$/.exec(t);if(n){for(let r of e)if(r.extensions.indexOf(n[1])>-1)return r}return null}static matchLanguageName(e,t,n=!0){t=t.toLowerCase();for(let r of e)if(r.alias.some(s=>s==t))return r;if(n)for(let r of e)for(let s of r.alias){let o=t.indexOf(s);if(o>-1&&(s.length>2||!/\w/.test(t[o-1])&&!/\w/.test(t[o+s.length])))return r}return null}}const hw=R.define(),Js=R.define({combine:i=>{if(!i.length)return"  ";let e=i[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(i[0]));return e}});function Vr(i){let e=i.facet(Js);return e.charCodeAt(0)==9?i.tabSize*e.length:e.length}function Rl(i,e){let t="",n=i.tabSize,r=i.facet(Js)[0];if(r=="	"){for(;e>=n;)t+="	",e-=n;r=" "}for(let s=0;s<e;s++)t+=r;return t}function em(i,e){i instanceof j&&(i=new qc(i));for(let n of i.state.facet(hw)){let r=n(i,e);if(r!==void 0)return r}let t=ae(i.state);return t.length>=e?h2(i,t,e):null}class qc{constructor(e,t={}){this.state=e,this.options=t,this.unit=Vr(e)}lineAt(e,t=1){let n=this.state.doc.lineAt(e),{simulateBreak:r,simulateDoubleBreak:s}=this.options;return r!=null&&r>=n.from&&r<=n.to?s&&r==e?{text:"",from:e}:(t<0?r<e:r<=e)?{text:n.text.slice(r-n.from),from:r}:{text:n.text.slice(0,r-n.from),from:n.from}:n}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:n,from:r}=this.lineAt(e,t);return n.slice(e-r,Math.min(n.length,e+100-r))}column(e,t=1){let{text:n,from:r}=this.lineAt(e,t),s=this.countColumn(n,e-r),o=this.options.overrideIndentation?this.options.overrideIndentation(r):-1;return o>-1&&(s+=o-this.countColumn(n,n.search(/\S|$/))),s}countColumn(e,t=e.length){return dn(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:n,from:r}=this.lineAt(e,t),s=this.options.overrideIndentation;if(s){let o=s(r);if(o>-1)return o}return this.countColumn(n,n.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const Jl=new B;function h2(i,e,t){let n=e.resolveStack(t),r=n.node.enterUnfinishedNodesBefore(t);if(r!=n.node){let s=[];for(let o=r;o!=n.node;o=o.parent)s.push(o);for(let o=s.length-1;o>=0;o--)n={node:s[o],next:n}}return cw(n,i,t)}function cw(i,e,t){for(let n=i;n;n=n.next){let r=f2(n.node);if(r)return r(tm.create(e,t,n))}return 0}function c2(i){return i.pos==i.options.simulateBreak&&i.options.simulateDoubleBreak}function f2(i){let e=i.type.prop(Jl);if(e)return e;let t=i.firstChild,n;if(t&&(n=t.type.prop(B.closedBy))){let r=i.lastChild,s=r&&n.indexOf(r.name)>-1;return o=>fw(o,!0,1,void 0,s&&!c2(o)?r.from:void 0)}return i.parent==null?u2:null}function u2(){return 0}class tm extends qc{constructor(e,t,n){super(e.state,e.options),this.base=e,this.pos=t,this.context=n}get node(){return this.context.node}static create(e,t,n){return new tm(e,t,n)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let n=e.resolve(t.from);for(;n.parent&&n.parent.from==n.from;)n=n.parent;if(d2(n,e))break;t=this.state.doc.lineAt(n.from)}return this.lineIndent(t.from)}continue(){return cw(this.context.next,this.base,this.pos)}}function d2(i,e){for(let t=e;t;t=t.parent)if(i==t)return!0;return!1}function p2(i){let e=i.node,t=e.childAfter(e.from),n=e.lastChild;if(!t)return null;let r=i.options.simulateBreak,s=i.state.doc.lineAt(t.from),o=r==null||r<=s.from?s.to:Math.min(s.to,r);for(let l=t.to;;){let a=e.childAfter(l);if(!a||a==n)return null;if(!a.type.isSkipped)return a.from<o?t:null;l=a.to}}function m2({closing:i,align:e=!0,units:t=1}){return n=>fw(n,e,t,i)}function fw(i,e,t,n,r){let s=i.textAfter,o=s.match(/^\s*/)[0].length,l=n&&s.slice(o,o+n.length)==n||r==i.pos+o,a=e?p2(i):null;return a?l?i.column(a.from):i.column(a.to):i.baseIndent+(l?0:i.unit*t)}const g2=i=>i.baseIndent;function Ph({except:i,units:e=1}={}){return t=>{let n=i&&i.test(t.textAfter);return t.baseIndent+(n?0:e*t.unit)}}const O2=200;function y2(){return j.transactionFilter.of(i=>{if(!i.docChanged||!i.isUserEvent("input.type")&&!i.isUserEvent("input.complete"))return i;let e=i.startState.languageDataAt("indentOnInput",i.startState.selection.main.head);if(!e.length)return i;let t=i.newDoc,{head:n}=i.newSelection.main,r=t.lineAt(n);if(n>r.from+O2)return i;let s=t.sliceString(r.from,n);if(!e.some(h=>h.test(s)))return i;let{state:o}=i,l=-1,a=[];for(let{head:h}of o.selection.ranges){let c=o.doc.lineAt(h);if(c.from==l)continue;l=c.from;let f=em(o,c.from);if(f==null)continue;let u=/^\s*/.exec(c.text)[0],d=Rl(o,f);u!=d&&a.push({from:c.from,to:c.from+u.length,insert:d})}return a.length?[i,{changes:a,sequential:!0}]:i})}const uw=R.define(),eo=new B;function dw(i){let e=i.firstChild,t=i.lastChild;return e&&e.to<t.from?{from:e.to,to:t.type.isError?i.to:t.from}:null}function k2(i,e,t){let n=ae(i);if(n.length<t)return null;let r=n.resolveStack(t,1),s=null;for(let o=r;o;o=o.next){let l=o.node;if(l.to<=t||l.from>t)continue;if(s&&l.from<e)break;let a=l.type.prop(eo);if(a&&(l.to<n.length-50||n.length==i.doc.length||!b2(l))){let h=a(l,i);h&&h.from<=t&&h.from>=e&&h.to>t&&(s=h)}}return s}function b2(i){let e=i.lastChild;return e&&e.to==i.to&&e.type.isError}function nc(i,e,t){for(let n of i.facet(uw)){let r=n(i,e,t);if(r)return r}return k2(i,e,t)}function pw(i,e){let t=e.mapPos(i.from,1),n=e.mapPos(i.to,-1);return t>=n?void 0:{from:t,to:n}}const Lc=q.define({map:pw}),ea=q.define({map:pw});function mw(i){let e=[];for(let{head:t}of i.state.selection.ranges)e.some(n=>n.from<=t&&n.to>=t)||e.push(i.lineBlockAt(t));return e}const qr=Ae.define({create(){return I.none},update(i,e){i=i.map(e.changes);for(let t of e.effects)if(t.is(Lc)&&!S2(i,t.value.from,t.value.to)){let{preparePlaceholder:n}=e.state.facet(nm),r=n?I.replace({widget:new C2(n(e.state,t.value))}):L0;i=i.update({add:[r.range(t.value.from,t.value.to)]})}else t.is(ea)&&(i=i.update({filter:(n,r)=>t.value.from!=n||t.value.to!=r,filterFrom:t.value.from,filterTo:t.value.to}));if(e.selection){let t=!1,{head:n}=e.selection.main;i.between(n,n,(r,s)=>{r<n&&s>n&&(t=!0)}),t&&(i=i.update({filterFrom:n,filterTo:n,filter:(r,s)=>s<=n||r>=n}))}return i},provide:i=>M.decorations.from(i),toJSON(i,e){let t=[];return i.between(0,e.doc.length,(n,r)=>{t.push(n,r)}),t},fromJSON(i){if(!Array.isArray(i)||i.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let t=0;t<i.length;){let n=i[t++],r=i[t++];if(typeof n!="number"||typeof r!="number")throw new RangeError("Invalid JSON for fold state");e.push(L0.range(n,r))}return I.set(e,!0)}});function ic(i,e,t){var n;let r=null;return(n=i.field(qr,!1))===null||n===void 0||n.between(e,t,(s,o)=>{(!r||r.from>s)&&(r={from:s,to:o})}),r}function S2(i,e,t){let n=!1;return i.between(e,e,(r,s)=>{r==e&&s==t&&(n=!0)}),n}function gw(i,e){return i.field(qr,!1)?e:e.concat(q.appendConfig.of(yw()))}const w2=i=>{for(let e of mw(i)){let t=nc(i.state,e.from,e.to);if(t)return i.dispatch({effects:gw(i.state,[Lc.of(t),Ow(i,t)])}),!0}return!1},x2=i=>{if(!i.state.field(qr,!1))return!1;let e=[];for(let t of mw(i)){let n=ic(i.state,t.from,t.to);n&&e.push(ea.of(n),Ow(i,n,!1))}return e.length&&i.dispatch({effects:e}),e.length>0};function Ow(i,e,t=!0){let n=i.state.doc.lineAt(e.from).number,r=i.state.doc.lineAt(e.to).number;return M.announce.of(`${i.state.phrase(t?"Folded lines":"Unfolded lines")} ${n} ${i.state.phrase("to")} ${r}.`)}const v2=i=>{let{state:e}=i,t=[];for(let n=0;n<e.doc.length;){let r=i.lineBlockAt(n),s=nc(e,r.from,r.to);s&&t.push(Lc.of(s)),n=(s?i.lineBlockAt(s.to):r).to+1}return t.length&&i.dispatch({effects:gw(i.state,t)}),!!t.length},$2=i=>{let e=i.state.field(qr,!1);if(!e||!e.size)return!1;let t=[];return e.between(0,i.state.doc.length,(n,r)=>{t.push(ea.of({from:n,to:r}))}),i.dispatch({effects:t}),!0},P2=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:w2},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:x2},{key:"Ctrl-Alt-[",run:v2},{key:"Ctrl-Alt-]",run:$2}],Q2={placeholderDOM:null,preparePlaceholder:null,placeholderText:""},nm=R.define({combine(i){return On(i,Q2)}});function yw(i){let e=[qr,A2];return i&&e.push(nm.of(i)),e}function kw(i,e){let{state:t}=i,n=t.facet(nm),r=o=>{let l=i.lineBlockAt(i.posAtDOM(o.target)),a=ic(i.state,l.from,l.to);a&&i.dispatch({effects:ea.of(a)}),o.preventDefault()};if(n.placeholderDOM)return n.placeholderDOM(i,r,e);let s=document.createElement("span");return s.textContent=n.placeholderText,s.setAttribute("aria-label",t.phrase("folded code")),s.title=t.phrase("unfold"),s.className="cm-foldPlaceholder",s.onclick=r,s}const L0=I.replace({widget:new class extends _n{toDOM(i){return kw(i,null)}}});class C2 extends _n{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return kw(e,this.value)}}const T2={openText:"",closedText:"",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class Gf extends Ln{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}}function M2(i={}){let e=Object.assign(Object.assign({},T2),i),t=new Gf(e,!0),n=new Gf(e,!1),r=ve.fromClass(class{constructor(o){this.from=o.viewport.from,this.markers=this.buildMarkers(o)}update(o){(o.docChanged||o.viewportChanged||o.startState.facet(Hi)!=o.state.facet(Hi)||o.startState.field(qr,!1)!=o.state.field(qr,!1)||ae(o.startState)!=ae(o.state)||e.foldingChanged(o))&&(this.markers=this.buildMarkers(o.view))}buildMarkers(o){let l=new _i;for(let a of o.viewportLineBlocks){let h=ic(o.state,a.from,a.to)?n:nc(o.state,a.from,a.to)?t:null;h&&l.add(a.from,a.from,h)}return l.finish()}}),{domEventHandlers:s}=e;return[r,HS({class:"cm-foldGutter",markers(o){var l;return((l=o.plugin(r))===null||l===void 0?void 0:l.markers)||H.empty},initialSpacer(){return new Gf(e,!1)},domEventHandlers:Object.assign(Object.assign({},s),{click:(o,l,a)=>{if(s.click&&s.click(o,l,a))return!0;let h=ic(o.state,l.from,l.to);if(h)return o.dispatch({effects:ea.of(h)}),!0;let c=nc(o.state,l.from,l.to);return c?(o.dispatch({effects:Lc.of(c)}),!0):!1}})}),yw()]}const A2=M.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class ta{constructor(e,t){this.specs=e;let n;function r(l){let a=Fi.newName();return(n||(n=Object.create(null)))["."+a]=l,a}const s=typeof t.all=="string"?t.all:t.all?r(t.all):void 0,o=t.scope;this.scope=o instanceof Zt?l=>l.prop(Di)==o.data:o?l=>l==o:void 0,this.style=lw(e.map(l=>({tag:l.tag,class:l.class||r(Object.assign({},l,{tag:null}))})),{all:s}).style,this.module=n?new Fi(n):null,this.themeType=t.themeType}static define(e,t){return new ta(e,t||{})}}const Wd=R.define(),bw=R.define({combine(i){return i.length?[i[0]]:null}});function Hf(i){let e=i.facet(Wd);return e.length?e:i.facet(bw)}function Sw(i,e){let t=[R2],n;return i instanceof ta&&(i.module&&t.push(M.styleModule.of(i.module)),n=i.themeType),e!=null&&e.fallback?t.push(bw.of(i)):n?t.push(Wd.computeN([M.darkTheme],r=>r.facet(M.darkTheme)==(n=="dark")?[i]:[])):t.push(Wd.of(i)),t}class Z2{constructor(e){this.markCache=Object.create(null),this.tree=ae(e.state),this.decorations=this.buildDeco(e,Hf(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=ae(e.state),n=Hf(e.state),r=n!=Hf(e.startState),{viewport:s}=e.view,o=e.changes.mapPos(this.decoratedTo,1);t.length<s.to&&!r&&t.type==this.tree.type&&o>=s.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=o):(t!=this.tree||e.viewportChanged||r)&&(this.tree=t,this.decorations=this.buildDeco(e.view,n),this.decoratedTo=s.to)}buildDeco(e,t){if(!t||!this.tree.length)return I.none;let n=new _i;for(let{from:r,to:s}of e.visibleRanges)r2(this.tree,t,(o,l,a)=>{n.add(o,l,this.markCache[a]||(this.markCache[a]=I.mark({class:a})))},r,s);return n.finish()}}const R2=di.high(ve.fromClass(Z2,{decorations:i=>i.decorations})),E2=ta.define([{tag:O.meta,color:"#404740"},{tag:O.link,textDecoration:"underline"},{tag:O.heading,textDecoration:"underline",fontWeight:"bold"},{tag:O.emphasis,fontStyle:"italic"},{tag:O.strong,fontWeight:"bold"},{tag:O.strikethrough,textDecoration:"line-through"},{tag:O.keyword,color:"#708"},{tag:[O.atom,O.bool,O.url,O.contentSeparator,O.labelName],color:"#219"},{tag:[O.literal,O.inserted],color:"#164"},{tag:[O.string,O.deleted],color:"#a11"},{tag:[O.regexp,O.escape,O.special(O.string)],color:"#e40"},{tag:O.definition(O.variableName),color:"#00f"},{tag:O.local(O.variableName),color:"#30a"},{tag:[O.typeName,O.namespace],color:"#085"},{tag:O.className,color:"#167"},{tag:[O.special(O.variableName),O.macroName],color:"#256"},{tag:O.definition(O.propertyName),color:"#00c"},{tag:O.comment,color:"#940"},{tag:O.invalid,color:"#f00"}]),N2=M.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),ww=1e4,xw="()[]{}",vw=R.define({combine(i){return On(i,{afterCursor:!0,brackets:xw,maxScanDistance:ww,renderMatch:W2})}}),D2=I.mark({class:"cm-matchingBracket"}),I2=I.mark({class:"cm-nonmatchingBracket"});function W2(i){let e=[],t=i.matched?D2:I2;return e.push(t.range(i.start.from,i.start.to)),i.end&&e.push(t.range(i.end.from,i.end.to)),e}const X2=Ae.define({create(){return I.none},update(i,e){if(!e.docChanged&&!e.selection)return i;let t=[],n=e.state.facet(vw);for(let r of e.state.selection.ranges){if(!r.empty)continue;let s=Nn(e.state,r.head,-1,n)||r.head>0&&Nn(e.state,r.head-1,1,n)||n.afterCursor&&(Nn(e.state,r.head,1,n)||r.head<e.state.doc.length&&Nn(e.state,r.head+1,-1,n));s&&(t=t.concat(n.renderMatch(s,e.state)))}return I.set(t,!0)},provide:i=>M.decorations.from(i)}),B2=[X2,N2];function V2(i={}){return[vw.of(i),B2]}const $w=new B;function Xd(i,e,t){let n=i.prop(e<0?B.openedBy:B.closedBy);if(n)return n;if(i.name.length==1){let r=t.indexOf(i.name);if(r>-1&&r%2==(e<0?1:0))return[t[r+e]]}return null}function Bd(i){let e=i.type.prop($w);return e?e(i.node):i}function Nn(i,e,t,n={}){let r=n.maxScanDistance||ww,s=n.brackets||xw,o=ae(i),l=o.resolveInner(e,t);for(let a=l;a;a=a.parent){let h=Xd(a.type,t,s);if(h&&a.from<a.to){let c=Bd(a);if(c&&(t>0?e>=c.from&&e<c.to:e>c.from&&e<=c.to))return q2(i,e,t,a,c,h,s)}}return L2(i,e,t,o,l.type,r,s)}function q2(i,e,t,n,r,s,o){let l=n.parent,a={from:r.from,to:r.to},h=0,c=l==null?void 0:l.cursor();if(c&&(t<0?c.childBefore(n.from):c.childAfter(n.to)))do if(t<0?c.to<=n.from:c.from>=n.to){if(h==0&&s.indexOf(c.type.name)>-1&&c.from<c.to){let f=Bd(c);return{start:a,end:f?{from:f.from,to:f.to}:void 0,matched:!0}}else if(Xd(c.type,t,o))h++;else if(Xd(c.type,-t,o)){if(h==0){let f=Bd(c);return{start:a,end:f&&f.from<f.to?{from:f.from,to:f.to}:void 0,matched:!1}}h--}}while(t<0?c.prevSibling():c.nextSibling());return{start:a,matched:!1}}function L2(i,e,t,n,r,s,o){let l=t<0?i.sliceDoc(e-1,e):i.sliceDoc(e,e+1),a=o.indexOf(l);if(a<0||a%2==0!=t>0)return null;let h={from:t<0?e-1:e,to:t>0?e+1:e},c=i.doc.iterRange(e,t>0?i.doc.length:0),f=0;for(let u=0;!c.next().done&&u<=s;){let d=c.value;t<0&&(u+=d.length);let p=e+u*t;for(let m=t>0?0:d.length-1,g=t>0?d.length:-1;m!=g;m+=t){let y=o.indexOf(d[m]);if(!(y<0||n.resolveInner(p+m,1).type!=r))if(y%2==0==t>0)f++;else{if(f==1)return{start:h,end:{from:p+m,to:p+m+1},matched:y>>1==a>>1};f--}}t>0&&(u+=d.length)}return c.done?{start:h,matched:!1}:null}function z0(i,e,t,n=0,r=0){e==null&&(e=i.search(/[^\s\u00a0]/),e==-1&&(e=i.length));let s=r;for(let o=n;o<e;o++)i.charCodeAt(o)==9?s+=t-s%t:s++;return s}class Pw{constructor(e,t,n,r){this.string=e,this.tabSize=t,this.indentUnit=n,this.overrideIndent=r,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(e){let t=this.string.charAt(this.pos),n;if(typeof e=="string"?n=t==e:n=t&&(e instanceof RegExp?e.test(t):e(t)),n)return++this.pos,t}eatWhile(e){let t=this.pos;for(;this.eat(e););return this.pos>t}eatSpace(){let e=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e}skipToEnd(){this.pos=this.string.length}skipTo(e){let t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0}backUp(e){this.pos-=e}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=z0(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var e;return(e=this.overrideIndent)!==null&&e!==void 0?e:z0(this.string,null,this.tabSize)}match(e,t,n){if(typeof e=="string"){let r=o=>n?o.toLowerCase():o,s=this.string.substr(this.pos,e.length);return r(s)==r(e)?(t!==!1&&(this.pos+=e.length),!0):null}else{let r=this.string.slice(this.pos).match(e);return r&&r.index>0?null:(r&&t!==!1&&(this.pos+=r[0].length),r)}}current(){return this.string.slice(this.start,this.pos)}}function z2(i){return{name:i.name||"",token:i.token,blankLine:i.blankLine||(()=>{}),startState:i.startState||(()=>!0),copyState:i.copyState||Y2,indent:i.indent||(()=>null),languageData:i.languageData||{},tokenTable:i.tokenTable||sm}}function Y2(i){if(typeof i!="object")return i;let e={};for(let t in i){let n=i[t];e[t]=n instanceof Array?n.slice():n}return e}const Y0=new WeakMap;class im extends Zt{constructor(e){let t=Vc(e.languageData),n=z2(e),r,s=new class extends Bc{createParse(o,l,a){return new _2(r,o,l,a)}};super(t,s,[hw.of((o,l)=>this.getIndent(o,l))],e.name),this.topNode=G2(t),r=this,this.streamParser=n,this.stateAfter=new B({perNode:!0}),this.tokenTable=e.tokenTable?new Mw(n.tokenTable):U2}static define(e){return new im(e)}getIndent(e,t){let n=ae(e.state),r=n.resolve(t);for(;r&&r.type!=this.topNode;)r=r.parent;if(!r)return null;let s,{overrideIndentation:o}=e.options;o&&(s=Y0.get(e.state),s!=null&&s<t-1e4&&(s=void 0));let l=rm(this,n,0,r.from,s??t),a,h;if(l?(h=l.state,a=l.pos+1):(h=this.streamParser.startState(e.unit),a=0),t-a>1e4)return null;for(;a<t;){let f=e.state.doc.lineAt(a),u=Math.min(t,f.to);if(f.length){let d=o?o(f.from):-1,p=new Pw(f.text,e.state.tabSize,e.unit,d<0?void 0:d);for(;p.pos<u-f.from;)Cw(this.streamParser.token,p,h)}else this.streamParser.blankLine(h,e.unit);if(u==t)break;a=f.to+1}let c=e.lineAt(t);return o&&s==null&&Y0.set(e.state,c.from),this.streamParser.indent(h,/^\s*(.*)/.exec(c.text)[1],e)}get allowsNesting(){return!1}}function rm(i,e,t,n,r){let s=t>=n&&t+e.length<=r&&e.prop(i.stateAfter);if(s)return{state:i.streamParser.copyState(s),pos:t+e.length};for(let o=e.children.length-1;o>=0;o--){let l=e.children[o],a=t+e.positions[o],h=l instanceof F&&a<r&&rm(i,l,a,n,r);if(h)return h}return null}function Qw(i,e,t,n,r){if(r&&t<=0&&n>=e.length)return e;!r&&e.type==i.topNode&&(r=!0);for(let s=e.children.length-1;s>=0;s--){let o=e.positions[s],l=e.children[s],a;if(o<n&&l instanceof F){if(!(a=Qw(i,l,t-o,n-o,r)))break;return r?new F(e.type,e.children.slice(0,s).concat(a),e.positions.slice(0,s+1),o+a.length):a}}return null}function j2(i,e,t,n){for(let r of e){let s=r.from+(r.openStart?25:0),o=r.to-(r.openEnd?25:0),l=s<=t&&o>t&&rm(i,r.tree,0-r.offset,t,o),a;if(l&&(a=Qw(i,r.tree,t+r.offset,l.pos+r.offset,!1)))return{state:l.state,tree:a}}return{state:i.streamParser.startState(n?Vr(n):4),tree:F.empty}}let _2=class{constructor(e,t,n,r){this.lang=e,this.input=t,this.fragments=n,this.ranges=r,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=r[r.length-1].to;let s=Br.get(),o=r[0].from,{state:l,tree:a}=j2(e,n,o,s==null?void 0:s.state);this.state=l,this.parsedPos=this.chunkStart=o+a.length;for(let h=0;h<a.children.length;h++)this.chunks.push(a.children[h]),this.chunkPos.push(a.positions[h]);s&&this.parsedPos<s.viewport.from-1e5&&(this.state=this.lang.streamParser.startState(Vr(s.state)),s.skipUntilInView(this.parsedPos,s.viewport.from),this.parsedPos=s.viewport.from),this.moveRangeIndex()}advance(){let e=Br.get(),t=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),n=Math.min(t,this.chunkStart+2048);for(e&&(n=Math.min(n,e.viewport.to));this.parsedPos<n;)this.parseLine(e);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=t?this.finish():e&&this.parsedPos>=e.viewport.to?(e.skipUntilInView(this.parsedPos,t),this.finish()):null}stopAt(e){this.stoppedAt=e}lineAfter(e){let t=this.input.chunk(e);if(this.input.lineChunks)t==`
`&&(t="");else{let n=t.indexOf(`
`);n>-1&&(t=t.slice(0,n))}return e+t.length<=this.to?t:t.slice(0,this.to-e)}nextLine(){let e=this.parsedPos,t=this.lineAfter(e),n=e+t.length;for(let r=this.rangeIndex;;){let s=this.ranges[r].to;if(s>=n||(t=t.slice(0,s-(n-t.length)),r++,r==this.ranges.length))break;let o=this.ranges[r].from,l=this.lineAfter(o);t+=l,n=o+l.length}return{line:t,end:n}}skipGapsTo(e,t,n){for(;;){let r=this.ranges[this.rangeIndex].to,s=e+t;if(n>0?r>s:r>=s)break;let o=this.ranges[++this.rangeIndex].from;t+=o-r}return t}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(e,t,n,r,s){if(this.ranges.length>1){s=this.skipGapsTo(t,s,1),t+=s;let o=this.chunk.length;s=this.skipGapsTo(n,s,-1),n+=s,r+=this.chunk.length-o}return this.chunk.push(e,t,n,r),s}parseLine(e){let{line:t,end:n}=this.nextLine(),r=0,{streamParser:s}=this.lang,o=new Pw(t,e?e.state.tabSize:4,e?Vr(e.state):2);if(o.eol())s.blankLine(this.state,o.indentUnit);else for(;!o.eol();){let l=Cw(s.token,o,this.state);if(l&&(r=this.emitToken(this.lang.tokenTable.resolve(l),this.parsedPos+o.start,this.parsedPos+o.pos,4,r)),o.start>1e4)break}this.parsedPos=n,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let e=F.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:F2,topID:0,maxBufferLength:2048,reused:this.chunkReused});e=new F(e.type,e.children,e.positions,e.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(e),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new F(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}};function Cw(i,e,t){e.start=e.pos;for(let n=0;n<10;n++){let r=i(e,t);if(e.pos>e.start)return r}throw new Error("Stream parser failed to advance stream.")}const sm=Object.create(null),El=[Me.none],F2=new Hs(El),j0=[],_0=Object.create(null),Tw=Object.create(null);for(let[i,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Tw[i]=Aw(sm,e);class Mw{constructor(e){this.extra=e,this.table=Object.assign(Object.create(null),Tw)}resolve(e){return e?this.table[e]||(this.table[e]=Aw(this.extra,e)):0}}const U2=new Mw(sm);function Kf(i,e){j0.indexOf(i)>-1||(j0.push(i),console.warn(e))}function Aw(i,e){let t=[];for(let l of e.split(" ")){let a=[];for(let h of l.split(".")){let c=i[h]||O[h];c?typeof c=="function"?a.length?a=a.map(c):Kf(h,`Modifier ${h} used at start of tag`):a.length?Kf(h,`Tag ${h} used as modifier`):a=Array.isArray(c)?c:[c]:Kf(h,`Unknown highlighting tag ${h}`)}for(let h of a)t.push(h)}if(!t.length)return 0;let n=e.replace(/ /g,"_"),r=n+" "+t.map(l=>l.id),s=_0[r];if(s)return s.id;let o=_0[r]=Me.define({id:El.length,name:n,props:[Ks({[n]:t})]});return El.push(o),o.id}function G2(i){let e=Me.define({id:El.length,name:"Document",props:[Di.add(()=>i)],top:!0});return El.push(e),e}ge.RTL,ge.LTR;const H2=i=>{let{state:e}=i,t=e.doc.lineAt(e.selection.main.from),n=lm(i.state,t.from);return n.line?K2(i):n.block?eE(i):!1};function om(i,e){return({state:t,dispatch:n})=>{if(t.readOnly)return!1;let r=i(e,t);return r?(n(t.update(r)),!0):!1}}const K2=om(iE,0),J2=om(Zw,0),eE=om((i,e)=>Zw(i,e,nE(e)),0);function lm(i,e){let t=i.languageDataAt("commentTokens",e);return t.length?t[0]:{}}const po=50;function tE(i,{open:e,close:t},n,r){let s=i.sliceDoc(n-po,n),o=i.sliceDoc(r,r+po),l=/\s*$/.exec(s)[0].length,a=/^\s*/.exec(o)[0].length,h=s.length-l;if(s.slice(h-e.length,h)==e&&o.slice(a,a+t.length)==t)return{open:{pos:n-l,margin:l&&1},close:{pos:r+a,margin:a&&1}};let c,f;r-n<=2*po?c=f=i.sliceDoc(n,r):(c=i.sliceDoc(n,n+po),f=i.sliceDoc(r-po,r));let u=/^\s*/.exec(c)[0].length,d=/\s*$/.exec(f)[0].length,p=f.length-d-t.length;return c.slice(u,u+e.length)==e&&f.slice(p,p+t.length)==t?{open:{pos:n+u+e.length,margin:/\s/.test(c.charAt(u+e.length))?1:0},close:{pos:r-d-t.length,margin:/\s/.test(f.charAt(p-1))?1:0}}:null}function nE(i){let e=[];for(let t of i.selection.ranges){let n=i.doc.lineAt(t.from),r=t.to<=n.to?n:i.doc.lineAt(t.to),s=e.length-1;s>=0&&e[s].to>n.from?e[s].to=r.to:e.push({from:n.from+/^\s*/.exec(n.text)[0].length,to:r.to})}return e}function Zw(i,e,t=e.selection.ranges){let n=t.map(s=>lm(e,s.from).block);if(!n.every(s=>s))return null;let r=t.map((s,o)=>tE(e,n[o],s.from,s.to));if(i!=2&&!r.every(s=>s))return{changes:e.changes(t.map((s,o)=>r[o]?[]:[{from:s.from,insert:n[o].open+" "},{from:s.to,insert:" "+n[o].close}]))};if(i!=1&&r.some(s=>s)){let s=[];for(let o=0,l;o<r.length;o++)if(l=r[o]){let a=n[o],{open:h,close:c}=l;s.push({from:h.pos-a.open.length,to:h.pos+h.margin},{from:c.pos-c.margin,to:c.pos+a.close.length})}return{changes:s}}return null}function iE(i,e,t=e.selection.ranges){let n=[],r=-1;for(let{from:s,to:o}of t){let l=n.length,a=1e9,h=lm(e,s).line;if(h){for(let c=s;c<=o;){let f=e.doc.lineAt(c);if(f.from>r&&(s==o||o>f.from)){r=f.from;let u=/^\s*/.exec(f.text)[0].length,d=u==f.length,p=f.text.slice(u,u+h.length)==h?u:-1;u<f.text.length&&u<a&&(a=u),n.push({line:f,comment:p,token:h,indent:u,empty:d,single:!1})}c=f.to+1}if(a<1e9)for(let c=l;c<n.length;c++)n[c].indent<n[c].line.text.length&&(n[c].indent=a);n.length==l+1&&(n[l].single=!0)}}if(i!=2&&n.some(s=>s.comment<0&&(!s.empty||s.single))){let s=[];for(let{line:l,token:a,indent:h,empty:c,single:f}of n)(f||!c)&&s.push({from:l.from+h,insert:a+" "});let o=e.changes(s);return{changes:o,selection:e.selection.map(o,1)}}else if(i!=1&&n.some(s=>s.comment>=0)){let s=[];for(let{line:o,comment:l,token:a}of n)if(l>=0){let h=o.from+l,c=h+a.length;o.text[c-o.from]==" "&&c++,s.push({from:h,to:c})}return{changes:s}}return null}const Vd=pi.define(),rE=pi.define(),sE=R.define(),Rw=R.define({combine(i){return On(i,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(n,r)=>e(n,r)||t(n,r)})}}),Ew=Ae.define({create(){return Dn.empty},update(i,e){let t=e.state.facet(Rw),n=e.annotation(Vd);if(n){let a=kt.fromTransaction(e,n.selection),h=n.side,c=h==0?i.undone:i.done;return a?c=rc(c,c.length,t.minDepth,a):c=Iw(c,e.startState.selection),new Dn(h==0?n.rest:c,h==0?c:n.rest)}let r=e.annotation(rE);if((r=="full"||r=="before")&&(i=i.isolate()),e.annotation(Ce.addToHistory)===!1)return e.changes.empty?i:i.addMapping(e.changes.desc);let s=kt.fromTransaction(e),o=e.annotation(Ce.time),l=e.annotation(Ce.userEvent);return s?i=i.addChanges(s,o,l,t,e):e.selection&&(i=i.addSelection(e.startState.selection,o,l,t.newGroupDelay)),(r=="full"||r=="after")&&(i=i.isolate()),i},toJSON(i){return{done:i.done.map(e=>e.toJSON()),undone:i.undone.map(e=>e.toJSON())}},fromJSON(i){return new Dn(i.done.map(kt.fromJSON),i.undone.map(kt.fromJSON))}});function oE(i={}){return[Ew,Rw.of(i),M.domEventHandlers({beforeinput(e,t){let n=e.inputType=="historyUndo"?Nw:e.inputType=="historyRedo"?qd:null;return n?(e.preventDefault(),n(t)):!1}})]}function zc(i,e){return function({state:t,dispatch:n}){if(!e&&t.readOnly)return!1;let r=t.field(Ew,!1);if(!r)return!1;let s=r.pop(i,t,e);return s?(n(s),!0):!1}}const Nw=zc(0,!1),qd=zc(1,!1),lE=zc(0,!0),aE=zc(1,!0);class kt{constructor(e,t,n,r,s){this.changes=e,this.effects=t,this.mapped=n,this.startSelection=r,this.selectionsAfter=s}setSelAfter(e){return new kt(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,n;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(t=this.mapped)===null||t===void 0?void 0:t.toJSON(),startSelection:(n=this.startSelection)===null||n===void 0?void 0:n.toJSON(),selectionsAfter:this.selectionsAfter.map(r=>r.toJSON())}}static fromJSON(e){return new kt(e.changes&&Ne.fromJSON(e.changes),[],e.mapped&&Wn.fromJSON(e.mapped),e.startSelection&&b.fromJSON(e.startSelection),e.selectionsAfter.map(b.fromJSON))}static fromTransaction(e,t){let n=_t;for(let r of e.startState.facet(sE)){let s=r(e);s.length&&(n=n.concat(s))}return!n.length&&e.changes.empty?null:new kt(e.changes.invert(e.startState.doc),n,void 0,t||e.startState.selection,_t)}static selection(e){return new kt(void 0,_t,void 0,void 0,e)}}function rc(i,e,t,n){let r=e+1>t+20?e-t-1:0,s=i.slice(r,e);return s.push(n),s}function hE(i,e){let t=[],n=!1;return i.iterChangedRanges((r,s)=>t.push(r,s)),e.iterChangedRanges((r,s,o,l)=>{for(let a=0;a<t.length;){let h=t[a++],c=t[a++];l>=h&&o<=c&&(n=!0)}}),n}function cE(i,e){return i.ranges.length==e.ranges.length&&i.ranges.filter((t,n)=>t.empty!=e.ranges[n].empty).length===0}function Dw(i,e){return i.length?e.length?i.concat(e):i:e}const _t=[],fE=200;function Iw(i,e){if(i.length){let t=i[i.length-1],n=t.selectionsAfter.slice(Math.max(0,t.selectionsAfter.length-fE));return n.length&&n[n.length-1].eq(e)?i:(n.push(e),rc(i,i.length-1,1e9,t.setSelAfter(n)))}else return[kt.selection([e])]}function uE(i){let e=i[i.length-1],t=i.slice();return t[i.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),t}function Jf(i,e){if(!i.length)return i;let t=i.length,n=_t;for(;t;){let r=dE(i[t-1],e,n);if(r.changes&&!r.changes.empty||r.effects.length){let s=i.slice(0,t);return s[t-1]=r,s}else e=r.mapped,t--,n=r.selectionsAfter}return n.length?[kt.selection(n)]:_t}function dE(i,e,t){let n=Dw(i.selectionsAfter.length?i.selectionsAfter.map(l=>l.map(e)):_t,t);if(!i.changes)return kt.selection(n);let r=i.changes.map(e),s=e.mapDesc(i.changes,!0),o=i.mapped?i.mapped.composeDesc(s):s;return new kt(r,q.mapEffects(i.effects,e),o,i.startSelection.map(s),n)}const pE=/^(input\.type|delete)($|\.)/;class Dn{constructor(e,t,n=0,r=void 0){this.done=e,this.undone=t,this.prevTime=n,this.prevUserEvent=r}isolate(){return this.prevTime?new Dn(this.done,this.undone):this}addChanges(e,t,n,r,s){let o=this.done,l=o[o.length-1];return l&&l.changes&&!l.changes.empty&&e.changes&&(!n||pE.test(n))&&(!l.selectionsAfter.length&&t-this.prevTime<r.newGroupDelay&&r.joinToEvent(s,hE(l.changes,e.changes))||n=="input.type.compose")?o=rc(o,o.length-1,r.minDepth,new kt(e.changes.compose(l.changes),Dw(e.effects,l.effects),l.mapped,l.startSelection,_t)):o=rc(o,o.length,r.minDepth,e),new Dn(o,_t,t,n)}addSelection(e,t,n,r){let s=this.done.length?this.done[this.done.length-1].selectionsAfter:_t;return s.length>0&&t-this.prevTime<r&&n==this.prevUserEvent&&n&&/^select($|\.)/.test(n)&&cE(s[s.length-1],e)?this:new Dn(Iw(this.done,e),this.undone,t,n)}addMapping(e){return new Dn(Jf(this.done,e),Jf(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,n){let r=e==0?this.done:this.undone;if(r.length==0)return null;let s=r[r.length-1],o=s.selectionsAfter[0]||t.selection;if(n&&s.selectionsAfter.length)return t.update({selection:s.selectionsAfter[s.selectionsAfter.length-1],annotations:Vd.of({side:e,rest:uE(r),selection:o}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(s.changes){let l=r.length==1?_t:r.slice(0,r.length-1);return s.mapped&&(l=Jf(l,s.mapped)),t.update({changes:s.changes,selection:s.startSelection,effects:s.effects,annotations:Vd.of({side:e,rest:l,selection:o}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}Dn.empty=new Dn(_t,_t);const mE=[{key:"Mod-z",run:Nw,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:qd,preventDefault:!0},{linux:"Ctrl-Shift-z",run:qd,preventDefault:!0},{key:"Mod-u",run:lE,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:aE,preventDefault:!0}];function to(i,e){return b.create(i.ranges.map(e),i.mainIndex)}function Fn(i,e){return i.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function yn({state:i,dispatch:e},t){let n=to(i.selection,t);return n.eq(i.selection,!0)?!1:(e(Fn(i,n)),!0)}function Yc(i,e){return b.cursor(e?i.to:i.from)}function Ww(i,e){return yn(i,t=>t.empty?i.moveByChar(t,e):Yc(t,e))}function nt(i){return i.textDirectionAt(i.state.selection.main.head)==ge.LTR}const Xw=i=>Ww(i,!nt(i)),Bw=i=>Ww(i,nt(i));function Vw(i,e){return yn(i,t=>t.empty?i.moveByGroup(t,e):Yc(t,e))}const gE=i=>Vw(i,!nt(i)),OE=i=>Vw(i,nt(i));function yE(i,e,t){if(e.type.prop(t))return!0;let n=e.to-e.from;return n&&(n>2||/[^\s,.;:]/.test(i.sliceDoc(e.from,e.to)))||e.firstChild}function jc(i,e,t){let n=ae(i).resolveInner(e.head),r=t?B.closedBy:B.openedBy;for(let a=e.head;;){let h=t?n.childAfter(a):n.childBefore(a);if(!h)break;yE(i,h,r)?n=h:a=t?h.to:h.from}let s=n.type.prop(r),o,l;return s&&(o=t?Nn(i,n.from,1):Nn(i,n.to,-1))&&o.matched?l=t?o.end.to:o.end.from:l=t?n.to:n.from,b.cursor(l,t?-1:1)}const kE=i=>yn(i,e=>jc(i.state,e,!nt(i))),bE=i=>yn(i,e=>jc(i.state,e,nt(i)));function qw(i,e){return yn(i,t=>{if(!t.empty)return Yc(t,e);let n=i.moveVertically(t,e);return n.head!=t.head?n:i.moveToLineBoundary(t,e)})}const Lw=i=>qw(i,!1),zw=i=>qw(i,!0);function Yw(i){let e=i.scrollDOM.clientHeight<i.scrollDOM.scrollHeight-2,t=0,n=0,r;if(e){for(let s of i.state.facet(M.scrollMargins)){let o=s(i);o!=null&&o.top&&(t=Math.max(o==null?void 0:o.top,t)),o!=null&&o.bottom&&(n=Math.max(o==null?void 0:o.bottom,n))}r=i.scrollDOM.clientHeight-t-n}else r=(i.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:t,marginBottom:n,selfScroll:e,height:Math.max(i.defaultLineHeight,r-5)}}function jw(i,e){let t=Yw(i),{state:n}=i,r=to(n.selection,o=>o.empty?i.moveVertically(o,e,t.height):Yc(o,e));if(r.eq(n.selection))return!1;let s;if(t.selfScroll){let o=i.coordsAtPos(n.selection.main.head),l=i.scrollDOM.getBoundingClientRect(),a=l.top+t.marginTop,h=l.bottom-t.marginBottom;o&&o.top>a&&o.bottom<h&&(s=M.scrollIntoView(r.main.head,{y:"start",yMargin:o.top-a}))}return i.dispatch(Fn(n,r),{effects:s}),!0}const F0=i=>jw(i,!1),Ld=i=>jw(i,!0);function tr(i,e,t){let n=i.lineBlockAt(e.head),r=i.moveToLineBoundary(e,t);if(r.head==e.head&&r.head!=(t?n.to:n.from)&&(r=i.moveToLineBoundary(e,t,!1)),!t&&r.head==n.from&&n.length){let s=/^\s*/.exec(i.state.sliceDoc(n.from,Math.min(n.from+100,n.to)))[0].length;s&&e.head!=n.from+s&&(r=b.cursor(n.from+s))}return r}const SE=i=>yn(i,e=>tr(i,e,!0)),wE=i=>yn(i,e=>tr(i,e,!1)),xE=i=>yn(i,e=>tr(i,e,!nt(i))),vE=i=>yn(i,e=>tr(i,e,nt(i))),$E=i=>yn(i,e=>b.cursor(i.lineBlockAt(e.head).from,1)),PE=i=>yn(i,e=>b.cursor(i.lineBlockAt(e.head).to,-1));function QE(i,e,t){let n=!1,r=to(i.selection,s=>{let o=Nn(i,s.head,-1)||Nn(i,s.head,1)||s.head>0&&Nn(i,s.head-1,1)||s.head<i.doc.length&&Nn(i,s.head+1,-1);if(!o||!o.end)return s;n=!0;let l=o.start.from==s.head?o.end.to:o.end.from;return t?b.range(s.anchor,l):b.cursor(l)});return n?(e(Fn(i,r)),!0):!1}const CE=({state:i,dispatch:e})=>QE(i,e,!1);function Jt(i,e){let t=to(i.state.selection,n=>{let r=e(n);return b.range(n.anchor,r.head,r.goalColumn,r.bidiLevel||void 0)});return t.eq(i.state.selection)?!1:(i.dispatch(Fn(i.state,t)),!0)}function _w(i,e){return Jt(i,t=>i.moveByChar(t,e))}const Fw=i=>_w(i,!nt(i)),Uw=i=>_w(i,nt(i));function Gw(i,e){return Jt(i,t=>i.moveByGroup(t,e))}const TE=i=>Gw(i,!nt(i)),ME=i=>Gw(i,nt(i)),AE=i=>Jt(i,e=>jc(i.state,e,!nt(i))),ZE=i=>Jt(i,e=>jc(i.state,e,nt(i)));function Hw(i,e){return Jt(i,t=>i.moveVertically(t,e))}const Kw=i=>Hw(i,!1),Jw=i=>Hw(i,!0);function ex(i,e){return Jt(i,t=>i.moveVertically(t,e,Yw(i).height))}const U0=i=>ex(i,!1),G0=i=>ex(i,!0),RE=i=>Jt(i,e=>tr(i,e,!0)),EE=i=>Jt(i,e=>tr(i,e,!1)),NE=i=>Jt(i,e=>tr(i,e,!nt(i))),DE=i=>Jt(i,e=>tr(i,e,nt(i))),IE=i=>Jt(i,e=>b.cursor(i.lineBlockAt(e.head).from)),WE=i=>Jt(i,e=>b.cursor(i.lineBlockAt(e.head).to)),H0=({state:i,dispatch:e})=>(e(Fn(i,{anchor:0})),!0),K0=({state:i,dispatch:e})=>(e(Fn(i,{anchor:i.doc.length})),!0),J0=({state:i,dispatch:e})=>(e(Fn(i,{anchor:i.selection.main.anchor,head:0})),!0),ey=({state:i,dispatch:e})=>(e(Fn(i,{anchor:i.selection.main.anchor,head:i.doc.length})),!0),XE=({state:i,dispatch:e})=>(e(i.update({selection:{anchor:0,head:i.doc.length},userEvent:"select"})),!0),BE=({state:i,dispatch:e})=>{let t=_c(i).map(({from:n,to:r})=>b.range(n,Math.min(r+1,i.doc.length)));return e(i.update({selection:b.create(t),userEvent:"select"})),!0},VE=({state:i,dispatch:e})=>{let t=to(i.selection,n=>{var r;let s=ae(i).resolveStack(n.from,1);for(let o=s;o;o=o.next){let{node:l}=o;if((l.from<n.from&&l.to>=n.to||l.to>n.to&&l.from<=n.from)&&(!((r=l.parent)===null||r===void 0)&&r.parent))return b.range(l.to,l.from)}return n});return e(Fn(i,t)),!0},qE=({state:i,dispatch:e})=>{let t=i.selection,n=null;return t.ranges.length>1?n=b.create([t.main]):t.main.empty||(n=b.create([b.cursor(t.main.head)])),n?(e(Fn(i,n)),!0):!1};function na(i,e){if(i.state.readOnly)return!1;let t="delete.selection",{state:n}=i,r=n.changeByRange(s=>{let{from:o,to:l}=s;if(o==l){let a=e(s);a<o?(t="delete.backward",a=Ra(i,a,!1)):a>o&&(t="delete.forward",a=Ra(i,a,!0)),o=Math.min(o,a),l=Math.max(l,a)}else o=Ra(i,o,!1),l=Ra(i,l,!0);return o==l?{range:s}:{changes:{from:o,to:l},range:b.cursor(o,o<s.head?-1:1)}});return r.changes.empty?!1:(i.dispatch(n.update(r,{scrollIntoView:!0,userEvent:t,effects:t=="delete.selection"?M.announce.of(n.phrase("Selection deleted")):void 0})),!0)}function Ra(i,e,t){if(i instanceof M)for(let n of i.state.facet(M.atomicRanges).map(r=>r(i)))n.between(e,e,(r,s)=>{r<e&&s>e&&(e=t?s:r)});return e}const tx=(i,e)=>na(i,t=>{let n=t.from,{state:r}=i,s=r.doc.lineAt(n),o,l;if(!e&&n>s.from&&n<s.from+200&&!/[^ \t]/.test(o=s.text.slice(0,n-s.from))){if(o[o.length-1]=="	")return n-1;let a=dn(o,r.tabSize),h=a%Vr(r)||Vr(r);for(let c=0;c<h&&o[o.length-1-c]==" ";c++)n--;l=n}else l=_e(s.text,n-s.from,e,e)+s.from,l==n&&s.number!=(e?r.doc.lines:1)?l+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(s.text.slice(l-s.from,n-s.from))&&(l=_e(s.text,l-s.from,!1,!1)+s.from);return l}),zd=i=>tx(i,!1),nx=i=>tx(i,!0),ix=(i,e)=>na(i,t=>{let n=t.head,{state:r}=i,s=r.doc.lineAt(n),o=r.charCategorizer(n);for(let l=null;;){if(n==(e?s.to:s.from)){n==t.head&&s.number!=(e?r.doc.lines:1)&&(n+=e?1:-1);break}let a=_e(s.text,n-s.from,e)+s.from,h=s.text.slice(Math.min(n,a)-s.from,Math.max(n,a)-s.from),c=o(h);if(l!=null&&c!=l)break;(h!=" "||n!=t.head)&&(l=c),n=a}return n}),rx=i=>ix(i,!1),LE=i=>ix(i,!0),zE=i=>na(i,e=>{let t=i.lineBlockAt(e.head).to;return e.head<t?t:Math.min(i.state.doc.length,e.head+1)}),YE=i=>na(i,e=>{let t=i.moveToLineBoundary(e,!1).head;return e.head>t?t:Math.max(0,e.head-1)}),jE=i=>na(i,e=>{let t=i.moveToLineBoundary(e,!0).head;return e.head<t?t:Math.min(i.state.doc.length,e.head+1)}),_E=({state:i,dispatch:e})=>{if(i.readOnly)return!1;let t=i.changeByRange(n=>({changes:{from:n.from,to:n.to,insert:te.of(["",""])},range:b.cursor(n.from)}));return e(i.update(t,{scrollIntoView:!0,userEvent:"input"})),!0},FE=({state:i,dispatch:e})=>{if(i.readOnly)return!1;let t=i.changeByRange(n=>{if(!n.empty||n.from==0||n.from==i.doc.length)return{range:n};let r=n.from,s=i.doc.lineAt(r),o=r==s.from?r-1:_e(s.text,r-s.from,!1)+s.from,l=r==s.to?r+1:_e(s.text,r-s.from,!0)+s.from;return{changes:{from:o,to:l,insert:i.doc.slice(r,l).append(i.doc.slice(o,r))},range:b.cursor(l)}});return t.changes.empty?!1:(e(i.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function _c(i){let e=[],t=-1;for(let n of i.selection.ranges){let r=i.doc.lineAt(n.from),s=i.doc.lineAt(n.to);if(!n.empty&&n.to==s.from&&(s=i.doc.lineAt(n.to-1)),t>=r.number){let o=e[e.length-1];o.to=s.to,o.ranges.push(n)}else e.push({from:r.from,to:s.to,ranges:[n]});t=s.number+1}return e}function sx(i,e,t){if(i.readOnly)return!1;let n=[],r=[];for(let s of _c(i)){if(t?s.to==i.doc.length:s.from==0)continue;let o=i.doc.lineAt(t?s.to+1:s.from-1),l=o.length+1;if(t){n.push({from:s.to,to:o.to},{from:s.from,insert:o.text+i.lineBreak});for(let a of s.ranges)r.push(b.range(Math.min(i.doc.length,a.anchor+l),Math.min(i.doc.length,a.head+l)))}else{n.push({from:o.from,to:s.from},{from:s.to,insert:i.lineBreak+o.text});for(let a of s.ranges)r.push(b.range(a.anchor-l,a.head-l))}}return n.length?(e(i.update({changes:n,scrollIntoView:!0,selection:b.create(r,i.selection.mainIndex),userEvent:"move.line"})),!0):!1}const UE=({state:i,dispatch:e})=>sx(i,e,!1),GE=({state:i,dispatch:e})=>sx(i,e,!0);function ox(i,e,t){if(i.readOnly)return!1;let n=[];for(let r of _c(i))t?n.push({from:r.from,insert:i.doc.slice(r.from,r.to)+i.lineBreak}):n.push({from:r.to,insert:i.lineBreak+i.doc.slice(r.from,r.to)});return e(i.update({changes:n,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const HE=({state:i,dispatch:e})=>ox(i,e,!1),KE=({state:i,dispatch:e})=>ox(i,e,!0),JE=i=>{if(i.state.readOnly)return!1;let{state:e}=i,t=e.changes(_c(e).map(({from:r,to:s})=>(r>0?r--:s<e.doc.length&&s++,{from:r,to:s}))),n=to(e.selection,r=>i.moveVertically(r,!0)).map(t);return i.dispatch({changes:t,selection:n,scrollIntoView:!0,userEvent:"delete.line"}),!0};function eN(i,e){if(/\(\)|\[\]|\{\}/.test(i.sliceDoc(e-1,e+1)))return{from:e,to:e};let t=ae(i).resolveInner(e),n=t.childBefore(e),r=t.childAfter(e),s;return n&&r&&n.to<=e&&r.from>=e&&(s=n.type.prop(B.closedBy))&&s.indexOf(r.name)>-1&&i.doc.lineAt(n.to).from==i.doc.lineAt(r.from).from&&!/\S/.test(i.sliceDoc(n.to,r.from))?{from:n.to,to:r.from}:null}const tN=lx(!1),nN=lx(!0);function lx(i){return({state:e,dispatch:t})=>{if(e.readOnly)return!1;let n=e.changeByRange(r=>{let{from:s,to:o}=r,l=e.doc.lineAt(s),a=!i&&s==o&&eN(e,s);i&&(s=o=(o<=l.to?l:e.doc.lineAt(o)).to);let h=new qc(e,{simulateBreak:s,simulateDoubleBreak:!!a}),c=em(h,s);for(c==null&&(c=dn(/^\s*/.exec(e.doc.lineAt(s).text)[0],e.tabSize));o<l.to&&/\s/.test(l.text[o-l.from]);)o++;a?{from:s,to:o}=a:s>l.from&&s<l.from+100&&!/\S/.test(l.text.slice(0,s))&&(s=l.from);let f=["",Rl(e,c)];return a&&f.push(Rl(e,h.lineIndent(l.from,-1))),{changes:{from:s,to:o,insert:te.of(f)},range:b.cursor(s+1+f[1].length)}});return t(e.update(n,{scrollIntoView:!0,userEvent:"input"})),!0}}function am(i,e){let t=-1;return i.changeByRange(n=>{let r=[];for(let o=n.from;o<=n.to;){let l=i.doc.lineAt(o);l.number>t&&(n.empty||n.to>l.from)&&(e(l,r,n),t=l.number),o=l.to+1}let s=i.changes(r);return{changes:r,range:b.range(s.mapPos(n.anchor,1),s.mapPos(n.head,1))}})}const iN=({state:i,dispatch:e})=>{if(i.readOnly)return!1;let t=Object.create(null),n=new qc(i,{overrideIndentation:s=>{let o=t[s];return o??-1}}),r=am(i,(s,o,l)=>{let a=em(n,s.from);if(a==null)return;/\S/.test(s.text)||(a=0);let h=/^\s*/.exec(s.text)[0],c=Rl(i,a);(h!=c||l.from<s.from+h.length)&&(t[s.from]=a,o.push({from:s.from,to:s.from+h.length,insert:c}))});return r.changes.empty||e(i.update(r,{userEvent:"indent"})),!0},ax=({state:i,dispatch:e})=>i.readOnly?!1:(e(i.update(am(i,(t,n)=>{n.push({from:t.from,insert:i.facet(Js)})}),{userEvent:"input.indent"})),!0),hx=({state:i,dispatch:e})=>i.readOnly?!1:(e(i.update(am(i,(t,n)=>{let r=/^\s*/.exec(t.text)[0];if(!r)return;let s=dn(r,i.tabSize),o=0,l=Rl(i,Math.max(0,s-Vr(i)));for(;o<r.length&&o<l.length&&r.charCodeAt(o)==l.charCodeAt(o);)o++;n.push({from:t.from+o,to:t.from+r.length,insert:l.slice(o)})}),{userEvent:"delete.dedent"})),!0),rN=[{key:"Ctrl-b",run:Xw,shift:Fw,preventDefault:!0},{key:"Ctrl-f",run:Bw,shift:Uw},{key:"Ctrl-p",run:Lw,shift:Kw},{key:"Ctrl-n",run:zw,shift:Jw},{key:"Ctrl-a",run:$E,shift:IE},{key:"Ctrl-e",run:PE,shift:WE},{key:"Ctrl-d",run:nx},{key:"Ctrl-h",run:zd},{key:"Ctrl-k",run:zE},{key:"Ctrl-Alt-h",run:rx},{key:"Ctrl-o",run:_E},{key:"Ctrl-t",run:FE},{key:"Ctrl-v",run:Ld}],sN=[{key:"ArrowLeft",run:Xw,shift:Fw,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:gE,shift:TE,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:xE,shift:NE,preventDefault:!0},{key:"ArrowRight",run:Bw,shift:Uw,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:OE,shift:ME,preventDefault:!0},{mac:"Cmd-ArrowRight",run:vE,shift:DE,preventDefault:!0},{key:"ArrowUp",run:Lw,shift:Kw,preventDefault:!0},{mac:"Cmd-ArrowUp",run:H0,shift:J0},{mac:"Ctrl-ArrowUp",run:F0,shift:U0},{key:"ArrowDown",run:zw,shift:Jw,preventDefault:!0},{mac:"Cmd-ArrowDown",run:K0,shift:ey},{mac:"Ctrl-ArrowDown",run:Ld,shift:G0},{key:"PageUp",run:F0,shift:U0},{key:"PageDown",run:Ld,shift:G0},{key:"Home",run:wE,shift:EE,preventDefault:!0},{key:"Mod-Home",run:H0,shift:J0},{key:"End",run:SE,shift:RE,preventDefault:!0},{key:"Mod-End",run:K0,shift:ey},{key:"Enter",run:tN},{key:"Mod-a",run:XE},{key:"Backspace",run:zd,shift:zd},{key:"Delete",run:nx},{key:"Mod-Backspace",mac:"Alt-Backspace",run:rx},{key:"Mod-Delete",mac:"Alt-Delete",run:LE},{mac:"Mod-Backspace",run:YE},{mac:"Mod-Delete",run:jE}].concat(rN.map(i=>({mac:i.key,run:i.run,shift:i.shift}))),oN=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:kE,shift:AE},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:bE,shift:ZE},{key:"Alt-ArrowUp",run:UE},{key:"Shift-Alt-ArrowUp",run:HE},{key:"Alt-ArrowDown",run:GE},{key:"Shift-Alt-ArrowDown",run:KE},{key:"Escape",run:qE},{key:"Mod-Enter",run:nN},{key:"Alt-l",mac:"Ctrl-l",run:BE},{key:"Mod-i",run:VE,preventDefault:!0},{key:"Mod-[",run:hx},{key:"Mod-]",run:ax},{key:"Mod-Alt-\\",run:iN},{key:"Shift-Mod-k",run:JE},{key:"Shift-Mod-\\",run:CE},{key:"Mod-/",run:H2},{key:"Alt-A",run:J2}].concat(sN),lN={key:"Tab",run:ax,shift:hx};function he(){var i=arguments[0];typeof i=="string"&&(i=document.createElement(i));var e=1,t=arguments[1];if(t&&typeof t=="object"&&t.nodeType==null&&!Array.isArray(t)){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=t[n];typeof r=="string"?i.setAttribute(n,r):r!=null&&(i[n]=r)}e++}for(;e<arguments.length;e++)cx(i,arguments[e]);return i}function cx(i,e){if(typeof e=="string")i.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)i.appendChild(e);else if(Array.isArray(e))for(var t=0;t<e.length;t++)cx(i,e[t]);else throw new RangeError("Unsupported child node: "+e)}const ty=typeof String.prototype.normalize=="function"?i=>i.normalize("NFKD"):i=>i;class qs{constructor(e,t,n=0,r=e.length,s,o){this.test=o,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(n,r),this.bufferStart=n,this.normalize=s?l=>s(ty(l)):ty,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return ze(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=Xp(e),n=this.bufferStart+this.bufferPos;this.bufferPos+=Lt(e);let r=this.normalize(t);for(let s=0,o=n;;s++){let l=r.charCodeAt(s),a=this.match(l,o,this.bufferPos+this.bufferStart);if(s==r.length-1){if(a)return this.value=a,this;break}o==n&&s<t.length&&t.charCodeAt(s)==l&&o++}}}match(e,t,n){let r=null;for(let s=0;s<this.matches.length;s+=2){let o=this.matches[s],l=!1;this.query.charCodeAt(o)==e&&(o==this.query.length-1?r={from:this.matches[s+1],to:n}:(this.matches[s]++,l=!0)),l||(this.matches.splice(s,2),s-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?r={from:t,to:n}:this.matches.push(1,t)),r&&this.test&&!this.test(r.from,r.to,this.buffer,this.bufferStart)&&(r=null),r}}typeof Symbol<"u"&&(qs.prototype[Symbol.iterator]=function(){return this});const fx={from:-1,to:-1,match:/.*/.exec("")},hm="gm"+(/x/.unicode==null?"":"u");class ux{constructor(e,t,n,r=0,s=e.length){if(this.text=e,this.to=s,this.curLine="",this.done=!1,this.value=fx,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new dx(e,t,n,r,s);this.re=new RegExp(t,hm+(n!=null&&n.ignoreCase?"i":"")),this.test=n==null?void 0:n.test,this.iter=e.iter();let o=e.lineAt(r);this.curLineStart=o.from,this.matchPos=sc(e,r),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let n=this.curLineStart+t.index,r=n+t[0].length;if(this.matchPos=sc(this.text,r+(n==r?1:0)),n==this.curLineStart+this.curLine.length&&this.nextLine(),(n<r||n>this.value.to)&&(!this.test||this.test(n,r,t)))return this.value={from:n,to:r,match:t},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const eu=new WeakMap;class Ps{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,n){let r=eu.get(e);if(!r||r.from>=n||r.to<=t){let l=new Ps(t,e.sliceString(t,n));return eu.set(e,l),l}if(r.from==t&&r.to==n)return r;let{text:s,from:o}=r;return o>t&&(s=e.sliceString(t,o)+s,o=t),r.to<n&&(s+=e.sliceString(r.to,n)),eu.set(e,new Ps(o,s)),new Ps(t,s.slice(t-o,n-o))}}class dx{constructor(e,t,n,r,s){this.text=e,this.to=s,this.done=!1,this.value=fx,this.matchPos=sc(e,r),this.re=new RegExp(t,hm+(n!=null&&n.ignoreCase?"i":"")),this.test=n==null?void 0:n.test,this.flat=Ps.get(e,r,this.chunkEnd(r+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let n=this.flat.from+t.index,r=n+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(n,r,t)))return this.value={from:n,to:r,match:t},this.matchPos=sc(this.text,r+(n==r?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=Ps.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(ux.prototype[Symbol.iterator]=dx.prototype[Symbol.iterator]=function(){return this});function aN(i){try{return new RegExp(i,hm),!0}catch{return!1}}function sc(i,e){if(e>=i.length)return e;let t=i.lineAt(e),n;for(;e<t.to&&(n=t.text.charCodeAt(e-t.from))>=56320&&n<57344;)e++;return e}function Yd(i){let e=String(i.state.doc.lineAt(i.state.selection.main.head).number),t=he("input",{class:"cm-textfield",name:"line",value:e}),n=he("form",{class:"cm-gotoLine",onkeydown:s=>{s.keyCode==27?(s.preventDefault(),i.dispatch({effects:oc.of(!1)}),i.focus()):s.keyCode==13&&(s.preventDefault(),r())},onsubmit:s=>{s.preventDefault(),r()}},he("label",i.state.phrase("Go to line"),": ",t)," ",he("button",{class:"cm-button",type:"submit"},i.state.phrase("go")));function r(){let s=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(t.value);if(!s)return;let{state:o}=i,l=o.doc.lineAt(o.selection.main.head),[,a,h,c,f]=s,u=c?+c.slice(1):0,d=h?+h:l.number;if(h&&f){let g=d/100;a&&(g=g*(a=="-"?-1:1)+l.number/o.doc.lines),d=Math.round(o.doc.lines*g)}else h&&a&&(d=d*(a=="-"?-1:1)+l.number);let p=o.doc.line(Math.max(1,Math.min(o.doc.lines,d))),m=b.cursor(p.from+Math.max(0,Math.min(u,p.length)));i.dispatch({effects:[oc.of(!1),M.scrollIntoView(m.from,{y:"center"})],selection:m}),i.focus()}return{dom:n}}const oc=q.define(),ny=Ae.define({create(){return!0},update(i,e){for(let t of e.effects)t.is(oc)&&(i=t.value);return i},provide:i=>Tl.from(i,e=>e?Yd:null)}),hN=i=>{let e=Cl(i,Yd);if(!e){let t=[oc.of(!0)];i.state.field(ny,!1)==null&&t.push(q.appendConfig.of([ny,cN])),i.dispatch({effects:t}),e=Cl(i,Yd)}return e&&e.dom.querySelector("input").select(),!0},cN=M.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),fN={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},px=R.define({combine(i){return On(i,fN,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})}});function uN(i){let e=[ON,gN];return i&&e.push(px.of(i)),e}const dN=I.mark({class:"cm-selectionMatch"}),pN=I.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function iy(i,e,t,n){return(t==0||i(e.sliceDoc(t-1,t))!=ke.Word)&&(n==e.doc.length||i(e.sliceDoc(n,n+1))!=ke.Word)}function mN(i,e,t,n){return i(e.sliceDoc(t,t+1))==ke.Word&&i(e.sliceDoc(n-1,n))==ke.Word}const gN=ve.fromClass(class{constructor(i){this.decorations=this.getDeco(i)}update(i){(i.selectionSet||i.docChanged||i.viewportChanged)&&(this.decorations=this.getDeco(i.view))}getDeco(i){let e=i.state.facet(px),{state:t}=i,n=t.selection;if(n.ranges.length>1)return I.none;let r=n.main,s,o=null;if(r.empty){if(!e.highlightWordAroundCursor)return I.none;let a=t.wordAt(r.head);if(!a)return I.none;o=t.charCategorizer(r.head),s=t.sliceDoc(a.from,a.to)}else{let a=r.to-r.from;if(a<e.minSelectionLength||a>200)return I.none;if(e.wholeWords){if(s=t.sliceDoc(r.from,r.to),o=t.charCategorizer(r.head),!(iy(o,t,r.from,r.to)&&mN(o,t,r.from,r.to)))return I.none}else if(s=t.sliceDoc(r.from,r.to),!s)return I.none}let l=[];for(let a of i.visibleRanges){let h=new qs(t.doc,s,a.from,a.to);for(;!h.next().done;){let{from:c,to:f}=h.value;if((!o||iy(o,t,c,f))&&(r.empty&&c<=r.from&&f>=r.to?l.push(pN.range(c,f)):(c>=r.to||f<=r.from)&&l.push(dN.range(c,f)),l.length>e.maxMatches))return I.none}}return I.set(l)}},{decorations:i=>i.decorations}),ON=M.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),yN=({state:i,dispatch:e})=>{let{selection:t}=i,n=b.create(t.ranges.map(r=>i.wordAt(r.head)||b.cursor(r.head)),t.mainIndex);return n.eq(t)?!1:(e(i.update({selection:n})),!0)};function kN(i,e){let{main:t,ranges:n}=i.selection,r=i.wordAt(t.head),s=r&&r.from==t.from&&r.to==t.to;for(let o=!1,l=new qs(i.doc,e,n[n.length-1].to);;)if(l.next(),l.done){if(o)return null;l=new qs(i.doc,e,0,Math.max(0,n[n.length-1].from-1)),o=!0}else{if(o&&n.some(a=>a.from==l.value.from))continue;if(s){let a=i.wordAt(l.value.from);if(!a||a.from!=l.value.from||a.to!=l.value.to)continue}return l.value}}const bN=({state:i,dispatch:e})=>{let{ranges:t}=i.selection;if(t.some(s=>s.from===s.to))return yN({state:i,dispatch:e});let n=i.sliceDoc(t[0].from,t[0].to);if(i.selection.ranges.some(s=>i.sliceDoc(s.from,s.to)!=n))return!1;let r=kN(i,n);return r?(e(i.update({selection:i.selection.addRange(b.range(r.from,r.to),!1),effects:M.scrollIntoView(r.to)})),!0):!1},no=R.define({combine(i){return On(i,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new ZN(e),scrollToMatch:e=>M.scrollIntoView(e)})}});class mx{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||aN(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(t,n)=>n=="n"?`
`:n=="r"?"\r":n=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new vN(this):new wN(this)}getCursor(e,t=0,n){let r=e.doc?e:j.create({doc:e});return n==null&&(n=r.doc.length),this.regexp?as(this,r,t,n):ls(this,r,t,n)}}class gx{constructor(e){this.spec=e}}function ls(i,e,t,n){return new qs(e.doc,i.unquoted,t,n,i.caseSensitive?void 0:r=>r.toLowerCase(),i.wholeWord?SN(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function SN(i,e){return(t,n,r,s)=>((s>t||s+r.length<n)&&(s=Math.max(0,t-2),r=i.sliceString(s,Math.min(i.length,n+2))),(e(lc(r,t-s))!=ke.Word||e(ac(r,t-s))!=ke.Word)&&(e(ac(r,n-s))!=ke.Word||e(lc(r,n-s))!=ke.Word))}class wN extends gx{constructor(e){super(e)}nextMatch(e,t,n){let r=ls(this.spec,e,n,e.doc.length).nextOverlapping();return r.done&&(r=ls(this.spec,e,0,t).nextOverlapping()),r.done?null:r.value}prevMatchInRange(e,t,n){for(let r=n;;){let s=Math.max(t,r-1e4-this.spec.unquoted.length),o=ls(this.spec,e,s,r),l=null;for(;!o.nextOverlapping().done;)l=o.value;if(l)return l;if(s==t)return null;r-=1e4}}prevMatch(e,t,n){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,n,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let n=ls(this.spec,e,0,e.doc.length),r=[];for(;!n.next().done;){if(r.length>=t)return null;r.push(n.value)}return r}highlight(e,t,n,r){let s=ls(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(n+this.spec.unquoted.length,e.doc.length));for(;!s.next().done;)r(s.value.from,s.value.to)}}function as(i,e,t,n){return new ux(e.doc,i.search,{ignoreCase:!i.caseSensitive,test:i.wholeWord?xN(e.charCategorizer(e.selection.main.head)):void 0},t,n)}function lc(i,e){return i.slice(_e(i,e,!1),e)}function ac(i,e){return i.slice(e,_e(i,e))}function xN(i){return(e,t,n)=>!n[0].length||(i(lc(n.input,n.index))!=ke.Word||i(ac(n.input,n.index))!=ke.Word)&&(i(ac(n.input,n.index+n[0].length))!=ke.Word||i(lc(n.input,n.index+n[0].length))!=ke.Word)}class vN extends gx{nextMatch(e,t,n){let r=as(this.spec,e,n,e.doc.length).next();return r.done&&(r=as(this.spec,e,0,t).next()),r.done?null:r.value}prevMatchInRange(e,t,n){for(let r=1;;r++){let s=Math.max(t,n-r*1e4),o=as(this.spec,e,s,n),l=null;for(;!o.next().done;)l=o.value;if(l&&(s==t||l.from>s+10))return l;if(s==t)return null}}prevMatch(e,t,n){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,n,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&\d+])/g,(t,n)=>n=="$"?"$":n=="&"?e.match[0]:n!="0"&&+n<e.match.length?e.match[n]:t)}matchAll(e,t){let n=as(this.spec,e,0,e.doc.length),r=[];for(;!n.next().done;){if(r.length>=t)return null;r.push(n.value)}return r}highlight(e,t,n,r){let s=as(this.spec,e,Math.max(0,t-250),Math.min(n+250,e.doc.length));for(;!s.next().done;)r(s.value.from,s.value.to)}}const Nl=q.define(),cm=q.define(),zi=Ae.define({create(i){return new tu(jd(i).create(),null)},update(i,e){for(let t of e.effects)t.is(Nl)?i=new tu(t.value.create(),i.panel):t.is(cm)&&(i=new tu(i.query,t.value?fm:null));return i},provide:i=>Tl.from(i,e=>e.panel)});class tu{constructor(e,t){this.query=e,this.panel=t}}const $N=I.mark({class:"cm-searchMatch"}),PN=I.mark({class:"cm-searchMatch cm-searchMatch-selected"}),QN=ve.fromClass(class{constructor(i){this.view=i,this.decorations=this.highlight(i.state.field(zi))}update(i){let e=i.state.field(zi);(e!=i.startState.field(zi)||i.docChanged||i.selectionSet||i.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:i,panel:e}){if(!e||!i.spec.valid)return I.none;let{view:t}=this,n=new _i;for(let r=0,s=t.visibleRanges,o=s.length;r<o;r++){let{from:l,to:a}=s[r];for(;r<o-1&&a>s[r+1].from-2*250;)a=s[++r].to;i.highlight(t.state,l,a,(h,c)=>{let f=t.state.selection.ranges.some(u=>u.from==h&&u.to==c);n.add(h,c,f?PN:$N)})}return n.finish()}},{decorations:i=>i.decorations});function ia(i){return e=>{let t=e.state.field(zi,!1);return t&&t.query.spec.valid?i(e,t):kx(e)}}const hc=ia((i,{query:e})=>{let{to:t}=i.state.selection.main,n=e.nextMatch(i.state,t,t);if(!n)return!1;let r=b.single(n.from,n.to),s=i.state.facet(no);return i.dispatch({selection:r,effects:[um(i,n),s.scrollToMatch(r.main,i)],userEvent:"select.search"}),yx(i),!0}),cc=ia((i,{query:e})=>{let{state:t}=i,{from:n}=t.selection.main,r=e.prevMatch(t,n,n);if(!r)return!1;let s=b.single(r.from,r.to),o=i.state.facet(no);return i.dispatch({selection:s,effects:[um(i,r),o.scrollToMatch(s.main,i)],userEvent:"select.search"}),yx(i),!0}),CN=ia((i,{query:e})=>{let t=e.matchAll(i.state,1e3);return!t||!t.length?!1:(i.dispatch({selection:b.create(t.map(n=>b.range(n.from,n.to))),userEvent:"select.search.matches"}),!0)}),TN=({state:i,dispatch:e})=>{let t=i.selection;if(t.ranges.length>1||t.main.empty)return!1;let{from:n,to:r}=t.main,s=[],o=0;for(let l=new qs(i.doc,i.sliceDoc(n,r));!l.next().done;){if(s.length>1e3)return!1;l.value.from==n&&(o=s.length),s.push(b.range(l.value.from,l.value.to))}return e(i.update({selection:b.create(s,o),userEvent:"select.search.matches"})),!0},ry=ia((i,{query:e})=>{let{state:t}=i,{from:n,to:r}=t.selection.main;if(t.readOnly)return!1;let s=e.nextMatch(t,n,n);if(!s)return!1;let o=[],l,a,h=[];if(s.from==n&&s.to==r&&(a=t.toText(e.getReplacement(s)),o.push({from:s.from,to:s.to,insert:a}),s=e.nextMatch(t,s.from,s.to),h.push(M.announce.of(t.phrase("replaced match on line $",t.doc.lineAt(n).number)+"."))),s){let c=o.length==0||o[0].from>=s.to?0:s.to-s.from-a.length;l=b.single(s.from-c,s.to-c),h.push(um(i,s)),h.push(t.facet(no).scrollToMatch(l.main,i))}return i.dispatch({changes:o,selection:l,effects:h,userEvent:"input.replace"}),!0}),MN=ia((i,{query:e})=>{if(i.state.readOnly)return!1;let t=e.matchAll(i.state,1e9).map(r=>{let{from:s,to:o}=r;return{from:s,to:o,insert:e.getReplacement(r)}});if(!t.length)return!1;let n=i.state.phrase("replaced $ matches",t.length)+".";return i.dispatch({changes:t,effects:M.announce.of(n),userEvent:"input.replace.all"}),!0});function fm(i){return i.state.facet(no).createPanel(i)}function jd(i,e){var t,n,r,s,o;let l=i.selection.main,a=l.empty||l.to>l.from+100?"":i.sliceDoc(l.from,l.to);if(e&&!a)return e;let h=i.facet(no);return new mx({search:((t=e==null?void 0:e.literal)!==null&&t!==void 0?t:h.literal)?a:a.replace(/\n/g,"\\n"),caseSensitive:(n=e==null?void 0:e.caseSensitive)!==null&&n!==void 0?n:h.caseSensitive,literal:(r=e==null?void 0:e.literal)!==null&&r!==void 0?r:h.literal,regexp:(s=e==null?void 0:e.regexp)!==null&&s!==void 0?s:h.regexp,wholeWord:(o=e==null?void 0:e.wholeWord)!==null&&o!==void 0?o:h.wholeWord})}function Ox(i){let e=Cl(i,fm);return e&&e.dom.querySelector("[main-field]")}function yx(i){let e=Ox(i);e&&e==i.root.activeElement&&e.select()}const kx=i=>{let e=i.state.field(zi,!1);if(e&&e.panel){let t=Ox(i);if(t&&t!=i.root.activeElement){let n=jd(i.state,e.query.spec);n.valid&&i.dispatch({effects:Nl.of(n)}),t.focus(),t.select()}}else i.dispatch({effects:[cm.of(!0),e?Nl.of(jd(i.state,e.query.spec)):q.appendConfig.of(EN)]});return!0},bx=i=>{let e=i.state.field(zi,!1);if(!e||!e.panel)return!1;let t=Cl(i,fm);return t&&t.dom.contains(i.root.activeElement)&&i.focus(),i.dispatch({effects:cm.of(!1)}),!0},AN=[{key:"Mod-f",run:kx,scope:"editor search-panel"},{key:"F3",run:hc,shift:cc,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:hc,shift:cc,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:bx,scope:"editor search-panel"},{key:"Mod-Shift-l",run:TN},{key:"Mod-Alt-g",run:hN},{key:"Mod-d",run:bN,preventDefault:!0}];class ZN{constructor(e){this.view=e;let t=this.query=e.state.field(zi).query.spec;this.commit=this.commit.bind(this),this.searchField=he("input",{value:t.search,placeholder:vt(e,"Find"),"aria-label":vt(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=he("input",{value:t.replace,placeholder:vt(e,"Replace"),"aria-label":vt(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=he("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=he("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=he("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit});function n(r,s,o){return he("button",{class:"cm-button",name:r,onclick:s,type:"button"},o)}this.dom=he("div",{onkeydown:r=>this.keydown(r),class:"cm-search"},[this.searchField,n("next",()=>hc(e),[vt(e,"next")]),n("prev",()=>cc(e),[vt(e,"previous")]),n("select",()=>CN(e),[vt(e,"all")]),he("label",null,[this.caseField,vt(e,"match case")]),he("label",null,[this.reField,vt(e,"regexp")]),he("label",null,[this.wordField,vt(e,"by word")]),...e.state.readOnly?[]:[he("br"),this.replaceField,n("replace",()=>ry(e),[vt(e,"replace")]),n("replaceAll",()=>MN(e),[vt(e,"replace all")])],he("button",{name:"close",onclick:()=>bx(e),"aria-label":vt(e,"close"),type:"button"},[""])])}commit(){let e=new mx({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Nl.of(e)}))}keydown(e){BZ(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?cc:hc)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),ry(this.view))}update(e){for(let t of e.transactions)for(let n of t.effects)n.is(Nl)&&!n.value.eq(this.query)&&this.setQuery(n.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(no).top}}function vt(i,e){return i.state.phrase(e)}const Ea=30,Na=/[\s\.,:;?!]/;function um(i,{from:e,to:t}){let n=i.state.doc.lineAt(e),r=i.state.doc.lineAt(t).to,s=Math.max(n.from,e-Ea),o=Math.min(r,t+Ea),l=i.state.sliceDoc(s,o);if(s!=n.from){for(let a=0;a<Ea;a++)if(!Na.test(l[a+1])&&Na.test(l[a])){l=l.slice(a);break}}if(o!=r){for(let a=l.length-1;a>l.length-Ea;a--)if(!Na.test(l[a-1])&&Na.test(l[a])){l=l.slice(0,a);break}}return M.announce.of(`${i.state.phrase("current match")}. ${l} ${i.state.phrase("on line")} ${n.number}.`)}const RN=M.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),EN=[zi,di.low(QN),RN];class dm{constructor(e,t,n){this.state=e,this.pos=t,this.explicit=n,this.abortListeners=[]}tokenBefore(e){let t=ae(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),n=Math.max(t.from,this.pos-250),r=t.text.slice(n-t.from,this.pos-t.from),s=r.search(wx(e,!1));return s<0?null:{from:n+s,to:this.pos,text:r.slice(s)}}get aborted(){return this.abortListeners==null}addEventListener(e,t){e=="abort"&&this.abortListeners&&this.abortListeners.push(t)}}function sy(i){let e=Object.keys(i).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function NN(i){let e=Object.create(null),t=Object.create(null);for(let{label:r}of i){e[r[0]]=!0;for(let s=1;s<r.length;s++)t[r[s]]=!0}let n=sy(e)+sy(t)+"*$";return[new RegExp("^"+n),new RegExp(n)]}function Sx(i){let e=i.map(r=>typeof r=="string"?{label:r}:r),[t,n]=e.every(r=>/^\w+$/.test(r.label))?[/\w*$/,/\w+$/]:NN(e);return r=>{let s=r.matchBefore(n);return s||r.explicit?{from:s?s.from:r.pos,options:e,validFor:t}:null}}function DN(i,e){return t=>{for(let n=ae(t.state).resolveInner(t.pos,-1);n;n=n.parent){if(i.indexOf(n.name)>-1)return null;if(n.type.isTop)break}return e(t)}}class oy{constructor(e,t,n,r){this.completion=e,this.source=t,this.match=n,this.score=r}}function Yi(i){return i.selection.main.from}function wx(i,e){var t;let{source:n}=i,r=e&&n[0]!="^",s=n[n.length-1]!="$";return!r&&!s?i:new RegExp(`${r?"^":""}(?:${n})${s?"$":""}`,(t=i.flags)!==null&&t!==void 0?t:i.ignoreCase?"i":"")}const xx=pi.define();function IN(i,e,t,n){let{main:r}=i.selection,s=t-r.from,o=n-r.from;return Object.assign(Object.assign({},i.changeByRange(l=>l!=r&&t!=n&&i.sliceDoc(l.from+s,l.from+o)!=i.sliceDoc(t,n)?{range:l}:{changes:{from:l.from+s,to:n==r.from?l.to:l.from+o,insert:e},range:b.cursor(l.from+s+e.length)})),{scrollIntoView:!0,userEvent:"input.complete"})}const ly=new WeakMap;function WN(i){if(!Array.isArray(i))return i;let e=ly.get(i);return e||ly.set(i,e=Sx(i)),e}const fc=q.define(),Dl=q.define();class XN{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let t=0;t<e.length;){let n=ze(e,t),r=Lt(n);this.chars.push(n);let s=e.slice(t,t+r),o=s.toUpperCase();this.folded.push(ze(o==s?s.toLowerCase():o,0)),t+=r}this.astral=e.length!=this.chars.length}ret(e,t){return this.score=e,this.matched=t,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:t,folded:n,any:r,precise:s,byWord:o}=this;if(t.length==1){let k=ze(e,0),v=Lt(k),$=v==e.length?0:-100;if(k!=t[0])if(k==n[0])$+=-200;else return null;return this.ret($,[0,v])}let l=e.indexOf(this.pattern);if(l==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let a=t.length,h=0;if(l<0){for(let k=0,v=Math.min(e.length,200);k<v&&h<a;){let $=ze(e,k);($==t[h]||$==n[h])&&(r[h++]=k),k+=Lt($)}if(h<a)return null}let c=0,f=0,u=!1,d=0,p=-1,m=-1,g=/[a-z]/.test(e),y=!0;for(let k=0,v=Math.min(e.length,200),$=0;k<v&&f<a;){let S=ze(e,k);l<0&&(c<a&&S==t[c]&&(s[c++]=k),d<a&&(S==t[d]||S==n[d]?(d==0&&(p=k),m=k+1,d++):d=0));let x,Q=S<255?S>=48&&S<=57||S>=97&&S<=122?2:S>=65&&S<=90?1:0:(x=Xp(S))!=x.toLowerCase()?1:x!=x.toUpperCase()?2:0;(!k||Q==1&&g||$==0&&Q!=0)&&(t[f]==S||n[f]==S&&(u=!0)?o[f++]=k:o.length&&(y=!1)),$=Q,k+=Lt(S)}return f==a&&o[0]==0&&y?this.result(-100+(u?-200:0),o,e):d==a&&p==0?this.ret(-200-e.length+(m==e.length?0:-100),[0,m]):l>-1?this.ret(-700-e.length,[l,l+this.pattern.length]):d==a?this.ret(-900-e.length,[p,m]):f==a?this.result(-100+(u?-200:0)+-700+(y?0:-1100),o,e):t.length==2?null:this.result((r[0]?-700:0)+-200+-1100,r,e)}result(e,t,n){let r=[],s=0;for(let o of t){let l=o+(this.astral?Lt(ze(n,o)):1);s&&r[s-1]==o?r[s-1]=l:(r[s++]=o,r[s++]=l)}return this.ret(e-n.length,r)}}class BN{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let t=e.slice(0,this.pattern.length),n=t==this.pattern?0:t.toLowerCase()==this.folded?-200:null;return n==null?null:(this.matched=[0,t.length],this.score=n+(e.length==this.pattern.length?0:-100),this)}}const je=R.define({combine(i){return On(i,{activateOnTyping:!0,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:VN,filterStrict:!1,compareCompletions:(e,t)=>e.label.localeCompare(t.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(e,t)=>n=>ay(e(n),t(n)),optionClass:(e,t)=>n=>ay(e(n),t(n)),addToOptions:(e,t)=>e.concat(t),filterStrict:(e,t)=>e||t})}});function ay(i,e){return i?e?i+" "+e:i:e}function VN(i,e,t,n,r,s){let o=i.textDirection==ge.RTL,l=o,a=!1,h="top",c,f,u=e.left-r.left,d=r.right-e.right,p=n.right-n.left,m=n.bottom-n.top;if(l&&u<Math.min(p,d)?l=!1:!l&&d<Math.min(p,u)&&(l=!0),p<=(l?u:d))c=Math.max(r.top,Math.min(t.top,r.bottom-m))-e.top,f=Math.min(400,l?u:d);else{a=!0,f=Math.min(400,(o?e.right:r.right-e.left)-30);let k=r.bottom-e.bottom;k>=m||k>e.top?c=t.bottom-e.top:(h="bottom",c=e.bottom-t.top)}let g=(e.bottom-e.top)/s.offsetHeight,y=(e.right-e.left)/s.offsetWidth;return{style:`${h}: ${c/g}px; max-width: ${f/y}px`,class:"cm-completionInfo-"+(a?o?"left-narrow":"right-narrow":l?"left":"right")}}function qN(i){let e=i.addToOptions.slice();return i.icons&&e.push({render(t){let n=document.createElement("div");return n.classList.add("cm-completionIcon"),t.type&&n.classList.add(...t.type.split(/\s+/g).map(r=>"cm-completionIcon-"+r)),n.setAttribute("aria-hidden","true"),n},position:20}),e.push({render(t,n,r,s){let o=document.createElement("span");o.className="cm-completionLabel";let l=t.displayLabel||t.label,a=0;for(let h=0;h<s.length;){let c=s[h++],f=s[h++];c>a&&o.appendChild(document.createTextNode(l.slice(a,c)));let u=o.appendChild(document.createElement("span"));u.appendChild(document.createTextNode(l.slice(c,f))),u.className="cm-completionMatchedText",a=f}return a<l.length&&o.appendChild(document.createTextNode(l.slice(a))),o},position:50},{render(t){if(!t.detail)return null;let n=document.createElement("span");return n.className="cm-completionDetail",n.textContent=t.detail,n},position:80}),e.sort((t,n)=>t.position-n.position).map(t=>t.render)}function nu(i,e,t){if(i<=t)return{from:0,to:i};if(e<0&&(e=0),e<=i>>1){let r=Math.floor(e/t);return{from:r*t,to:(r+1)*t}}let n=Math.floor((i-e)/t);return{from:i-(n+1)*t,to:i-n*t}}class LN{constructor(e,t,n){this.view=e,this.stateField=t,this.applyCompletion=n,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:a=>this.placeInfo(a),key:this},this.space=null,this.currentClass="";let r=e.state.field(t),{options:s,selected:o}=r.open,l=e.state.facet(je);this.optionContent=qN(l),this.optionClass=l.optionClass,this.tooltipClass=l.tooltipClass,this.range=nu(s.length,o,l.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",a=>{let{options:h}=e.state.field(t).open;for(let c=a.target,f;c&&c!=this.dom;c=c.parentNode)if(c.nodeName=="LI"&&(f=/-(\d+)$/.exec(c.id))&&+f[1]<h.length){this.applyCompletion(e,h[+f[1]]),a.preventDefault();return}}),this.dom.addEventListener("focusout",a=>{let h=e.state.field(this.stateField,!1);h&&h.tooltip&&e.state.facet(je).closeOnBlur&&a.relatedTarget!=e.contentDOM&&e.dispatch({effects:Dl.of(null)})}),this.showOptions(s,r.id)}mount(){this.updateSel()}showOptions(e,t){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,t,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var t;let n=e.state.field(this.stateField),r=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),n!=r){let{options:s,selected:o,disabled:l}=n.open;(!r.open||r.open.options!=s)&&(this.range=nu(s.length,o,e.state.facet(je).maxRenderedOptions),this.showOptions(s,n.id)),this.updateSel(),l!=((t=r.open)===null||t===void 0?void 0:t.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!l)}}updateTooltipClass(e){let t=this.tooltipClass(e);if(t!=this.currentClass){for(let n of this.currentClass.split(" "))n&&this.dom.classList.remove(n);for(let n of t.split(" "))n&&this.dom.classList.add(n);this.currentClass=t}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;if((t.selected>-1&&t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=nu(t.options.length,t.selected,this.view.state.facet(je).maxRenderedOptions),this.showOptions(t.options,e.id)),this.updateSelectedOption(t.selected)){this.destroyInfo();let{completion:n}=t.options[t.selected],{info:r}=n;if(!r)return;let s=typeof r=="string"?document.createTextNode(r):r(n);if(!s)return;"then"in s?s.then(o=>{o&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(o,n)}).catch(o=>lt(this.view.state,o,"completion info")):this.addInfoPane(s,n)}}addInfoPane(e,t){this.destroyInfo();let n=this.info=document.createElement("div");if(n.className="cm-tooltip cm-completionInfo",e.nodeType!=null)n.appendChild(e),this.infoDestroy=null;else{let{dom:r,destroy:s}=e;n.appendChild(r),this.infoDestroy=s||null}this.dom.appendChild(n),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let t=null;for(let n=this.list.firstChild,r=this.range.from;n;n=n.nextSibling,r++)n.nodeName!="LI"||!n.id?r--:r==e?n.hasAttribute("aria-selected")||(n.setAttribute("aria-selected","true"),t=n):n.hasAttribute("aria-selected")&&n.removeAttribute("aria-selected");return t&&YN(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),n=this.info.getBoundingClientRect(),r=e.getBoundingClientRect(),s=this.space;if(!s){let o=this.dom.ownerDocument.defaultView||window;s={left:0,top:0,right:o.innerWidth,bottom:o.innerHeight}}return r.top>Math.min(s.bottom,t.bottom)-10||r.bottom<Math.max(s.top,t.top)+10?null:this.view.state.facet(je).positionInfo(this.view,t,r,n,s,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,t,n){const r=document.createElement("ul");r.id=t,r.setAttribute("role","listbox"),r.setAttribute("aria-expanded","true"),r.setAttribute("aria-label",this.view.state.phrase("Completions"));let s=null;for(let o=n.from;o<n.to;o++){let{completion:l,match:a}=e[o],{section:h}=l;if(h){let u=typeof h=="string"?h:h.name;if(u!=s&&(o>n.from||n.from==0))if(s=u,typeof h!="string"&&h.header)r.appendChild(h.header(h));else{let d=r.appendChild(document.createElement("completion-section"));d.textContent=u}}const c=r.appendChild(document.createElement("li"));c.id=t+"-"+o,c.setAttribute("role","option");let f=this.optionClass(l);f&&(c.className=f);for(let u of this.optionContent){let d=u(l,this.view.state,this.view,a);d&&c.appendChild(d)}}return n.from&&r.classList.add("cm-completionListIncompleteTop"),n.to<e.length&&r.classList.add("cm-completionListIncompleteBottom"),r}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function zN(i,e){return t=>new LN(t,i,e)}function YN(i,e){let t=i.getBoundingClientRect(),n=e.getBoundingClientRect(),r=t.height/i.offsetHeight;n.top<t.top?i.scrollTop-=(t.top-n.top)/r:n.bottom>t.bottom&&(i.scrollTop+=(n.bottom-t.bottom)/r)}function hy(i){return(i.boost||0)*100+(i.apply?10:0)+(i.info?5:0)+(i.type?1:0)}function jN(i,e){let t=[],n=null,r=h=>{t.push(h);let{section:c}=h.completion;if(c){n||(n=[]);let f=typeof c=="string"?c:c.name;n.some(u=>u.name==f)||n.push(typeof c=="string"?{name:f}:c)}},s=e.facet(je);for(let h of i)if(h.hasResult()){let c=h.result.getMatch;if(h.result.filter===!1)for(let f of h.result.options)r(new oy(f,h.source,c?c(f):[],1e9-t.length));else{let f=e.sliceDoc(h.from,h.to),u,d=s.filterStrict?new BN(f):new XN(f);for(let p of h.result.options)if(u=d.match(p.label)){let m=p.displayLabel?c?c(p,u.matched):[]:u.matched;r(new oy(p,h.source,m,u.score+(p.boost||0)))}}}if(n){let h=Object.create(null),c=0,f=(u,d)=>{var p,m;return((p=u.rank)!==null&&p!==void 0?p:1e9)-((m=d.rank)!==null&&m!==void 0?m:1e9)||(u.name<d.name?-1:1)};for(let u of n.sort(f))c-=1e5,h[u.name]=c;for(let u of t){let{section:d}=u.completion;d&&(u.score+=h[typeof d=="string"?d:d.name])}}let o=[],l=null,a=s.compareCompletions;for(let h of t.sort((c,f)=>f.score-c.score||a(c.completion,f.completion))){let c=h.completion;!l||l.label!=c.label||l.detail!=c.detail||l.type!=null&&c.type!=null&&l.type!=c.type||l.apply!=c.apply||l.boost!=c.boost?o.push(h):hy(h.completion)>hy(l)&&(o[o.length-1]=h),l=h.completion}return o}class ds{constructor(e,t,n,r,s,o){this.options=e,this.attrs=t,this.tooltip=n,this.timestamp=r,this.selected=s,this.disabled=o}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new ds(this.options,cy(t,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,t,n,r,s){let o=jN(e,t);if(!o.length)return r&&e.some(a=>a.state==1)?new ds(r.options,r.attrs,r.tooltip,r.timestamp,r.selected,!0):null;let l=t.facet(je).selectOnOpen?0:-1;if(r&&r.selected!=l&&r.selected!=-1){let a=r.options[r.selected].completion;for(let h=0;h<o.length;h++)if(o[h].completion==a){l=h;break}}return new ds(o,cy(n,l),{pos:e.reduce((a,h)=>h.hasResult()?Math.min(a,h.from):a,1e8),create:HN,above:s.aboveCursor},r?r.timestamp:Date.now(),l,!1)}map(e){return new ds(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class uc{constructor(e,t,n){this.active=e,this.id=t,this.open=n}static start(){return new uc(UN,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:t}=e,n=t.facet(je),s=(n.override||t.languageDataAt("autocomplete",Yi(t)).map(WN)).map(l=>(this.active.find(h=>h.source==l)||new rt(l,this.active.some(h=>h.state!=0)?1:0)).update(e,n));s.length==this.active.length&&s.every((l,a)=>l==this.active[a])&&(s=this.active);let o=this.open;o&&e.docChanged&&(o=o.map(e.changes)),e.selection||s.some(l=>l.hasResult()&&e.changes.touchesRange(l.from,l.to))||!_N(s,this.active)?o=ds.build(s,t,this.id,o,n):o&&o.disabled&&!s.some(l=>l.state==1)&&(o=null),!o&&s.every(l=>l.state!=1)&&s.some(l=>l.hasResult())&&(s=s.map(l=>l.hasResult()?new rt(l.source,0):l));for(let l of e.effects)l.is($x)&&(o=o&&o.setSelected(l.value,this.id));return s==this.active&&o==this.open?this:new uc(s,this.id,o)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:FN}}function _N(i,e){if(i==e)return!0;for(let t=0,n=0;;){for(;t<i.length&&!i[t].hasResult;)t++;for(;n<e.length&&!e[n].hasResult;)n++;let r=t==i.length,s=n==e.length;if(r||s)return r==s;if(i[t++].result!=e[n++].result)return!1}}const FN={"aria-autocomplete":"list"};function cy(i,e){let t={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":i};return e>-1&&(t["aria-activedescendant"]=i+"-"+e),t}const UN=[];function _d(i){return i.isUserEvent("input.type")?"input":i.isUserEvent("delete.backward")?"delete":null}class rt{constructor(e,t,n=-1){this.source=e,this.state=t,this.explicitPos=n}hasResult(){return!1}update(e,t){let n=_d(e),r=this;n?r=r.handleUserEvent(e,n,t):e.docChanged?r=r.handleChange(e):e.selection&&r.state!=0&&(r=new rt(r.source,0));for(let s of e.effects)if(s.is(fc))r=new rt(r.source,1,s.value?Yi(e.state):-1);else if(s.is(Dl))r=new rt(r.source,0);else if(s.is(vx))for(let o of s.value)o.source==r.source&&(r=o);return r}handleUserEvent(e,t,n){return t=="delete"||!n.activateOnTyping?this.map(e.changes):new rt(this.source,1)}handleChange(e){return e.changes.touchesRange(Yi(e.startState))?new rt(this.source,0):this.map(e.changes)}map(e){return e.empty||this.explicitPos<0?this:new rt(this.source,this.state,e.mapPos(this.explicitPos))}}class Qs extends rt{constructor(e,t,n,r,s){super(e,2,t),this.result=n,this.from=r,this.to=s}hasResult(){return!0}handleUserEvent(e,t,n){var r;let s=this.result;s.map&&!e.changes.empty&&(s=s.map(s,e.changes));let o=e.changes.mapPos(this.from),l=e.changes.mapPos(this.to,1),a=Yi(e.state);if((this.explicitPos<0?a<=o:a<this.from)||a>l||!s||t=="delete"&&Yi(e.startState)==this.from)return new rt(this.source,t=="input"&&n.activateOnTyping?1:0);let h=this.explicitPos<0?-1:e.changes.mapPos(this.explicitPos);return GN(s.validFor,e.state,o,l)?new Qs(this.source,h,s,o,l):s.update&&(s=s.update(s,o,l,new dm(e.state,a,h>=0)))?new Qs(this.source,h,s,s.from,(r=s.to)!==null&&r!==void 0?r:Yi(e.state)):new rt(this.source,1,h)}handleChange(e){return e.changes.touchesRange(this.from,this.to)?new rt(this.source,0):this.map(e.changes)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new Qs(this.source,this.explicitPos<0?-1:e.mapPos(this.explicitPos),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new rt(this.source,0)}}function GN(i,e,t,n){if(!i)return!1;let r=e.sliceDoc(t,n);return typeof i=="function"?i(r,t,n,e):wx(i,!0).test(r)}const vx=q.define({map(i,e){return i.map(t=>t.map(e))}}),$x=q.define(),yt=Ae.define({create(){return uc.start()},update(i,e){return i.update(e)},provide:i=>[Wc.from(i,e=>e.tooltip),M.contentAttributes.from(i,e=>e.attrs)]});function pm(i,e){const t=e.completion.apply||e.completion.label;let n=i.state.field(yt).active.find(r=>r.source==e.source);return n instanceof Qs?(typeof t=="string"?i.dispatch(Object.assign(Object.assign({},IN(i.state,t,n.from,n.to)),{annotations:xx.of(e.completion)})):t(i,e.completion,n.from,n.to),!0):!1}const HN=zN(yt,pm);function Da(i,e="option"){return t=>{let n=t.state.field(yt,!1);if(!n||!n.open||n.open.disabled||Date.now()-n.open.timestamp<t.state.facet(je).interactionDelay)return!1;let r=1,s;e=="page"&&(s=US(t,n.open.tooltip))&&(r=Math.max(2,Math.floor(s.dom.offsetHeight/s.dom.querySelector("li").offsetHeight)-1));let{length:o}=n.open.options,l=n.open.selected>-1?n.open.selected+r*(i?1:-1):i?0:o-1;return l<0?l=e=="page"?0:o-1:l>=o&&(l=e=="page"?o-1:0),t.dispatch({effects:$x.of(l)}),!0}}const KN=i=>{let e=i.state.field(yt,!1);return i.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<i.state.facet(je).interactionDelay?!1:pm(i,e.open.options[e.open.selected])},JN=i=>i.state.field(yt,!1)?(i.dispatch({effects:fc.of(!0)}),!0):!1,eD=i=>{let e=i.state.field(yt,!1);return!e||!e.active.some(t=>t.state!=0)?!1:(i.dispatch({effects:Dl.of(null)}),!0)};class tD{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}const nD=50,iD=1e3,rD=ve.fromClass(class{constructor(i){this.view=i,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of i.state.field(yt).active)e.state==1&&this.startQuery(e)}update(i){let e=i.state.field(yt);if(!i.selectionSet&&!i.docChanged&&i.startState.field(yt)==e)return;let t=i.transactions.some(r=>(r.selection||r.docChanged)&&!_d(r));for(let r=0;r<this.running.length;r++){let s=this.running[r];if(t||s.updates.length+i.transactions.length>nD&&Date.now()-s.time>iD){for(let o of s.context.abortListeners)try{o()}catch(l){lt(this.view.state,l)}s.context.abortListeners=null,this.running.splice(r--,1)}else s.updates.push(...i.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),i.transactions.some(r=>r.effects.some(s=>s.is(fc)))&&(this.pendingStart=!0);let n=this.pendingStart?50:i.state.facet(je).activateOnTypingDelay;if(this.debounceUpdate=e.active.some(r=>r.state==1&&!this.running.some(s=>s.active.source==r.source))?setTimeout(()=>this.startUpdate(),n):-1,this.composing!=0)for(let r of i.transactions)_d(r)=="input"?this.composing=2:this.composing==2&&r.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:i}=this.view,e=i.field(yt);for(let t of e.active)t.state==1&&!this.running.some(n=>n.active.source==t.source)&&this.startQuery(t)}startQuery(i){let{state:e}=this.view,t=Yi(e),n=new dm(e,t,i.explicitPos==t),r=new tD(i,n);this.running.push(r),Promise.resolve(i.source(n)).then(s=>{r.context.aborted||(r.done=s||null,this.scheduleAccept())},s=>{this.view.dispatch({effects:Dl.of(null)}),lt(this.view.state,s)})}scheduleAccept(){this.running.every(i=>i.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(je).updateSyncTime))}accept(){var i;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],t=this.view.state.facet(je);for(let n=0;n<this.running.length;n++){let r=this.running[n];if(r.done===void 0)continue;if(this.running.splice(n--,1),r.done){let o=new Qs(r.active.source,r.active.explicitPos,r.done,r.done.from,(i=r.done.to)!==null&&i!==void 0?i:Yi(r.updates.length?r.updates[0].startState:this.view.state));for(let l of r.updates)o=o.update(l,t);if(o.hasResult()){e.push(o);continue}}let s=this.view.state.field(yt).active.find(o=>o.source==r.active.source);if(s&&s.state==1)if(r.done==null){let o=new rt(r.active.source,0);for(let l of r.updates)o=o.update(l,t);o.state!=1&&e.push(o)}else this.startQuery(s)}e.length&&this.view.dispatch({effects:vx.of(e)})}},{eventHandlers:{blur(i){let e=this.view.state.field(yt,!1);if(e&&e.tooltip&&this.view.state.facet(je).closeOnBlur){let t=e.open&&US(this.view,e.open.tooltip);(!t||!t.dom.contains(i.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:Dl.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:fc.of(!1)}),20),this.composing=0}}}),sD=typeof navigator=="object"&&/Win/.test(navigator.platform),oD=di.highest(M.domEventHandlers({keydown(i,e){let t=e.state.field(yt,!1);if(!t||!t.open||t.open.disabled||t.open.selected<0||i.key.length>1||i.ctrlKey&&!(sD&&i.altKey)||i.metaKey)return!1;let n=t.open.options[t.open.selected],r=t.active.find(o=>o.source==n.source),s=n.completion.commitCharacters||r.result.commitCharacters;return s&&s.indexOf(i.key)>-1&&pm(e,n),!1}})),Px=M.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class lD{constructor(e,t,n,r){this.field=e,this.line=t,this.from=n,this.to=r}}class mm{constructor(e,t,n){this.field=e,this.from=t,this.to=n}map(e){let t=e.mapPos(this.from,-1,Ye.TrackDel),n=e.mapPos(this.to,1,Ye.TrackDel);return t==null||n==null?null:new mm(this.field,t,n)}}class gm{constructor(e,t){this.lines=e,this.fieldPositions=t}instantiate(e,t){let n=[],r=[t],s=e.doc.lineAt(t),o=/^\s*/.exec(s.text)[0];for(let a of this.lines){if(n.length){let h=o,c=/^\t*/.exec(a)[0].length;for(let f=0;f<c;f++)h+=e.facet(Js);r.push(t+h.length-c),a=h+a.slice(c)}n.push(a),t+=a.length+1}let l=this.fieldPositions.map(a=>new mm(a.field,r[a.line]+a.from,r[a.line]+a.to));return{text:n,ranges:l}}static parse(e){let t=[],n=[],r=[],s;for(let o of e.split(/\r\n?|\n/)){for(;s=/[#$]\{(?:(\d+)(?::([^}]*))?|([^}]*))\}/.exec(o);){let l=s[1]?+s[1]:null,a=s[2]||s[3]||"",h=-1;for(let c=0;c<t.length;c++)(l!=null?t[c].seq==l:a&&t[c].name==a)&&(h=c);if(h<0){let c=0;for(;c<t.length&&(l==null||t[c].seq!=null&&t[c].seq<l);)c++;t.splice(c,0,{seq:l,name:a}),h=c;for(let f of r)f.field>=h&&f.field++}r.push(new lD(h,n.length,s.index,s.index+a.length)),o=o.slice(0,s.index)+a+o.slice(s.index+s[0].length)}for(let l;l=/\\([{}])/.exec(o);){o=o.slice(0,l.index)+l[1]+o.slice(l.index+l[0].length);for(let a of r)a.line==n.length&&a.from>l.index&&(a.from--,a.to--)}n.push(o)}return new gm(n,r)}}let aD=I.widget({widget:new class extends _n{toDOM(){let i=document.createElement("span");return i.className="cm-snippetFieldPosition",i}ignoreEvent(){return!1}}}),hD=I.mark({class:"cm-snippetField"});class io{constructor(e,t){this.ranges=e,this.active=t,this.deco=I.set(e.map(n=>(n.from==n.to?aD:hD).range(n.from,n.to)))}map(e){let t=[];for(let n of this.ranges){let r=n.map(e);if(!r)return null;t.push(r)}return new io(t,this.active)}selectionInsideField(e){return e.ranges.every(t=>this.ranges.some(n=>n.field==this.active&&n.from<=t.from&&n.to>=t.to))}}const ra=q.define({map(i,e){return i&&i.map(e)}}),cD=q.define(),Il=Ae.define({create(){return null},update(i,e){for(let t of e.effects){if(t.is(ra))return t.value;if(t.is(cD)&&i)return new io(i.ranges,t.value)}return i&&e.docChanged&&(i=i.map(e.changes)),i&&e.selection&&!i.selectionInsideField(e.selection)&&(i=null),i},provide:i=>M.decorations.from(i,e=>e?e.deco:I.none)});function Om(i,e){return b.create(i.filter(t=>t.field==e).map(t=>b.range(t.from,t.to)))}function fD(i){let e=gm.parse(i);return(t,n,r,s)=>{let{text:o,ranges:l}=e.instantiate(t.state,r),a={changes:{from:r,to:s,insert:te.of(o)},scrollIntoView:!0,annotations:n?[xx.of(n),Ce.userEvent.of("input.complete")]:void 0};if(l.length&&(a.selection=Om(l,0)),l.some(h=>h.field>0)){let h=new io(l,0),c=a.effects=[ra.of(h)];t.state.field(Il,!1)===void 0&&c.push(q.appendConfig.of([Il,gD,OD,Px]))}t.dispatch(t.state.update(a))}}function Qx(i){return({state:e,dispatch:t})=>{let n=e.field(Il,!1);if(!n||i<0&&n.active==0)return!1;let r=n.active+i,s=i>0&&!n.ranges.some(o=>o.field==r+i);return t(e.update({selection:Om(n.ranges,r),effects:ra.of(s?null:new io(n.ranges,r)),scrollIntoView:!0})),!0}}const uD=({state:i,dispatch:e})=>i.field(Il,!1)?(e(i.update({effects:ra.of(null)})),!0):!1,dD=Qx(1),pD=Qx(-1),mD=[{key:"Tab",run:dD,shift:pD},{key:"Escape",run:uD}],fy=R.define({combine(i){return i.length?i[0]:mD}}),gD=di.highest(Gs.compute([fy],i=>i.facet(fy)));function Ot(i,e){return Object.assign(Object.assign({},e),{apply:fD(i)})}const OD=M.domEventHandlers({mousedown(i,e){let t=e.state.field(Il,!1),n;if(!t||(n=e.posAtCoords({x:i.clientX,y:i.clientY}))==null)return!1;let r=t.ranges.find(s=>s.from<=n&&s.to>=n);return!r||r.field==t.active?!1:(e.dispatch({selection:Om(t.ranges,r.field),effects:ra.of(t.ranges.some(s=>s.field>r.field)?new io(t.ranges,r.field):null),scrollIntoView:!0}),!0)}}),Wl={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},kr=q.define({map(i,e){let t=e.mapPos(i,-1,Ye.TrackAfter);return t??void 0}}),ym=new class extends Dr{};ym.startSide=1;ym.endSide=-1;const Cx=Ae.define({create(){return H.empty},update(i,e){if(i=i.map(e.changes),e.selection){let t=e.state.doc.lineAt(e.selection.main.head);i=i.update({filter:n=>n>=t.from&&n<=t.to})}for(let t of e.effects)t.is(kr)&&(i=i.update({add:[ym.range(t.value,t.value+1)]}));return i}});function yD(){return[bD,Cx]}const iu="()[]{}<>";function Tx(i){for(let e=0;e<iu.length;e+=2)if(iu.charCodeAt(e)==i)return iu.charAt(e+1);return Xp(i<128?i:i+1)}function Mx(i,e){return i.languageDataAt("closeBrackets",e)[0]||Wl}const kD=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),bD=M.inputHandler.of((i,e,t,n)=>{if((kD?i.composing:i.compositionStarted)||i.state.readOnly)return!1;let r=i.state.selection.main;if(n.length>2||n.length==2&&Lt(ze(n,0))==1||e!=r.from||t!=r.to)return!1;let s=xD(i.state,n);return s?(i.dispatch(s),!0):!1}),SD=({state:i,dispatch:e})=>{if(i.readOnly)return!1;let n=Mx(i,i.selection.main.head).brackets||Wl.brackets,r=null,s=i.changeByRange(o=>{if(o.empty){let l=vD(i.doc,o.head);for(let a of n)if(a==l&&Fc(i.doc,o.head)==Tx(ze(a,0)))return{changes:{from:o.head-a.length,to:o.head+a.length},range:b.cursor(o.head-a.length)}}return{range:r=o}});return r||e(i.update(s,{scrollIntoView:!0,userEvent:"delete.backward"})),!r},wD=[{key:"Backspace",run:SD}];function xD(i,e){let t=Mx(i,i.selection.main.head),n=t.brackets||Wl.brackets;for(let r of n){let s=Tx(ze(r,0));if(e==r)return s==r?QD(i,r,n.indexOf(r+r+r)>-1,t):$D(i,r,s,t.before||Wl.before);if(e==s&&Ax(i,i.selection.main.from))return PD(i,r,s)}return null}function Ax(i,e){let t=!1;return i.field(Cx).between(0,i.doc.length,n=>{n==e&&(t=!0)}),t}function Fc(i,e){let t=i.sliceString(e,e+2);return t.slice(0,Lt(ze(t,0)))}function vD(i,e){let t=i.sliceString(e-2,e);return Lt(ze(t,0))==t.length?t:t.slice(1)}function $D(i,e,t,n){let r=null,s=i.changeByRange(o=>{if(!o.empty)return{changes:[{insert:e,from:o.from},{insert:t,from:o.to}],effects:kr.of(o.to+e.length),range:b.range(o.anchor+e.length,o.head+e.length)};let l=Fc(i.doc,o.head);return!l||/\s/.test(l)||n.indexOf(l)>-1?{changes:{insert:e+t,from:o.head},effects:kr.of(o.head+e.length),range:b.cursor(o.head+e.length)}:{range:r=o}});return r?null:i.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function PD(i,e,t){let n=null,r=i.changeByRange(s=>s.empty&&Fc(i.doc,s.head)==t?{changes:{from:s.head,to:s.head+t.length,insert:t},range:b.cursor(s.head+t.length)}:n={range:s});return n?null:i.update(r,{scrollIntoView:!0,userEvent:"input.type"})}function QD(i,e,t,n){let r=n.stringPrefixes||Wl.stringPrefixes,s=null,o=i.changeByRange(l=>{if(!l.empty)return{changes:[{insert:e,from:l.from},{insert:e,from:l.to}],effects:kr.of(l.to+e.length),range:b.range(l.anchor+e.length,l.head+e.length)};let a=l.head,h=Fc(i.doc,a),c;if(h==e){if(uy(i,a))return{changes:{insert:e+e,from:a},effects:kr.of(a+e.length),range:b.cursor(a+e.length)};if(Ax(i,a)){let u=t&&i.sliceDoc(a,a+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:a,to:a+u.length,insert:u},range:b.cursor(a+u.length)}}}else{if(t&&i.sliceDoc(a-2*e.length,a)==e+e&&(c=dy(i,a-2*e.length,r))>-1&&uy(i,c))return{changes:{insert:e+e+e+e,from:a},effects:kr.of(a+e.length),range:b.cursor(a+e.length)};if(i.charCategorizer(a)(h)!=ke.Word&&dy(i,a,r)>-1&&!CD(i,a,e,r))return{changes:{insert:e+e,from:a},effects:kr.of(a+e.length),range:b.cursor(a+e.length)}}return{range:s=l}});return s?null:i.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function uy(i,e){let t=ae(i).resolveInner(e+1);return t.parent&&t.from==e}function CD(i,e,t,n){let r=ae(i).resolveInner(e,-1),s=n.reduce((o,l)=>Math.max(o,l.length),0);for(let o=0;o<5;o++){let l=i.sliceDoc(r.from,Math.min(r.to,r.from+t.length+s)),a=l.indexOf(t);if(!a||a>-1&&n.indexOf(l.slice(0,a))>-1){let c=r.firstChild;for(;c&&c.from==r.from&&c.to-c.from>t.length+a;){if(i.sliceDoc(c.to-t.length,c.to)==t)return!1;c=c.firstChild}return!0}let h=r.to==e&&r.parent;if(!h)break;r=h}return!1}function dy(i,e,t){let n=i.charCategorizer(e);if(n(i.sliceDoc(e-1,e))!=ke.Word)return e;for(let r of t){let s=e-r.length;if(i.sliceDoc(s,e)==r&&n(i.sliceDoc(s-1,s))!=ke.Word)return s}return-1}function TD(i={}){return[oD,yt,je.of(i),rD,MD,Px]}const Zx=[{key:"Ctrl-Space",run:JN},{key:"Escape",run:eD},{key:"ArrowDown",run:Da(!0)},{key:"ArrowUp",run:Da(!1)},{key:"PageDown",run:Da(!0,"page")},{key:"PageUp",run:Da(!1,"page")},{key:"Enter",run:KN}],MD=di.highest(Gs.computeN([je],i=>i.facet(je).defaultKeymap?[Zx]:[]));class AD{constructor(e,t,n){this.from=e,this.to=t,this.diagnostic=n}}class ur{constructor(e,t,n){this.diagnostics=e,this.panel=t,this.selected=n}static init(e,t,n){let r=e,s=n.facet(br).markerFilter;s&&(r=s(r,n));let o=I.set(r.map(l=>l.from==l.to||l.from==l.to-1&&n.doc.lineAt(l.from).to==l.from?I.widget({widget:new BD(l),diagnostic:l}).range(l.from):I.mark({attributes:{class:"cm-lintRange cm-lintRange-"+l.severity+(l.markClass?" "+l.markClass:"")},diagnostic:l,inclusive:!0}).range(l.from,l.to)),!0);return new ur(o,t,Ls(o))}}function Ls(i,e=null,t=0){let n=null;return i.between(t,1e9,(r,s,{spec:o})=>{if(!(e&&o.diagnostic!=e))return n=new AD(r,s,o.diagnostic),!1}),n}function Rx(i,e){let t=i.startState.doc.lineAt(e.pos);return!!(i.effects.some(n=>n.is(Uc))||i.changes.touchesRange(t.from,t.to))}function Ex(i,e){return i.field(Rt,!1)?e:e.concat(q.appendConfig.of(Vx))}function ZD(i,e){return{effects:Ex(i,[Uc.of(e)])}}const Uc=q.define(),km=q.define(),Nx=q.define(),Rt=Ae.define({create(){return new ur(I.none,null,null)},update(i,e){if(e.docChanged){let t=i.diagnostics.map(e.changes),n=null;if(i.selected){let r=e.changes.mapPos(i.selected.from,1);n=Ls(t,i.selected.diagnostic,r)||Ls(t,null,r)}i=new ur(t,i.panel,n)}for(let t of e.effects)t.is(Uc)?i=ur.init(t.value,i.panel,e.state):t.is(km)?i=new ur(i.diagnostics,t.value?Gc.open:null,i.selected):t.is(Nx)&&(i=new ur(i.diagnostics,i.panel,t.value));return i},provide:i=>[Tl.from(i,e=>e.panel),M.decorations.from(i,e=>e.diagnostics)]}),RD=I.mark({class:"cm-lintRange cm-lintRange-active",inclusive:!0});function ED(i,e,t){let{diagnostics:n}=i.state.field(Rt),r=[],s=2e8,o=0;n.between(e-(t<0?1:0),e+(t>0?1:0),(a,h,{spec:c})=>{e>=a&&e<=h&&(a==h||(e>a||t>0)&&(e<h||t<0))&&(r.push(c.diagnostic),s=Math.min(a,s),o=Math.max(h,o))});let l=i.state.facet(br).tooltipFilter;return l&&(r=l(r,i.state)),r.length?{pos:s,end:o,above:i.state.doc.lineAt(s).to<o,create(){return{dom:Dx(i,r)}}}:null}function Dx(i,e){return he("ul",{class:"cm-tooltip-lint"},e.map(t=>Wx(i,t,!1)))}const ND=i=>{let e=i.state.field(Rt,!1);(!e||!e.panel)&&i.dispatch({effects:Ex(i.state,[km.of(!0)])});let t=Cl(i,Gc.open);return t&&t.dom.querySelector(".cm-panel-lint ul").focus(),!0},py=i=>{let e=i.state.field(Rt,!1);return!e||!e.panel?!1:(i.dispatch({effects:km.of(!1)}),!0)},DD=i=>{let e=i.state.field(Rt,!1);if(!e)return!1;let t=i.state.selection.main,n=e.diagnostics.iter(t.to+1);return!n.value&&(n=e.diagnostics.iter(0),!n.value||n.from==t.from&&n.to==t.to)?!1:(i.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0}),!0)},ID=[{key:"Mod-Shift-m",run:ND,preventDefault:!0},{key:"F8",run:DD}],WD=ve.fromClass(class{constructor(i){this.view=i,this.timeout=-1,this.set=!0;let{delay:e}=i.state.facet(br);this.lintTime=Date.now()+e,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,e)}run(){let i=Date.now();if(i<this.lintTime-10)this.timeout=setTimeout(this.run,this.lintTime-i);else{this.set=!1;let{state:e}=this.view,{sources:t}=e.facet(br);t.length&&Promise.all(t.map(n=>Promise.resolve(n(this.view)))).then(n=>{let r=n.reduce((s,o)=>s.concat(o));this.view.state.doc==e.doc&&this.view.dispatch(ZD(this.view.state,r))},n=>{lt(this.view.state,n)})}}update(i){let e=i.state.facet(br);(i.docChanged||e!=i.startState.facet(br)||e.needsRefresh&&e.needsRefresh(i))&&(this.lintTime=Date.now()+e.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,e.delay)))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}}),br=R.define({combine(i){return Object.assign({sources:i.map(e=>e.source).filter(e=>e!=null)},On(i.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null},{needsRefresh:(e,t)=>e?t?n=>e(n)||t(n):e:t}))}});function XD(i,e={}){return[br.of({source:i,config:e}),WD,Vx]}function Ix(i){let e=[];if(i)e:for(let{name:t}of i){for(let n=0;n<t.length;n++){let r=t[n];if(/[a-zA-Z]/.test(r)&&!e.some(s=>s.toLowerCase()==r.toLowerCase())){e.push(r);continue e}}e.push("")}return e}function Wx(i,e,t){var n;let r=t?Ix(e.actions):[];return he("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},he("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage():e.message),(n=e.actions)===null||n===void 0?void 0:n.map((s,o)=>{let l=!1,a=u=>{if(u.preventDefault(),l)return;l=!0;let d=Ls(i.state.field(Rt).diagnostics,e);d&&s.apply(i,d.from,d.to)},{name:h}=s,c=r[o]?h.indexOf(r[o]):-1,f=c<0?h:[h.slice(0,c),he("u",h.slice(c,c+1)),h.slice(c+1)];return he("button",{type:"button",class:"cm-diagnosticAction",onclick:a,onmousedown:a,"aria-label":` Action: ${h}${c<0?"":` (access key "${r[o]})"`}.`},f)}),e.source&&he("div",{class:"cm-diagnosticSource"},e.source))}class BD extends _n{constructor(e){super(),this.diagnostic=e}eq(e){return e.diagnostic==this.diagnostic}toDOM(){return he("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class my{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=Wx(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class Gc{constructor(e){this.view=e,this.items=[];let t=r=>{if(r.keyCode==27)py(this.view),this.view.focus();else if(r.keyCode==38||r.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(r.keyCode==40||r.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(r.keyCode==36)this.moveSelection(0);else if(r.keyCode==35)this.moveSelection(this.items.length-1);else if(r.keyCode==13)this.view.focus();else if(r.keyCode>=65&&r.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:s}=this.items[this.selectedIndex],o=Ix(s.actions);for(let l=0;l<o.length;l++)if(o[l].toUpperCase().charCodeAt(0)==r.keyCode){let a=Ls(this.view.state.field(Rt).diagnostics,s);a&&s.actions[l].apply(e,a.from,a.to)}}else return;r.preventDefault()},n=r=>{for(let s=0;s<this.items.length;s++)this.items[s].dom.contains(r.target)&&this.moveSelection(s)};this.list=he("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:n}),this.dom=he("div",{class:"cm-panel-lint"},this.list,he("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>py(this.view)},"")),this.update()}get selectedIndex(){let e=this.view.state.field(Rt).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(Rt),n=0,r=!1,s=null;for(e.between(0,this.view.state.doc.length,(o,l,{spec:a})=>{let h=-1,c;for(let f=n;f<this.items.length;f++)if(this.items[f].diagnostic==a.diagnostic){h=f;break}h<0?(c=new my(this.view,a.diagnostic),this.items.splice(n,0,c),r=!0):(c=this.items[h],h>n&&(this.items.splice(n,h-n),r=!0)),t&&c.diagnostic==t.diagnostic?c.dom.hasAttribute("aria-selected")||(c.dom.setAttribute("aria-selected","true"),s=c):c.dom.hasAttribute("aria-selected")&&c.dom.removeAttribute("aria-selected"),n++});n<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)r=!0,this.items.pop();this.items.length==0&&(this.items.push(new my(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),r=!0),s?(this.list.setAttribute("aria-activedescendant",s.id),this.view.requestMeasure({key:this,read:()=>({sel:s.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:o,panel:l})=>{let a=l.height/this.list.offsetHeight;o.top<l.top?this.list.scrollTop-=(l.top-o.top)/a:o.bottom>l.bottom&&(this.list.scrollTop+=(o.bottom-l.bottom)/a)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),r&&this.sync()}sync(){let e=this.list.firstChild;function t(){let n=e;e=n.nextSibling,n.remove()}for(let n of this.items)if(n.dom.parentNode==this.list){for(;e!=n.dom;)t();e=n.dom.nextSibling}else this.list.insertBefore(n.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=this.view.state.field(Rt),n=Ls(t.diagnostics,this.items[e].diagnostic);n&&this.view.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0,effects:Nx.of(n)})}static open(e){return new Gc(e)}}function Qh(i,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(i)}</svg>')`}function Ia(i){return Qh(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${i}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const VD=M.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:Ia("#d11")},".cm-lintRange-warning":{backgroundImage:Ia("orange")},".cm-lintRange-info":{backgroundImage:Ia("#999")},".cm-lintRange-hint":{backgroundImage:Ia("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function gy(i){return i=="error"?4:i=="warning"?3:i=="info"?2:1}class qD extends Ln{constructor(e){super(),this.diagnostics=e,this.severity=e.reduce((t,n)=>gy(t)<gy(n.severity)?n.severity:t,"hint")}toDOM(e){let t=document.createElement("div");t.className="cm-lint-marker cm-lint-marker-"+this.severity;let n=this.diagnostics,r=e.state.facet(Hc).tooltipFilter;return r&&(n=r(n,e.state)),n.length&&(t.onmouseover=()=>zD(e,t,n)),t}}function LD(i,e){let t=n=>{let r=e.getBoundingClientRect();if(!(n.clientX>r.left-10&&n.clientX<r.right+10&&n.clientY>r.top-10&&n.clientY<r.bottom+10)){for(let s=n.target;s;s=s.parentNode)if(s.nodeType==1&&s.classList.contains("cm-tooltip-lint"))return;window.removeEventListener("mousemove",t),i.state.field(Bx)&&i.dispatch({effects:bm.of(null)})}};window.addEventListener("mousemove",t)}function zD(i,e,t){function n(){let o=i.elementAtHeight(e.getBoundingClientRect().top+5-i.documentTop);i.coordsAtPos(o.from)&&i.dispatch({effects:bm.of({pos:o.from,above:!1,create(){return{dom:Dx(i,t),getCoords:()=>e.getBoundingClientRect()}}})}),e.onmouseout=e.onmousemove=null,LD(i,e)}let{hoverTime:r}=i.state.facet(Hc),s=setTimeout(n,r);e.onmouseout=()=>{clearTimeout(s),e.onmouseout=e.onmousemove=null},e.onmousemove=()=>{clearTimeout(s),s=setTimeout(n,r)}}function YD(i,e){let t=Object.create(null);for(let r of e){let s=i.lineAt(r.from);(t[s.from]||(t[s.from]=[])).push(r)}let n=[];for(let r in t)n.push(new qD(t[r]).range(+r));return H.of(n,!0)}const jD=HS({class:"cm-gutter-lint",markers:i=>i.state.field(Xx)}),Xx=Ae.define({create(){return H.empty},update(i,e){i=i.map(e.changes);let t=e.state.facet(Hc).markerFilter;for(let n of e.effects)if(n.is(Uc)){let r=n.value;t&&(r=t(r||[],e.state)),i=YD(e.state.doc,r.slice(0))}return i}}),bm=q.define(),Bx=Ae.define({create(){return null},update(i,e){return i&&e.docChanged&&(i=Rx(e,i)?null:Object.assign(Object.assign({},i),{pos:e.changes.mapPos(i.pos)})),e.effects.reduce((t,n)=>n.is(bm)?n.value:t,i)},provide:i=>Wc.from(i)}),_D=M.baseTheme({".cm-gutter-lint":{width:"1.4em","& .cm-gutterElement":{padding:".2em"}},".cm-lint-marker":{width:"1em",height:"1em"},".cm-lint-marker-info":{content:Qh('<path fill="#aaf" stroke="#77e" stroke-width="6" stroke-linejoin="round" d="M5 5L35 5L35 35L5 35Z"/>')},".cm-lint-marker-warning":{content:Qh('<path fill="#fe8" stroke="#fd7" stroke-width="6" stroke-linejoin="round" d="M20 6L37 35L3 35Z"/>')},".cm-lint-marker-error":{content:Qh('<circle cx="20" cy="20" r="15" fill="#f87" stroke="#f43" stroke-width="6"/>')}}),Vx=[Rt,M.decorations.compute([Rt],i=>{let{selected:e,panel:t}=i.field(Rt);return!e||!t||e.from==e.to?I.none:I.set([RD.range(e.from,e.to)])}),CR(ED,{hideOn:Rx}),VD],Hc=R.define({combine(i){return On(i,{hoverTime:300,markerFilter:null,tooltipFilter:null})}});function FD(i={}){return[Hc.of(i),Xx,jD,_D,Bx]}const UD=[DR(),XR(),iR(),oE(),M2(),jZ(),HZ(),j.allowMultipleSelections.of(!0),y2(),Sw(E2,{fallback:!0}),V2(),yD(),TD(),OR(),bR(),hR(),uN(),Gs.of([...wD,...oN,...AN,...mE,...P2,...Zx,...ID])];/*!
* VueCodemirror v6.1.1
* Copyright (c) Surmon. All rights reserved.
* Released under the MIT License.
* Surmon
*/var GD=Object.freeze({autofocus:!1,disabled:!1,indentWithTab:!0,tabSize:2,placeholder:"",autoDestroy:!0,extensions:[UD]}),HD=Symbol("vue-codemirror-global-config"),st,KD=function(i){var e=i.onUpdate,t=i.onChange,n=i.onFocus,r=i.onBlur,s=function(o,l){var a={};for(var h in o)Object.prototype.hasOwnProperty.call(o,h)&&l.indexOf(h)<0&&(a[h]=o[h]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function"){var c=0;for(h=Object.getOwnPropertySymbols(o);c<h.length;c++)l.indexOf(h[c])<0&&Object.prototype.propertyIsEnumerable.call(o,h[c])&&(a[h[c]]=o[h[c]])}return a}(i,["onUpdate","onChange","onFocus","onBlur"]);return j.create({doc:s.doc,selection:s.selection,extensions:(Array.isArray(s.extensions)?s.extensions:[s.extensions]).concat([M.updateListener.of(function(o){e(o),o.docChanged&&t(o.state.doc.toString(),o),o.focusChanged&&(o.view.hasFocus?n(o):r(o))})])})},hs=function(i){var e=new Ul;return{compartment:e,run:function(t){e.get(i.state)?i.dispatch({effects:e.reconfigure(t)}):i.dispatch({effects:q.appendConfig.of(e.of(t))})}}},Oy=function(i,e){var t=hs(i),n=t.compartment,r=t.run;return function(s){var o=n.get(i.state);r(s??o!==e?e:[])}},Wa={type:Boolean,default:void 0},JD={autofocus:Wa,disabled:Wa,indentWithTab:Wa,tabSize:Number,placeholder:String,style:Object,autoDestroy:Wa,phrases:Object,root:Object,extensions:Array,selection:Object},eI={modelValue:{type:String,default:""}},tI=Object.assign(Object.assign({},JD),eI);(function(i){i.Change="change",i.Update="update",i.Focus="focus",i.Blur="blur",i.Ready="ready",i.ModelUpdate="update:modelValue"})(st||(st={}));var dr={};dr[st.Change]=function(i,e){return!0},dr[st.Update]=function(i){return!0},dr[st.Focus]=function(i){return!0},dr[st.Blur]=function(i){return!0},dr[st.Ready]=function(i){return!0};var qx={};qx[st.ModelUpdate]=dr[st.Change];var nI=Object.assign(Object.assign({},dr),qx),iI=Dt({name:"VueCodemirror",props:Object.assign({},tI),emits:Object.assign({},nI),setup:function(i,e){var t=ni(),n=ni(),r=ni(),s=Object.assign(Object.assign({},GD),Fs(HD,{})),o=ps(function(){var l={};return Object.keys(U$(i)).forEach(function(a){var h;a!=="modelValue"&&(l[a]=(h=i[a])!==null&&h!==void 0?h:s[a])}),l});return S1(function(){var l;n.value=KD({doc:i.modelValue,selection:o.value.selection,extensions:(l=s.extensions)!==null&&l!==void 0?l:[],onFocus:function(h){return e.emit(st.Focus,h)},onBlur:function(h){return e.emit(st.Blur,h)},onUpdate:function(h){return e.emit(st.Update,h)},onChange:function(h,c){h!==i.modelValue&&(e.emit(st.Change,h,c),e.emit(st.ModelUpdate,h,c))}}),r.value=function(h){return new M(Object.assign({},h))}({state:n.value,parent:t.value,root:o.value.root});var a=function(h){var c=function(){return h.state.doc.toString()},f=hs(h).run,u=Oy(h,[M.editable.of(!1),j.readOnly.of(!0)]),d=Oy(h,Gs.of([lN])),p=hs(h).run,m=hs(h).run,g=hs(h).run,y=hs(h).run;return{focus:function(){return h.focus()},getDoc:c,setDoc:function(k){k!==c()&&h.dispatch({changes:{from:0,to:h.state.doc.length,insert:k}})},reExtensions:f,toggleDisabled:u,toggleIndentWithTab:d,setTabSize:function(k){p([j.tabSize.of(k),Js.of(" ".repeat(k))])},setPhrases:function(k){m([j.phrases.of(k)])},setPlaceholder:function(k){g(dR(k))},setStyle:function(k){k===void 0&&(k={}),y(M.theme({"&":Object.assign({},k)}))}}}(r.value);nn(function(){return i.modelValue},function(h){h!==a.getDoc()&&a.setDoc(h)}),nn(function(){return i.extensions},function(h){return a.reExtensions(h||[])},{immediate:!0}),nn(function(){return o.value.disabled},function(h){return a.toggleDisabled(h)},{immediate:!0}),nn(function(){return o.value.indentWithTab},function(h){return a.toggleIndentWithTab(h)},{immediate:!0}),nn(function(){return o.value.tabSize},function(h){return a.setTabSize(h)},{immediate:!0}),nn(function(){return o.value.phrases},function(h){return a.setPhrases(h||{})},{immediate:!0}),nn(function(){return o.value.placeholder},function(h){return a.setPlaceholder(h)},{immediate:!0}),nn(function(){return o.value.style},function(h){return a.setStyle(h)},{immediate:!0}),o.value.autofocus&&a.focus(),e.emit(st.Ready,{state:n.value,view:r.value,container:t.value})}),G$(function(){o.value.autoDestroy&&r.value&&function(l){l.destroy()}(r.value)}),function(){return x1("div",{class:"v-codemirror",style:{display:"contents"},ref:t})}}}),rI=iI;class dc{static create(e,t,n,r,s){let o=r+(r<<8)+e+(t<<4)|0;return new dc(e,t,n,o,s,[],[])}constructor(e,t,n,r,s,o,l){this.type=e,this.value=t,this.from=n,this.hash=r,this.end=s,this.children=o,this.positions=l,this.hashProp=[[B.contextHash,r]]}addChild(e,t){e.prop(B.contextHash)!=this.hash&&(e=new F(e.type,e.children,e.positions,e.length,this.hashProp)),this.children.push(e),this.positions.push(t)}toTree(e,t=this.end){let n=this.children.length-1;return n>=0&&(t=Math.max(t,this.positions[n]+this.children[n].length+this.from)),new F(e.types[this.type],this.children,this.positions,t-this.from).balance({makeTree:(r,s,o)=>new F(Me.none,r,s,o,this.hashProp)})}}var C;(function(i){i[i.Document=1]="Document",i[i.CodeBlock=2]="CodeBlock",i[i.FencedCode=3]="FencedCode",i[i.Blockquote=4]="Blockquote",i[i.HorizontalRule=5]="HorizontalRule",i[i.BulletList=6]="BulletList",i[i.OrderedList=7]="OrderedList",i[i.ListItem=8]="ListItem",i[i.ATXHeading1=9]="ATXHeading1",i[i.ATXHeading2=10]="ATXHeading2",i[i.ATXHeading3=11]="ATXHeading3",i[i.ATXHeading4=12]="ATXHeading4",i[i.ATXHeading5=13]="ATXHeading5",i[i.ATXHeading6=14]="ATXHeading6",i[i.SetextHeading1=15]="SetextHeading1",i[i.SetextHeading2=16]="SetextHeading2",i[i.HTMLBlock=17]="HTMLBlock",i[i.LinkReference=18]="LinkReference",i[i.Paragraph=19]="Paragraph",i[i.CommentBlock=20]="CommentBlock",i[i.ProcessingInstructionBlock=21]="ProcessingInstructionBlock",i[i.Escape=22]="Escape",i[i.Entity=23]="Entity",i[i.HardBreak=24]="HardBreak",i[i.Emphasis=25]="Emphasis",i[i.StrongEmphasis=26]="StrongEmphasis",i[i.Link=27]="Link",i[i.Image=28]="Image",i[i.InlineCode=29]="InlineCode",i[i.HTMLTag=30]="HTMLTag",i[i.Comment=31]="Comment",i[i.ProcessingInstruction=32]="ProcessingInstruction",i[i.Autolink=33]="Autolink",i[i.HeaderMark=34]="HeaderMark",i[i.QuoteMark=35]="QuoteMark",i[i.ListMark=36]="ListMark",i[i.LinkMark=37]="LinkMark",i[i.EmphasisMark=38]="EmphasisMark",i[i.CodeMark=39]="CodeMark",i[i.CodeText=40]="CodeText",i[i.CodeInfo=41]="CodeInfo",i[i.LinkTitle=42]="LinkTitle",i[i.LinkLabel=43]="LinkLabel",i[i.URL=44]="URL"})(C||(C={}));class sI{constructor(e,t){this.start=e,this.content=t,this.marks=[],this.parsers=[]}}class oI{constructor(){this.text="",this.baseIndent=0,this.basePos=0,this.depth=0,this.markers=[],this.pos=0,this.indent=0,this.next=-1}forward(){this.basePos>this.pos&&this.forwardInner()}forwardInner(){let e=this.skipSpace(this.basePos);this.indent=this.countIndent(e,this.pos,this.indent),this.pos=e,this.next=e==this.text.length?-1:this.text.charCodeAt(e)}skipSpace(e){return hl(this.text,e)}reset(e){for(this.text=e,this.baseIndent=this.basePos=this.pos=this.indent=0,this.forwardInner(),this.depth=1;this.markers.length;)this.markers.pop()}moveBase(e){this.basePos=e,this.baseIndent=this.countIndent(e,this.pos,this.indent)}moveBaseColumn(e){this.baseIndent=e,this.basePos=this.findColumn(e)}addMarker(e){this.markers.push(e)}countIndent(e,t=0,n=0){for(let r=t;r<e;r++)n+=this.text.charCodeAt(r)==9?4-n%4:1;return n}findColumn(e){let t=0;for(let n=0;t<this.text.length&&n<e;t++)n+=this.text.charCodeAt(t)==9?4-n%4:1;return t}scrub(){if(!this.baseIndent)return this.text;let e="";for(let t=0;t<this.basePos;t++)e+=" ";return e+this.text.slice(this.basePos)}}function yy(i,e,t){if(t.pos==t.text.length||i!=e.block&&t.indent>=e.stack[t.depth+1].value+t.baseIndent)return!0;if(t.indent>=t.baseIndent+4)return!1;let n=(i.type==C.OrderedList?xm:wm)(t,e,!1);return n>0&&(i.type!=C.BulletList||Sm(t,e,!1)<0)&&t.text.charCodeAt(t.pos+n-1)==i.value}const Lx={[C.Blockquote](i,e,t){return t.next!=62?!1:(t.markers.push(K(C.QuoteMark,e.lineStart+t.pos,e.lineStart+t.pos+1)),t.moveBase(t.pos+(en(t.text.charCodeAt(t.pos+1))?2:1)),i.end=e.lineStart+t.text.length,!0)},[C.ListItem](i,e,t){return t.indent<t.baseIndent+i.value&&t.next>-1?!1:(t.moveBaseColumn(t.baseIndent+i.value),!0)},[C.OrderedList]:yy,[C.BulletList]:yy,[C.Document](){return!0}};function en(i){return i==32||i==9||i==10||i==13}function hl(i,e=0){for(;e<i.length&&en(i.charCodeAt(e));)e++;return e}function ky(i,e,t){for(;e>t&&en(i.charCodeAt(e-1));)e--;return e}function zx(i){if(i.next!=96&&i.next!=126)return-1;let e=i.pos+1;for(;e<i.text.length&&i.text.charCodeAt(e)==i.next;)e++;if(e<i.pos+3)return-1;if(i.next==96){for(let t=e;t<i.text.length;t++)if(i.text.charCodeAt(t)==96)return-1}return e}function Yx(i){return i.next!=62?-1:i.text.charCodeAt(i.pos+1)==32?2:1}function Sm(i,e,t){if(i.next!=42&&i.next!=45&&i.next!=95)return-1;let n=1;for(let r=i.pos+1;r<i.text.length;r++){let s=i.text.charCodeAt(r);if(s==i.next)n++;else if(!en(s))return-1}return t&&i.next==45&&Fx(i)>-1&&i.depth==e.stack.length||n<3?-1:1}function jx(i,e){for(let t=i.stack.length-1;t>=0;t--)if(i.stack[t].type==e)return!0;return!1}function wm(i,e,t){return(i.next==45||i.next==43||i.next==42)&&(i.pos==i.text.length-1||en(i.text.charCodeAt(i.pos+1)))&&(!t||jx(e,C.BulletList)||i.skipSpace(i.pos+2)<i.text.length)?1:-1}function xm(i,e,t){let n=i.pos,r=i.next;for(;r>=48&&r<=57;){n++;if(n==i.text.length)return-1;r=i.text.charCodeAt(n)}return n==i.pos||n>i.pos+9||r!=46&&r!=41||n<i.text.length-1&&!en(i.text.charCodeAt(n+1))||t&&!jx(e,C.OrderedList)&&(i.skipSpace(n+1)==i.text.length||n>i.pos+1||i.next!=49)?-1:n+1-i.pos}function _x(i){if(i.next!=35)return-1;let e=i.pos+1;for(;e<i.text.length&&i.text.charCodeAt(e)==35;)e++;if(e<i.text.length&&i.text.charCodeAt(e)!=32)return-1;let t=e-i.pos;return t>6?-1:t}function Fx(i){if(i.next!=45&&i.next!=61||i.indent>=i.baseIndent+4)return-1;let e=i.pos+1;for(;e<i.text.length&&i.text.charCodeAt(e)==i.next;)e++;let t=e;for(;e<i.text.length&&en(i.text.charCodeAt(e));)e++;return e==i.text.length?t:-1}const Fd=/^[ \t]*$/,Ux=/-->/,Gx=/\?>/,Ud=[[/^<(?:script|pre|style)(?:\s|>|$)/i,/<\/(?:script|pre|style)>/i],[/^\s*<!--/,Ux],[/^\s*<\?/,Gx],[/^\s*<![A-Z]/,/>/],[/^\s*<!\[CDATA\[/,/\]\]>/],[/^\s*<\/?(?:address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h1|h2|h3|h4|h5|h6|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul)(?:\s|\/?>|$)/i,Fd],[/^\s*(?:<\/[a-z][\w-]*\s*>|<[a-z][\w-]*(\s+[a-z:_][\w-.]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*>)\s*$/i,Fd]];function Hx(i,e,t){if(i.next!=60)return-1;let n=i.text.slice(i.pos);for(let r=0,s=Ud.length-(t?1:0);r<s;r++)if(Ud[r][0].test(n))return r;return-1}function by(i,e){let t=i.countIndent(e,i.pos,i.indent),n=i.countIndent(i.skipSpace(e),e,t);return n>=t+5?t+1:n}function sr(i,e,t){let n=i.length-1;n>=0&&i[n].to==e&&i[n].type==C.CodeText?i[n].to=t:i.push(K(C.CodeText,e,t))}const Xa={LinkReference:void 0,IndentedCode(i,e){let t=e.baseIndent+4;if(e.indent<t)return!1;let n=e.findColumn(t),r=i.lineStart+n,s=i.lineStart+e.text.length,o=[],l=[];for(sr(o,r,s);i.nextLine()&&e.depth>=i.stack.length;)if(e.pos==e.text.length){sr(l,i.lineStart-1,i.lineStart);for(let a of e.markers)l.push(a)}else{if(e.indent<t)break;{if(l.length){for(let h of l)h.type==C.CodeText?sr(o,h.from,h.to):o.push(h);l=[]}sr(o,i.lineStart-1,i.lineStart);for(let h of e.markers)o.push(h);s=i.lineStart+e.text.length;let a=i.lineStart+e.findColumn(e.baseIndent+4);a<s&&sr(o,a,s)}}return l.length&&(l=l.filter(a=>a.type!=C.CodeText),l.length&&(e.markers=l.concat(e.markers))),i.addNode(i.buffer.writeElements(o,-r).finish(C.CodeBlock,s-r),r),!0},FencedCode(i,e){let t=zx(e);if(t<0)return!1;let n=i.lineStart+e.pos,r=e.next,s=t-e.pos,o=e.skipSpace(t),l=ky(e.text,e.text.length,o),a=[K(C.CodeMark,n,n+s)];o<l&&a.push(K(C.CodeInfo,i.lineStart+o,i.lineStart+l));for(let h=!0;i.nextLine()&&e.depth>=i.stack.length;h=!1){let c=e.pos;if(e.indent-e.baseIndent<4)for(;c<e.text.length&&e.text.charCodeAt(c)==r;)c++;if(c-e.pos>=s&&e.skipSpace(c)==e.text.length){for(let f of e.markers)a.push(f);a.push(K(C.CodeMark,i.lineStart+e.pos,i.lineStart+c)),i.nextLine();break}else{h||sr(a,i.lineStart-1,i.lineStart);for(let d of e.markers)a.push(d);let f=i.lineStart+e.basePos,u=i.lineStart+e.text.length;f<u&&sr(a,f,u)}}return i.addNode(i.buffer.writeElements(a,-n).finish(C.FencedCode,i.prevLineEnd()-n),n),!0},Blockquote(i,e){let t=Yx(e);return t<0?!1:(i.startContext(C.Blockquote,e.pos),i.addNode(C.QuoteMark,i.lineStart+e.pos,i.lineStart+e.pos+1),e.moveBase(e.pos+t),null)},HorizontalRule(i,e){if(Sm(e,i,!1)<0)return!1;let t=i.lineStart+e.pos;return i.nextLine(),i.addNode(C.HorizontalRule,t),!0},BulletList(i,e){let t=wm(e,i,!1);if(t<0)return!1;i.block.type!=C.BulletList&&i.startContext(C.BulletList,e.basePos,e.next);let n=by(e,e.pos+1);return i.startContext(C.ListItem,e.basePos,n-e.baseIndent),i.addNode(C.ListMark,i.lineStart+e.pos,i.lineStart+e.pos+t),e.moveBaseColumn(n),null},OrderedList(i,e){let t=xm(e,i,!1);if(t<0)return!1;i.block.type!=C.OrderedList&&i.startContext(C.OrderedList,e.basePos,e.text.charCodeAt(e.pos+t-1));let n=by(e,e.pos+t);return i.startContext(C.ListItem,e.basePos,n-e.baseIndent),i.addNode(C.ListMark,i.lineStart+e.pos,i.lineStart+e.pos+t),e.moveBaseColumn(n),null},ATXHeading(i,e){let t=_x(e);if(t<0)return!1;let n=e.pos,r=i.lineStart+n,s=ky(e.text,e.text.length,n),o=s;for(;o>n&&e.text.charCodeAt(o-1)==e.next;)o--;(o==s||o==n||!en(e.text.charCodeAt(o-1)))&&(o=e.text.length);let l=i.buffer.write(C.HeaderMark,0,t).writeElements(i.parser.parseInline(e.text.slice(n+t+1,o),r+t+1),-r);o<e.text.length&&l.write(C.HeaderMark,o-n,s-n);let a=l.finish(C.ATXHeading1-1+t,e.text.length-n);return i.nextLine(),i.addNode(a,r),!0},HTMLBlock(i,e){let t=Hx(e,i,!1);if(t<0)return!1;let n=i.lineStart+e.pos,r=Ud[t][1],s=[],o=r!=Fd;for(;!r.test(e.text)&&i.nextLine();){if(e.depth<i.stack.length){o=!1;break}for(let h of e.markers)s.push(h)}o&&i.nextLine();let l=r==Ux?C.CommentBlock:r==Gx?C.ProcessingInstructionBlock:C.HTMLBlock,a=i.prevLineEnd();return i.addNode(i.buffer.writeElements(s,-n).finish(l,a-n),n),!0},SetextHeading:void 0};class lI{constructor(e){this.stage=0,this.elts=[],this.pos=0,this.start=e.start,this.advance(e.content)}nextLine(e,t,n){if(this.stage==-1)return!1;let r=n.content+`
`+t.scrub(),s=this.advance(r);return s>-1&&s<r.length?this.complete(e,n,s):!1}finish(e,t){return(this.stage==2||this.stage==3)&&hl(t.content,this.pos)==t.content.length?this.complete(e,t,t.content.length):!1}complete(e,t,n){return e.addLeafElement(t,K(C.LinkReference,this.start,this.start+n,this.elts)),!0}nextStage(e){return e?(this.pos=e.to-this.start,this.elts.push(e),this.stage++,!0):(e===!1&&(this.stage=-1),!1)}advance(e){for(;;){if(this.stage==-1)return-1;if(this.stage==0){if(!this.nextStage(ov(e,this.pos,this.start,!0)))return-1;if(e.charCodeAt(this.pos)!=58)return this.stage=-1;this.elts.push(K(C.LinkMark,this.pos+this.start,this.pos+this.start+1)),this.pos++}else if(this.stage==1){if(!this.nextStage(rv(e,hl(e,this.pos),this.start)))return-1}else if(this.stage==2){let t=hl(e,this.pos),n=0;if(t>this.pos){let r=sv(e,t,this.start);if(r){let s=ru(e,r.to-this.start);s>0&&(this.nextStage(r),n=s)}}return n||(n=ru(e,this.pos)),n>0&&n<e.length?n:-1}else return ru(e,this.pos)}}}function ru(i,e){for(;e<i.length;e++){let t=i.charCodeAt(e);if(t==10)break;if(!en(t))return-1}return e}class aI{nextLine(e,t,n){let r=t.depth<e.stack.length?-1:Fx(t),s=t.next;if(r<0)return!1;let o=K(C.HeaderMark,e.lineStart+t.pos,e.lineStart+r);return e.nextLine(),e.addLeafElement(n,K(s==61?C.SetextHeading1:C.SetextHeading2,n.start,e.prevLineEnd(),[...e.parser.parseInline(n.content,n.start),o])),!0}finish(){return!1}}const hI={LinkReference(i,e){return e.content.charCodeAt(0)==91?new lI(e):null},SetextHeading(){return new aI}},cI=[(i,e)=>_x(e)>=0,(i,e)=>zx(e)>=0,(i,e)=>Yx(e)>=0,(i,e)=>wm(e,i,!0)>=0,(i,e)=>xm(e,i,!0)>=0,(i,e)=>Sm(e,i,!0)>=0,(i,e)=>Hx(e,i,!0)>=0],fI={text:"",end:0};class uI{constructor(e,t,n,r){this.parser=e,this.input=t,this.ranges=r,this.line=new oI,this.atEnd=!1,this.reusePlaceholders=new Map,this.stoppedAt=null,this.rangeI=0,this.to=r[r.length-1].to,this.lineStart=this.absoluteLineStart=this.absoluteLineEnd=r[0].from,this.block=dc.create(C.Document,0,this.lineStart,0,0),this.stack=[this.block],this.fragments=n.length?new gI(n,t):null,this.readLine()}get parsedPos(){return this.absoluteLineStart}advance(){if(this.stoppedAt!=null&&this.absoluteLineStart>this.stoppedAt)return this.finish();let{line:e}=this;for(;;){for(let n=0;;){let r=e.depth<this.stack.length?this.stack[this.stack.length-1]:null;for(;n<e.markers.length&&(!r||e.markers[n].from<r.end);){let s=e.markers[n++];this.addNode(s.type,s.from,s.to)}if(!r)break;this.finishContext()}if(e.pos<e.text.length)break;if(!this.nextLine())return this.finish()}if(this.fragments&&this.reuseFragment(e.basePos))return null;e:for(;;){for(let n of this.parser.blockParsers)if(n){let r=n(this,e);if(r!=!1){if(r==!0)return null;e.forward();continue e}}break}let t=new sI(this.lineStart+e.pos,e.text.slice(e.pos));for(let n of this.parser.leafBlockParsers)if(n){let r=n(this,t);r&&t.parsers.push(r)}e:for(;this.nextLine()&&e.pos!=e.text.length;){if(e.indent<e.baseIndent+4){for(let n of this.parser.endLeafBlock)if(n(this,e,t))break e}for(let n of t.parsers)if(n.nextLine(this,e,t))return null;t.content+=`
`+e.scrub();for(let n of e.markers)t.marks.push(n)}return this.finishLeaf(t),null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}reuseFragment(e){if(!this.fragments.moveTo(this.absoluteLineStart+e,this.absoluteLineStart)||!this.fragments.matches(this.block.hash))return!1;let t=this.fragments.takeNodes(this);return t?(this.absoluteLineStart+=t,this.lineStart=lv(this.absoluteLineStart,this.ranges),this.moveRangeI(),this.absoluteLineStart<this.to?(this.lineStart++,this.absoluteLineStart++,this.readLine()):(this.atEnd=!0,this.readLine()),!0):!1}get depth(){return this.stack.length}parentType(e=this.depth-1){return this.parser.nodeSet.types[this.stack[e].type]}nextLine(){return this.lineStart+=this.line.text.length,this.absoluteLineEnd>=this.to?(this.absoluteLineStart=this.absoluteLineEnd,this.atEnd=!0,this.readLine(),!1):(this.lineStart++,this.absoluteLineStart=this.absoluteLineEnd+1,this.moveRangeI(),this.readLine(),!0)}moveRangeI(){for(;this.rangeI<this.ranges.length-1&&this.absoluteLineStart>=this.ranges[this.rangeI].to;)this.rangeI++,this.absoluteLineStart=Math.max(this.absoluteLineStart,this.ranges[this.rangeI].from)}scanLine(e){let t=fI;if(t.end=e,e>=this.to)t.text="";else if(t.text=this.lineChunkAt(e),t.end+=t.text.length,this.ranges.length>1){let n=this.absoluteLineStart,r=this.rangeI;for(;this.ranges[r].to<t.end;){r++;let s=this.ranges[r].from,o=this.lineChunkAt(s);t.end=s+o.length,t.text=t.text.slice(0,this.ranges[r-1].to-n)+o,n=t.end-t.text.length}}return t}readLine(){let{line:e}=this,{text:t,end:n}=this.scanLine(this.absoluteLineStart);for(this.absoluteLineEnd=n,e.reset(t);e.depth<this.stack.length;e.depth++){let r=this.stack[e.depth],s=this.parser.skipContextMarkup[r.type];if(!s)throw new Error("Unhandled block context "+C[r.type]);if(!s(r,this,e))break;e.forward()}}lineChunkAt(e){let t=this.input.chunk(e),n;if(this.input.lineChunks)n=t==`
`?"":t;else{let r=t.indexOf(`
`);n=r<0?t:t.slice(0,r)}return e+n.length>this.to?n.slice(0,this.to-e):n}prevLineEnd(){return this.atEnd?this.lineStart:this.lineStart-1}startContext(e,t,n=0){this.block=dc.create(e,n,this.lineStart+t,this.block.hash,this.lineStart+this.line.text.length),this.stack.push(this.block)}startComposite(e,t,n=0){this.startContext(this.parser.getNodeType(e),t,n)}addNode(e,t,n){typeof e=="number"&&(e=new F(this.parser.nodeSet.types[e],zs,zs,(n??this.prevLineEnd())-t)),this.block.addChild(e,t-this.block.from)}addElement(e){this.block.addChild(e.toTree(this.parser.nodeSet),e.from-this.block.from)}addLeafElement(e,t){this.addNode(this.buffer.writeElements(Kd(t.children,e.marks),-t.from).finish(t.type,t.to-t.from),t.from)}finishContext(){let e=this.stack.pop(),t=this.stack[this.stack.length-1];t.addChild(e.toTree(this.parser.nodeSet),e.from-t.from),this.block=t}finish(){for(;this.stack.length>1;)this.finishContext();return this.addGaps(this.block.toTree(this.parser.nodeSet,this.lineStart))}addGaps(e){return this.ranges.length>1?Kx(this.ranges,0,e.topNode,this.ranges[0].from,this.reusePlaceholders):e}finishLeaf(e){for(let n of e.parsers)if(n.finish(this,e))return;let t=Kd(this.parser.parseInline(e.content,e.start),e.marks);this.addNode(this.buffer.writeElements(t,-e.start).finish(C.Paragraph,e.content.length),e.start)}elt(e,t,n,r){return typeof e=="string"?K(this.parser.getNodeType(e),t,n,r):new tv(e,t)}get buffer(){return new ev(this.parser.nodeSet)}}function Kx(i,e,t,n,r){let s=i[e].to,o=[],l=[],a=t.from+n;function h(c,f){for(;f?c>=s:c>s;){let u=i[e+1].from-s;n+=u,c+=u,e++,s=i[e].to}}for(let c=t.firstChild;c;c=c.nextSibling){h(c.from+n,!0);let f=c.from+n,u,d=r.get(c.tree);d?u=d:c.to+n>s?(u=Kx(i,e,c,n,r),h(c.to+n,!1)):u=c.toTree(),o.push(u),l.push(f-a)}return h(t.to+n,!1),new F(t.type,o,l,t.to+n-a,t.tree?t.tree.propValues:void 0)}class Kc extends Bc{constructor(e,t,n,r,s,o,l,a,h){super(),this.nodeSet=e,this.blockParsers=t,this.leafBlockParsers=n,this.blockNames=r,this.endLeafBlock=s,this.skipContextMarkup=o,this.inlineParsers=l,this.inlineNames=a,this.wrappers=h,this.nodeTypes=Object.create(null);for(let c of e.types)this.nodeTypes[c.name]=c.id}createParse(e,t,n){let r=new uI(this,e,t,n);for(let s of this.wrappers)r=s(r,e,t,n);return r}configure(e){let t=Gd(e);if(!t)return this;let{nodeSet:n,skipContextMarkup:r}=this,s=this.blockParsers.slice(),o=this.leafBlockParsers.slice(),l=this.blockNames.slice(),a=this.inlineParsers.slice(),h=this.inlineNames.slice(),c=this.endLeafBlock.slice(),f=this.wrappers;if(mo(t.defineNodes)){r=Object.assign({},r);let u=n.types.slice(),d;for(let p of t.defineNodes){let{name:m,block:g,composite:y,style:k}=typeof p=="string"?{name:p}:p;if(u.some(S=>S.name==m))continue;y&&(r[u.length]=(S,x,Q)=>y(x,Q,S.value));let v=u.length,$=y?["Block","BlockContext"]:g?v>=C.ATXHeading1&&v<=C.SetextHeading2?["Block","LeafBlock","Heading"]:["Block","LeafBlock"]:void 0;u.push(Me.define({id:v,name:m,props:$&&[[B.group,$]]})),k&&(d||(d={}),Array.isArray(k)||k instanceof sn?d[m]=k:Object.assign(d,k))}n=new Hs(u),d&&(n=n.extend(Ks(d)))}if(mo(t.props)&&(n=n.extend(...t.props)),mo(t.remove))for(let u of t.remove){let d=this.blockNames.indexOf(u),p=this.inlineNames.indexOf(u);d>-1&&(s[d]=o[d]=void 0),p>-1&&(a[p]=void 0)}if(mo(t.parseBlock))for(let u of t.parseBlock){let d=l.indexOf(u.name);if(d>-1)s[d]=u.parse,o[d]=u.leaf;else{let p=u.before?Ba(l,u.before):u.after?Ba(l,u.after)+1:l.length-1;s.splice(p,0,u.parse),o.splice(p,0,u.leaf),l.splice(p,0,u.name)}u.endLeaf&&c.push(u.endLeaf)}if(mo(t.parseInline))for(let u of t.parseInline){let d=h.indexOf(u.name);if(d>-1)a[d]=u.parse;else{let p=u.before?Ba(h,u.before):u.after?Ba(h,u.after)+1:h.length-1;a.splice(p,0,u.parse),h.splice(p,0,u.name)}}return t.wrap&&(f=f.concat(t.wrap)),new Kc(n,s,o,l,c,r,a,h,f)}getNodeType(e){let t=this.nodeTypes[e];if(t==null)throw new RangeError(`Unknown node type '${e}'`);return t}parseInline(e,t){let n=new pI(this,e,t);e:for(let r=t;r<n.end;){let s=n.char(r);for(let o of this.inlineParsers)if(o){let l=o(n,s,r);if(l>=0){r=l;continue e}}r++}return n.resolveMarkers(0)}}function mo(i){return i!=null&&i.length>0}function Gd(i){if(!Array.isArray(i))return i;if(i.length==0)return null;let e=Gd(i[0]);if(i.length==1)return e;let t=Gd(i.slice(1));if(!t||!e)return e||t;let n=(o,l)=>(o||zs).concat(l||zs),r=e.wrap,s=t.wrap;return{props:n(e.props,t.props),defineNodes:n(e.defineNodes,t.defineNodes),parseBlock:n(e.parseBlock,t.parseBlock),parseInline:n(e.parseInline,t.parseInline),remove:n(e.remove,t.remove),wrap:r?s?(o,l,a,h)=>r(s(o,l,a,h),l,a,h):r:s}}function Ba(i,e){let t=i.indexOf(e);if(t<0)throw new RangeError(`Position specified relative to unknown parser ${e}`);return t}let Jx=[Me.none];for(let i=1,e;e=C[i];i++)Jx[i]=Me.define({id:i,name:e,props:i>=C.Escape?[]:[[B.group,i in Lx?["Block","BlockContext"]:["Block","LeafBlock"]]],top:e=="Document"});const zs=[];class ev{constructor(e){this.nodeSet=e,this.content=[],this.nodes=[]}write(e,t,n,r=0){return this.content.push(e,t,n,4+r*4),this}writeElements(e,t=0){for(let n of e)n.writeTo(this,t);return this}finish(e,t){return F.build({buffer:this.content,nodeSet:this.nodeSet,reused:this.nodes,topID:e,length:t})}}let Xl=class{constructor(e,t,n,r=zs){this.type=e,this.from=t,this.to=n,this.children=r}writeTo(e,t){let n=e.content.length;e.writeElements(this.children,t),e.content.push(this.type,this.from+t,this.to+t,e.content.length+4-n)}toTree(e){return new ev(e).writeElements(this.children,-this.from).finish(this.type,this.to-this.from)}};class tv{constructor(e,t){this.tree=e,this.from=t}get to(){return this.from+this.tree.length}get type(){return this.tree.type.id}get children(){return zs}writeTo(e,t){e.nodes.push(this.tree),e.content.push(e.nodes.length-1,this.from+t,this.to+t,-1)}toTree(){return this.tree}}function K(i,e,t,n){return new Xl(i,e,t,n)}const nv={resolve:"Emphasis",mark:"EmphasisMark"},iv={resolve:"Emphasis",mark:"EmphasisMark"},cs={},Hd={};class qt{constructor(e,t,n,r){this.type=e,this.from=t,this.to=n,this.side=r}}const Sy="!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~";let Bl=/[!"#$%&'()*+,\-.\/:;<=>?@\[\\\]^_`{|}~\xA1\u2010-\u2027]/;try{Bl=new RegExp("[\\p{Pc}|\\p{Pd}|\\p{Pe}|\\p{Pf}|\\p{Pi}|\\p{Po}|\\p{Ps}]","u")}catch{}const su={Escape(i,e,t){if(e!=92||t==i.end-1)return-1;let n=i.char(t+1);for(let r=0;r<Sy.length;r++)if(Sy.charCodeAt(r)==n)return i.append(K(C.Escape,t,t+2));return-1},Entity(i,e,t){if(e!=38)return-1;let n=/^(?:#\d+|#x[a-f\d]+|\w+);/i.exec(i.slice(t+1,t+31));return n?i.append(K(C.Entity,t,t+1+n[0].length)):-1},InlineCode(i,e,t){if(e!=96||t&&i.char(t-1)==96)return-1;let n=t+1;for(;n<i.end&&i.char(n)==96;)n++;let r=n-t,s=0;for(;n<i.end;n++)if(i.char(n)==96){if(s++,s==r&&i.char(n+1)!=96)return i.append(K(C.InlineCode,t,n+1,[K(C.CodeMark,t,t+r),K(C.CodeMark,n+1-r,n+1)]))}else s=0;return-1},HTMLTag(i,e,t){if(e!=60||t==i.end-1)return-1;let n=i.slice(t+1,i.end),r=/^(?:[a-z][-\w+.]+:[^\s>]+|[a-z\d.!#$%&'*+/=?^_`{|}~-]+@[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?(?:\.[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?)*)>/i.exec(n);if(r)return i.append(K(C.Autolink,t,t+1+r[0].length,[K(C.LinkMark,t,t+1),K(C.URL,t+1,t+r[0].length),K(C.LinkMark,t+r[0].length,t+1+r[0].length)]));let s=/^!--[^>](?:-[^-]|[^-])*?-->/i.exec(n);if(s)return i.append(K(C.Comment,t,t+1+s[0].length));let o=/^\?[^]*?\?>/.exec(n);if(o)return i.append(K(C.ProcessingInstruction,t,t+1+o[0].length));let l=/^(?:![A-Z][^]*?>|!\[CDATA\[[^]*?\]\]>|\/\s*[a-zA-Z][\w-]*\s*>|\s*[a-zA-Z][\w-]*(\s+[a-zA-Z:_][\w-.:]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*(\/\s*)?>)/.exec(n);return l?i.append(K(C.HTMLTag,t,t+1+l[0].length)):-1},Emphasis(i,e,t){if(e!=95&&e!=42)return-1;let n=t+1;for(;i.char(n)==e;)n++;let r=i.slice(t-1,t),s=i.slice(n,n+1),o=Bl.test(r),l=Bl.test(s),a=/\s|^$/.test(r),h=/\s|^$/.test(s),c=!h&&(!l||a||o),f=!a&&(!o||h||l),u=c&&(e==42||!f||o),d=f&&(e==42||!c||l);return i.append(new qt(e==95?nv:iv,t,n,(u?1:0)|(d?2:0)))},HardBreak(i,e,t){if(e==92&&i.char(t+1)==10)return i.append(K(C.HardBreak,t,t+2));if(e==32){let n=t+1;for(;i.char(n)==32;)n++;if(i.char(n)==10&&n>=t+2)return i.append(K(C.HardBreak,t,n+1))}return-1},Link(i,e,t){return e==91?i.append(new qt(cs,t,t+1,1)):-1},Image(i,e,t){return e==33&&i.char(t+1)==91?i.append(new qt(Hd,t,t+2,1)):-1},LinkEnd(i,e,t){if(e!=93)return-1;for(let n=i.parts.length-1;n>=0;n--){let r=i.parts[n];if(r instanceof qt&&(r.type==cs||r.type==Hd)){if(!r.side||i.skipSpace(r.to)==t&&!/[(\[]/.test(i.slice(t+1,t+2)))return i.parts[n]=null,-1;let s=i.takeContent(n),o=i.parts[n]=dI(i,s,r.type==cs?C.Link:C.Image,r.from,t+1);if(r.type==cs)for(let l=0;l<n;l++){let a=i.parts[l];a instanceof qt&&a.type==cs&&(a.side=0)}return o.to}}return-1}};function dI(i,e,t,n,r){let{text:s}=i,o=i.char(r),l=r;if(e.unshift(K(C.LinkMark,n,n+(t==C.Image?2:1))),e.push(K(C.LinkMark,r-1,r)),o==40){let a=i.skipSpace(r+1),h=rv(s,a-i.offset,i.offset),c;h&&(a=i.skipSpace(h.to),a!=h.to&&(c=sv(s,a-i.offset,i.offset),c&&(a=i.skipSpace(c.to)))),i.char(a)==41&&(e.push(K(C.LinkMark,r,r+1)),l=a+1,h&&e.push(h),c&&e.push(c),e.push(K(C.LinkMark,a,l)))}else if(o==91){let a=ov(s,r-i.offset,i.offset,!1);a&&(e.push(a),l=a.to)}return K(t,n,l,e)}function rv(i,e,t){if(i.charCodeAt(e)==60){for(let r=e+1;r<i.length;r++){let s=i.charCodeAt(r);if(s==62)return K(C.URL,e+t,r+1+t);if(s==60||s==10)return!1}return null}else{let r=0,s=e;for(let o=!1;s<i.length;s++){let l=i.charCodeAt(s);if(en(l))break;if(o)o=!1;else if(l==40)r++;else if(l==41){if(!r)break;r--}else l==92&&(o=!0)}return s>e?K(C.URL,e+t,s+t):s==i.length?null:!1}}function sv(i,e,t){let n=i.charCodeAt(e);if(n!=39&&n!=34&&n!=40)return!1;let r=n==40?41:n;for(let s=e+1,o=!1;s<i.length;s++){let l=i.charCodeAt(s);if(o)o=!1;else{if(l==r)return K(C.LinkTitle,e+t,s+1+t);l==92&&(o=!0)}}return null}function ov(i,e,t,n){for(let r=!1,s=e+1,o=Math.min(i.length,s+999);s<o;s++){let l=i.charCodeAt(s);if(r)r=!1;else{if(l==93)return n?!1:K(C.LinkLabel,e+t,s+1+t);if(n&&!en(l)&&(n=!1),l==91)return!1;l==92&&(r=!0)}}return null}class pI{constructor(e,t,n){this.parser=e,this.text=t,this.offset=n,this.parts=[]}char(e){return e>=this.end?-1:this.text.charCodeAt(e-this.offset)}get end(){return this.offset+this.text.length}slice(e,t){return this.text.slice(e-this.offset,t-this.offset)}append(e){return this.parts.push(e),e.to}addDelimiter(e,t,n,r,s){return this.append(new qt(e,t,n,(r?1:0)|(s?2:0)))}get hasOpenLink(){for(let e=this.parts.length-1;e>=0;e--){let t=this.parts[e];if(t instanceof qt&&(t.type==cs||t.type==Hd))return!0}return!1}addElement(e){return this.append(e)}resolveMarkers(e){for(let n=e;n<this.parts.length;n++){let r=this.parts[n];if(!(r instanceof qt&&r.type.resolve&&r.side&2))continue;let s=r.type==nv||r.type==iv,o=r.to-r.from,l,a=n-1;for(;a>=e;a--){let m=this.parts[a];if(m instanceof qt&&m.side&1&&m.type==r.type&&!(s&&(r.side&1||m.side&2)&&(m.to-m.from+o)%3==0&&((m.to-m.from)%3||o%3))){l=m;break}}if(!l)continue;let h=r.type.resolve,c=[],f=l.from,u=r.to;if(s){let m=Math.min(2,l.to-l.from,o);f=l.to-m,u=r.from+m,h=m==1?"Emphasis":"StrongEmphasis"}l.type.mark&&c.push(this.elt(l.type.mark,f,l.to));for(let m=a+1;m<n;m++)this.parts[m]instanceof Xl&&c.push(this.parts[m]),this.parts[m]=null;r.type.mark&&c.push(this.elt(r.type.mark,r.from,u));let d=this.elt(h,f,u,c);this.parts[a]=s&&l.from!=f?new qt(l.type,l.from,f,l.side):null,(this.parts[n]=s&&r.to!=u?new qt(r.type,u,r.to,r.side):null)?this.parts.splice(n,0,d):this.parts[n]=d}let t=[];for(let n=e;n<this.parts.length;n++){let r=this.parts[n];r instanceof Xl&&t.push(r)}return t}findOpeningDelimiter(e){for(let t=this.parts.length-1;t>=0;t--){let n=this.parts[t];if(n instanceof qt&&n.type==e)return t}return null}takeContent(e){let t=this.resolveMarkers(e);return this.parts.length=e,t}skipSpace(e){return hl(this.text,e-this.offset)+this.offset}elt(e,t,n,r){return typeof e=="string"?K(this.parser.getNodeType(e),t,n,r):new tv(e,t)}}function Kd(i,e){if(!e.length)return i;if(!i.length)return e;let t=i.slice(),n=0;for(let r of e){for(;n<t.length&&t[n].to<r.to;)n++;if(n<t.length&&t[n].from<r.from){let s=t[n];s instanceof Xl&&(t[n]=new Xl(s.type,s.from,s.to,Kd(s.children,[r])))}else t.splice(n++,0,r)}return t}const mI=[C.CodeBlock,C.ListItem,C.OrderedList,C.BulletList];let gI=class{constructor(e,t){this.fragments=e,this.input=t,this.i=0,this.fragment=null,this.fragmentEnd=-1,this.cursor=null,e.length&&(this.fragment=e[this.i++])}nextFragment(){this.fragment=this.i<this.fragments.length?this.fragments[this.i++]:null,this.cursor=null,this.fragmentEnd=-1}moveTo(e,t){for(;this.fragment&&this.fragment.to<=e;)this.nextFragment();if(!this.fragment||this.fragment.from>(e?e-1:0))return!1;if(this.fragmentEnd<0){let s=this.fragment.to;for(;s>0&&this.input.read(s-1,s)!=`
`;)s--;this.fragmentEnd=s?s-1:0}let n=this.cursor;n||(n=this.cursor=this.fragment.tree.cursor(),n.firstChild());let r=e+this.fragment.offset;for(;n.to<=r;)if(!n.parent())return!1;for(;;){if(n.from>=r)return this.fragment.from<=t;if(!n.childAfter(r))return!1}}matches(e){let t=this.cursor.tree;return t&&t.prop(B.contextHash)==e}takeNodes(e){let t=this.cursor,n=this.fragment.offset,r=this.fragmentEnd-(this.fragment.openEnd?1:0),s=e.absoluteLineStart,o=s,l=e.block.children.length,a=o,h=l;for(;;){if(t.to-n>r){if(t.type.isAnonymous&&t.firstChild())continue;break}let c=lv(t.from-n,e.ranges);if(t.to-n<=e.ranges[e.rangeI].to)e.addNode(t.tree,c);else{let f=new F(e.parser.nodeSet.types[C.Paragraph],[],[],0,e.block.hashProp);e.reusePlaceholders.set(f,t.tree),e.addNode(f,c)}if(t.type.is("Block")&&(mI.indexOf(t.type.id)<0?(o=t.to-n,l=e.block.children.length):(o=a,l=h,a=t.to-n,h=e.block.children.length)),!t.nextSibling())break}for(;e.block.children.length>l;)e.block.children.pop(),e.block.positions.pop();return o-s}};function lv(i,e){let t=i;for(let n=1;n<e.length;n++){let r=e[n-1].to,s=e[n].from;r<i&&(t-=s-r)}return t}const OI=Ks({"Blockquote/...":O.quote,HorizontalRule:O.contentSeparator,"ATXHeading1/... SetextHeading1/...":O.heading1,"ATXHeading2/... SetextHeading2/...":O.heading2,"ATXHeading3/...":O.heading3,"ATXHeading4/...":O.heading4,"ATXHeading5/...":O.heading5,"ATXHeading6/...":O.heading6,"Comment CommentBlock":O.comment,Escape:O.escape,Entity:O.character,"Emphasis/...":O.emphasis,"StrongEmphasis/...":O.strong,"Link/... Image/...":O.link,"OrderedList/... BulletList/...":O.list,"BlockQuote/...":O.quote,"InlineCode CodeText":O.monospace,"URL Autolink":O.url,"HeaderMark HardBreak QuoteMark ListMark LinkMark EmphasisMark CodeMark":O.processingInstruction,"CodeInfo LinkLabel":O.labelName,LinkTitle:O.string,Paragraph:O.content}),yI=new Kc(new Hs(Jx).extend(OI),Object.keys(Xa).map(i=>Xa[i]),Object.keys(Xa).map(i=>hI[i]),Object.keys(Xa),cI,Lx,Object.keys(su).map(i=>su[i]),Object.keys(su),[]);function kI(i,e,t){let n=[];for(let r=i.firstChild,s=e;;r=r.nextSibling){let o=r?r.from:t;if(o>s&&n.push({from:s,to:o}),!r)break;s=r.to}return n}function bI(i){let{codeParser:e,htmlParser:t}=i;return{wrap:sw((r,s)=>{let o=r.type.id;if(e&&(o==C.CodeBlock||o==C.FencedCode)){let l="";if(o==C.FencedCode){let h=r.node.getChild(C.CodeInfo);h&&(l=s.read(h.from,h.to))}let a=e(l);if(a)return{parser:a,overlay:h=>h.type.id==C.CodeText}}else if(t&&(o==C.HTMLBlock||o==C.HTMLTag))return{parser:t,overlay:kI(r.node,r.from,r.to)};return null})}}const SI={resolve:"Strikethrough",mark:"StrikethroughMark"},wI={defineNodes:[{name:"Strikethrough",style:{"Strikethrough/...":O.strikethrough}},{name:"StrikethroughMark",style:O.processingInstruction}],parseInline:[{name:"Strikethrough",parse(i,e,t){if(e!=126||i.char(t+1)!=126||i.char(t+2)==126)return-1;let n=i.slice(t-1,t),r=i.slice(t+2,t+3),s=/\s|^$/.test(n),o=/\s|^$/.test(r),l=Bl.test(n),a=Bl.test(r);return i.addDelimiter(SI,t,t+2,!o&&(!a||s||l),!s&&(!l||o||a))},after:"Emphasis"}]};function cl(i,e,t=0,n,r=0){let s=0,o=!0,l=-1,a=-1,h=!1,c=()=>{n.push(i.elt("TableCell",r+l,r+a,i.parser.parseInline(e.slice(l,a),r+l)))};for(let f=t;f<e.length;f++){let u=e.charCodeAt(f);u==124&&!h?((!o||l>-1)&&s++,o=!1,n&&(l>-1&&c(),n.push(i.elt("TableDelimiter",f+r,f+r+1))),l=a=-1):(h||u!=32&&u!=9)&&(l<0&&(l=f),a=f+1),h=!h&&u==92}return l>-1&&(s++,n&&c()),s}function wy(i,e){for(let t=e;t<i.length;t++){let n=i.charCodeAt(t);if(n==124)return!0;n==92&&t++}return!1}const av=/^\|?(\s*:?-+:?\s*\|)+(\s*:?-+:?\s*)?$/;class xy{constructor(){this.rows=null}nextLine(e,t,n){if(this.rows==null){this.rows=!1;let r;if((t.next==45||t.next==58||t.next==124)&&av.test(r=t.text.slice(t.pos))){let s=[];cl(e,n.content,0,s,n.start)==cl(e,r,t.pos)&&(this.rows=[e.elt("TableHeader",n.start,n.start+n.content.length,s),e.elt("TableDelimiter",e.lineStart+t.pos,e.lineStart+t.text.length)])}}else if(this.rows){let r=[];cl(e,t.text,t.pos,r,e.lineStart),this.rows.push(e.elt("TableRow",e.lineStart+t.pos,e.lineStart+t.text.length,r))}return!1}finish(e,t){return this.rows?(e.addLeafElement(t,e.elt("Table",t.start,t.start+t.content.length,this.rows)),!0):!1}}const xI={defineNodes:[{name:"Table",block:!0},{name:"TableHeader",style:{"TableHeader/...":O.heading}},"TableRow",{name:"TableCell",style:O.content},{name:"TableDelimiter",style:O.processingInstruction}],parseBlock:[{name:"Table",leaf(i,e){return wy(e.content,0)?new xy:null},endLeaf(i,e,t){if(t.parsers.some(r=>r instanceof xy)||!wy(e.text,e.basePos))return!1;let n=i.scanLine(i.absoluteLineEnd+1).text;return av.test(n)&&cl(i,e.text,e.basePos)==cl(i,n,e.basePos)},before:"SetextHeading"}]};class vI{nextLine(){return!1}finish(e,t){return e.addLeafElement(t,e.elt("Task",t.start,t.start+t.content.length,[e.elt("TaskMarker",t.start,t.start+3),...e.parser.parseInline(t.content.slice(3),t.start+3)])),!0}}const $I={defineNodes:[{name:"Task",block:!0,style:O.list},{name:"TaskMarker",style:O.atom}],parseBlock:[{name:"TaskList",leaf(i,e){return/^\[[ xX]\][ \t]/.test(e.content)&&i.parentType().name=="ListItem"?new vI:null},after:"SetextHeading"}]},vy=/(www\.)|(https?:\/\/)|([\w.+-]+@)|(mailto:|xmpp:)/gy,$y=/[\w-]+(\.[\w-]+)+(\/[^\s<]*)?/gy,PI=/[\w-]+\.[\w-]+($|\/)/,Py=/[\w.+-]+@[\w-]+(\.[\w.-]+)+/gy,Qy=/\/[a-zA-Z\d@.]+/gy;function Cy(i,e,t,n){let r=0;for(let s=e;s<t;s++)i[s]==n&&r++;return r}function QI(i,e){$y.lastIndex=e;let t=$y.exec(i);if(!t||PI.exec(t[0])[0].indexOf("_")>-1)return-1;let n=e+t[0].length;for(;;){let r=i[n-1],s;if(/[?!.,:*_~]/.test(r)||r==")"&&Cy(i,e,n,")")>Cy(i,e,n,"("))n--;else if(r==";"&&(s=/&(?:#\d+|#x[a-f\d]+|\w+);$/.exec(i.slice(e,n))))n=e+s.index;else break}return n}function Ty(i,e){Py.lastIndex=e;let t=Py.exec(i);if(!t)return-1;let n=t[0][t[0].length-1];return n=="_"||n=="-"?-1:e+t[0].length-(n=="."?1:0)}const CI={parseInline:[{name:"Autolink",parse(i,e,t){let n=t-i.offset;vy.lastIndex=n;let r=vy.exec(i.text),s=-1;if(!r)return-1;if(r[1]||r[2]){if(s=QI(i.text,n+r[0].length),s>-1&&i.hasOpenLink){let o=/([^\[\]]|\[[^\]]*\])*/.exec(i.text.slice(n,s));s=n+o[0].length}}else r[3]?s=Ty(i.text,n):(s=Ty(i.text,n+r[0].length),s>-1&&r[0]=="xmpp:"&&(Qy.lastIndex=s,r=Qy.exec(i.text),r&&(s=r.index+r[0].length)));return s<0?-1:(i.addElement(i.elt("URL",t,s+i.offset)),s+i.offset)}}]},TI=[xI,$I,wI,CI];function hv(i,e,t){return(n,r,s)=>{if(r!=i||n.char(s+1)==i)return-1;let o=[n.elt(t,s,s+1)];for(let l=s+1;l<n.end;l++){let a=n.char(l);if(a==i)return n.addElement(n.elt(e,s,l+1,o.concat(n.elt(t,l,l+1))));if(a==92&&o.push(n.elt("Escape",l,l+++2)),en(a))break}return-1}}const MI={defineNodes:[{name:"Superscript",style:O.special(O.content)},{name:"SuperscriptMark",style:O.processingInstruction}],parseInline:[{name:"Superscript",parse:hv(94,"Superscript","SuperscriptMark")}]},AI={defineNodes:[{name:"Subscript",style:O.special(O.content)},{name:"SubscriptMark",style:O.processingInstruction}],parseInline:[{name:"Subscript",parse:hv(126,"Subscript","SubscriptMark")}]},ZI={defineNodes:[{name:"Emoji",style:O.character}],parseInline:[{name:"Emoji",parse(i,e,t){let n;return e!=58||!(n=/^[a-zA-Z_0-9]+:/.exec(i.slice(t+1,i.end)))?-1:i.addElement(i.elt("Emoji",t,t+1+n[0].length))}}]};var My={};class pc{constructor(e,t,n,r,s,o,l,a,h,c=0,f){this.p=e,this.stack=t,this.state=n,this.reducePos=r,this.pos=s,this.score=o,this.buffer=l,this.bufferBase=a,this.curContext=h,this.lookAhead=c,this.parent=f}toString(){return`[${this.stack.filter((e,t)=>t%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,t,n=0){let r=e.parser.context;return new pc(e,[],t,n,n,0,[],0,r?new Ay(r,r.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var t;let n=e>>19,r=e&65535,{parser:s}=this.p,o=s.dynamicPrecedence(r);if(o&&(this.score+=o),n==0){this.pushState(s.getGoto(this.state,r,!0),this.reducePos),r<s.minRepeatTerm&&this.storeNode(r,this.reducePos,this.reducePos,4,!0),this.reduceContext(r,this.reducePos);return}let l=this.stack.length-(n-1)*3-(e&262144?6:0),a=l?this.stack[l-2]:this.p.ranges[0].from,h=this.reducePos-a;h>=2e3&&!(!((t=this.p.parser.nodeSet.types[r])===null||t===void 0)&&t.isAnonymous)&&(a==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=h):this.p.lastBigReductionSize<h&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=a,this.p.lastBigReductionSize=h));let c=l?this.stack[l-1]:0,f=this.bufferBase+this.buffer.length-c;if(r<s.minRepeatTerm||e&131072){let u=s.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(r,a,u,f+4,!0)}if(e&262144)this.state=this.stack[l];else{let u=this.stack[l-3];this.state=s.getGoto(u,r,!0)}for(;this.stack.length>l;)this.stack.pop();this.reduceContext(r,a)}storeNode(e,t,n,r=4,s=!1){if(e==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let o=this,l=this.buffer.length;if(l==0&&o.parent&&(l=o.bufferBase-o.parent.bufferBase,o=o.parent),l>0&&o.buffer[l-4]==0&&o.buffer[l-1]>-1){if(t==n)return;if(o.buffer[l-2]>=t){o.buffer[l-2]=n;return}}}if(!s||this.pos==n)this.buffer.push(e,t,n,r);else{let o=this.buffer.length;if(o>0&&this.buffer[o-4]!=0)for(;o>0&&this.buffer[o-2]>n;)this.buffer[o]=this.buffer[o-4],this.buffer[o+1]=this.buffer[o-3],this.buffer[o+2]=this.buffer[o-2],this.buffer[o+3]=this.buffer[o-1],o-=4,r>4&&(r-=4);this.buffer[o]=e,this.buffer[o+1]=t,this.buffer[o+2]=n,this.buffer[o+3]=r}}shift(e,t,n,r){if(e&131072)this.pushState(e&65535,this.pos);else if(e&262144)this.pos=r,this.shiftContext(t,n),t<=this.p.parser.maxNode&&this.buffer.push(t,n,r,4);else{let s=e,{parser:o}=this.p;(r>this.pos||t<=o.maxNode)&&(this.pos=r,o.stateFlag(s,1)||(this.reducePos=r)),this.pushState(s,n),this.shiftContext(t,n),t<=o.maxNode&&this.buffer.push(t,n,r,4)}}apply(e,t,n,r){e&65536?this.reduce(e):this.shift(e,t,n,r)}useNode(e,t){let n=this.p.reused.length-1;(n<0||this.p.reused[n]!=e)&&(this.p.reused.push(e),n++);let r=this.pos;this.reducePos=this.pos=r+e.length,this.pushState(t,r),this.buffer.push(n,r,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,t=e.buffer.length;for(;t>0&&e.buffer[t-2]>e.reducePos;)t-=4;let n=e.buffer.slice(t),r=e.bufferBase+t;for(;e&&r==e.bufferBase;)e=e.parent;return new pc(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,n,r,this.curContext,this.lookAhead,e)}recoverByDelete(e,t){let n=e<=this.p.parser.maxNode;n&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,n?8:4),this.pos=this.reducePos=t,this.score-=190}canShift(e){for(let t=new RI(this);;){let n=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if(n==0)return!1;if(!(n&65536))return!0;t.reduce(n)}}recoverByInsert(e){if(this.stack.length>=300)return[];let t=this.p.parser.nextStates(this.state);if(t.length>8||this.stack.length>=120){let r=[];for(let s=0,o;s<t.length;s+=2)(o=t[s+1])!=this.state&&this.p.parser.hasAction(o,e)&&r.push(t[s],o);if(this.stack.length<120)for(let s=0;r.length<8&&s<t.length;s+=2){let o=t[s+1];r.some((l,a)=>a&1&&l==o)||r.push(t[s],o)}t=r}let n=[];for(let r=0;r<t.length&&n.length<4;r+=2){let s=t[r+1];if(s==this.state)continue;let o=this.split();o.pushState(s,this.pos),o.storeNode(0,o.pos,o.pos,4,!0),o.shiftContext(t[r],this.pos),o.reducePos=this.pos,o.score-=200,n.push(o)}return n}forceReduce(){let{parser:e}=this.p,t=e.stateSlot(this.state,5);if(!(t&65536))return!1;if(!e.validAction(this.state,t)){let n=t>>19,r=t&65535,s=this.stack.length-n*3;if(s<0||e.getGoto(this.stack[s],r,!1)<0){let o=this.findForcedReduction();if(o==null)return!1;t=o}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(t),!0}findForcedReduction(){let{parser:e}=this.p,t=[],n=(r,s)=>{if(!t.includes(r))return t.push(r),e.allActions(r,o=>{if(!(o&393216))if(o&65536){let l=(o>>19)-s;if(l>1){let a=o&65535,h=this.stack.length-l*3;if(h>=0&&e.getGoto(this.stack[h],a,!1)>=0)return l<<19|65536|a}}else{let l=n(o,s+1);if(l!=null)return l}})};return n(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:e}=this.p;return e.data[e.stateSlot(this.state,1)]==65535&&!e.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)))}reduceContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)))}emitContext(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(e){if(e!=this.curContext.context){let t=new Ay(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t}}setLookAhead(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class Ay{constructor(e,t){this.tracker=e,this.context=t,this.hash=e.strict?e.hash(t):0}}class RI{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let t=e&65535,n=e>>19;n==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(n-1)*3;let r=this.start.p.parser.getGoto(this.stack[this.base-3],t,!0);this.state=r}}class mc{constructor(e,t,n){this.stack=e,this.pos=t,this.index=n,this.buffer=e.buffer,this.index==0&&this.maybeNext()}static create(e,t=e.bufferBase+e.buffer.length){return new mc(e,t,t-e.bufferBase)}maybeNext(){let e=this.stack.parent;e!=null&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new mc(this.stack,this.pos,this.index)}}function _o(i,e=Uint16Array){if(typeof i!="string")return i;let t=null;for(let n=0,r=0;n<i.length;){let s=0;for(;;){let o=i.charCodeAt(n++),l=!1;if(o==126){s=65535;break}o>=92&&o--,o>=34&&o--;let a=o-32;if(a>=46&&(a-=46,l=!0),s+=a,l)break;s*=46}t?t[r++]=s:t=new e(s)}return t}class Ch{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const Zy=new Ch;class EI{constructor(e,t){this.input=e,this.ranges=t,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=Zy,this.rangeIndex=0,this.pos=this.chunkPos=t[0].from,this.range=t[0],this.end=t[t.length-1].to,this.readNext()}resolveOffset(e,t){let n=this.range,r=this.rangeIndex,s=this.pos+e;for(;s<n.from;){if(!r)return null;let o=this.ranges[--r];s-=n.from-o.to,n=o}for(;t<0?s>n.to:s>=n.to;){if(r==this.ranges.length-1)return null;let o=this.ranges[++r];s+=o.from-n.to,n=o}return s}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let t of this.ranges)if(t.to>e)return Math.max(e,t.from);return this.end}peek(e){let t=this.chunkOff+e,n,r;if(t>=0&&t<this.chunk.length)n=this.pos+e,r=this.chunk.charCodeAt(t);else{let s=this.resolveOffset(e,1);if(s==null)return-1;if(n=s,n>=this.chunk2Pos&&n<this.chunk2Pos+this.chunk2.length)r=this.chunk2.charCodeAt(n-this.chunk2Pos);else{let o=this.rangeIndex,l=this.range;for(;l.to<=n;)l=this.ranges[++o];this.chunk2=this.input.chunk(this.chunk2Pos=n),n+this.chunk2.length>l.to&&(this.chunk2=this.chunk2.slice(0,l.to-n)),r=this.chunk2.charCodeAt(0)}}return n>=this.token.lookAhead&&(this.token.lookAhead=n+1),r}acceptToken(e,t=0){let n=t?this.resolveOffset(t,-1):this.pos;if(n==null||n<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=n}acceptTokenTo(e,t){this.token.value=e,this.token.end=t}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:t}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),t=this.pos+e.length;this.chunk=t>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=Zy,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.chunk2Pos&&t<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,t-this.chunk2Pos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);let n="";for(let r of this.ranges){if(r.from>=t)break;r.to>e&&(n+=this.input.read(Math.max(r.from,e),Math.min(r.to,t)))}return n}}class Cs{constructor(e,t){this.data=e,this.id=t}token(e,t){let{parser:n}=t.p;cv(this.data,e,t,this.id,n.data,n.tokenPrecTable)}}Cs.prototype.contextual=Cs.prototype.fallback=Cs.prototype.extend=!1;class gc{constructor(e,t,n){this.precTable=t,this.elseToken=n,this.data=typeof e=="string"?_o(e):e}token(e,t){let n=e.pos,r=0;for(;;){let s=e.next<0,o=e.resolveOffset(1,1);if(cv(this.data,e,t,0,this.data,this.precTable),e.token.value>-1)break;if(this.elseToken==null)return;if(s||r++,o==null)break;e.reset(o,e.token)}r&&(e.reset(n,e.token),e.acceptToken(this.elseToken,r))}}gc.prototype.contextual=Cs.prototype.fallback=Cs.prototype.extend=!1;class kn{constructor(e,t={}){this.token=e,this.contextual=!!t.contextual,this.fallback=!!t.fallback,this.extend=!!t.extend}}function cv(i,e,t,n,r,s){let o=0,l=1<<n,{dialect:a}=t.p.parser;e:for(;l&i[o];){let h=i[o+1];for(let d=o+3;d<h;d+=2)if((i[d+1]&l)>0){let p=i[d];if(a.allows(p)&&(e.token.value==-1||e.token.value==p||NI(p,e.token.value,r,s))){e.acceptToken(p);break}}let c=e.next,f=0,u=i[o+2];if(e.next<0&&u>f&&i[h+u*3-3]==65535){o=i[h+u*3-1];continue e}for(;f<u;){let d=f+u>>1,p=h+d+(d<<1),m=i[p],g=i[p+1]||65536;if(c<m)u=d;else if(c>=g)f=d+1;else{o=i[p+2],e.advance();continue e}}break}}function Ry(i,e,t){for(let n=e,r;(r=i[n])!=65535;n++)if(r==t)return n-e;return-1}function NI(i,e,t,n){let r=Ry(t,n,e);return r<0||Ry(t,n,i)<r}const $t=typeof process<"u"&&My&&/\bparse\b/.test(My.LOG);let ou=null;function Ey(i,e,t){let n=i.cursor(ce.IncludeAnonymous);for(n.moveTo(e);;)if(!(t<0?n.childBefore(e):n.childAfter(e)))for(;;){if((t<0?n.to<e:n.from>e)&&!n.type.isError)return t<0?Math.max(0,Math.min(n.to-1,e-25)):Math.min(i.length,Math.max(n.from+1,e+25));if(t<0?n.prevSibling():n.nextSibling())break;if(!n.parent())return t<0?0:i.length}}class DI{constructor(e,t){this.fragments=e,this.nodeSet=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?Ey(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?Ey(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let t=this.trees.length-1;if(t<0)return this.nextFragment(),null;let n=this.trees[t],r=this.index[t];if(r==n.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let s=n.children[r],o=this.start[t]+n.positions[r];if(o>e)return this.nextStart=o,null;if(s instanceof F){if(o==e){if(o<this.safeFrom)return null;let l=o+s.length;if(l<=this.safeTo){let a=s.prop(B.lookAhead);if(!a||l+a<this.fragment.to)return s}}this.index[t]++,o+s.length>=Math.max(this.safeFrom,e)&&(this.trees.push(s),this.start.push(o),this.index.push(0))}else this.index[t]++,this.nextStart=o+s.length}}}class II{constructor(e,t){this.stream=t,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(n=>new Ch)}getActions(e){let t=0,n=null,{parser:r}=e.p,{tokenizers:s}=r,o=r.stateSlot(e.state,3),l=e.curContext?e.curContext.hash:0,a=0;for(let h=0;h<s.length;h++){if(!(1<<h&o))continue;let c=s[h],f=this.tokens[h];if(!(n&&!c.fallback)&&((c.contextual||f.start!=e.pos||f.mask!=o||f.context!=l)&&(this.updateCachedToken(f,c,e),f.mask=o,f.context=l),f.lookAhead>f.end+25&&(a=Math.max(f.lookAhead,a)),f.value!=0)){let u=t;if(f.extended>-1&&(t=this.addActions(e,f.extended,f.end,t)),t=this.addActions(e,f.value,f.end,t),!c.extend&&(n=f,t>u))break}}for(;this.actions.length>t;)this.actions.pop();return a&&e.setLookAhead(a),!n&&e.pos==this.stream.end&&(n=new Ch,n.value=e.p.parser.eofTerm,n.start=n.end=e.pos,t=this.addActions(e,n.value,n.end,t)),this.mainToken=n,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let t=new Ch,{pos:n,p:r}=e;return t.start=n,t.end=Math.min(n+1,r.stream.end),t.value=n==r.stream.end?r.parser.eofTerm:0,t}updateCachedToken(e,t,n){let r=this.stream.clipPos(n.pos);if(t.token(this.stream.reset(r,e),n),e.value>-1){let{parser:s}=n.p;for(let o=0;o<s.specialized.length;o++)if(s.specialized[o]==e.value){let l=s.specializers[o](this.stream.read(e.start,e.end),n);if(l>=0&&n.p.parser.dialect.allows(l>>1)){l&1?e.extended=l>>1:e.value=l>>1;break}}}else e.value=0,e.end=this.stream.clipPos(r+1)}putAction(e,t,n,r){for(let s=0;s<r;s+=3)if(this.actions[s]==e)return r;return this.actions[r++]=e,this.actions[r++]=t,this.actions[r++]=n,r}addActions(e,t,n,r){let{state:s}=e,{parser:o}=e.p,{data:l}=o;for(let a=0;a<2;a++)for(let h=o.stateSlot(s,a?2:1);;h+=3){if(l[h]==65535)if(l[h+1]==1)h=Jn(l,h+2);else{r==0&&l[h+1]==2&&(r=this.putAction(Jn(l,h+2),t,n,r));break}l[h]==t&&(r=this.putAction(Jn(l,h+1),t,n,r))}return r}}class WI{constructor(e,t,n,r){this.parser=e,this.input=t,this.ranges=r,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new EI(t,r),this.tokens=new II(e,this.stream),this.topTerm=e.top[1];let{from:s}=r[0];this.stacks=[pc.start(this,e.top[0],s)],this.fragments=n.length&&this.stream.end-s>e.bufferLength*4?new DI(n,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e=this.stacks,t=this.minStackPos,n=this.stacks=[],r,s;if(this.bigReductionCount>300&&e.length==1){let[o]=e;for(;o.forceReduce()&&o.stack.length&&o.stack[o.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let o=0;o<e.length;o++){let l=e[o];for(;;){if(this.tokens.mainToken=null,l.pos>t)n.push(l);else{if(this.advanceStack(l,n,e))continue;{r||(r=[],s=[]),r.push(l);let a=this.tokens.getMainToken(l);s.push(a.value,a.end)}}break}}if(!n.length){let o=r&&BI(r);if(o)return $t&&console.log("Finish with "+this.stackID(o)),this.stackToTree(o);if(this.parser.strict)throw $t&&r&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+t);this.recovering||(this.recovering=5)}if(this.recovering&&r){let o=this.stoppedAt!=null&&r[0].pos>this.stoppedAt?r[0]:this.runRecovery(r,s,n);if(o)return $t&&console.log("Force-finish "+this.stackID(o)),this.stackToTree(o.forceAll())}if(this.recovering){let o=this.recovering==1?1:this.recovering*3;if(n.length>o)for(n.sort((l,a)=>a.score-l.score);n.length>o;)n.pop();n.some(l=>l.reducePos>t)&&this.recovering--}else if(n.length>1){e:for(let o=0;o<n.length-1;o++){let l=n[o];for(let a=o+1;a<n.length;a++){let h=n[a];if(l.sameState(h)||l.buffer.length>500&&h.buffer.length>500)if((l.score-h.score||l.buffer.length-h.buffer.length)>0)n.splice(a--,1);else{n.splice(o--,1);continue e}}}n.length>12&&n.splice(12,n.length-12)}this.minStackPos=n[0].pos;for(let o=1;o<n.length;o++)n[o].pos<this.minStackPos&&(this.minStackPos=n[o].pos);return null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,t,n){let r=e.pos,{parser:s}=this,o=$t?this.stackID(e)+" -> ":"";if(this.stoppedAt!=null&&r>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let h=e.curContext&&e.curContext.tracker.strict,c=h?e.curContext.hash:0;for(let f=this.fragments.nodeAt(r);f;){let u=this.parser.nodeSet.types[f.type.id]==f.type?s.getGoto(e.state,f.type.id):-1;if(u>-1&&f.length&&(!h||(f.prop(B.contextHash)||0)==c))return e.useNode(f,u),$t&&console.log(o+this.stackID(e)+` (via reuse of ${s.getName(f.type.id)})`),!0;if(!(f instanceof F)||f.children.length==0||f.positions[0]>0)break;let d=f.children[0];if(d instanceof F&&f.positions[0]==0)f=d;else break}}let l=s.stateSlot(e.state,4);if(l>0)return e.reduce(l),$t&&console.log(o+this.stackID(e)+` (via always-reduce ${s.getName(l&65535)})`),!0;if(e.stack.length>=8400)for(;e.stack.length>6e3&&e.forceReduce(););let a=this.tokens.getActions(e);for(let h=0;h<a.length;){let c=a[h++],f=a[h++],u=a[h++],d=h==a.length||!n,p=d?e:e.split(),m=this.tokens.mainToken;if(p.apply(c,f,m?m.start:p.pos,u),$t&&console.log(o+this.stackID(p)+` (via ${c&65536?`reduce of ${s.getName(c&65535)}`:"shift"} for ${s.getName(f)} @ ${r}${p==e?"":", split"})`),d)return!0;p.pos>r?t.push(p):n.push(p)}return!1}advanceFully(e,t){let n=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>n)return Ny(e,t),!0}}runRecovery(e,t,n){let r=null,s=!1;for(let o=0;o<e.length;o++){let l=e[o],a=t[o<<1],h=t[(o<<1)+1],c=$t?this.stackID(l)+" -> ":"";if(l.deadEnd&&(s||(s=!0,l.restart(),$t&&console.log(c+this.stackID(l)+" (restarted)"),this.advanceFully(l,n))))continue;let f=l.split(),u=c;for(let d=0;f.forceReduce()&&d<10&&($t&&console.log(u+this.stackID(f)+" (via force-reduce)"),!this.advanceFully(f,n));d++)$t&&(u=this.stackID(f)+" -> ");for(let d of l.recoverByInsert(a))$t&&console.log(c+this.stackID(d)+" (via recover-insert)"),this.advanceFully(d,n);this.stream.end>l.pos?(h==l.pos&&(h++,a=0),l.recoverByDelete(a,h),$t&&console.log(c+this.stackID(l)+` (via recover-delete ${this.parser.getName(a)})`),Ny(l,n)):(!r||r.score<l.score)&&(r=l)}return r}stackToTree(e){return e.close(),F.build({buffer:mc.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let t=(ou||(ou=new WeakMap)).get(e);return t||ou.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}}function Ny(i,e){for(let t=0;t<e.length;t++){let n=e[t];if(n.pos==i.pos&&n.sameState(i)){e[t].score<i.score&&(e[t]=i);return}}e.push(i)}class XI{constructor(e,t,n){this.source=e,this.flags=t,this.disabled=n}allows(e){return!this.disabled||this.disabled[e]==0}}const lu=i=>i;class fv{constructor(e){this.start=e.start,this.shift=e.shift||lu,this.reduce=e.reduce||lu,this.reuse=e.reuse||lu,this.hash=e.hash||(()=>0),this.strict=e.strict!==!1}}class Ys extends Bc{constructor(e){if(super(),this.wrappers=[],e.version!=14)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let t=e.nodeNames.split(" ");this.minRepeatTerm=t.length;for(let l=0;l<e.repeatNodeCount;l++)t.push("");let n=Object.keys(e.topRules).map(l=>e.topRules[l][1]),r=[];for(let l=0;l<t.length;l++)r.push([]);function s(l,a,h){r[l].push([a,a.deserialize(String(h))])}if(e.nodeProps)for(let l of e.nodeProps){let a=l[0];typeof a=="string"&&(a=B[a]);for(let h=1;h<l.length;){let c=l[h++];if(c>=0)s(c,a,l[h++]);else{let f=l[h+-c];for(let u=-c;u>0;u--)s(l[h++],a,f);h++}}}this.nodeSet=new Hs(t.map((l,a)=>Me.define({name:a>=this.minRepeatTerm?void 0:l,id:a,props:r[a],top:n.indexOf(a)>-1,error:a==0,skipped:e.skippedNodes&&e.skippedNodes.indexOf(a)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=ew;let o=_o(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let l=0;l<this.specializerSpecs.length;l++)this.specialized[l]=this.specializerSpecs[l].term;this.specializers=this.specializerSpecs.map(Dy),this.states=_o(e.states,Uint32Array),this.data=_o(e.stateData),this.goto=_o(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(l=>typeof l=="number"?new Cs(o,l):l),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,t,n){let r=new WI(this,e,t,n);for(let s of this.wrappers)r=s(r,e,t,n);return r}getGoto(e,t,n=!1){let r=this.goto;if(t>=r[0])return-1;for(let s=r[t+1];;){let o=r[s++],l=o&1,a=r[s++];if(l&&n)return a;for(let h=s+(o>>1);s<h;s++)if(r[s]==e)return a;if(l)return-1}}hasAction(e,t){let n=this.data;for(let r=0;r<2;r++)for(let s=this.stateSlot(e,r?2:1),o;;s+=3){if((o=n[s])==65535)if(n[s+1]==1)o=n[s=Jn(n,s+2)];else{if(n[s+1]==2)return Jn(n,s+2);break}if(o==t||o==0)return Jn(n,s+1)}return 0}stateSlot(e,t){return this.states[e*6+t]}stateFlag(e,t){return(this.stateSlot(e,0)&t)>0}validAction(e,t){return!!this.allActions(e,n=>n==t?!0:null)}allActions(e,t){let n=this.stateSlot(e,4),r=n?t(n):void 0;for(let s=this.stateSlot(e,1);r==null;s+=3){if(this.data[s]==65535)if(this.data[s+1]==1)s=Jn(this.data,s+2);else break;r=t(Jn(this.data,s+1))}return r}nextStates(e){let t=[];for(let n=this.stateSlot(e,1);;n+=3){if(this.data[n]==65535)if(this.data[n+1]==1)n=Jn(this.data,n+2);else break;if(!(this.data[n+2]&1)){let r=this.data[n+1];t.some((s,o)=>o&1&&s==r)||t.push(this.data[n],r)}}return t}configure(e){let t=Object.assign(Object.create(Ys.prototype),this);if(e.props&&(t.nodeSet=this.nodeSet.extend(...e.props)),e.top){let n=this.topRules[e.top];if(!n)throw new RangeError(`Invalid top rule name ${e.top}`);t.top=n}return e.tokenizers&&(t.tokenizers=this.tokenizers.map(n=>{let r=e.tokenizers.find(s=>s.from==n);return r?r.to:n})),e.specializers&&(t.specializers=this.specializers.slice(),t.specializerSpecs=this.specializerSpecs.map((n,r)=>{let s=e.specializers.find(l=>l.from==n.external);if(!s)return n;let o=Object.assign(Object.assign({},n),{external:s.to});return t.specializers[r]=Dy(o),o})),e.contextTracker&&(t.context=e.contextTracker),e.dialect&&(t.dialect=this.parseDialect(e.dialect)),e.strict!=null&&(t.strict=e.strict),e.wrap&&(t.wrappers=t.wrappers.concat(e.wrap)),e.bufferLength!=null&&(t.bufferLength=e.bufferLength),t}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let t=this.dynamicPrecedences;return t==null?0:t[e]||0}parseDialect(e){let t=Object.keys(this.dialects),n=t.map(()=>!1);if(e)for(let s of e.split(" ")){let o=t.indexOf(s);o>=0&&(n[o]=!0)}let r=null;for(let s=0;s<t.length;s++)if(!n[s])for(let o=this.dialects[t[s]],l;(l=this.data[o++])!=65535;)(r||(r=new Uint8Array(this.maxTerm+1)))[l]=1;return new XI(e,n,r)}static deserialize(e){return new Ys(e)}}function Jn(i,e){return i[e]|i[e+1]<<16}function BI(i){let e=null;for(let t of i){let n=t.p.stoppedAt;(t.pos==t.p.stream.end||n!=null&&t.pos>n)&&t.p.parser.stateFlag(t.state,2)&&(!e||e.score<t.score)&&(e=t)}return e}function Dy(i){if(i.external){let e=i.extend?1:0;return(t,n)=>i.external(t,n)<<1|e}return i.get}const VI=54,qI=1,LI=55,zI=2,YI=56,jI=3,Iy=4,_I=5,Oc=6,uv=7,dv=8,pv=9,mv=10,FI=11,UI=12,GI=13,au=57,HI=14,Wy=58,gv=20,KI=22,Ov=23,JI=24,Jd=26,yv=27,eW=28,tW=31,nW=34,iW=36,rW=37,sW=0,oW=1,lW={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},aW={dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},Xy={dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}};function hW(i){return i==45||i==46||i==58||i>=65&&i<=90||i==95||i>=97&&i<=122||i>=161}function kv(i){return i==9||i==10||i==13||i==32}let By=null,Vy=null,qy=0;function ep(i,e){let t=i.pos+e;if(qy==t&&Vy==i)return By;let n=i.peek(e);for(;kv(n);)n=i.peek(++e);let r="";for(;hW(n);)r+=String.fromCharCode(n),n=i.peek(++e);return Vy=i,qy=t,By=r?r.toLowerCase():n==cW||n==fW?void 0:null}const bv=60,yc=62,vm=47,cW=63,fW=33,uW=45;function Ly(i,e){this.name=i,this.parent=e,this.hash=e?e.hash:0;for(let t=0;t<i.length;t++)this.hash+=(this.hash<<4)+i.charCodeAt(t)+(i.charCodeAt(t)<<8)}const dW=[Oc,mv,uv,dv,pv],pW=new fv({start:null,shift(i,e,t,n){return dW.indexOf(e)>-1?new Ly(ep(n,1)||"",i):i},reduce(i,e){return e==gv&&i?i.parent:i},reuse(i,e,t,n){let r=e.type.id;return r==Oc||r==iW?new Ly(ep(n,1)||"",i):i},hash(i){return i?i.hash:0},strict:!1}),mW=new kn((i,e)=>{if(i.next!=bv){i.next<0&&e.context&&i.acceptToken(au);return}i.advance();let t=i.next==vm;t&&i.advance();let n=ep(i,0);if(n===void 0)return;if(!n)return i.acceptToken(t?HI:Oc);let r=e.context?e.context.name:null;if(t){if(n==r)return i.acceptToken(FI);if(r&&aW[r])return i.acceptToken(au,-2);if(e.dialectEnabled(sW))return i.acceptToken(UI);for(let s=e.context;s;s=s.parent)if(s.name==n)return;i.acceptToken(GI)}else{if(n=="script")return i.acceptToken(uv);if(n=="style")return i.acceptToken(dv);if(n=="textarea")return i.acceptToken(pv);if(lW.hasOwnProperty(n))return i.acceptToken(mv);r&&Xy[r]&&Xy[r][n]?i.acceptToken(au,-1):i.acceptToken(Oc)}},{contextual:!0}),gW=new kn(i=>{for(let e=0,t=0;;t++){if(i.next<0){t&&i.acceptToken(Wy);break}if(i.next==uW)e++;else if(i.next==yc&&e>=2){t>=3&&i.acceptToken(Wy,-2);break}else e=0;i.advance()}});function OW(i){for(;i;i=i.parent)if(i.name=="svg"||i.name=="math")return!0;return!1}const yW=new kn((i,e)=>{if(i.next==vm&&i.peek(1)==yc){let t=e.dialectEnabled(oW)||OW(e.context);i.acceptToken(t?_I:Iy,2)}else i.next==yc&&i.acceptToken(Iy,1)});function $m(i,e,t){let n=2+i.length;return new kn(r=>{for(let s=0,o=0,l=0;;l++){if(r.next<0){l&&r.acceptToken(e);break}if(s==0&&r.next==bv||s==1&&r.next==vm||s>=2&&s<n&&r.next==i.charCodeAt(s-2))s++,o++;else if((s==2||s==n)&&kv(r.next))o++;else if(s==n&&r.next==yc){l>o?r.acceptToken(e,-o):r.acceptToken(t,-(o-2));break}else if((r.next==10||r.next==13)&&l){r.acceptToken(e,1);break}else s=o=0;r.advance()}})}const kW=$m("script",VI,qI),bW=$m("style",LI,zI),SW=$m("textarea",YI,jI),wW=Ks({"Text RawText":O.content,"StartTag StartCloseTag SelfClosingEndTag EndTag":O.angleBracket,TagName:O.tagName,"MismatchedCloseTag/TagName":[O.tagName,O.invalid],AttributeName:O.attributeName,"AttributeValue UnquotedAttributeValue":O.attributeValue,Is:O.definitionOperator,"EntityReference CharacterReference":O.character,Comment:O.blockComment,ProcessingInst:O.processingInstruction,DoctypeDecl:O.documentMeta}),xW=Ys.deserialize({version:14,states:",xOVO!rOOO!WQ#tO'#CqO!]Q#tO'#CzO!bQ#tO'#C}O!gQ#tO'#DQO!lQ#tO'#DSO!qOaO'#CpO!|ObO'#CpO#XOdO'#CpO$eO!rO'#CpOOO`'#Cp'#CpO$lO$fO'#DTO$tQ#tO'#DVO$yQ#tO'#DWOOO`'#Dk'#DkOOO`'#DY'#DYQVO!rOOO%OQ&rO,59]O%ZQ&rO,59fO%fQ&rO,59iO%qQ&rO,59lO%|Q&rO,59nOOOa'#D^'#D^O&XOaO'#CxO&dOaO,59[OOOb'#D_'#D_O&lObO'#C{O&wObO,59[OOOd'#D`'#D`O'POdO'#DOO'[OdO,59[OOO`'#Da'#DaO'dO!rO,59[O'kQ#tO'#DROOO`,59[,59[OOOp'#Db'#DbO'pO$fO,59oOOO`,59o,59oO'xQ#|O,59qO'}Q#|O,59rOOO`-E7W-E7WO(SQ&rO'#CsOOQW'#DZ'#DZO(bQ&rO1G.wOOOa1G.w1G.wOOO`1G/Y1G/YO(mQ&rO1G/QOOOb1G/Q1G/QO(xQ&rO1G/TOOOd1G/T1G/TO)TQ&rO1G/WOOO`1G/W1G/WO)`Q&rO1G/YOOOa-E7[-E7[O)kQ#tO'#CyOOO`1G.v1G.vOOOb-E7]-E7]O)pQ#tO'#C|OOOd-E7^-E7^O)uQ#tO'#DPOOO`-E7_-E7_O)zQ#|O,59mOOOp-E7`-E7`OOO`1G/Z1G/ZOOO`1G/]1G/]OOO`1G/^1G/^O*PQ,UO,59_OOQW-E7X-E7XOOOa7+$c7+$cOOO`7+$t7+$tOOOb7+$l7+$lOOOd7+$o7+$oOOO`7+$r7+$rO*[Q#|O,59eO*aQ#|O,59hO*fQ#|O,59kOOO`1G/X1G/XO*kO7[O'#CvO*|OMhO'#CvOOQW1G.y1G.yOOO`1G/P1G/POOO`1G/S1G/SOOO`1G/V1G/VOOOO'#D['#D[O+_O7[O,59bOOQW,59b,59bOOOO'#D]'#D]O+pOMhO,59bOOOO-E7Y-E7YOOQW1G.|1G.|OOOO-E7Z-E7Z",stateData:",]~O!^OS~OUSOVPOWQOXROYTO[]O][O^^O`^Oa^Ob^Oc^Ox^O{_O!dZO~OfaO~OfbO~OfcO~OfdO~OfeO~O!WfOPlP!ZlP~O!XiOQoP!ZoP~O!YlORrP!ZrP~OUSOVPOWQOXROYTOZqO[]O][O^^O`^Oa^Ob^Oc^Ox^O!dZO~O!ZrO~P#dO![sO!euO~OfvO~OfwO~OS|OT}OhyO~OS!POT}OhyO~OS!ROT}OhyO~OS!TOT}OhyO~OS}OT}OhyO~O!WfOPlX!ZlX~OP!WO!Z!XO~O!XiOQoX!ZoX~OQ!ZO!Z!XO~O!YlORrX!ZrX~OR!]O!Z!XO~O!Z!XO~P#dOf!_O~O![sO!e!aO~OS!bO~OS!cO~Oi!dOSgXTgXhgX~OS!fOT!gOhyO~OS!hOT!gOhyO~OS!iOT!gOhyO~OS!jOT!gOhyO~OS!gOT!gOhyO~Of!kO~Of!lO~Of!mO~OS!nO~Ok!qO!`!oO!b!pO~OS!rO~OS!sO~OS!tO~Oa!uOb!uOc!uO!`!wO!a!uO~Oa!xOb!xOc!xO!b!wO!c!xO~Oa!uOb!uOc!uO!`!{O!a!uO~Oa!xOb!xOc!xO!b!{O!c!xO~OT~bac!dx{!d~",goto:"%p!`PPPPPPPPPPPPPPPPPPPP!a!gP!mPP!yP!|#P#S#Y#]#`#f#i#l#r#x!aP!a!aP$O$U$l$r$x%O%U%[%bPPPPPPPP%hX^OX`pXUOX`pezabcde{!O!Q!S!UR!q!dRhUR!XhXVOX`pRkVR!XkXWOX`pRnWR!XnXXOX`pQrXR!XpXYOX`pQ`ORx`Q{aQ!ObQ!QcQ!SdQ!UeZ!e{!O!Q!S!UQ!v!oR!z!vQ!y!pR!|!yQgUR!VgQjVR!YjQmWR![mQpXR!^pQtZR!`tS_O`ToXp",nodeNames:" StartCloseTag StartCloseTag StartCloseTag EndTag SelfClosingEndTag StartTag StartTag StartTag StartTag StartTag StartCloseTag StartCloseTag StartCloseTag IncompleteCloseTag Document Text EntityReference CharacterReference InvalidEntity Element OpenTag TagName Attribute AttributeName Is AttributeValue UnquotedAttributeValue ScriptText CloseTag OpenTag StyleText CloseTag OpenTag TextareaText CloseTag OpenTag CloseTag SelfClosingTag Comment ProcessingInst MismatchedCloseTag CloseTag DoctypeDecl",maxTerm:67,context:pW,nodeProps:[["closedBy",-10,1,2,3,7,8,9,10,11,12,13,"EndTag",6,"EndTag SelfClosingEndTag",-4,21,30,33,36,"CloseTag"],["openedBy",4,"StartTag StartCloseTag",5,"StartTag",-4,29,32,35,37,"OpenTag"],["group",-9,14,17,18,19,20,39,40,41,42,"Entity",16,"Entity TextContent",-3,28,31,34,"TextContent Entity"],["isolate",-11,21,29,30,32,33,35,36,37,38,41,42,"ltr",-3,26,27,39,""]],propSources:[wW],skippedNodes:[0],repeatNodeCount:9,tokenData:"!<p!aR!YOX$qXY,QYZ,QZ[$q[]&X]^,Q^p$qpq,Qqr-_rs3_sv-_vw3}wxHYx}-_}!OH{!O!P-_!P!Q$q!Q![-_![!]Mz!]!^-_!^!_!$S!_!`!;x!`!a&X!a!c-_!c!}Mz!}#R-_#R#SMz#S#T1k#T#oMz#o#s-_#s$f$q$f%W-_%W%oMz%o%p-_%p&aMz&a&b-_&b1pMz1p4U-_4U4dMz4d4e-_4e$ISMz$IS$I`-_$I`$IbMz$Ib$Kh-_$Kh%#tMz%#t&/x-_&/x&EtMz&Et&FV-_&FV;'SMz;'S;:j!#|;:j;=`3X<%l?&r-_?&r?AhMz?Ah?BY$q?BY?MnMz?MnO$q!Z$|c`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr$qrs&}sv$qvw+Pwx(tx!^$q!^!_*V!_!a&X!a#S$q#S#T&X#T;'S$q;'S;=`+z<%lO$q!R&bX`P!a`!cpOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&Xq'UV`P!cpOv&}wx'kx!^&}!^!_(V!_;'S&};'S;=`(n<%lO&}P'pT`POv'kw!^'k!_;'S'k;'S;=`(P<%lO'kP(SP;=`<%l'kp([S!cpOv(Vx;'S(V;'S;=`(h<%lO(Vp(kP;=`<%l(Vq(qP;=`<%l&}a({W`P!a`Or(trs'ksv(tw!^(t!^!_)e!_;'S(t;'S;=`*P<%lO(t`)jT!a`Or)esv)ew;'S)e;'S;=`)y<%lO)e`)|P;=`<%l)ea*SP;=`<%l(t!Q*^V!a`!cpOr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!Q*vP;=`<%l*V!R*|P;=`<%l&XW+UYkWOX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+PW+wP;=`<%l+P!Z+}P;=`<%l$q!a,]``P!a`!cp!^^OX&XXY,QYZ,QZ]&X]^,Q^p&Xpq,Qqr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X!_-ljhS`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx!P-_!P!Q$q!Q!^-_!^!_*V!_!a&X!a#S-_#S#T1k#T#s-_#s$f$q$f;'S-_;'S;=`3X<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q[/ebhSkWOX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!a#S/^#S#T0m#T#s/^#s$f+P$f;'S/^;'S;=`1e<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+PS0rXhSqr0msw0mx!P0m!Q!^0m!a#s0m$f;'S0m;'S;=`1_<%l?Ah0m?BY?Mn0mS1bP;=`<%l0m[1hP;=`<%l/^!V1vchS`P!a`!cpOq&Xqr1krs&}sv1kvw0mwx(tx!P1k!P!Q&X!Q!^1k!^!_*V!_!a&X!a#s1k#s$f&X$f;'S1k;'S;=`3R<%l?Ah1k?Ah?BY&X?BY?Mn1k?MnO&X!V3UP;=`<%l1k!_3[P;=`<%l-_!Z3hV!`h`P!cpOv&}wx'kx!^&}!^!_(V!_;'S&};'S;=`(n<%lO&}!_4WihSkWc!ROX5uXZ7SZ[5u[^7S^p5uqr8trs7Sst>]tw8twx7Sx!P8t!P!Q5u!Q!]8t!]!^/^!^!a7S!a#S8t#S#T;{#T#s8t#s$f5u$f;'S8t;'S;=`>V<%l?Ah8t?Ah?BY5u?BY?Mn8t?MnO5u!Z5zbkWOX5uXZ7SZ[5u[^7S^p5uqr5urs7Sst+Ptw5uwx7Sx!]5u!]!^7w!^!a7S!a#S5u#S#T7S#T;'S5u;'S;=`8n<%lO5u!R7VVOp7Sqs7St!]7S!]!^7l!^;'S7S;'S;=`7q<%lO7S!R7qOa!R!R7tP;=`<%l7S!Z8OYkWa!ROX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+P!Z8qP;=`<%l5u!_8{ihSkWOX5uXZ7SZ[5u[^7S^p5uqr8trs7Sst/^tw8twx7Sx!P8t!P!Q5u!Q!]8t!]!^:j!^!a7S!a#S8t#S#T;{#T#s8t#s$f5u$f;'S8t;'S;=`>V<%l?Ah8t?Ah?BY5u?BY?Mn8t?MnO5u!_:sbhSkWa!ROX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!a#S/^#S#T0m#T#s/^#s$f+P$f;'S/^;'S;=`1e<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+P!V<QchSOp7Sqr;{rs7Sst0mtw;{wx7Sx!P;{!P!Q7S!Q!];{!]!^=]!^!a7S!a#s;{#s$f7S$f;'S;{;'S;=`>P<%l?Ah;{?Ah?BY7S?BY?Mn;{?MnO7S!V=dXhSa!Rqr0msw0mx!P0m!Q!^0m!a#s0m$f;'S0m;'S;=`1_<%l?Ah0m?BY?Mn0m!V>SP;=`<%l;{!_>YP;=`<%l8t!_>dhhSkWOX@OXZAYZ[@O[^AY^p@OqrBwrsAYswBwwxAYx!PBw!P!Q@O!Q!]Bw!]!^/^!^!aAY!a#SBw#S#TE{#T#sBw#s$f@O$f;'SBw;'S;=`HS<%l?AhBw?Ah?BY@O?BY?MnBw?MnO@O!Z@TakWOX@OXZAYZ[@O[^AY^p@Oqr@OrsAYsw@OwxAYx!]@O!]!^Az!^!aAY!a#S@O#S#TAY#T;'S@O;'S;=`Bq<%lO@O!RA]UOpAYq!]AY!]!^Ao!^;'SAY;'S;=`At<%lOAY!RAtOb!R!RAwP;=`<%lAY!ZBRYkWb!ROX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+P!ZBtP;=`<%l@O!_COhhSkWOX@OXZAYZ[@O[^AY^p@OqrBwrsAYswBwwxAYx!PBw!P!Q@O!Q!]Bw!]!^Dj!^!aAY!a#SBw#S#TE{#T#sBw#s$f@O$f;'SBw;'S;=`HS<%l?AhBw?Ah?BY@O?BY?MnBw?MnO@O!_DsbhSkWb!ROX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!a#S/^#S#T0m#T#s/^#s$f+P$f;'S/^;'S;=`1e<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+P!VFQbhSOpAYqrE{rsAYswE{wxAYx!PE{!P!QAY!Q!]E{!]!^GY!^!aAY!a#sE{#s$fAY$f;'SE{;'S;=`G|<%l?AhE{?Ah?BYAY?BY?MnE{?MnOAY!VGaXhSb!Rqr0msw0mx!P0m!Q!^0m!a#s0m$f;'S0m;'S;=`1_<%l?Ah0m?BY?Mn0m!VHPP;=`<%lE{!_HVP;=`<%lBw!ZHcW!bx`P!a`Or(trs'ksv(tw!^(t!^!_)e!_;'S(t;'S;=`*P<%lO(t!aIYlhS`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx}-_}!OKQ!O!P-_!P!Q$q!Q!^-_!^!_*V!_!a&X!a#S-_#S#T1k#T#s-_#s$f$q$f;'S-_;'S;=`3X<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q!aK_khS`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx!P-_!P!Q$q!Q!^-_!^!_*V!_!`&X!`!aMS!a#S-_#S#T1k#T#s-_#s$f$q$f;'S-_;'S;=`3X<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q!TM_X`P!a`!cp!eQOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X!aNZ!ZhSfQ`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx}-_}!OMz!O!PMz!P!Q$q!Q![Mz![!]Mz!]!^-_!^!_*V!_!a&X!a!c-_!c!}Mz!}#R-_#R#SMz#S#T1k#T#oMz#o#s-_#s$f$q$f$}-_$}%OMz%O%W-_%W%oMz%o%p-_%p&aMz&a&b-_&b1pMz1p4UMz4U4dMz4d4e-_4e$ISMz$IS$I`-_$I`$IbMz$Ib$Je-_$Je$JgMz$Jg$Kh-_$Kh%#tMz%#t&/x-_&/x&EtMz&Et&FV-_&FV;'SMz;'S;:j!#|;:j;=`3X<%l?&r-_?&r?AhMz?Ah?BY$q?BY?MnMz?MnO$q!a!$PP;=`<%lMz!R!$ZY!a`!cpOq*Vqr!$yrs(Vsv*Vwx)ex!a*V!a!b!4t!b;'S*V;'S;=`*s<%lO*V!R!%Q]!a`!cpOr*Vrs(Vsv*Vwx)ex}*V}!O!%y!O!f*V!f!g!']!g#W*V#W#X!0`#X;'S*V;'S;=`*s<%lO*V!R!&QX!a`!cpOr*Vrs(Vsv*Vwx)ex}*V}!O!&m!O;'S*V;'S;=`*s<%lO*V!R!&vV!a`!cp!dPOr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!R!'dX!a`!cpOr*Vrs(Vsv*Vwx)ex!q*V!q!r!(P!r;'S*V;'S;=`*s<%lO*V!R!(WX!a`!cpOr*Vrs(Vsv*Vwx)ex!e*V!e!f!(s!f;'S*V;'S;=`*s<%lO*V!R!(zX!a`!cpOr*Vrs(Vsv*Vwx)ex!v*V!v!w!)g!w;'S*V;'S;=`*s<%lO*V!R!)nX!a`!cpOr*Vrs(Vsv*Vwx)ex!{*V!{!|!*Z!|;'S*V;'S;=`*s<%lO*V!R!*bX!a`!cpOr*Vrs(Vsv*Vwx)ex!r*V!r!s!*}!s;'S*V;'S;=`*s<%lO*V!R!+UX!a`!cpOr*Vrs(Vsv*Vwx)ex!g*V!g!h!+q!h;'S*V;'S;=`*s<%lO*V!R!+xY!a`!cpOr!+qrs!,hsv!+qvw!-Swx!.[x!`!+q!`!a!/j!a;'S!+q;'S;=`!0Y<%lO!+qq!,mV!cpOv!,hvx!-Sx!`!,h!`!a!-q!a;'S!,h;'S;=`!.U<%lO!,hP!-VTO!`!-S!`!a!-f!a;'S!-S;'S;=`!-k<%lO!-SP!-kO{PP!-nP;=`<%l!-Sq!-xS!cp{POv(Vx;'S(V;'S;=`(h<%lO(Vq!.XP;=`<%l!,ha!.aX!a`Or!.[rs!-Ssv!.[vw!-Sw!`!.[!`!a!.|!a;'S!.[;'S;=`!/d<%lO!.[a!/TT!a`{POr)esv)ew;'S)e;'S;=`)y<%lO)ea!/gP;=`<%l!.[!R!/sV!a`!cp{POr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!R!0]P;=`<%l!+q!R!0gX!a`!cpOr*Vrs(Vsv*Vwx)ex#c*V#c#d!1S#d;'S*V;'S;=`*s<%lO*V!R!1ZX!a`!cpOr*Vrs(Vsv*Vwx)ex#V*V#V#W!1v#W;'S*V;'S;=`*s<%lO*V!R!1}X!a`!cpOr*Vrs(Vsv*Vwx)ex#h*V#h#i!2j#i;'S*V;'S;=`*s<%lO*V!R!2qX!a`!cpOr*Vrs(Vsv*Vwx)ex#m*V#m#n!3^#n;'S*V;'S;=`*s<%lO*V!R!3eX!a`!cpOr*Vrs(Vsv*Vwx)ex#d*V#d#e!4Q#e;'S*V;'S;=`*s<%lO*V!R!4XX!a`!cpOr*Vrs(Vsv*Vwx)ex#X*V#X#Y!+q#Y;'S*V;'S;=`*s<%lO*V!R!4{Y!a`!cpOr!4trs!5ksv!4tvw!6Vwx!8]x!a!4t!a!b!:]!b;'S!4t;'S;=`!;r<%lO!4tq!5pV!cpOv!5kvx!6Vx!a!5k!a!b!7W!b;'S!5k;'S;=`!8V<%lO!5kP!6YTO!a!6V!a!b!6i!b;'S!6V;'S;=`!7Q<%lO!6VP!6lTO!`!6V!`!a!6{!a;'S!6V;'S;=`!7Q<%lO!6VP!7QOxPP!7TP;=`<%l!6Vq!7]V!cpOv!5kvx!6Vx!`!5k!`!a!7r!a;'S!5k;'S;=`!8V<%lO!5kq!7yS!cpxPOv(Vx;'S(V;'S;=`(h<%lO(Vq!8YP;=`<%l!5ka!8bX!a`Or!8]rs!6Vsv!8]vw!6Vw!a!8]!a!b!8}!b;'S!8];'S;=`!:V<%lO!8]a!9SX!a`Or!8]rs!6Vsv!8]vw!6Vw!`!8]!`!a!9o!a;'S!8];'S;=`!:V<%lO!8]a!9vT!a`xPOr)esv)ew;'S)e;'S;=`)y<%lO)ea!:YP;=`<%l!8]!R!:dY!a`!cpOr!4trs!5ksv!4tvw!6Vwx!8]x!`!4t!`!a!;S!a;'S!4t;'S;=`!;r<%lO!4t!R!;]V!a`!cpxPOr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!R!;uP;=`<%l!4t!V!<TXiS`P!a`!cpOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X",tokenizers:[kW,bW,SW,yW,mW,gW,0,1,2,3,4,5],topRules:{Document:[0,15]},dialects:{noMatch:0,selfClosing:509},tokenPrec:511});function Sv(i,e){let t=Object.create(null);for(let n of i.getChildren(Ov)){let r=n.getChild(JI),s=n.getChild(Jd)||n.getChild(yv);r&&(t[e.read(r.from,r.to)]=s?s.type.id==Jd?e.read(s.from+1,s.to-1):e.read(s.from,s.to):"")}return t}function zy(i,e){let t=i.getChild(KI);return t?e.read(t.from,t.to):" "}function hu(i,e,t){let n;for(let r of t)if(!r.attrs||r.attrs(n||(n=Sv(i.node.parent.firstChild,e))))return{parser:r.parser};return null}function wv(i=[],e=[]){let t=[],n=[],r=[],s=[];for(let l of i)(l.tag=="script"?t:l.tag=="style"?n:l.tag=="textarea"?r:s).push(l);let o=e.length?Object.create(null):null;for(let l of e)(o[l.name]||(o[l.name]=[])).push(l);return sw((l,a)=>{let h=l.type.id;if(h==eW)return hu(l,a,t);if(h==tW)return hu(l,a,n);if(h==nW)return hu(l,a,r);if(h==gv&&s.length){let c=l.node,f=c.firstChild,u=f&&zy(f,a),d;if(u){for(let p of s)if(p.tag==u&&(!p.attrs||p.attrs(d||(d=Sv(c,a))))){let m=c.lastChild,g=m.type.id==rW?m.from:c.to;if(g>f.to)return{parser:p.parser,overlay:[{from:f.to,to:g}]}}}}if(o&&h==Ov){let c=l.node,f;if(f=c.firstChild){let u=o[a.read(f.from,f.to)];if(u)for(let d of u){if(d.tagName&&d.tagName!=zy(c.parent,a))continue;let p=c.lastChild;if(p.type.id==Jd){let m=p.from+1,g=p.lastChild,y=p.to-(g&&g.isError?0:1);if(y>m)return{parser:d.parser,overlay:[{from:m,to:y}]}}else if(p.type.id==yv)return{parser:d.parser,overlay:[{from:p.from,to:p.to}]}}}}return null})}const vW=99,Yy=1,$W=100,PW=101,jy=2,xv=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],QW=58,CW=40,vv=95,TW=91,Th=45,MW=46,AW=35,ZW=37,RW=38,EW=92,NW=10;function Vl(i){return i>=65&&i<=90||i>=97&&i<=122||i>=161}function $v(i){return i>=48&&i<=57}const DW=new kn((i,e)=>{for(let t=!1,n=0,r=0;;r++){let{next:s}=i;if(Vl(s)||s==Th||s==vv||t&&$v(s))!t&&(s!=Th||r>0)&&(t=!0),n===r&&s==Th&&n++,i.advance();else if(s==EW&&i.peek(1)!=NW)i.advance(),i.next>-1&&i.advance(),t=!0;else{t&&i.acceptToken(s==CW?$W:n==2&&e.canShift(jy)?jy:PW);break}}}),IW=new kn(i=>{if(xv.includes(i.peek(-1))){let{next:e}=i;(Vl(e)||e==vv||e==AW||e==MW||e==TW||e==QW&&Vl(i.peek(1))||e==Th||e==RW)&&i.acceptToken(vW)}}),WW=new kn(i=>{if(!xv.includes(i.peek(-1))){let{next:e}=i;if(e==ZW&&(i.advance(),i.acceptToken(Yy)),Vl(e)){do i.advance();while(Vl(i.next)||$v(i.next));i.acceptToken(Yy)}}}),XW=Ks({"AtKeyword import charset namespace keyframes media supports":O.definitionKeyword,"from to selector":O.keyword,NamespaceName:O.namespace,KeyframeName:O.labelName,KeyframeRangeName:O.operatorKeyword,TagName:O.tagName,ClassName:O.className,PseudoClassName:O.constant(O.className),IdName:O.labelName,"FeatureName PropertyName":O.propertyName,AttributeName:O.attributeName,NumberLiteral:O.number,KeywordQuery:O.keyword,UnaryQueryOp:O.operatorKeyword,"CallTag ValueName":O.atom,VariableName:O.variableName,Callee:O.operatorKeyword,Unit:O.unit,"UniversalSelector NestingSelector":O.definitionOperator,MatchOp:O.compareOperator,"ChildOp SiblingOp, LogicOp":O.logicOperator,BinOp:O.arithmeticOperator,Important:O.modifier,Comment:O.blockComment,ColorLiteral:O.color,"ParenthesizedContent StringLiteral":O.string,":":O.punctuation,"PseudoOp #":O.derefOperator,"; ,":O.separator,"( )":O.paren,"[ ]":O.squareBracket,"{ }":O.brace}),BW={__proto__:null,lang:32,"nth-child":32,"nth-last-child":32,"nth-of-type":32,"nth-last-of-type":32,dir:32,"host-context":32,url:60,"url-prefix":60,domain:60,regexp:60,selector:138},VW={__proto__:null,"@import":118,"@media":142,"@charset":146,"@namespace":150,"@keyframes":156,"@supports":168},qW={__proto__:null,not:132,only:132},LW=Ys.deserialize({version:14,states:":^QYQ[OOO#_Q[OOP#fOWOOOOQP'#Cd'#CdOOQP'#Cc'#CcO#kQ[O'#CfO$_QXO'#CaO$fQ[O'#ChO$qQ[O'#DTO$vQ[O'#DWOOQP'#Em'#EmO${QdO'#DgO%jQ[O'#DtO${QdO'#DvO%{Q[O'#DxO&WQ[O'#D{O&`Q[O'#ERO&nQ[O'#ETOOQS'#El'#ElOOQS'#EW'#EWQYQ[OOO&uQXO'#CdO'jQWO'#DcO'oQWO'#EsO'zQ[O'#EsQOQWOOP(UO#tO'#C_POOO)C@[)C@[OOQP'#Cg'#CgOOQP,59Q,59QO#kQ[O,59QO(aQ[O'#E[O({QWO,58{O)TQ[O,59SO$qQ[O,59oO$vQ[O,59rO(aQ[O,59uO(aQ[O,59wO(aQ[O,59xO)`Q[O'#DbOOQS,58{,58{OOQP'#Ck'#CkOOQO'#DR'#DROOQP,59S,59SO)gQWO,59SO)lQWO,59SOOQP'#DV'#DVOOQP,59o,59oOOQO'#DX'#DXO)qQ`O,59rOOQS'#Cp'#CpO${QdO'#CqO)yQvO'#CsO+ZQtO,5:ROOQO'#Cx'#CxO)lQWO'#CwO+oQWO'#CyO+tQ[O'#DOOOQS'#Ep'#EpOOQO'#Dj'#DjO+|Q[O'#DqO,[QWO'#EtO&`Q[O'#DoO,jQWO'#DrOOQO'#Eu'#EuO)OQWO,5:`O,oQpO,5:bOOQS'#Dz'#DzO,wQWO,5:dO,|Q[O,5:dOOQO'#D}'#D}O-UQWO,5:gO-ZQWO,5:mO-cQWO,5:oOOQS-E8U-E8UO${QdO,59}O-kQ[O'#E^O-xQWO,5;_O-xQWO,5;_POOO'#EV'#EVP.TO#tO,58yPOOO,58y,58yOOQP1G.l1G.lO.zQXO,5:vOOQO-E8Y-E8YOOQS1G.g1G.gOOQP1G.n1G.nO)gQWO1G.nO)lQWO1G.nOOQP1G/Z1G/ZO/XQ`O1G/^O/rQXO1G/aO0YQXO1G/cO0pQXO1G/dO1WQWO,59|O1]Q[O'#DSO1dQdO'#CoOOQP1G/^1G/^O${QdO1G/^O1kQpO,59]OOQS,59_,59_O${QdO,59aO1sQWO1G/mOOQS,59c,59cO1xQ!bO,59eOOQS'#DP'#DPOOQS'#EY'#EYO2QQ[O,59jOOQS,59j,59jO2YQWO'#DjO2eQWO,5:VO2jQWO,5:]O&`Q[O,5:XO&`Q[O'#E_O2rQWO,5;`O2}QWO,5:ZO(aQ[O,5:^OOQS1G/z1G/zOOQS1G/|1G/|OOQS1G0O1G0OO3`QWO1G0OO3eQdO'#EOOOQS1G0R1G0ROOQS1G0X1G0XOOQS1G0Z1G0ZO3pQtO1G/iOOQO,5:x,5:xO4WQ[O,5:xOOQO-E8[-E8[O4eQWO1G0yPOOO-E8T-E8TPOOO1G.e1G.eOOQP7+$Y7+$YOOQP7+$x7+$xO${QdO7+$xOOQS1G/h1G/hO4pQXO'#ErO4wQWO,59nO4|QtO'#EXO5tQdO'#EoO6OQWO,59ZO6TQpO7+$xOOQS1G.w1G.wOOQS1G.{1G.{OOQS7+%X7+%XO6]QWO1G/POOQS-E8W-E8WOOQS1G/U1G/UO${QdO1G/qOOQO1G/w1G/wOOQO1G/s1G/sO6bQWO,5:yOOQO-E8]-E8]O6pQXO1G/xOOQS7+%j7+%jO6wQYO'#CsOOQO'#EQ'#EQO7SQ`O'#EPOOQO'#EP'#EPO7_QWO'#E`O7gQdO,5:jOOQS,5:j,5:jO7rQtO'#E]O${QdO'#E]O8sQdO7+%TOOQO7+%T7+%TOOQO1G0d1G0dO9WQpO<<HdO9`QWO,5;^OOQP1G/Y1G/YOOQS-E8V-E8VO${QdO'#EZO9hQWO,5;ZOOQT1G.u1G.uOOQP<<Hd<<HdOOQS7+$k7+$kO9pQdO7+%]OOQO7+%d7+%dOOQO,5:k,5:kO3hQdO'#EaO7_QWO,5:zOOQS,5:z,5:zOOQS-E8^-E8^OOQS1G0U1G0UO9wQtO,5:wOOQS-E8Z-E8ZOOQO<<Ho<<HoOOQPAN>OAN>OO:xQdO,5:uOOQO-E8X-E8XOOQO<<Hw<<HwOOQO,5:{,5:{OOQO-E8_-E8_OOQS1G0f1G0f",stateData:";[~O#ZOS#[QQ~OUYOXYO]VO^VOqXOxWO![aO!]ZO!i[O!k]O!m^O!p_O!v`O#XRO#bTO~OQfOUYOXYO]VO^VOqXOxWO![aO!]ZO!i[O!k]O!m^O!p_O!v`O#XeO#bTO~O#U#gP~P!ZO#[jO~O#XlO~O]qO^qOqsOtoOxrO!OtO!RvO#VuO#bnO~O!TwO~P#pO`}O#WzO#XyO~O#X!OO~O#X!QO~OQ![Ob!TOf![Oh![On!YOq!ZO#W!WO#X!SO#e!UO~Ob!^O!d!`O!g!aO#X!]O!T#hP~Oh!fOn!YO#X!eO~Oh!hO#X!hO~Ob!^O!d!`O!g!aO#X!]O~O!Y#hP~P%jO]WX]!WX^WXqWXtWXxWX!OWX!RWX!TWX#VWX#bWX~O]!mO~O!Y!nO#U#gX!S#gX~O#U#gX!S#gX~P!ZO#]!qO#^!qO#_!sO~OUYOXYO]VO^VOqXOxWO#XRO#bTO~OtoO!TwO~O`!zO#WzO#XyO~O!S#gP~P!ZOb#RO~Ob#SO~Op#TO|#UO~OP#WObgXjgX!YgX!dgX!ggX#XgXagXQgXfgXhgXngXqgXtgX!XgX#UgX#WgX#egXpgX!SgX~Ob!^Oj#XO!d!`O!g!aO#X!]O!Y#hP~Ob#[O~Op#`O#X#]O~Ob!^O!d!`O!g!aO#X#aO~Ot#eO!b#dO!T#hX!Y#hX~Ob#hO~Oj#XO!Y#jO~O!Y#kO~Oh#lOn!YO~O!T#mO~O!TwO!b#dO~O!TwO!Y#pO~O!Y#QX#U#QX!S#QX~P!ZO!Y!nO#U#ga!S#ga~O#]!qO#^!qO#_#wO~O]qO^qOqsOxrO!OtO!RvO#VuO#bnO~Ot#Oa!T#Oaa#Oa~P.`Op#yO|#zO~O]qO^qOqsOxrO#bnO~Ot}i!O}i!R}i!T}i#V}ia}i~P/aOt!Pi!O!Pi!R!Pi!T!Pi#V!Pia!Pi~P/aOt!Qi!O!Qi!R!Qi!T!Qi#V!Qia!Qi~P/aO!S#{O~Oa#fP~P(aOa#cP~P${Oa$SOj#XO~O!Y$UO~Oh$VOo$VO~Op$XO#X#]O~O]!`Xa!^X!b!^X~O]$YO~Oa$ZO!b#dO~Ot#eO!T#ha!Y#ha~O!b#dOt!ca!T!ca!Y!caa!ca~O!Y$`O~O!S$gO#X$bO#e$aO~Oj#XOt$iO!X$kO!Y!Vi#U!Vi!S!Vi~P${O!Y#Qa#U#Qa!S#Qa~P!ZO!Y!nO#U#gi!S#gi~Oa#fX~P#pOa$oO~Oj#XOQ!{Xa!{Xb!{Xf!{Xh!{Xn!{Xq!{Xt!{X#W!{X#X!{X#e!{X~Ot$qOa#cX~P${Oa$sO~Oj#XOp$tO~Oa$uO~O!b#dOt#Ra!T#Ra!Y#Ra~Oa$wO~P.`OP#WOtgX!TgX~O#e$aOt!sX!T!sX~Ot$yO!TwO~O!S$}O#X$bO#e$aO~Oj#XOQ#PXb#PXf#PXh#PXn#PXq#PXt#PX!X#PX!Y#PX#U#PX#W#PX#X#PX#e#PX!S#PX~Ot$iO!X%QO!Y!Vq#U!Vq!S!Vq~P${Oj#XOp%RO~OtoOa#fa~Ot$qOa#ca~Oa%UO~P${Oj#XOQ#Pab#Paf#Pah#Pan#Paq#Pat#Pa!X#Pa!Y#Pa#U#Pa#W#Pa#X#Pa#e#Pa!S#Pa~Oa!}at!}a~P${O#Zo#[#ej!R#e~",goto:"-g#jPPP#kP#nP#w$WP#w$g#wPP$mPPP$s$|$|P%`P$|P$|%z&^PPPP$|&vP&z'Q#wP'W#w'^P#wP#w#wPPP'd'y(WPP#nPP(_(_(i(_P(_P(_(_P#nP#nP#nP(l#nP(o(r(u(|#nP#nP)R)X)h)v)|*S*^*d*n*t*zPPPPPPPPPP+Q+ZP+v+yP,o,r,x-RRkQ_bOPdhw!n#skYOPdhotuvw!n#R#h#skSOPdhotuvw!n#R#h#sQmTR!tnQ{VR!xqQ!x}Q#Z!XR#x!zq![Z]!T!m#S#U#X#q#z$P$Y$i$j$q$v%Sp![Z]!T!m#S#U#X#q#z$P$Y$i$j$q$v%SU$d#m$f$yR$x$cq!XZ]!T!m#S#U#X#q#z$P$Y$i$j$q$v%Sp![Z]!T!m#S#U#X#q#z$P$Y$i$j$q$v%SQ!f^R#l!gT#^!Z#_Q|VR!yqQ!x|R#x!yQ!PWR!{rQ!RXR!|sQxUQ!wpQ#i!cQ#o!jQ#p!kQ${$eR%X$zSgPwQ!phQ#r!nR$l#sZfPhw!n#sa!b[`a!V!^!`#d#eR#b!^R!g^R!i_R#n!iS$e#m$fR%V$yV$c#m$f$yQ!rjR#v!rQdOShPwU!ldh#sR#s!nQ$P#SU$p$P$v%SQ$v$YR%S$qQ#_!ZR$W#_Q$r$PR%T$rQpUS!vp$nR$n#|Q$j#qR%P$jQ!ogS#t!o#uR#u!pQ#f!_R$^#fQ$f#mR$|$fQ$z$eR%W$z_cOPdhw!n#s^UOPdhw!n#sQ!uoQ!}tQ#OuQ#PvQ#|#RR$_#hR$Q#SQ!VZQ!d]Q#V!TQ#q!m[$O#S$P$Y$q$v%SQ$R#UQ$T#XS$h#q$jQ$m#zR%O$iR#}#RQiPR#QwQ!c[Q!kaR#Y!VU!_[a!VQ!j`Q#c!^Q#g!`Q$[#dR$]#e",nodeNames:" Unit VariableName Comment StyleSheet RuleSet UniversalSelector TagSelector TagName NestingSelector ClassSelector ClassName PseudoClassSelector : :: PseudoClassName PseudoClassName ) ( ArgList ValueName ParenthesizedValue ColorLiteral NumberLiteral StringLiteral BinaryExpression BinOp CallExpression Callee CallLiteral CallTag ParenthesizedContent ] [ LineNames LineName , PseudoClassName ArgList IdSelector # IdName AttributeSelector AttributeName MatchOp ChildSelector ChildOp DescendantSelector SiblingSelector SiblingOp } { Block Declaration PropertyName Important ; ImportStatement AtKeyword import KeywordQuery FeatureQuery FeatureName BinaryQuery LogicOp UnaryQuery UnaryQueryOp ParenthesizedQuery SelectorQuery selector MediaStatement media CharsetStatement charset NamespaceStatement namespace NamespaceName KeyframesStatement keyframes KeyframeName KeyframeList KeyframeSelector KeyframeRangeName SupportsStatement supports AtRule Styles",maxTerm:117,nodeProps:[["isolate",-2,3,24,""],["openedBy",17,"(",32,"[",50,"{"],["closedBy",18,")",33,"]",51,"}"]],propSources:[XW],skippedNodes:[0,3,87],repeatNodeCount:11,tokenData:"J^~R!^OX$}X^%u^p$}pq%uqr)Xrs.Rst/utu6duv$}vw7^wx7oxy9^yz9oz{9t{|:_|}?Q}!O?c!O!P@Q!P!Q@i!Q![Ab![!]B]!]!^CX!^!_$}!_!`Cj!`!aC{!a!b$}!b!cDw!c!}$}!}#OFa#O#P$}#P#QFr#Q#R6d#R#T$}#T#UGT#U#c$}#c#dHf#d#o$}#o#pH{#p#q6d#q#rI^#r#sIo#s#y$}#y#z%u#z$f$}$f$g%u$g#BY$}#BY#BZ%u#BZ$IS$}$IS$I_%u$I_$I|$}$I|$JO%u$JO$JT$}$JT$JU%u$JU$KV$}$KV$KW%u$KW&FU$}&FU&FV%u&FV;'S$};'S;=`JW<%lO$}`%QSOy%^z;'S%^;'S;=`%o<%lO%^`%cSo`Oy%^z;'S%^;'S;=`%o<%lO%^`%rP;=`<%l%^~%zh#Z~OX%^X^'f^p%^pq'fqy%^z#y%^#y#z'f#z$f%^$f$g'f$g#BY%^#BY#BZ'f#BZ$IS%^$IS$I_'f$I_$I|%^$I|$JO'f$JO$JT%^$JT$JU'f$JU$KV%^$KV$KW'f$KW&FU%^&FU&FV'f&FV;'S%^;'S;=`%o<%lO%^~'mh#Z~o`OX%^X^'f^p%^pq'fqy%^z#y%^#y#z'f#z$f%^$f$g'f$g#BY%^#BY#BZ'f#BZ$IS%^$IS$I_'f$I_$I|%^$I|$JO'f$JO$JT%^$JT$JU'f$JU$KV%^$KV$KW'f$KW&FU%^&FU&FV'f&FV;'S%^;'S;=`%o<%lO%^l)[UOy%^z#]%^#]#^)n#^;'S%^;'S;=`%o<%lO%^l)sUo`Oy%^z#a%^#a#b*V#b;'S%^;'S;=`%o<%lO%^l*[Uo`Oy%^z#d%^#d#e*n#e;'S%^;'S;=`%o<%lO%^l*sUo`Oy%^z#c%^#c#d+V#d;'S%^;'S;=`%o<%lO%^l+[Uo`Oy%^z#f%^#f#g+n#g;'S%^;'S;=`%o<%lO%^l+sUo`Oy%^z#h%^#h#i,V#i;'S%^;'S;=`%o<%lO%^l,[Uo`Oy%^z#T%^#T#U,n#U;'S%^;'S;=`%o<%lO%^l,sUo`Oy%^z#b%^#b#c-V#c;'S%^;'S;=`%o<%lO%^l-[Uo`Oy%^z#h%^#h#i-n#i;'S%^;'S;=`%o<%lO%^l-uS!X[o`Oy%^z;'S%^;'S;=`%o<%lO%^~.UWOY.RZr.Rrs.ns#O.R#O#P.s#P;'S.R;'S;=`/o<%lO.R~.sOh~~.vRO;'S.R;'S;=`/P;=`O.R~/SXOY.RZr.Rrs.ns#O.R#O#P.s#P;'S.R;'S;=`/o;=`<%l.R<%lO.R~/rP;=`<%l.Rn/zYxQOy%^z!Q%^!Q![0j![!c%^!c!i0j!i#T%^#T#Z0j#Z;'S%^;'S;=`%o<%lO%^l0oYo`Oy%^z!Q%^!Q![1_![!c%^!c!i1_!i#T%^#T#Z1_#Z;'S%^;'S;=`%o<%lO%^l1dYo`Oy%^z!Q%^!Q![2S![!c%^!c!i2S!i#T%^#T#Z2S#Z;'S%^;'S;=`%o<%lO%^l2ZYf[o`Oy%^z!Q%^!Q![2y![!c%^!c!i2y!i#T%^#T#Z2y#Z;'S%^;'S;=`%o<%lO%^l3QYf[o`Oy%^z!Q%^!Q![3p![!c%^!c!i3p!i#T%^#T#Z3p#Z;'S%^;'S;=`%o<%lO%^l3uYo`Oy%^z!Q%^!Q![4e![!c%^!c!i4e!i#T%^#T#Z4e#Z;'S%^;'S;=`%o<%lO%^l4lYf[o`Oy%^z!Q%^!Q![5[![!c%^!c!i5[!i#T%^#T#Z5[#Z;'S%^;'S;=`%o<%lO%^l5aYo`Oy%^z!Q%^!Q![6P![!c%^!c!i6P!i#T%^#T#Z6P#Z;'S%^;'S;=`%o<%lO%^l6WSf[o`Oy%^z;'S%^;'S;=`%o<%lO%^d6gUOy%^z!_%^!_!`6y!`;'S%^;'S;=`%o<%lO%^d7QS|So`Oy%^z;'S%^;'S;=`%o<%lO%^b7cSXQOy%^z;'S%^;'S;=`%o<%lO%^~7rWOY7oZw7owx.nx#O7o#O#P8[#P;'S7o;'S;=`9W<%lO7o~8_RO;'S7o;'S;=`8h;=`O7o~8kXOY7oZw7owx.nx#O7o#O#P8[#P;'S7o;'S;=`9W;=`<%l7o<%lO7o~9ZP;=`<%l7on9cSb^Oy%^z;'S%^;'S;=`%o<%lO%^~9tOa~n9{UUQjWOy%^z!_%^!_!`6y!`;'S%^;'S;=`%o<%lO%^n:fWjW!RQOy%^z!O%^!O!P;O!P!Q%^!Q![>T![;'S%^;'S;=`%o<%lO%^l;TUo`Oy%^z!Q%^!Q![;g![;'S%^;'S;=`%o<%lO%^l;nYo`#e[Oy%^z!Q%^!Q![;g![!g%^!g!h<^!h#X%^#X#Y<^#Y;'S%^;'S;=`%o<%lO%^l<cYo`Oy%^z{%^{|=R|}%^}!O=R!O!Q%^!Q![=j![;'S%^;'S;=`%o<%lO%^l=WUo`Oy%^z!Q%^!Q![=j![;'S%^;'S;=`%o<%lO%^l=qUo`#e[Oy%^z!Q%^!Q![=j![;'S%^;'S;=`%o<%lO%^l>[[o`#e[Oy%^z!O%^!O!P;g!P!Q%^!Q![>T![!g%^!g!h<^!h#X%^#X#Y<^#Y;'S%^;'S;=`%o<%lO%^n?VSt^Oy%^z;'S%^;'S;=`%o<%lO%^l?hWjWOy%^z!O%^!O!P;O!P!Q%^!Q![>T![;'S%^;'S;=`%o<%lO%^n@VU#bQOy%^z!Q%^!Q![;g![;'S%^;'S;=`%o<%lO%^~@nTjWOy%^z{@}{;'S%^;'S;=`%o<%lO%^~AUSo`#[~Oy%^z;'S%^;'S;=`%o<%lO%^lAg[#e[Oy%^z!O%^!O!P;g!P!Q%^!Q![>T![!g%^!g!h<^!h#X%^#X#Y<^#Y;'S%^;'S;=`%o<%lO%^bBbU]QOy%^z![%^![!]Bt!];'S%^;'S;=`%o<%lO%^bB{S^Qo`Oy%^z;'S%^;'S;=`%o<%lO%^nC^S!Y^Oy%^z;'S%^;'S;=`%o<%lO%^dCoS|SOy%^z;'S%^;'S;=`%o<%lO%^bDQU!OQOy%^z!`%^!`!aDd!a;'S%^;'S;=`%o<%lO%^bDkS!OQo`Oy%^z;'S%^;'S;=`%o<%lO%^bDzWOy%^z!c%^!c!}Ed!}#T%^#T#oEd#o;'S%^;'S;=`%o<%lO%^bEk[![Qo`Oy%^z}%^}!OEd!O!Q%^!Q![Ed![!c%^!c!}Ed!}#T%^#T#oEd#o;'S%^;'S;=`%o<%lO%^nFfSq^Oy%^z;'S%^;'S;=`%o<%lO%^nFwSp^Oy%^z;'S%^;'S;=`%o<%lO%^bGWUOy%^z#b%^#b#cGj#c;'S%^;'S;=`%o<%lO%^bGoUo`Oy%^z#W%^#W#XHR#X;'S%^;'S;=`%o<%lO%^bHYS!bQo`Oy%^z;'S%^;'S;=`%o<%lO%^bHiUOy%^z#f%^#f#gHR#g;'S%^;'S;=`%o<%lO%^fIQS!TUOy%^z;'S%^;'S;=`%o<%lO%^nIcS!S^Oy%^z;'S%^;'S;=`%o<%lO%^fItU!RQOy%^z!_%^!_!`6y!`;'S%^;'S;=`%o<%lO%^`JZP;=`<%l$}",tokenizers:[IW,WW,DW,1,2,3,4,new gc("m~RRYZ[z{a~~g~aO#^~~dP!P!Qg~lO#_~~",28,105)],topRules:{StyleSheet:[0,4],Styles:[1,86]},specialized:[{term:100,get:i=>BW[i]||-1},{term:58,get:i=>VW[i]||-1},{term:101,get:i=>qW[i]||-1}],tokenPrec:1200});let cu=null;function fu(){if(!cu&&typeof document=="object"&&document.body){let{style:i}=document.body,e=[],t=new Set;for(let n in i)n!="cssText"&&n!="cssFloat"&&typeof i[n]=="string"&&(/[A-Z]/.test(n)&&(n=n.replace(/[A-Z]/g,r=>"-"+r.toLowerCase())),t.has(n)||(e.push(n),t.add(n)));cu=e.sort().map(n=>({type:"property",label:n}))}return cu||[]}const _y=["active","after","any-link","autofill","backdrop","before","checked","cue","default","defined","disabled","empty","enabled","file-selector-button","first","first-child","first-letter","first-line","first-of-type","focus","focus-visible","focus-within","fullscreen","has","host","host-context","hover","in-range","indeterminate","invalid","is","lang","last-child","last-of-type","left","link","marker","modal","not","nth-child","nth-last-child","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","part","placeholder","placeholder-shown","read-only","read-write","required","right","root","scope","selection","slotted","target","target-text","valid","visited","where"].map(i=>({type:"class",label:i})),Fy=["above","absolute","activeborder","additive","activecaption","after-white-space","ahead","alias","all","all-scroll","alphabetic","alternate","always","antialiased","appworkspace","asterisks","attr","auto","auto-flow","avoid","avoid-column","avoid-page","avoid-region","axis-pan","background","backwards","baseline","below","bidi-override","blink","block","block-axis","bold","bolder","border","border-box","both","bottom","break","break-all","break-word","bullets","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","calc","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-decimal","clear","clip","close-quote","col-resize","collapse","color","color-burn","color-dodge","column","column-reverse","compact","condensed","contain","content","contents","content-box","context-menu","continuous","copy","counter","counters","cover","crop","cross","crosshair","currentcolor","cursive","cyclic","darken","dashed","decimal","decimal-leading-zero","default","default-button","dense","destination-atop","destination-in","destination-out","destination-over","difference","disc","discard","disclosure-closed","disclosure-open","document","dot-dash","dot-dot-dash","dotted","double","down","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipse","ellipsis","embed","end","ethiopic-abegede-gez","ethiopic-halehame-aa-er","ethiopic-halehame-gez","ew-resize","exclusion","expanded","extends","extra-condensed","extra-expanded","fantasy","fast","fill","fill-box","fixed","flat","flex","flex-end","flex-start","footnotes","forwards","from","geometricPrecision","graytext","grid","groove","hand","hard-light","help","hidden","hide","higher","highlight","highlighttext","horizontal","hsl","hsla","hue","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-flex","inline-grid","inline-table","inset","inside","intrinsic","invert","italic","justify","keep-all","landscape","large","larger","left","level","lighter","lighten","line-through","linear","linear-gradient","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-hexadecimal","lower-latin","lower-norwegian","lowercase","ltr","luminosity","manipulation","match","matrix","matrix3d","medium","menu","menutext","message-box","middle","min-intrinsic","mix","monospace","move","multiple","multiple_mask_images","multiply","n-resize","narrower","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","numbers","numeric","nw-resize","nwse-resize","oblique","opacity","open-quote","optimizeLegibility","optimizeSpeed","outset","outside","outside-shape","overlay","overline","padding","padding-box","painted","page","paused","perspective","pinch-zoom","plus-darker","plus-lighter","pointer","polygon","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radial-gradient","radio","read-only","read-write","read-write-plaintext-only","rectangle","region","relative","repeat","repeating-linear-gradient","repeating-radial-gradient","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","rotate","rotate3d","rotateX","rotateY","rotateZ","round","row","row-resize","row-reverse","rtl","run-in","running","s-resize","sans-serif","saturation","scale","scale3d","scaleX","scaleY","scaleZ","screen","scroll","scrollbar","scroll-position","se-resize","self-start","self-end","semi-condensed","semi-expanded","separate","serif","show","single","skew","skewX","skewY","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","soft-light","solid","source-atop","source-in","source-out","source-over","space","space-around","space-between","space-evenly","spell-out","square","start","static","status-bar","stretch","stroke","stroke-box","sub","subpixel-antialiased","svg_masks","super","sw-resize","symbolic","symbols","system-ui","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","text","text-bottom","text-top","textarea","textfield","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","to","top","transform","translate","translate3d","translateX","translateY","translateZ","transparent","ultra-condensed","ultra-expanded","underline","unidirectional-pan","unset","up","upper-latin","uppercase","url","var","vertical","vertical-text","view-box","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","wider","window","windowframe","windowtext","words","wrap","wrap-reverse","x-large","x-small","xor","xx-large","xx-small"].map(i=>({type:"keyword",label:i})).concat(["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"].map(i=>({type:"constant",label:i}))),zW=["a","abbr","address","article","aside","b","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","dd","del","details","dfn","dialog","div","dl","dt","em","figcaption","figure","footer","form","header","hgroup","h1","h2","h3","h4","h5","h6","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","main","meter","nav","ol","output","p","pre","ruby","section","select","small","source","span","strong","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","tr","u","ul"].map(i=>({type:"type",label:i})),gi=/^(\w[\w-]*|-\w[\w-]*|)$/,YW=/^-(-[\w-]*)?$/;function jW(i,e){var t;if((i.name=="("||i.type.isError)&&(i=i.parent||i),i.name!="ArgList")return!1;let n=(t=i.parent)===null||t===void 0?void 0:t.firstChild;return(n==null?void 0:n.name)!="Callee"?!1:e.sliceString(n.from,n.to)=="var"}const Uy=new rw,_W=["Declaration"];function FW(i){for(let e=i;;){if(e.type.isTop)return e;if(!(e=e.parent))return i}}function Pv(i,e,t){if(e.to-e.from>4096){let n=Uy.get(e);if(n)return n;let r=[],s=new Set,o=e.cursor(ce.IncludeAnonymous);if(o.firstChild())do for(let l of Pv(i,o.node,t))s.has(l.label)||(s.add(l.label),r.push(l));while(o.nextSibling());return Uy.set(e,r),r}else{let n=[],r=new Set;return e.cursor().iterate(s=>{var o;if(t(s)&&s.matchContext(_W)&&((o=s.node.nextSibling)===null||o===void 0?void 0:o.name)==":"){let l=i.sliceString(s.from,s.to);r.has(l)||(r.add(l),n.push({label:l,type:"variable"}))}}),n}}const UW=i=>e=>{let{state:t,pos:n}=e,r=ae(t).resolveInner(n,-1),s=r.type.isError&&r.from==r.to-1&&t.doc.sliceString(r.from,r.to)=="-";if(r.name=="PropertyName"||(s||r.name=="TagName")&&/^(Block|Styles)$/.test(r.resolve(r.to).name))return{from:r.from,options:fu(),validFor:gi};if(r.name=="ValueName")return{from:r.from,options:Fy,validFor:gi};if(r.name=="PseudoClassName")return{from:r.from,options:_y,validFor:gi};if(i(r)||(e.explicit||s)&&jW(r,t.doc))return{from:i(r)||s?r.from:n,options:Pv(t.doc,FW(r),i),validFor:YW};if(r.name=="TagName"){for(let{parent:a}=r;a;a=a.parent)if(a.name=="Block")return{from:r.from,options:fu(),validFor:gi};return{from:r.from,options:zW,validFor:gi}}if(!e.explicit)return null;let o=r.resolve(n),l=o.childBefore(n);return l&&l.name==":"&&o.name=="PseudoClassSelector"?{from:n,options:_y,validFor:gi}:l&&l.name==":"&&o.name=="Declaration"||o.name=="ArgList"?{from:n,options:Fy,validFor:gi}:o.name=="Block"||o.name=="Styles"?{from:n,options:fu(),validFor:gi}:null},GW=UW(i=>i.name=="VariableName"),kc=Bs.define({name:"css",parser:LW.configure({props:[Jl.add({Declaration:Ph()}),eo.add({"Block KeyframeList":dw})]}),languageData:{commentTokens:{block:{open:"/*",close:"*/"}},indentOnInput:/^\s*\}$/,wordChars:"-"}});function HW(){return new Zl(kc,kc.data.of({autocomplete:GW}))}const KW=309,Gy=1,JW=2,eX=3,tX=310,nX=312,iX=313,rX=4,sX=5,oX=0,tp=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],Qv=125,lX=59,np=47,aX=42,hX=43,cX=45,fX=60,uX=44,dX=new fv({start:!1,shift(i,e){return e==rX||e==sX||e==nX?i:e==iX},strict:!1}),pX=new kn((i,e)=>{let{next:t}=i;(t==Qv||t==-1||e.context)&&i.acceptToken(tX)},{contextual:!0,fallback:!0}),mX=new kn((i,e)=>{let{next:t}=i,n;tp.indexOf(t)>-1||t==np&&((n=i.peek(1))==np||n==aX)||t!=Qv&&t!=lX&&t!=-1&&!e.context&&i.acceptToken(KW)},{contextual:!0}),gX=new kn((i,e)=>{let{next:t}=i;if((t==hX||t==cX)&&(i.advance(),t==i.next)){i.advance();let n=!e.context&&e.canShift(Gy);i.acceptToken(n?Gy:JW)}},{contextual:!0});function uu(i,e){return i>=65&&i<=90||i>=97&&i<=122||i==95||i>=192||!e&&i>=48&&i<=57}const OX=new kn((i,e)=>{if(i.next!=fX||!e.dialectEnabled(oX)||(i.advance(),i.next==np))return;let t=0;for(;tp.indexOf(i.next)>-1;)i.advance(),t++;if(uu(i.next,!0)){for(i.advance(),t++;uu(i.next,!1);)i.advance(),t++;for(;tp.indexOf(i.next)>-1;)i.advance(),t++;if(i.next==uX)return;for(let n=0;;n++){if(n==7){if(!uu(i.next,!0))return;break}if(i.next!="extends".charCodeAt(n))break;i.advance(),t++}}i.acceptToken(eX,-t)}),yX=Ks({"get set async static":O.modifier,"for while do if else switch try catch finally return throw break continue default case":O.controlKeyword,"in of await yield void typeof delete instanceof":O.operatorKeyword,"let var const using function class extends":O.definitionKeyword,"import export from":O.moduleKeyword,"with debugger as new":O.keyword,TemplateString:O.special(O.string),super:O.atom,BooleanLiteral:O.bool,this:O.self,null:O.null,Star:O.modifier,VariableName:O.variableName,"CallExpression/VariableName TaggedTemplateExpression/VariableName":O.function(O.variableName),VariableDefinition:O.definition(O.variableName),Label:O.labelName,PropertyName:O.propertyName,PrivatePropertyName:O.special(O.propertyName),"CallExpression/MemberExpression/PropertyName":O.function(O.propertyName),"FunctionDeclaration/VariableDefinition":O.function(O.definition(O.variableName)),"ClassDeclaration/VariableDefinition":O.definition(O.className),PropertyDefinition:O.definition(O.propertyName),PrivatePropertyDefinition:O.definition(O.special(O.propertyName)),UpdateOp:O.updateOperator,"LineComment Hashbang":O.lineComment,BlockComment:O.blockComment,Number:O.number,String:O.string,Escape:O.escape,ArithOp:O.arithmeticOperator,LogicOp:O.logicOperator,BitOp:O.bitwiseOperator,CompareOp:O.compareOperator,RegExp:O.regexp,Equals:O.definitionOperator,Arrow:O.function(O.punctuation),": Spread":O.punctuation,"( )":O.paren,"[ ]":O.squareBracket,"{ }":O.brace,"InterpolationStart InterpolationEnd":O.special(O.brace),".":O.derefOperator,", ;":O.separator,"@":O.meta,TypeName:O.typeName,TypeDefinition:O.definition(O.typeName),"type enum interface implements namespace module declare":O.definitionKeyword,"abstract global Privacy readonly override":O.modifier,"is keyof unique infer":O.operatorKeyword,JSXAttributeValue:O.attributeValue,JSXText:O.content,"JSXStartTag JSXStartCloseTag JSXSelfCloseEndTag JSXEndTag":O.angleBracket,"JSXIdentifier JSXNameSpacedName":O.tagName,"JSXAttribute/JSXIdentifier JSXAttribute/JSXNameSpacedName":O.attributeName,"JSXBuiltin/JSXIdentifier":O.standard(O.tagName)}),kX={__proto__:null,export:18,as:23,from:31,default:34,async:39,function:40,extends:52,this:56,true:64,false:64,null:76,void:80,typeof:84,super:102,new:136,delete:152,yield:161,await:165,class:170,public:227,private:227,protected:227,readonly:229,instanceof:248,satisfies:251,in:252,const:254,import:286,keyof:339,unique:343,infer:349,is:385,abstract:405,implements:407,type:409,let:412,var:414,using:417,interface:423,enum:427,namespace:433,module:435,declare:439,global:443,for:462,of:471,while:474,with:478,do:482,if:486,else:488,switch:492,case:498,try:504,catch:508,finally:512,return:516,throw:520,break:524,continue:528,debugger:532},bX={__proto__:null,async:123,get:125,set:127,declare:187,public:189,private:189,protected:189,static:191,abstract:193,override:195,readonly:201,accessor:203,new:389},SX={__proto__:null,"<":143},wX=Ys.deserialize({version:14,states:"$=WO%TQ^OOO%[Q^OOO'_Q`OOP(lOWOOO*zQ08SO'#ChO+RO!bO'#CiO+aO#tO'#CiO+oO?MpO'#D^O.QQ^O'#DdO.bQ^O'#DoO%[Q^O'#DyO0fQ^O'#EROOQ07b'#EZ'#EZO1PQWO'#EWOOQO'#El'#ElOOQO'#Ie'#IeO1XQWO'#GmO1dQWO'#EkO1iQWO'#EkO3kQ08SO'#JiO6[Q08SO'#JjO6xQWO'#FZO6}Q&jO'#FqOOQ07b'#Fc'#FcO7YO,YO'#FcO7hQ7[O'#FxO9UQWO'#FwOOQ07b'#Jj'#JjOOQ07`'#Ji'#JiO9ZQWO'#GqOOQU'#KV'#KVO9fQWO'#IRO9kQ07hO'#ISOOQU'#JW'#JWOOQU'#IW'#IWQ`Q^OOO`Q^OOO%[Q^O'#DqO9sQ^O'#D}O9zQ^O'#EPO9aQWO'#GmO:RQ7[O'#CnO:aQWO'#EjO:lQWO'#EuO:qQ7[O'#FbO;`QWO'#GmOOQO'#KW'#KWO;eQWO'#KWO;sQWO'#GuO;sQWO'#GvO;sQWO'#GxO9aQWO'#G{O<jQWO'#HOO>RQWO'#CdO>cQWO'#H[O>kQWO'#HbO>kQWO'#HdO`Q^O'#HfO>kQWO'#HhO>kQWO'#HkO>pQWO'#HqO>uQ07iO'#HwO%[Q^O'#HyO?QQ07iO'#H{O?]Q07iO'#H}O9kQ07hO'#IPO?hQ08SO'#ChO@jQ`O'#DiQOQWOOO%[Q^O'#EPOAQQWO'#ESO:RQ7[O'#EjOA]QWO'#EjOAhQpO'#FbOOQU'#Cf'#CfOOQ07`'#Dn'#DnOOQ07`'#Jm'#JmO%[Q^O'#JmOOQO'#Jq'#JqOOQO'#Ib'#IbOBhQ`O'#EcOOQ07`'#Eb'#EbOOQ07`'#Jt'#JtOCdQ07pO'#EcOCnQ`O'#EVOOQO'#Jp'#JpODSQ`O'#JqOEaQ`O'#EVOCnQ`O'#EcPEnO!0LbO'#CaPOOO)CDu)CDuOOOO'#IX'#IXOEyO!bO,59TOOQ07b,59T,59TOOOO'#IY'#IYOFXO#tO,59TO%[Q^O'#D`OOOO'#I['#I[OFgO?MpO,59xOOQ07b,59x,59xOFuQ^O'#I]OGYQWO'#JkOI[QrO'#JkO+}Q^O'#JkOIcQWO,5:OOIyQWO'#ElOJWQWO'#JzOJcQWO'#JyOJcQWO'#JyOJkQWO,5;YOJpQWO'#JxOOQ07f,5:Z,5:ZOJwQ^O,5:ZOLxQ08SO,5:eOMiQWO,5:mONSQ07hO'#JwONZQWO'#JvO9ZQWO'#JvONoQWO'#JvONwQWO,5;XON|QWO'#JvO!#UQrO'#JjOOQ07b'#Ch'#ChO%[Q^O'#ERO!#tQpO,5:rOOQO'#Jr'#JrOOQO-E<c-E<cO9aQWO,5=XO!$[QWO,5=XO!$aQ^O,5;VO!&dQ7[O'#EgO!'}QWO,5;VO!)mQ7[O'#DsO!)tQ^O'#DxO!*OQ`O,5;`O!*WQ`O,5;`O%[Q^O,5;`OOQU'#FR'#FROOQU'#FT'#FTO%[Q^O,5;aO%[Q^O,5;aO%[Q^O,5;aO%[Q^O,5;aO%[Q^O,5;aO%[Q^O,5;aO%[Q^O,5;aO%[Q^O,5;aO%[Q^O,5;aO%[Q^O,5;aO%[Q^O,5;aOOQU'#FX'#FXO!*fQ^O,5;rOOQ07b,5;w,5;wOOQ07b,5;x,5;xO!,iQWO,5;xOOQ07b,5;y,5;yO%[Q^O'#IiO!,qQ07hO,5<eO!&dQ7[O,5;aO!-`Q7[O,5;aO%[Q^O,5;uO!-gQ&jO'#FgO!.dQ&jO'#KOO!.OQ&jO'#KOO!.kQ&jO'#KOOOQO'#KO'#KOO!/PQ&jO,5<POOOS,5<],5<]O!/bQ^O'#FsOOOS'#Ih'#IhO7YO,YO,5;}O!/iQ&jO'#FuOOQ07b,5;},5;}O!0YQMhO'#CuOOQ07b'#Cy'#CyO!0mQWO'#CyO!0rO?MpO'#C}O!1`Q7[O,5<bO!1gQWO,5<dO!3SQ!LQO'#GSO!3aQWO'#GTO!3fQWO'#GTO!5UQ!LQO'#GXO!6QQ`O'#G]OOQO'#Gh'#GhO!(SQ7[O'#GgOOQO'#Gj'#GjO!(SQ7[O'#GiO!6sQMhO'#JdOOQ07b'#Jd'#JdO!6}QWO'#JcO!7]QWO'#JbO!7eQWO'#CtOOQ07b'#Cw'#CwOOQ07b'#DR'#DROOQ07b'#DT'#DTO1SQWO'#DVO!(SQ7[O'#FzO!(SQ7[O'#F|O!7mQWO'#GOO!7rQWO'#GPO!3fQWO'#GVO!(SQ7[O'#G[O!7wQWO'#EmO!8fQWO,5<cOOQ07`'#Cq'#CqO!8nQWO'#EnO!9hQ`O'#EoOOQ07`'#Jx'#JxO!9oQ07hO'#KXO9kQ07hO,5=]O`Q^O,5>mOOQU'#J`'#J`OOQU,5>n,5>nOOQU-E<U-E<UO!;qQ08SO,5:]O!>_Q08SO,5:iO%[Q^O,5:iO!@xQ08SO,5:kOOQO,5@r,5@rO!AiQ7[O,5=XO!AwQ07hO'#JaO9UQWO'#JaO!BYQ07hO,59YO!BeQ`O,59YO!BmQ7[O,59YO:RQ7[O,59YO!BxQWO,5;VO!CQQWO'#HZO!CfQWO'#K[O%[Q^O,5;zO!9cQ`O,5;|O!CnQWO,5=tO!CsQWO,5=tO!CxQWO,5=tO9kQ07hO,5=tO;sQWO,5=dOOQO'#Cu'#CuO!DWQ`O,5=aO!D`Q7[O,5=bO!DkQWO,5=dO!DpQpO,5=gO!DxQWO'#KWO>pQWO'#HQO9aQWO'#HSO!D}QWO'#HSO:RQ7[O'#HUO!ESQWO'#HUOOQU,5=j,5=jO!EXQWO'#HVO!EjQWO'#CnO!EoQWO,59OO!EyQWO,59OO!HOQ^O,59OOOQU,59O,59OO!H`Q07hO,59OO%[Q^O,59OO!JkQ^O'#H^OOQU'#H_'#H_OOQU'#H`'#H`O`Q^O,5=vO!KRQWO,5=vO`Q^O,5=|O`Q^O,5>OO!KWQWO,5>QO`Q^O,5>SO!K]QWO,5>VO!KbQ^O,5>]OOQU,5>c,5>cO%[Q^O,5>cO9kQ07hO,5>eOOQU,5>g,5>gO# lQWO,5>gOOQU,5>i,5>iO# lQWO,5>iOOQU,5>k,5>kO#!YQ`O'#D[O%[Q^O'#JmO#!dQ`O'#JmO##RQ`O'#DjO##dQ`O'#DjO#%uQ^O'#DjO#%|QWO'#JlO#&UQWO,5:TO#&ZQWO'#EpO#&iQWO'#J{O#&qQWO,5;ZO#&vQ`O'#DjO#'TQ`O'#EUOOQ07b,5:n,5:nO%[Q^O,5:nO#'[QWO,5:nO>pQWO,5;UO!BeQ`O,5;UO!BmQ7[O,5;UO:RQ7[O,5;UO#'dQWO,5@XO#'iQ$ISO,5:rOOQO-E<`-E<`O#(oQ07pO,5:}OCnQ`O,5:qO#(yQ`O,5:qOCnQ`O,5:}O!BYQ07hO,5:qOOQ07`'#Ef'#EfOOQO,5:},5:}O%[Q^O,5:}O#)WQ07hO,5:}O#)cQ07hO,5:}O!BeQ`O,5:qOOQO,5;T,5;TO#)qQ07hO,5:}POOO'#IV'#IVP#*VO!0LbO,58{POOO,58{,58{OOOO-E<V-E<VOOQ07b1G.o1G.oOOOO-E<W-E<WO#*bQpO,59zOOOO-E<Y-E<YOOQ07b1G/d1G/dO#*gQrO,5>wO+}Q^O,5>wOOQO,5>},5>}O#*qQ^O'#I]OOQO-E<Z-E<ZO#+OQWO,5@VO#+WQrO,5@VO#+_QWO,5@eOOQ07b1G/j1G/jO%[Q^O,5@fO#+gQWO'#IcOOQO-E<a-E<aO#+_QWO,5@eOOQ07`1G0t1G0tOOQ07f1G/u1G/uOOQ07f1G0X1G0XO%[Q^O,5@cO#+{Q07hO,5@cO#,^Q07hO,5@cO#,eQWO,5@bO9ZQWO,5@bO#,mQWO,5@bO#,{QWO'#IfO#,eQWO,5@bOOQ07`1G0s1G0sO!*OQ`O,5:tO!*ZQ`O,5:tOOQO,5:v,5:vO#-mQWO,5:vO#-uQ7[O1G2sO9aQWO1G2sOOQ07b1G0q1G0qO#.TQ08SO1G0qO#/YQ08QO,5;ROOQ07b'#GR'#GRO#/vQ08SO'#JdO!$aQ^O1G0qO#2OQ7[O'#JnO#2YQWO,5:_O#2_QrO'#JoO%[Q^O'#JoO#2iQWO,5:dOOQ07b'#D['#D[OOQ07b1G0z1G0zO%[Q^O1G0zOOQ07b1G1d1G1dO#2nQWO1G0zO#5VQ08SO1G0{O#5^Q08SO1G0{O#7wQ08SO1G0{O#8OQ08SO1G0{O#:YQ08SO1G0{O#:pQ08SO1G0{O#=jQ08SO1G0{O#=qQ08SO1G0{O#@UQ08SO1G0{O#@cQ08SO1G0{O#BaQ08SO1G0{O#EaQ(CYO'#ChO#G_Q(CYO1G1^O#GfQ(CYO'#JjO!,lQWO1G1dO#GvQ08SO,5?TOOQ07`-E<g-E<gO#HjQ08SO1G0{OOQ07b1G0{1G0{O#JuQ08SO1G1aO#KiQ&jO,5<TO#KqQ&jO,5<UO#KyQ&jO'#FlO#LbQWO'#FkOOQO'#KP'#KPOOQO'#Ig'#IgO#LgQ&jO1G1kOOQ07b1G1k1G1kOOOS1G1v1G1vO#LxQ(CYO'#JiO#MSQWO,5<_O!*fQ^O,5<_OOOS-E<f-E<fOOQ07b1G1i1G1iO#MXQ`O'#KOOOQ07b,5<a,5<aO#MaQ`O,5<aOOQ07b,59e,59eO!&dQ7[O'#DPOOOO'#IZ'#IZO#MfO?MpO,59iOOQ07b,59i,59iO%[Q^O1G1|O!7rQWO'#IkO#MqQ7[O,5<uOOQ07b,5<r,5<rO!(SQ7[O'#InO#NaQ7[O,5=RO!(SQ7[O'#IpO$ SQ7[O,5=TO!&dQ7[O,5=VOOQO1G2O1G2OO$ ^QpO'#CqO$ qQ!LQO'#EnO$!pQ`O'#G]O$#^QpO,5<nO$#eQWO'#KSO9ZQWO'#KSO$#sQWO,5<pO!(SQ7[O,5<oO$#xQWO'#GUO$$ZQWO,5<oO$$`QpO'#GRO$$mQpO'#KTO$$wQWO'#KTO!&dQ7[O'#KTO$$|QWO,5<sO$%RQ`O'#G^O!5{Q`O'#G^O$%dQWO'#G`O$%iQWO'#GbO!3fQWO'#GeO$%nQ07hO'#ImO$%yQ`O,5<wOOQ07f,5<w,5<wO$&QQ`O'#G^O$&`Q`O'#G_O$&hQ`O'#G_O$&mQ7[O,5=RO$&}Q7[O,5=TOOQ07b,5=W,5=WO!(SQ7[O,5?}O!(SQ7[O,5?}O$'_QWO'#IrO$'jQWO,5?|O$'rQWO,59`O$(cQ7[O,59qOOQ07b,59q,59qO$)UQ7[O,5<fO$)wQ7[O,5<hO@bQWO,5<jOOQ07b,5<k,5<kO$*RQWO,5<qO$*WQ7[O,5<vO$*hQWO'#JvO!$aQ^O1G1}O$*mQWO1G1}O9ZQWO'#JyO9ZQWO'#EpO%[Q^O'#EpO9ZQWO'#ItO$*rQ07hO,5@sOOQU1G2w1G2wOOQU1G4X1G4XOOQ07b1G/w1G/wO!,iQWO1G/wO$,wQ08SO1G0TOOQU1G2s1G2sO!&dQ7[O1G2sO%[Q^O1G2sO#-xQWO1G2sO$.{Q7[O'#EgOOQ07`,5?{,5?{O$/VQ07hO,5?{OOQU1G.t1G.tO!BYQ07hO1G.tO!BeQ`O1G.tO!BmQ7[O1G.tO$/hQWO1G0qO$/mQWO'#ChO$/xQWO'#K]O$0QQWO,5=uO$0VQWO'#K]O$0[QWO'#K]O$0jQWO'#IzO$0xQWO,5@vO$1QQrO1G1fOOQ07b1G1h1G1hO9aQWO1G3`O@bQWO1G3`O$1XQWO1G3`O$1^QWO1G3`OOQU1G3`1G3`O!DkQWO1G3OO!&dQ7[O1G2{O$1cQWO1G2{OOQU1G2|1G2|O!&dQ7[O1G2|O$1hQWO1G2|O$1pQ`O'#GzOOQU1G3O1G3OO!5{Q`O'#IvO!DpQpO1G3ROOQU1G3R1G3ROOQU,5=l,5=lO$1xQ7[O,5=nO9aQWO,5=nO$%iQWO,5=pO9UQWO,5=pO!BeQ`O,5=pO!BmQ7[O,5=pO:RQ7[O,5=pO$2WQWO'#KZO$2cQWO,5=qOOQU1G.j1G.jO$2hQ07hO1G.jO@bQWO1G.jO$2sQWO1G.jO9kQ07hO1G.jO$4xQrO,5@xO$5YQWO,5@xO9ZQWO,5@xO$5eQ^O,5=xO$5lQWO,5=xOOQU1G3b1G3bO`Q^O1G3bOOQU1G3h1G3hOOQU1G3j1G3jO>kQWO1G3lO$5qQ^O1G3nO$9uQ^O'#HmOOQU1G3q1G3qO$:SQWO'#HsO>pQWO'#HuOOQU1G3w1G3wO$:[Q^O1G3wO9kQ07hO1G3}OOQU1G4P1G4POOQ07`'#GY'#GYO9kQ07hO1G4RO9kQ07hO1G4TO$>cQWO,5@XO!*fQ^O,5;[O9ZQWO,5;[O>pQWO,5:UO!*fQ^O,5:UO!BeQ`O,5:UO$>hQ(CYO,5:UOOQO,5;[,5;[O$>rQ`O'#I^O$?YQWO,5@WOOQ07b1G/o1G/oO$?bQ`O'#IdO$?lQWO,5@gOOQ07`1G0u1G0uO##dQ`O,5:UOOQO'#Ia'#IaO$?tQ`O,5:pOOQ07f,5:p,5:pO#'_QWO1G0YOOQ07b1G0Y1G0YO%[Q^O1G0YOOQ07b1G0p1G0pO>pQWO1G0pO!BeQ`O1G0pO!BmQ7[O1G0pOOQ07`1G5s1G5sO!BYQ07hO1G0]OOQO1G0i1G0iO%[Q^O1G0iO$?{Q07hO1G0iO$@WQ07hO1G0iO!BeQ`O1G0]OCnQ`O1G0]O$@fQ07hO1G0iOOQO1G0]1G0]O$@zQ08SO1G0iPOOO-E<T-E<TPOOO1G.g1G.gOOOO1G/f1G/fO$AUQpO,5<eO$A^QrO1G4cOOQO1G4i1G4iO%[Q^O,5>wO$AhQWO1G5qO$ApQWO1G6PO$AxQrO1G6QO9ZQWO,5>}O$BSQ08SO1G5}O%[Q^O1G5}O$BdQ07hO1G5}O$BuQWO1G5|O$BuQWO1G5|O9ZQWO1G5|O$B}QWO,5?QO9ZQWO,5?QOOQO,5?Q,5?QO$CcQWO,5?QO$*hQWO,5?QOOQO-E<d-E<dOOQO1G0`1G0`OOQO1G0b1G0bO!,lQWO1G0bOOQU7+(_7+(_O!&dQ7[O7+(_O%[Q^O7+(_O$CqQWO7+(_O$C|Q7[O7+(_O$D[Q08SO,5=RO$FgQ08SO,5=TO$HrQ08SO,5=RO$KTQ08SO,5=TO$MfQ08SO,59qO% nQ08SO,5<fO%#yQ08SO,5<hO%&UQ08SO,5<vOOQ07b7+&]7+&]O%(gQ08SO7+&]O%)ZQ7[O'#I_O%)eQWO,5@YOOQ07b1G/y1G/yO%)mQ^O'#I`O%)zQWO,5@ZO%*SQrO,5@ZOOQ07b1G0O1G0OO%*^QWO7+&fOOQ07b7+&f7+&fO%*cQ(CYO,5:eO%[Q^O7+&xO%*mQ(CYO,5:]O%*zQ(CYO,5:iO%+UQ(CYO,5:kOOQ07b7+'O7+'OOOQO1G1o1G1oOOQO1G1p1G1pO%+`QtO,5<WO!*fQ^O,5<VOOQO-E<e-E<eOOQ07b7+'V7+'VOOOS7+'b7+'bOOOS1G1y1G1yO%+kQWO1G1yOOQ07b1G1{1G1{O%+pQpO,59kOOOO-E<X-E<XOOQ07b1G/T1G/TO%+wQ08SO7+'hOOQ07b,5?V,5?VO%,kQpO,5?VOOQ07b1G2a1G2aP!&dQ7[O'#IkPOQ07b-E<i-E<iO%-ZQ7[O,5?YOOQ07b-E<l-E<lO%-|Q7[O,5?[OOQ07b-E<n-E<nO%.WQpO1G2qO%._QpO'#CqO%.uQ7[O'#JyO%.|Q^O'#EpOOQ07b1G2Y1G2YO%/WQWO'#IjO%/lQWO,5@nO%/lQWO,5@nO%/tQWO,5@nO%0PQWO,5@nOOQO1G2[1G2[O%0_Q7[O1G2ZO!(SQ7[O1G2ZO%0oQ!LQO'#IlO%0|QWO,5@oO!&dQ7[O,5@oO%1UQpO,5@oOOQ07b1G2_1G2_OOQ07`,5<x,5<xOOQ07`,5<y,5<yO$*hQWO,5<yOC_QWO,5<yO!BeQ`O,5<xOOQO'#Ga'#GaO%1`QWO,5<zOOQ07`,5<|,5<|O$*hQWO,5=POOQO,5?X,5?XOOQO-E<k-E<kOOQ07f1G2c1G2cO!5{Q`O,5<xO%1hQWO,5<yO$%dQWO,5<zO!5{Q`O,5<yO!(SQ7[O'#InO%2[Q7[O1G2mO!(SQ7[O'#IpO%2}Q7[O1G2oO%3XQ7[O1G5iO%3cQ7[O1G5iOOQO,5?^,5?^OOQO-E<p-E<pOOQO1G.z1G.zO!9cQ`O,59sO%[Q^O,59sO%3pQWO1G2UO!(SQ7[O1G2]O%3uQ08SO7+'iOOQ07b7+'i7+'iO!$aQ^O7+'iO%4iQWO,5;[OOQ07`,5?`,5?`OOQ07`-E<r-E<rOOQ07b7+%c7+%cO%4nQpO'#KUO#'_QWO7+(_O%4xQrO7+(_O$CtQWO7+(_O%5PQ08QO'#ChO%5dQ08QO,5<}O%6UQWO,5<}OOQ07`1G5g1G5gOOQU7+$`7+$`O!BYQ07hO7+$`O!BeQ`O7+$`O!$aQ^O7+&]O%6ZQWO'#IyO%6rQWO,5@wOOQO1G3a1G3aO9aQWO,5@wO%6rQWO,5@wO%6zQWO,5@wOOQO,5?f,5?fOOQO-E<x-E<xOOQ07b7+'Q7+'QO%7PQWO7+(zO9kQ07hO7+(zO9aQWO7+(zO@bQWO7+(zOOQU7+(j7+(jO%7UQ08QO7+(gO!&dQ7[O7+(gO%7`QpO7+(hOOQU7+(h7+(hO!&dQ7[O7+(hO%7gQWO'#KYO%7rQWO,5=fOOQO,5?b,5?bOOQO-E<t-E<tOOQU7+(m7+(mO%9RQ`O'#HTOOQU1G3Y1G3YO!&dQ7[O1G3YO%[Q^O1G3YO%9YQWO1G3YO%9eQ7[O1G3YO9kQ07hO1G3[O$%iQWO1G3[O9UQWO1G3[O!BeQ`O1G3[O!BmQ7[O1G3[O%9sQWO'#IxO%:XQWO,5@uO%:aQ`O,5@uOOQ07`1G3]1G3]OOQU7+$U7+$UO@bQWO7+$UO9kQ07hO7+$UO%:lQWO7+$UO%[Q^O1G6dO%[Q^O1G6eO%:qQ07hO1G6dO%:{Q^O1G3dO%;SQWO1G3dO%;XQ^O1G3dOOQU7+(|7+(|O9kQ07hO7+)WO`Q^O7+)YOOQU'#K`'#K`OOQU'#I{'#I{O%;`Q^O,5>XOOQU,5>X,5>XO%[Q^O'#HnO%;mQWO'#HpOOQU,5>_,5>_O9ZQWO,5>_OOQU,5>a,5>aOOQU7+)c7+)cOOQU7+)i7+)iOOQU7+)m7+)mOOQU7+)o7+)oO%;rQ`O1G5sO%<WQ(CYO1G0vO%<bQWO1G0vOOQO1G/p1G/pO%<mQ(CYO1G/pO>pQWO1G/pO!*fQ^O'#DjOOQO,5>x,5>xOOQO-E<[-E<[OOQO,5?O,5?OOOQO-E<b-E<bO!BeQ`O1G/pOOQO-E<_-E<_OOQ07f1G0[1G0[OOQ07b7+%t7+%tO#'_QWO7+%tOOQ07b7+&[7+&[O>pQWO7+&[O!BeQ`O7+&[OOQO7+%w7+%wO$@zQ08SO7+&TOOQO7+&T7+&TO%[Q^O7+&TO%<wQ07hO7+&TO!BYQ07hO7+%wO!BeQ`O7+%wO%=SQ07hO7+&TO%=bQ08SO7++iO%[Q^O7++iO%=rQWO7++hO%=rQWO7++hOOQO1G4l1G4lO9ZQWO1G4lO%=zQWO1G4lOOQO7+%|7+%|O#'_QWO<<KyO%4xQrO<<KyO%>YQWO<<KyOOQU<<Ky<<KyO!&dQ7[O<<KyO%[Q^O<<KyO%>bQWO<<KyO%>mQ08SO,5?YO%@xQ08SO,5?[O%CTQ08SO1G2ZO%EfQ08SO1G2mO%GqQ08SO1G2oO%I|Q7[O,5>yOOQO-E<]-E<]O%JWQrO,5>zO%[Q^O,5>zOOQO-E<^-E<^O%JbQWO1G5uOOQ07b<<JQ<<JQO%JjQ(CYO1G0qO%LtQ(CYO1G0{O%L{Q(CYO1G0{O& PQ(CYO1G0{O& WQ(CYO1G0{O&!{Q(CYO1G0{O&#cQ(CYO1G0{O&%vQ(CYO1G0{O&%}Q(CYO1G0{O&'{Q(CYO1G0{O&(YQ(CYO1G0{O&*WQ(CYO1G0{O&*kQ08SO<<JdO&+pQ(CYO1G0{O&-fQ(CYO'#JdO&/iQ(CYO1G1aO&/vQ(CYO1G0TO!*fQ^O'#FnOOQO'#KQ'#KQOOQO1G1r1G1rO&0QQWO1G1qO&0VQ(CYO,5?TOOOS7+'e7+'eOOOO1G/V1G/VOOQ07b1G4q1G4qO!(SQ7[O7+(]O&2gQrO'#ChO&2qQWO,5?UO9ZQWO,5?UOOQO-E<h-E<hO&3PQWO1G6YO&3PQWO1G6YO&3XQWO1G6YO&3dQ7[O7+'uO&3tQpO,5?WO&4OQWO,5?WO!&dQ7[O,5?WOOQO-E<j-E<jO&4TQpO1G6ZO&4_QWO1G6ZOOQ07`1G2e1G2eO$*hQWO1G2eOOQ07`1G2d1G2dO&4gQWO1G2fO!&dQ7[O1G2fOOQ07`1G2k1G2kO!BeQ`O1G2dOC_QWO1G2eO&4lQWO1G2fO&4tQWO1G2eO&5hQ7[O,5?YOOQ07b-E<m-E<mO&6ZQ7[O,5?[OOQ07b-E<o-E<oO!(SQ7[O7++TOOQ07b1G/_1G/_O&6eQWO1G/_OOQ07b7+'p7+'pO&6jQ7[O7+'wO&6zQ08SO<<KTOOQ07b<<KT<<KTO&7nQWO1G0vO!&dQ7[O'#IsO&7sQWO,5@pO!&dQ7[O1G2iOOQU<<Gz<<GzO!BYQ07hO<<GzO&7{Q08SO<<IwOOQ07b<<Iw<<IwOOQO,5?e,5?eO&8oQWO,5?eO&8tQWO,5?eOOQO-E<w-E<wO&9SQWO1G6cO&9SQWO1G6cO9aQWO1G6cO@bQWO<<LfOOQU<<Lf<<LfO&9[QWO<<LfO9kQ07hO<<LfOOQU<<LR<<LRO%7UQ08QO<<LROOQU<<LS<<LSO%7`QpO<<LSO&9aQ`O'#IuO&9lQWO,5@tO!*fQ^O,5@tOOQU1G3Q1G3QO%.|Q^O'#JmOOQO'#Iw'#IwO9kQ07hO'#IwO&9tQ`O,5=oOOQU,5=o,5=oO&9{Q`O'#EcO&:aQWO7+(tO&:fQWO7+(tOOQU7+(t7+(tO!&dQ7[O7+(tO%[Q^O7+(tO&:nQWO7+(tOOQU7+(v7+(vO9kQ07hO7+(vO$%iQWO7+(vO9UQWO7+(vO!BeQ`O7+(vO&:yQWO,5?dOOQO-E<v-E<vOOQO'#HW'#HWO&;UQWO1G6aO9kQ07hO<<GpOOQU<<Gp<<GpO@bQWO<<GpO&;^QWO7+,OO&;cQWO7+,PO%[Q^O7+,OO%[Q^O7+,POOQU7+)O7+)OO&;hQWO7+)OO&;mQ^O7+)OO&;tQWO7+)OOOQU<<Lr<<LrOOQU<<Lt<<LtOOQU-E<y-E<yOOQU1G3s1G3sO&;yQWO,5>YOOQU,5>[,5>[O&<OQWO1G3yO9ZQWO7+&bO!*fQ^O7+&bOOQO7+%[7+%[O&<TQ(CYO1G6QO>pQWO7+%[OOQ07b<<I`<<I`OOQ07b<<Iv<<IvO>pQWO<<IvOOQO<<Io<<IoO$@zQ08SO<<IoO%[Q^O<<IoOOQO<<Ic<<IcO!BYQ07hO<<IcO&<_Q07hO<<IoO&<jQ08SO<= TO&<zQWO<= SOOQO7+*W7+*WO9ZQWO7+*WOOQUANAeANAeO&=SQWOANAeO!&dQ7[OANAeO#'_QWOANAeO%4xQrOANAeO%[Q^OANAeO&=[Q08SO7+'uO&?mQ08SO,5?YO&AxQ08SO,5?[O&DTQ08SO7+'wO&FfQrO1G4fO&FpQ(CYO7+&]O&HtQ(CYO,5=RO&J{Q(CYO,5=TO&K]Q(CYO,5=RO&KmQ(CYO,5=TO&K}Q(CYO,59qO&NQQ(CYO,5<fO'!TQ(CYO,5<hO'$WQ(CYO,5<vO'%|Q(CYO7+'hO'&ZQ(CYO7+'iO'&hQWO,5<YOOQO7+']7+']O'&mQ7[O<<KwOOQO1G4p1G4pO'&tQWO1G4pO''PQWO1G4pO''_QWO7++tO''_QWO7++tO!&dQ7[O1G4rO''gQpO1G4rO''qQWO7++uOOQ07`7+(P7+(PO$*hQWO7+(QO''yQpO7+(QOOQ07`7+(O7+(OO$*hQWO7+(PO'(QQWO7+(QO!&dQ7[O7+(QOC_QWO7+(PO'(VQ7[O<<NoOOQ07b7+$y7+$yO'(aQpO,5?_OOQO-E<q-E<qO'(kQ08QO7+(TOOQUAN=fAN=fO9aQWO1G5POOQO1G5P1G5PO'({QWO1G5PO')QQWO7++}O')QQWO7++}O9kQ07hOANBQO@bQWOANBQOOQUANBQANBQOOQUANAmANAmOOQUANAnANAnO')YQWO,5?aOOQO-E<s-E<sO')eQ(CYO1G6`OOQO,5?c,5?cOOQO-E<u-E<uOOQU1G3Z1G3ZO%.|Q^O,5<zOOQU<<L`<<L`O!&dQ7[O<<L`O&:aQWO<<L`O')oQWO<<L`O%[Q^O<<L`OOQU<<Lb<<LbO9kQ07hO<<LbO$%iQWO<<LbO9UQWO<<LbO')wQ`O1G5OO'*SQWO7++{OOQUAN=[AN=[O9kQ07hOAN=[OOQU<= j<= jOOQU<= k<= kO'*[QWO<= jO'*aQWO<= kOOQU<<Lj<<LjO'*fQWO<<LjO'*kQ^O<<LjOOQU1G3t1G3tO>pQWO7+)eO'*rQWO<<I|O'*}Q(CYO<<I|OOQO<<Hv<<HvOOQ07bAN?bAN?bOOQOAN?ZAN?ZO$@zQ08SOAN?ZOOQOAN>}AN>}O%[Q^OAN?ZOOQO<<Mr<<MrOOQUG27PG27PO!&dQ7[OG27PO#'_QWOG27PO'+XQWOG27PO%4xQrOG27PO'+aQ(CYO<<JdO'+nQ(CYO1G2ZO'-dQ(CYO,5?YO'/gQ(CYO,5?[O'1jQ(CYO1G2mO'3mQ(CYO1G2oO'5pQ(CYO<<KTO'5}Q(CYO<<IwOOQO1G1t1G1tO!(SQ7[OANAcOOQO7+*[7+*[O'6[QWO7+*[O'6gQWO<= `O'6oQpO7+*^OOQ07`<<Kl<<KlO$*hQWO<<KlOOQ07`<<Kk<<KkO'6yQpO<<KlO$*hQWO<<KkOOQO7+*k7+*kO9aQWO7+*kO'7QQWO<= iOOQUG27lG27lO9kQ07hOG27lO!*fQ^O1G4{O'7YQWO7++zO&:aQWOANAzOOQUANAzANAzO!&dQ7[OANAzO'7bQWOANAzOOQUANA|ANA|O9kQ07hOANA|O$%iQWOANA|OOQO'#HX'#HXOOQO7+*j7+*jOOQUG22vG22vOOQUANEUANEUOOQUANEVANEVOOQUANBUANBUO'7jQWOANBUOOQU<<MP<<MPO!*fQ^OAN?hOOQOG24uG24uO$@zQ08SOG24uO#'_QWOLD,kOOQULD,kLD,kO!&dQ7[OLD,kO'7oQWOLD,kO'7wQ(CYO7+'uO'9mQ(CYO,5?YO';pQ(CYO,5?[O'=sQ(CYO7+'wO'?iQ7[OG26}OOQO<<Mv<<MvOOQ07`ANAWANAWO$*hQWOANAWOOQ07`ANAVANAVOOQO<<NV<<NVOOQULD-WLD-WO'?yQ(CYO7+*gOOQUG27fG27fO&:aQWOG27fO!&dQ7[OG27fOOQUG27hG27hO9kQ07hOG27hOOQUG27pG27pO'@TQ(CYOG25SOOQOLD*aLD*aOOQU!$(!V!$(!VO#'_QWO!$(!VO!&dQ7[O!$(!VO'@_Q08SOG26}OOQ07`G26rG26rOOQULD-QLD-QO&:aQWOLD-QOOQULD-SLD-SOOQU!)9Eq!)9EqO#'_QWO!)9EqOOQU!$(!l!$(!lOOQU!.K;]!.K;]O'BpQ(CYOG26}O!*fQ^O'#DyO1PQWO'#EWO'DfQrO'#JiO!*fQ^O'#DqO'DmQ^O'#D}O'DtQrO'#ChO'G[QrO'#ChO!*fQ^O'#EPO'GlQ^O,5;VO!*fQ^O,5;aO!*fQ^O,5;aO!*fQ^O,5;aO!*fQ^O,5;aO!*fQ^O,5;aO!*fQ^O,5;aO!*fQ^O,5;aO!*fQ^O,5;aO!*fQ^O,5;aO!*fQ^O,5;aO!*fQ^O,5;aO!*fQ^O'#IiO'IoQWO,5<eO'IwQ7[O,5;aO'KbQ7[O,5;aO!*fQ^O,5;uO!&dQ7[O'#GgO'IwQ7[O'#GgO!&dQ7[O'#GiO'IwQ7[O'#GiO1SQWO'#DVO1SQWO'#DVO!&dQ7[O'#FzO'IwQ7[O'#FzO!&dQ7[O'#F|O'IwQ7[O'#F|O!&dQ7[O'#G[O'IwQ7[O'#G[O!*fQ^O,5:iO'KiQ`O'#D[O!*fQ^O,5@fO'GlQ^O1G0qO'KsQ(CYO'#ChO!*fQ^O1G1|O!&dQ7[O'#InO'IwQ7[O'#InO!&dQ7[O'#IpO'IwQ7[O'#IpO'K}QpO'#CqO!&dQ7[O,5<oO'IwQ7[O,5<oO'GlQ^O1G1}O!*fQ^O7+&xO!&dQ7[O1G2ZO'IwQ7[O1G2ZO!&dQ7[O'#InO'IwQ7[O'#InO!&dQ7[O'#IpO'IwQ7[O'#IpO!&dQ7[O1G2]O'IwQ7[O1G2]O'GlQ^O7+'iO'GlQ^O7+&]O!&dQ7[OANAcO'IwQ7[OANAcO'LbQWO'#EkO'LgQWO'#EkO'LoQWO'#FZO'LtQWO'#EuO'LyQWO'#JzO'MUQWO'#JxO'MaQWO,5;VO'MfQ7[O,5<bO'MmQWO'#GTO'MrQWO'#GTO'MwQWO,5<cO'NPQWO,5;VO'NXQ(CYO1G1^O'N`QWO,5<oO'NeQWO,5<oO'NjQWO,5<qO'NoQWO,5<qO'NtQWO1G1}O'NyQWO1G0qO( OQ7[O<<KwO( VQ7[O<<KwO7hQ7[O'#FxO9UQWO'#FwOA]QWO'#EjO!*fQ^O,5;rO!3fQWO'#GTO!3fQWO'#GTO!3fQWO'#GVO!3fQWO'#GVO!(SQ7[O7+(]O!(SQ7[O7+(]O%.WQpO1G2qO%.WQpO1G2qO!&dQ7[O,5=VO!&dQ7[O,5=V",stateData:"(!Z~O'tOS'uOSSOS'vRQ~OPYOQYORfOX!VO`qOczOdyOlkOnYOokOpkOvkOxYOzYO!PWO!TkO!UkO![XO!fuO!kZO!nYO!oYO!pYO!rvO!twO!wxO!{]O#s!PO$T|O%b}O%d!QO%f!OO%g!OO%h!OO%k!RO%m!SO%p!TO%q!TO%s!UO&P!WO&V!XO&X!YO&Z!ZO&]![O&`!]O&f!^O&l!_O&n!`O&p!aO&r!bO&t!cO'{SO'}TO(QUO(XVO(g[O(uiO~OVtO~P`OPYOQYORfOc!jOd!iOlkOnYOokOpkOvkOxYOzYO!PWO!TkO!UkO![!eO!fuO!kZO!nYO!oYO!pYO!rvO!t!gO!w!hO$T!kO'{!dO'}TO(QUO(XVO(g[O(uiO~O`!wOo!nO!P!oO!_!yO!`!vO!a!vO!{:jO#P!pO#Q!pO#R!xO#S!pO#T!pO#W!zO#X!zO'|!lO'}TO(QUO([!mO(g!sO~O'v!{O~OP[XZ[X`[Xn[X|[X}[X!P[X!Y[X!h[X!i[X!k[X!o[X#[[X#geX#j[X#k[X#l[X#m[X#n[X#o[X#p[X#q[X#r[X#t[X#v[X#x[X#y[X$O[X'r[X(X[X(i[X(p[X(q[X~O!d$|X~P(qO^!}O'}#PO(O!}O(P#PO~O^#QO(P#PO(Q#PO(R#QO~Ot#SO!R#TO(Y#TO(Z#VO~OPYOQYORfOc!jOd!iOlkOnYOokOpkOvkOxYOzYO!PWO!TkO!UkO![!eO!fuO!kZO!nYO!oYO!pYO!rvO!t!gO!w!hO$T!kO'{:nO'}TO(QUO(XVO(g[O(uiO~O!X#ZO!Y#WO!V(_P!V(mP~P+}O!Z#cO~P`OPYOQYORfOc!jOd!iOnYOokOpkOvkOxYOzYO!PWO!TkO!UkO![!eO!fuO!kZO!nYO!oYO!pYO!rvO!t!gO!w!hO$T!kO'}TO(QUO(XVO(g[O(uiO~Ol#mO!X#iO!{]O#e#lO#f#iO'{:oO!j(jP~P.iO!k#oO'{#nO~O!w#sO!{]O%b#tO~O#g#uO~O!d#vO#g#uO~OP$^OZ$eOn$RO|#zO}#{O!P#|O!Y$bO!h$TO!i#xO!k#yO!o$^O#j$PO#k$QO#l$QO#m$QO#n$SO#o$TO#p$TO#q$dO#r$TO#t$UO#v$WO#x$YO#y$ZO(XVO(i$[O(p#}O(q$OO~O`(]X'r(]X'p(]X!j(]X!V(]X![(]X%c(]X!d(]X~P1qO#[$fO$O$fOP(^XZ(^Xn(^X|(^X}(^X!P(^X!Y(^X!h(^X!k(^X!o(^X#j(^X#k(^X#l(^X#m(^X#n(^X#o(^X#p(^X#q(^X#r(^X#t(^X#v(^X#x(^X#y(^X(X(^X(i(^X(p(^X(q(^X![(^X%c(^X~O`(^X!i(^X'r(^X'p(^X!V(^X!j(^Xr(^X!d(^X~P4XO#[$fO~O$Y$hO$[$gO$c$mO~ORfO![$nO$f$oO$h$qO~Og%WOl%XOn$uOo$tOp$tOv%YOx%ZOz%[O!P$|O![$}O!f%aO!k$yO#f%bO$T%_O$o%]O$q%^O$t%`O'{$sO'}TO(QUO(X$vO(p%OO(q%QOf(UP~O!k%cO~O!P%fO![%gO'{%eO~O!d%kO~O`%lO'r%lO~O'|!lO~P%[O%h%sO~P%[Og%WO!k%cO'{%eO'|!lO~Od%zO!k%cO'{%eO~O#r$TO~O|&PO![%|O!k&OO%d&SO'{%eO'|!lO'}TO(QUO_)OP~O!w#sO~O%m&UO!P(zX![(zX'{(zX~O'{&VO~O!t&[O#s!PO%d!QO%f!OO%g!OO%h!OO%k!RO%m!SO%p!TO%q!TO~Oc&aOd&`O!w&^O%b&_O%u&]O~P;xOc&dOdyO![&cO!t&[O!wxO!{]O#s!PO%b}O%f!OO%g!OO%h!OO%k!RO%m!SO%p!TO%q!TO%s!UO~Oa&gO#[&jO%d&eO'|!lO~P<}O!k&kO!t&oO~O!k#oO~O![XO~O`%lO'q&wO'r%lO~O`%lO'q&zO'r%lO~O`%lO'q&|O'r%lO~O'p[X!V[Xr[X!j[X&T[X![[X%c[X!d[X~P(qO!_'ZO!`'SO!a'SO'|!lO'}TO(QUO~Oo'QO!P'PO!X'TO(['OO!Z(`P!Z(oP~P@UOj'^O!['[O'{%eO~Od'cO!k%cO'{%eO~O|&PO!k&OO~Oo!nO!P!oO!{:jO#P!pO#Q!pO#S!pO#T!pO'|!lO'}TO(QUO([!mO(g!sO~O!_'iO!`'hO!a'hO#R!pO#W'jO#X'jO~PApO`%lOg%WO!d#vO!k%cO'r%lO(i'lO~O!o'pO#['nO~PCOOo!nO!P!oO'}TO(QUO([!mO(g!sO~O![XOo(eX!P(eX!_(eX!`(eX!a(eX!{(eX#P(eX#Q(eX#R(eX#S(eX#T(eX#W(eX#X(eX'|(eX'}(eX(Q(eX([(eX(g(eX~O!`'hO!a'hO'|!lO~PCnO'w'tO'x'tO'y'vO~O^!}O'}'xO(O!}O(P'xO~O^#QO(P'xO(Q'xO(R#QO~Ot#SO!R#TO(Y#TO(Z'|O~O!X(OO!V'PX!V'VX!Y'PX!Y'VX~P+}O!Y(QO!V(_X~OP$^OZ$eOn$RO|#zO}#{O!P#|O!Y(QO!h$TO!i#xO!k#yO!o$^O#j$PO#k$QO#l$QO#m$QO#n$SO#o$TO#p$TO#q$dO#r$TO#t$UO#v$WO#x$YO#y$ZO(XVO(i$[O(p#}O(q$OO~O!V(_X~PGbO!V(VO~O!V(lX!Y(lX!d(lX!j(lX(i(lX~O#[(lX#g#`X!Z(lX~PIhO#[(WO!V(nX!Y(nX~O!Y(XO!V(mX~O!V([O~O#[$fO~PIhO!Z(]O~P`O|#zO}#{O!P#|O!i#xO!k#yO(XVOP!maZ!man!ma!Y!ma!h!ma!o!ma#j!ma#k!ma#l!ma#m!ma#n!ma#o!ma#p!ma#q!ma#r!ma#t!ma#v!ma#x!ma#y!ma(i!ma(p!ma(q!ma~O`!ma'r!ma'p!ma!V!ma!j!mar!ma![!ma%c!ma!d!ma~PKOO!j(^O~O!d#vO#[(_O(i'lO!Y(kX`(kX'r(kX~O!j(kX~PMnO!P%fO![%gO!{]O#e(dO#f(cO'{%eO~O!Y(eO!j(jX~O!j(gO~O!P%fO![%gO#f(cO'{%eO~OP(^XZ(^Xn(^X|(^X}(^X!P(^X!Y(^X!h(^X!i(^X!k(^X!o(^X#j(^X#k(^X#l(^X#m(^X#n(^X#o(^X#p(^X#q(^X#r(^X#t(^X#v(^X#x(^X#y(^X(X(^X(i(^X(p(^X(q(^X~O!d#vO!j(^X~P! [O|(hO}(iO!i#xO!k#yO!{!za!P!za~O!w!za%b!za![!za#e!za#f!za'{!za~P!#`O!w(mO~OPYOQYORfOc!jOd!iOlkOnYOokOpkOvkOxYOzYO!PWO!TkO!UkO![XO!fuO!kZO!nYO!oYO!pYO!rvO!t!gO!w!hO$T!kO'{!dO'}TO(QUO(XVO(g[O(uiO~Og%WOl%XOn$uOo$tOp$tOv%YOx%ZOz;WO!P$|O![$}O!f<hO!k$yO#f;^O$T%_O$o;YO$q;[O$t%`O'{(qO'}TO(QUO(X$vO(p%OO(q%QO~O#g(sO~Og%WOl%XOn$uOo$tOp$tOv%YOx%ZOz%[O!P$|O![$}O!f%aO!k$yO#f%bO$T%_O$o%]O$q%^O$t%`O'{(qO'}TO(QUO(X$vO(p%OO(q%QO~Of(bP~P!(SO!X(wO!j(cP~P%[O([(yO(g[O~O!P({O!k#yO([(yO(g[O~OP:iOQ:iORfOc<dOd!iOlkOn:iOokOpkOvkOx:iOz:iO!PWO!TkO!UkO![!eO!f:lO!kZO!n:iO!o:iO!p:iO!r:mO!t:pO!w!hO$T!kO'{)ZO'}TO(QUO(XVO(g[O(u<bO~O})^O!k#yO~O!Y$bO`$ma'r$ma'p$ma!j$ma!V$ma![$ma%c$ma!d$ma~O#s)bO~P!&dO|)eO!d)dO![$ZX$W$ZX$Y$ZX$[$ZX$c$ZX~O!d)dO![(rX$W(rX$Y(rX$[(rX$c(rX~O|)eO~P!.OO|)eO![(rX$W(rX$Y(rX$[(rX$c(rX~O![)gO$W)kO$Y)fO$[)fO$c)lO~O!X)oO~P!*fO$Y$hO$[$gO$c)sO~Oj$uX|$uX!P$uX!i$uX(p$uX(q$uX~OfiXf$uXjiX!YiX#[iX~P!/tOo)uO~Ot)vO(Y)wO(Z)yO~Oj*SO|){O!P)|O(p%OO(q%QO~Of)zO~P!0}Of*TO~Og%WOl%XOn$uOo$tOp$tOv%YOx%ZOz;WO!P*VO![*WO!f<hO!k$yO#f;^O$T%_O$o;YO$q;[O$t%`O'}TO(QUO(X$vO(p%OO(q%QO~O!X*ZO'{*UO!j(vP~P!1lO#g*]O~O!k*^O~Og%WOl%XOn$uOo$tOp$tOv%YOx%ZOz;WO!P$|O![$}O!f<hO!k$yO#f;^O$T%_O$o;YO$q;[O$t%`O'{*`O'}TO(QUO(X$vO(p%OO(q%QO~O!X*cO!V(wP~P!3kOn*oO!P*gO!_*mO!`*fO!a*fO!k*^O#W*nO%Y*iO'|!lO([!mO~O!Z*lO~P!5`O!i#xOj(WX|(WX!P(WX(p(WX(q(WX!Y(WX#[(WX~Of(WX#|(WX~P!6XOj*tO#[*sOf(VX!Y(VX~O!Y*uOf(UX~O'{&VOf(UP~O!k*|O~O'{(qO~Ol+QO!P%fO!X#iO![%gO!{]O#e#lO#f#iO'{%eO!j(jP~O!d#vO#g+RO~O!P%fO!X+TO!Y(XO![%gO'{%eO!V(mP~Oo'WO!P+VO!X+UO'}TO(QUO([(yO~O!Z(oP~P!9SO!Y+WO`({X'r({X~OP$^OZ$eOn$RO|#zO}#{O!P#|O!h$TO!i#xO!k#yO!o$^O#j$PO#k$QO#l$QO#m$QO#n$SO#o$TO#p$TO#q$dO#r$TO#t$UO#v$WO#x$YO#y$ZO(XVO(i$[O(p#}O(q$OO~O`!ea!Y!ea'r!ea'p!ea!V!ea!j!ear!ea![!ea%c!ea!d!ea~P!9zO|#zO}#{O!P#|O!i#xO!k#yO(XVOP!qaZ!qan!qa!Y!qa!h!qa!o!qa#j!qa#k!qa#l!qa#m!qa#n!qa#o!qa#p!qa#q!qa#r!qa#t!qa#v!qa#x!qa#y!qa(i!qa(p!qa(q!qa~O`!qa'r!qa'p!qa!V!qa!j!qar!qa![!qa%c!qa!d!qa~P!<eO|#zO}#{O!P#|O!i#xO!k#yO(XVOP!saZ!san!sa!Y!sa!h!sa!o!sa#j!sa#k!sa#l!sa#m!sa#n!sa#o!sa#p!sa#q!sa#r!sa#t!sa#v!sa#x!sa#y!sa(i!sa(p!sa(q!sa~O`!sa'r!sa'p!sa!V!sa!j!sar!sa![!sa%c!sa!d!sa~P!?OOg%WOj+aO!['[O%c+`O~O!d+cO`(TX![(TX'r(TX!Y(TX~O`%lO![XO'r%lO~Og%WO!k%cO~Og%WO!k%cO'{%eO~O!d#vO#g(sO~Oa+nO%d+oO'{+kO'}TO(QUO!Z)PP~O!Y+pO_)OX~OZ+tO~O_+uO~O![%|O'{%eO'|!lO_)OP~Og%WO#[+zO~Og%WOj+}O![$}O~O![,PO~O|,RO![XO~O%h%sO~O!w,WO~Od,]O~Oa,^O'{#nO'}TO(QUO!Z(}P~Od%zO~O%d!QO'{&VO~P<}OZ,cO_,bO~OPYOQYORfOczOdyOlkOnYOokOpkOvkOxYOzYO!PWO!TkO!UkO!fuO!kZO!nYO!oYO!pYO!rvO!wxO!{]O%b}O'}TO(QUO(XVO(g[O(uiO~O![!eO!t!gO$T!kO'{!dO~P!FRO_,bO`%lO'r%lO~OPYOQYORfOc!jOd!iOlkOnYOokOpkOvkOxYOzYO!PWO!TkO!UkO![!eO!fuO!kZO!nYO!oYO!pYO!rvO!w!hO$T!kO'{!dO'}TO(QUO(XVO(g[O(uiO~O`,hO!twO#s!OO%f!OO%g!OO%h!OO~P!HkO!k&kO~O&V,nO~O![,pO~O&h,rO&j,sOP&eaQ&eaR&eaX&ea`&eac&ead&eal&ean&eao&eap&eav&eax&eaz&ea!P&ea!T&ea!U&ea![&ea!f&ea!k&ea!n&ea!o&ea!p&ea!r&ea!t&ea!w&ea!{&ea#s&ea$T&ea%b&ea%d&ea%f&ea%g&ea%h&ea%k&ea%m&ea%p&ea%q&ea%s&ea&P&ea&V&ea&X&ea&Z&ea&]&ea&`&ea&f&ea&l&ea&n&ea&p&ea&r&ea&t&ea'p&ea'{&ea'}&ea(Q&ea(X&ea(g&ea(u&ea!Z&ea&^&eaa&ea&c&ea~O'{,xO~Og!bX!Y!OX!Z!OX!d!OX!d!bX!k!bX#[!OX~O!Y!bX!Z!bX~P# qO!d,}O#[,|Og(aX!Y#dX!Y(aX!Z#dX!Z(aX!d(aX!k(aX~Og%WO!d-PO!k%cO!Y!^X!Z!^X~Oo!nO!P!oO'}TO(QUO([!mO~OP:iOQ:iORfOc<dOd!iOlkOn:iOokOpkOvkOx:iOz:iO!PWO!TkO!UkO![!eO!f:lO!kZO!n:iO!o:iO!p:iO!r:mO!t:pO!w!hO$T!kO'}TO(QUO(XVO(g[O(u<bO~O'{;dO~P##uO!Y-TO!Z(`X~O!Z-VO~O!d,}O#[,|O!Y#dX!Z#dX~O!Y-WO!Z(oX~O!Z-YO~O!`-ZO!a-ZO'|!lO~P##dO!Z-^O~P'_Oj-aO!['[O~O!V-fO~Oo!za!_!za!`!za!a!za#P!za#Q!za#R!za#S!za#T!za#W!za#X!za'|!za'}!za(Q!za([!za(g!za~P!#`O!o-kO#[-iO~PCOO!`-mO!a-mO'|!lO~PCnO`%lO#[-iO'r%lO~O`%lO!d#vO#[-iO'r%lO~O`%lO!d#vO!o-kO#[-iO'r%lO(i'lO~O'w'tO'x'tO'y-rO~Or-sO~O!V'Pa!Y'Pa~P!9zO!X-wO!V'PX!Y'PX~P%[O!Y(QO!V(_a~O!V(_a~PGbO!Y(XO!V(ma~O!P%fO!X-{O![%gO'{%eO!V'VX!Y'VX~O#[-}O!Y(ka!j(ka`(ka'r(ka~O!d#vO~P#+{O!Y(eO!j(ja~O!P%fO![%gO#f.RO'{%eO~Ol.WO!P%fO!X.TO![%gO!{]O#e.VO#f.TO'{%eO!Y'YX!j'YX~O}.[O!k#yO~Og%WOj._O!['[O%c.^O~O`#_i!Y#_i'r#_i'p#_i!V#_i!j#_ir#_i![#_i%c#_i!d#_i~P!9zOj<nO|){O!P)|O(p%OO(q%QO~O#g#Za`#Za#[#Za'r#Za!Y#Za!j#Za![#Za!V#Za~P#.wO#g(WXP(WXZ(WX`(WXn(WX}(WX!h(WX!k(WX!o(WX#j(WX#k(WX#l(WX#m(WX#n(WX#o(WX#p(WX#q(WX#r(WX#t(WX#v(WX#x(WX#y(WX'r(WX(X(WX(i(WX!j(WX!V(WX'p(WXr(WX![(WX%c(WX!d(WX~P!6XO!Y.lOf(bX~P!0}Of.nO~O!Y.oO!j(cX~P!9zO!j.rO~O!V.tO~OP$^O|#zO}#{O!P#|O!i#xO!k#yO!o$^O(XVOZ#ii`#iin#ii!Y#ii!h#ii#k#ii#l#ii#m#ii#n#ii#o#ii#p#ii#q#ii#r#ii#t#ii#v#ii#x#ii#y#ii'r#ii(i#ii(p#ii(q#ii'p#ii!V#ii!j#iir#ii![#ii%c#ii!d#ii~O#j#ii~P#2sO#j$PO~P#2sOP$^O|#zO}#{O!P#|O!i#xO!k#yO!o$^O#j$PO#k$QO#l$QO#m$QO(XVOZ#ii`#ii!Y#ii!h#ii#n#ii#o#ii#p#ii#q#ii#r#ii#t#ii#v#ii#x#ii#y#ii'r#ii(i#ii(p#ii(q#ii'p#ii!V#ii!j#iir#ii![#ii%c#ii!d#ii~On#ii~P#5eOn$RO~P#5eOP$^On$RO|#zO}#{O!P#|O!i#xO!k#yO!o$^O#j$PO#k$QO#l$QO#m$QO#n$SO(XVO`#ii!Y#ii#t#ii#v#ii#x#ii#y#ii'r#ii(i#ii(p#ii(q#ii'p#ii!V#ii!j#iir#ii![#ii%c#ii!d#ii~OZ#ii!h#ii#o#ii#p#ii#q#ii#r#ii~P#8VOZ$eO!h$TO#o$TO#p$TO#q$dO#r$TO~P#8VOP$^OZ$eOn$RO|#zO}#{O!P#|O!h$TO!i#xO!k#yO!o$^O#j$PO#k$QO#l$QO#m$QO#n$SO#o$TO#p$TO#q$dO#r$TO#t$UO(XVO(q$OO`#ii!Y#ii#x#ii#y#ii'r#ii(i#ii(p#ii'p#ii!V#ii!j#iir#ii![#ii%c#ii!d#ii~O#v$WO~P#;WO#v#ii~P#;WOP$^OZ$eOn$RO|#zO}#{O!P#|O!h$TO!i#xO!k#yO!o$^O#j$PO#k$QO#l$QO#m$QO#n$SO#o$TO#p$TO#q$dO#r$TO#t$UO(XVO`#ii!Y#ii#x#ii#y#ii'r#ii(i#ii'p#ii!V#ii!j#iir#ii![#ii%c#ii!d#ii~O#v#ii(p#ii(q#ii~P#=xO#v$WO(p#}O(q$OO~P#=xOP$^OZ$eOn$RO|#zO}#{O!P#|O!h$TO!i#xO!k#yO!o$^O#j$PO#k$QO#l$QO#m$QO#n$SO#o$TO#p$TO#q$dO#r$TO#t$UO#v$WO#x$YO(XVO(p#}O(q$OO~O`#ii!Y#ii#y#ii'r#ii(i#ii'p#ii!V#ii!j#iir#ii![#ii%c#ii!d#ii~P#@pOP[XZ[Xn[X|[X}[X!P[X!h[X!i[X!k[X!o[X#[[X#geX#j[X#k[X#l[X#m[X#n[X#o[X#p[X#q[X#r[X#t[X#v[X#x[X#y[X$O[X(X[X(i[X(p[X(q[X!Y[X!Z[X~O#|[X~P#CZOP$^OZ;QOn:tO|#zO}#{O!P#|O!h:vO!i#xO!k#yO!o$^O#j:rO#k:sO#l:sO#m:sO#n:uO#o:vO#p:vO#q;PO#r:vO#t:wO#v:yO#x:{O#y:|O(XVO(i$[O(p#}O(q$OO~O#|.vO~P#EhO#[;RO$O;RO#|(^X!Z(^X~P! [O`']a!Y']a'r']a'p']a!j']a!V']ar']a![']a%c']a!d']a~P!9zOP#iiZ#ii`#iin#ii}#ii!Y#ii!h#ii!i#ii!k#ii!o#ii#j#ii#k#ii#l#ii#m#ii#n#ii#o#ii#p#ii#q#ii#r#ii#t#ii#v#ii#x#ii#y#ii'r#ii(X#ii(i#ii'p#ii!V#ii!j#iir#ii![#ii%c#ii!d#ii~P#.wO`#}i!Y#}i'r#}i'p#}i!V#}i!j#}ir#}i![#}i%c#}i!d#}i~P!9zO$Y.{O$[.{O~O$Y.|O$[.|O~O!d)dO#[.}O![$`X$W$`X$Y$`X$[$`X$c$`X~O!X/OO~O![)gO$W/QO$Y)fO$[)fO$c/RO~O!Y:}O!Z(]X~P#EhO!Z/SO~O!d)dO$c(rX~O$c/UO~Ot)vO(Y)wO(Z/XO~O!V/]O~P!&dO(p%OOj%Za|%Za!P%Za(q%Za!Y%Za#[%Za~Of%Za#|%Za~P#MxO(q%QOj%]a|%]a!P%]a(p%]a!Y%]a#[%]a~Of%]a#|%]a~P#NkO!YeX!deX!jeX!j$uX(ieX~P!/tO!X/fO!Y(XO'{/eO!V(mP!V(wP~P!1lOn*oO!_*mO!`*fO!a*fO!k*^O#W*nO%Y*iO'|!lO~Oo'WO!P/gO!X+UO!Z*lO'}TO(QUO([;aO!Z(oP~P$!UO!j/hO~P#.wO!Y/iO!d#vO(i'lO!j(vX~O!j/nO~O!P%fO!X*ZO![%gO'{%eO!j(vP~O#g/pO~O!V$uX!Y$uX!d$|X~P!/tO!Y/qO!V(wX~P#.wO!d/sO~O!V/uO~Og%WOn/yO!d#vO!k%cO(i'lO~O'{/{O~O!d+cO~O`%lO!Y0PO'r%lO~O!Z0RO~P!5`O!`0SO!a0SO'|!lO([!mO~O!P0UO([!mO~O#W0VO~Of%Za!Y%Za#[%Za#|%Za~P!0}Of%]a!Y%]a#[%]a#|%]a~P!0}O'{&VOf'fX!Y'fX~O!Y*uOf(Ua~Of0`O~O|0aO}0aO!P0bOjya(pya(qya!Yya#[ya~Ofya#|ya~P$'wO|){O!P)|Oj$na(p$na(q$na!Y$na#[$na~Of$na#|$na~P$(mO|){O!P)|Oj$pa(p$pa(q$pa!Y$pa#[$pa~Of$pa#|$pa~P$)`O#g0dO~Of%Oa!Y%Oa#[%Oa#|%Oa~P!0}O!d#vO~O#g0gO~O!Y+WO`({a'r({a~O|#zO}#{O!P#|O!i#xO!k#yO(XVOP!qiZ!qin!qi!Y!qi!h!qi!o!qi#j!qi#k!qi#l!qi#m!qi#n!qi#o!qi#p!qi#q!qi#r!qi#t!qi#v!qi#x!qi#y!qi(i!qi(p!qi(q!qi~O`!qi'r!qi'p!qi!V!qi!j!qir!qi![!qi%c!qi!d!qi~P$*}Og%WOn$uOo$tOp$tOv%YOx%ZOz;WO!P$|O![$}O!f<hO!k$yO#f;^O$T%_O$o;YO$q;[O$t%`O'}TO(QUO(X$vO(p%OO(q%QO~Ol0qO'{0pO~P$-hO!d+cO`(Ta![(Ta'r(Ta!Y(Ta~O#g0wO~OZ[X!YeX!ZeX~O!Y0xO!Z)PX~O!Z0zO~OZ0{O~Oa0}O'{+kO'}TO(QUO~O![%|O'{%eO_'nX!Y'nX~O!Y+pO_)Oa~O!j1QO~P!9zOZ1TO~O_1UO~O#[1XO~Oj1[O![$}O~O([(yO!Z(|P~Og%WOj1eO![1bO%c1dO~OZ1oO!Y1mO!Z(}X~O!Z1pO~O_1rO`%lO'r%lO~O'{#nO'}TO(QUO~O#[$fO$O$fOP(^XZ(^Xn(^X|(^X}(^X!P(^X!Y(^X!h(^X!k(^X!o(^X#j(^X#k(^X#l(^X#m(^X#n(^X#o(^X#p(^X#q(^X#t(^X#v(^X#x(^X#y(^X(X(^X(i(^X(p(^X(q(^X~O#r1uO&T1vO`(^X!i(^X~P$3OO#[$fO#r1uO&T1vO~O`1xO~P%[O`1zO~O&^1}OP&[iQ&[iR&[iX&[i`&[ic&[id&[il&[in&[io&[ip&[iv&[ix&[iz&[i!P&[i!T&[i!U&[i![&[i!f&[i!k&[i!n&[i!o&[i!p&[i!r&[i!t&[i!w&[i!{&[i#s&[i$T&[i%b&[i%d&[i%f&[i%g&[i%h&[i%k&[i%m&[i%p&[i%q&[i%s&[i&P&[i&V&[i&X&[i&Z&[i&]&[i&`&[i&f&[i&l&[i&n&[i&p&[i&r&[i&t&[i'p&[i'{&[i'}&[i(Q&[i(X&[i(g&[i(u&[i!Z&[ia&[i&c&[i~Oa2TO!Z2RO&c2SO~P`O![XO!k2VO~O&j,sOP&eiQ&eiR&eiX&ei`&eic&eid&eil&ein&eio&eip&eiv&eix&eiz&ei!P&ei!T&ei!U&ei![&ei!f&ei!k&ei!n&ei!o&ei!p&ei!r&ei!t&ei!w&ei!{&ei#s&ei$T&ei%b&ei%d&ei%f&ei%g&ei%h&ei%k&ei%m&ei%p&ei%q&ei%s&ei&P&ei&V&ei&X&ei&Z&ei&]&ei&`&ei&f&ei&l&ei&n&ei&p&ei&r&ei&t&ei'p&ei'{&ei'}&ei(Q&ei(X&ei(g&ei(u&ei!Z&ei&^&eia&ei&c&ei~O!V2]O~O!Y!^a!Z!^a~P#EhOo!nO!P!oO!X2cO([!mO!Y'QX!Z'QX~P@UO!Y-TO!Z(`a~O!Y'WX!Z'WX~P!9SO!Y-WO!Z(oa~O!Z2jO~P'_O`%lO#[2sO'r%lO~O`%lO!d#vO#[2sO'r%lO~O`%lO!d#vO!o2wO#[2sO'r%lO(i'lO~O`%lO'r%lO~P!9zO!Y$bOr$ma~O!V'Pi!Y'Pi~P!9zO!Y(QO!V(_i~O!Y(XO!V(mi~O!V(ni!Y(ni~P!9zO!Y(ki!j(ki`(ki'r(ki~P!9zO#[2yO!Y(ki!j(ki`(ki'r(ki~O!Y(eO!j(ji~O!P%fO![%gO!{]O#e3OO#f2}O'{%eO~O!P%fO![%gO#f2}O'{%eO~Oj3VO!['[O%c3UO~Og%WOj3VO!['[O%c3UO~O#g%ZaP%ZaZ%Za`%Zan%Za}%Za!h%Za!i%Za!k%Za!o%Za#j%Za#k%Za#l%Za#m%Za#n%Za#o%Za#p%Za#q%Za#r%Za#t%Za#v%Za#x%Za#y%Za'r%Za(X%Za(i%Za!j%Za!V%Za'p%Zar%Za![%Za%c%Za!d%Za~P#MxO#g%]aP%]aZ%]a`%]an%]a}%]a!h%]a!i%]a!k%]a!o%]a#j%]a#k%]a#l%]a#m%]a#n%]a#o%]a#p%]a#q%]a#r%]a#t%]a#v%]a#x%]a#y%]a'r%]a(X%]a(i%]a!j%]a!V%]a'p%]ar%]a![%]a%c%]a!d%]a~P#NkO#g%ZaP%ZaZ%Za`%Zan%Za}%Za!Y%Za!h%Za!i%Za!k%Za!o%Za#j%Za#k%Za#l%Za#m%Za#n%Za#o%Za#p%Za#q%Za#r%Za#t%Za#v%Za#x%Za#y%Za'r%Za(X%Za(i%Za!j%Za!V%Za'p%Za#[%Zar%Za![%Za%c%Za!d%Za~P#.wO#g%]aP%]aZ%]a`%]an%]a}%]a!Y%]a!h%]a!i%]a!k%]a!o%]a#j%]a#k%]a#l%]a#m%]a#n%]a#o%]a#p%]a#q%]a#r%]a#t%]a#v%]a#x%]a#y%]a'r%]a(X%]a(i%]a!j%]a!V%]a'p%]a#[%]ar%]a![%]a%c%]a!d%]a~P#.wO#gyaPyaZya`yanya!hya!iya!kya!oya#jya#kya#lya#mya#nya#oya#pya#qya#rya#tya#vya#xya#yya'rya(Xya(iya!jya!Vya'pyarya![ya%cya!dya~P$'wO#g$naP$naZ$na`$nan$na}$na!h$na!i$na!k$na!o$na#j$na#k$na#l$na#m$na#n$na#o$na#p$na#q$na#r$na#t$na#v$na#x$na#y$na'r$na(X$na(i$na!j$na!V$na'p$nar$na![$na%c$na!d$na~P$(mO#g$paP$paZ$pa`$pan$pa}$pa!h$pa!i$pa!k$pa!o$pa#j$pa#k$pa#l$pa#m$pa#n$pa#o$pa#p$pa#q$pa#r$pa#t$pa#v$pa#x$pa#y$pa'r$pa(X$pa(i$pa!j$pa!V$pa'p$par$pa![$pa%c$pa!d$pa~P$)`O#g%OaP%OaZ%Oa`%Oan%Oa}%Oa!Y%Oa!h%Oa!i%Oa!k%Oa!o%Oa#j%Oa#k%Oa#l%Oa#m%Oa#n%Oa#o%Oa#p%Oa#q%Oa#r%Oa#t%Oa#v%Oa#x%Oa#y%Oa'r%Oa(X%Oa(i%Oa!j%Oa!V%Oa'p%Oa#[%Oar%Oa![%Oa%c%Oa!d%Oa~P#.wO`#_q!Y#_q'r#_q'p#_q!V#_q!j#_qr#_q![#_q%c#_q!d#_q~P!9zOf'RX!Y'RX~P!(SO!Y.lOf(ba~O!X3aO!Y'SX!j'SX~P%[O!Y.oO!j(ca~O!Y.oO!j(ca~P!9zO!V3dO~O#|!ma!Z!ma~PKOO#|!ea!Y!ea!Z!ea~P#EhO#|!qa!Z!qa~P!<eO#|!sa!Z!sa~P!?OORfO![3vO$a3wO~O!Z3{O~Or3|O~P#.wO`$jq!Y$jq'r$jq'p$jq!V$jq!j$jqr$jq![$jq%c$jq!d$jq~P!9zO!V3}O~P#.wO|){O!P)|O(q%QOj'ba(p'ba!Y'ba#['ba~Of'ba#|'ba~P%,rO|){O!P)|Oj'da(p'da(q'da!Y'da#['da~Of'da#|'da~P%-eO(i$[O~P#.wO!VeX!V$uX!YeX!Y$uX!d$|X#[eX~P!/tO'{;jO~P!1lOlkO'{4PO~P.iO!P%fO!X4RO![%gO'{%eO!Y'^X!j'^X~O!Y/iO!j(va~O!Y/iO!d#vO!j(va~O!Y/iO!d#vO(i'lO!j(va~Of$wi!Y$wi#[$wi#|$wi~P!0}O!X4ZO!V'`X!Y'`X~P!3kO!Y/qO!V(wa~O!Y/qO!V(wa~P#.wO!d#vO#r4cO~On4fO!d#vO(i'lO~O(p%OOj%Zi|%Zi!P%Zi(q%Zi!Y%Zi#[%Zi~Of%Zi#|%Zi~P%1sO(q%QOj%]i|%]i!P%]i(p%]i!Y%]i#[%]i~Of%]i#|%]i~P%2fOf(Vi!Y(Vi~P!0}O#[4mOf(Vi!Y(Vi~P!0}O!j4pO~O`$kq!Y$kq'r$kq'p$kq!V$kq!j$kqr$kq![$kq%c$kq!d$kq~P!9zO!V4tO~O!Y4uO![(xX~P#.wO!i#xO~P4XO`$uX![$uX%W[X'r$uX!Y$uX~P!/tO%W4wO`kXjkX|kX!PkX![kX'rkX(pkX(qkX!YkX~O%W4wO~Oa4}O%d5OO'{+kO'}TO(QUO!Y'mX!Z'mX~O!Y0xO!Z)Pa~OZ5SO~O_5TO~O`%lO'r%lO~P#.wO![$}O~P#.wO!Y5]O#[5_O!Z(|X~O!Z5`O~Oo!nO!P5aO!_!yO!`!vO!a!vO!{:jO#P!pO#Q!pO#R!pO#S!pO#T!pO#W5fO#X!zO'|!lO'}TO(QUO([!mO(g!sO~O!Z5eO~P%7wOj5kO![1bO%c5jO~Og%WOj5kO![1bO%c5jO~Oa5rO'{#nO'}TO(QUO!Y'lX!Z'lX~O!Y1mO!Z(}a~O'}TO(QUO([5tO~O_5xO~O#r5{O&T5|O~PMnO!j5}O~P%[O`6PO~O`6PO~P%[Oa2TO!Z6UO&c2SO~P`O!d6WO~O!d6YOg(ai!Y(ai!Z(ai!d(ai!k(ai~O!Y#di!Z#di~P#EhO#[6ZO!Y#di!Z#di~O!Y!^i!Z!^i~P#EhO`%lO#[6dO'r%lO~O`%lO!d#vO#[6dO'r%lO~O!Y(kq!j(kq`(kq'r(kq~P!9zO!Y(eO!j(jq~O!P%fO![%gO#f6kO'{%eO~O!['[O%c6nO~Oj6qO!['[O%c6nO~O#g'baP'baZ'ba`'ban'ba}'ba!h'ba!i'ba!k'ba!o'ba#j'ba#k'ba#l'ba#m'ba#n'ba#o'ba#p'ba#q'ba#r'ba#t'ba#v'ba#x'ba#y'ba'r'ba(X'ba(i'ba!j'ba!V'ba'p'bar'ba!['ba%c'ba!d'ba~P%,rO#g'daP'daZ'da`'dan'da}'da!h'da!i'da!k'da!o'da#j'da#k'da#l'da#m'da#n'da#o'da#p'da#q'da#r'da#t'da#v'da#x'da#y'da'r'da(X'da(i'da!j'da!V'da'p'dar'da!['da%c'da!d'da~P%-eO#g$wiP$wiZ$wi`$win$wi}$wi!Y$wi!h$wi!i$wi!k$wi!o$wi#j$wi#k$wi#l$wi#m$wi#n$wi#o$wi#p$wi#q$wi#r$wi#t$wi#v$wi#x$wi#y$wi'r$wi(X$wi(i$wi!j$wi!V$wi'p$wi#[$wir$wi![$wi%c$wi!d$wi~P#.wO#g%ZiP%ZiZ%Zi`%Zin%Zi}%Zi!h%Zi!i%Zi!k%Zi!o%Zi#j%Zi#k%Zi#l%Zi#m%Zi#n%Zi#o%Zi#p%Zi#q%Zi#r%Zi#t%Zi#v%Zi#x%Zi#y%Zi'r%Zi(X%Zi(i%Zi!j%Zi!V%Zi'p%Zir%Zi![%Zi%c%Zi!d%Zi~P%1sO#g%]iP%]iZ%]i`%]in%]i}%]i!h%]i!i%]i!k%]i!o%]i#j%]i#k%]i#l%]i#m%]i#n%]i#o%]i#p%]i#q%]i#r%]i#t%]i#v%]i#x%]i#y%]i'r%]i(X%]i(i%]i!j%]i!V%]i'p%]ir%]i![%]i%c%]i!d%]i~P%2fOf'Ra!Y'Ra~P!0}O!Y'Sa!j'Sa~P!9zO!Y.oO!j(ci~O#|#_i!Y#_i!Z#_i~P#EhOP$^O|#zO}#{O!P#|O!i#xO!k#yO!o$^O(XVOZ#iin#ii!h#ii#k#ii#l#ii#m#ii#n#ii#o#ii#p#ii#q#ii#r#ii#t#ii#v#ii#x#ii#y#ii#|#ii(i#ii(p#ii(q#ii!Y#ii!Z#ii~O#j#ii~P%JwO#j:rO~P%JwOP$^O|#zO}#{O!P#|O!i#xO!k#yO!o$^O#j:rO#k:sO#l:sO#m:sO(XVOZ#ii!h#ii#n#ii#o#ii#p#ii#q#ii#r#ii#t#ii#v#ii#x#ii#y#ii#|#ii(i#ii(p#ii(q#ii!Y#ii!Z#ii~On#ii~P%MSOn:tO~P%MSOP$^On:tO|#zO}#{O!P#|O!i#xO!k#yO!o$^O#j:rO#k:sO#l:sO#m:sO#n:uO(XVO#t#ii#v#ii#x#ii#y#ii#|#ii(i#ii(p#ii(q#ii!Y#ii!Z#ii~OZ#ii!h#ii#o#ii#p#ii#q#ii#r#ii~P& _OZ;QO!h:vO#o:vO#p:vO#q;PO#r:vO~P& _OP$^OZ;QOn:tO|#zO}#{O!P#|O!h:vO!i#xO!k#yO!o$^O#j:rO#k:sO#l:sO#m:sO#n:uO#o:vO#p:vO#q;PO#r:vO#t:wO(XVO(q$OO#x#ii#y#ii#|#ii(i#ii(p#ii!Y#ii!Z#ii~O#v:yO~P&#yO#v#ii~P&#yOP$^OZ;QOn:tO|#zO}#{O!P#|O!h:vO!i#xO!k#yO!o$^O#j:rO#k:sO#l:sO#m:sO#n:uO#o:vO#p:vO#q;PO#r:vO#t:wO(XVO#x#ii#y#ii#|#ii(i#ii!Y#ii!Z#ii~O#v#ii(p#ii(q#ii~P&&UO#v:yO(p#}O(q$OO~P&&UOP$^OZ;QOn:tO|#zO}#{O!P#|O!h:vO!i#xO!k#yO!o$^O#j:rO#k:sO#l:sO#m:sO#n:uO#o:vO#p:vO#q;PO#r:vO#t:wO#v:yO#x:{O(XVO(p#}O(q$OO~O#y#ii#|#ii(i#ii!Y#ii!Z#ii~P&(gO`#zy!Y#zy'r#zy'p#zy!V#zy!j#zyr#zy![#zy%c#zy!d#zy~P!9zOj<oO|){O!P)|O(p%OO(q%QO~OP#iiZ#iin#ii}#ii!h#ii!i#ii!k#ii!o#ii#j#ii#k#ii#l#ii#m#ii#n#ii#o#ii#p#ii#q#ii#r#ii#t#ii#v#ii#x#ii#y#ii#|#ii(X#ii(i#ii!Y#ii!Z#ii~P&+_O!i#xOP(WXZ(WXj(WXn(WX|(WX}(WX!P(WX!h(WX!k(WX!o(WX#j(WX#k(WX#l(WX#m(WX#n(WX#o(WX#p(WX#q(WX#r(WX#t(WX#v(WX#x(WX#y(WX#|(WX(X(WX(i(WX(p(WX(q(WX!Y(WX!Z(WX~O#|#}i!Y#}i!Z#}i~P#EhO#|!qi!Z!qi~P$*}O!Z7TO~O!Y']a!Z']a~P#EhOP[XZ[Xn[X|[X}[X!P[X!V[X!Y[X!h[X!i[X!k[X!o[X#[[X#geX#j[X#k[X#l[X#m[X#n[X#o[X#p[X#q[X#r[X#t[X#v[X#x[X#y[X$O[X(X[X(i[X(p[X(q[X~O!d%TX#r%TX~P&0aO!d#vO(i'lO!Y'^a!j'^a~O!Y/iO!j(vi~O!Y/iO!d#vO!j(vi~Of$wq!Y$wq#[$wq#|$wq~P!0}O!V'`a!Y'`a~P#.wO!d7[O~O!Y/qO!V(wi~P#.wO!Y/qO!V(wi~O!V7`O~O!d#vO#r7eO~On7fO!d#vO(i'lO~O|){O!P)|O(q%QOj'ca(p'ca!Y'ca#['ca~Of'ca#|'ca~P&5PO|){O!P)|Oj'ea(p'ea(q'ea!Y'ea#['ea~Of'ea#|'ea~P&5rO!V7hO~Of$yq!Y$yq#[$yq#|$yq~P!0}O`$ky!Y$ky'r$ky'p$ky!V$ky!j$kyr$ky![$ky%c$ky!d$ky~P!9zO!d6YO~O!Y4uO![(xa~O`#_y!Y#_y'r#_y'p#_y!V#_y!j#_yr#_y![#_y%c#_y!d#_y~P!9zOZ7mO~Oa7oO'{+kO'}TO(QUO~O!Y0xO!Z)Pi~O_7sO~O([(yO!Y'iX!Z'iX~O!Y5]O!Z(|a~O!Z7|O~P%7wOo!nO!P7}O'}TO(QUO([!mO(g!sO~O![1bO~O![1bO%c8PO~Oj8SO![1bO%c8PO~OZ8XO!Y'la!Z'la~O!Y1mO!Z(}i~O!j8]O~O!j8^O~O!j8aO~O!j8aO~P%[O`8cO~O!d8dO~O!j8eO~O!Y(ni!Z(ni~P#EhO`%lO#[8mO'r%lO~O!Y(ky!j(ky`(ky'r(ky~P!9zO!Y(eO!j(jy~O!['[O%c8pO~O#g$wqP$wqZ$wq`$wqn$wq}$wq!Y$wq!h$wq!i$wq!k$wq!o$wq#j$wq#k$wq#l$wq#m$wq#n$wq#o$wq#p$wq#q$wq#r$wq#t$wq#v$wq#x$wq#y$wq'r$wq(X$wq(i$wq!j$wq!V$wq'p$wq#[$wqr$wq![$wq%c$wq!d$wq~P#.wO#g'caP'caZ'ca`'can'ca}'ca!h'ca!i'ca!k'ca!o'ca#j'ca#k'ca#l'ca#m'ca#n'ca#o'ca#p'ca#q'ca#r'ca#t'ca#v'ca#x'ca#y'ca'r'ca(X'ca(i'ca!j'ca!V'ca'p'car'ca!['ca%c'ca!d'ca~P&5PO#g'eaP'eaZ'ea`'ean'ea}'ea!h'ea!i'ea!k'ea!o'ea#j'ea#k'ea#l'ea#m'ea#n'ea#o'ea#p'ea#q'ea#r'ea#t'ea#v'ea#x'ea#y'ea'r'ea(X'ea(i'ea!j'ea!V'ea'p'ear'ea!['ea%c'ea!d'ea~P&5rO#g$yqP$yqZ$yq`$yqn$yq}$yq!Y$yq!h$yq!i$yq!k$yq!o$yq#j$yq#k$yq#l$yq#m$yq#n$yq#o$yq#p$yq#q$yq#r$yq#t$yq#v$yq#x$yq#y$yq'r$yq(X$yq(i$yq!j$yq!V$yq'p$yq#[$yqr$yq![$yq%c$yq!d$yq~P#.wO!Y'Si!j'Si~P!9zO#|#_q!Y#_q!Z#_q~P#EhO(p%OOP%ZaZ%Zan%Za}%Za!h%Za!i%Za!k%Za!o%Za#j%Za#k%Za#l%Za#m%Za#n%Za#o%Za#p%Za#q%Za#r%Za#t%Za#v%Za#x%Za#y%Za#|%Za(X%Za(i%Za!Y%Za!Z%Za~Oj%Za|%Za!P%Za(q%Za~P&F}O(q%QOP%]aZ%]an%]a}%]a!h%]a!i%]a!k%]a!o%]a#j%]a#k%]a#l%]a#m%]a#n%]a#o%]a#p%]a#q%]a#r%]a#t%]a#v%]a#x%]a#y%]a#|%]a(X%]a(i%]a!Y%]a!Z%]a~Oj%]a|%]a!P%]a(p%]a~P&IUOj<oO|){O!P)|O(q%QO~P&F}Oj<oO|){O!P)|O(p%OO~P&IUO|0aO}0aO!P0bOPyaZyajyanya!hya!iya!kya!oya#jya#kya#lya#mya#nya#oya#pya#qya#rya#tya#vya#xya#yya#|ya(Xya(iya(pya(qya!Yya!Zya~O|){O!P)|OP$naZ$naj$nan$na}$na!h$na!i$na!k$na!o$na#j$na#k$na#l$na#m$na#n$na#o$na#p$na#q$na#r$na#t$na#v$na#x$na#y$na#|$na(X$na(i$na(p$na(q$na!Y$na!Z$na~O|){O!P)|OP$paZ$paj$pan$pa}$pa!h$pa!i$pa!k$pa!o$pa#j$pa#k$pa#l$pa#m$pa#n$pa#o$pa#p$pa#q$pa#r$pa#t$pa#v$pa#x$pa#y$pa#|$pa(X$pa(i$pa(p$pa(q$pa!Y$pa!Z$pa~OP%OaZ%Oan%Oa}%Oa!h%Oa!i%Oa!k%Oa!o%Oa#j%Oa#k%Oa#l%Oa#m%Oa#n%Oa#o%Oa#p%Oa#q%Oa#r%Oa#t%Oa#v%Oa#x%Oa#y%Oa#|%Oa(X%Oa(i%Oa!Y%Oa!Z%Oa~P&+_O#|$jq!Y$jq!Z$jq~P#EhO#|$kq!Y$kq!Z$kq~P#EhO!Z8|O~O#|8}O~P!0}O!d#vO!Y'^i!j'^i~O!d#vO(i'lO!Y'^i!j'^i~O!Y/iO!j(vq~O!V'`i!Y'`i~P#.wO!Y/qO!V(wq~O!V9TO~P#.wO!V9TO~Of(Vy!Y(Vy~P!0}O!Y'ga!['ga~P#.wO`%Vq![%Vq'r%Vq!Y%Vq~P#.wOZ9YO~O!Y0xO!Z)Pq~O#[9^O!Y'ia!Z'ia~O!Y5]O!Z(|i~P#EhO![1bO%c9bO~O'}TO(QUO([9gO~O!Y1mO!Z(}q~O!j9jO~O!j9kO~O!j9lO~O!j9lO~P%[O#[9oO!Y#dy!Z#dy~O!Y#dy!Z#dy~P#EhO!['[O%c9tO~O#|#zy!Y#zy!Z#zy~P#EhOP$wiZ$win$wi}$wi!h$wi!i$wi!k$wi!o$wi#j$wi#k$wi#l$wi#m$wi#n$wi#o$wi#p$wi#q$wi#r$wi#t$wi#v$wi#x$wi#y$wi#|$wi(X$wi(i$wi!Y$wi!Z$wi~P&+_O|){O!P)|O(q%QOP'baZ'baj'ban'ba}'ba!h'ba!i'ba!k'ba!o'ba#j'ba#k'ba#l'ba#m'ba#n'ba#o'ba#p'ba#q'ba#r'ba#t'ba#v'ba#x'ba#y'ba#|'ba(X'ba(i'ba(p'ba!Y'ba!Z'ba~O|){O!P)|OP'daZ'daj'dan'da}'da!h'da!i'da!k'da!o'da#j'da#k'da#l'da#m'da#n'da#o'da#p'da#q'da#r'da#t'da#v'da#x'da#y'da#|'da(X'da(i'da(p'da(q'da!Y'da!Z'da~O(p%OOP%ZiZ%Zij%Zin%Zi|%Zi}%Zi!P%Zi!h%Zi!i%Zi!k%Zi!o%Zi#j%Zi#k%Zi#l%Zi#m%Zi#n%Zi#o%Zi#p%Zi#q%Zi#r%Zi#t%Zi#v%Zi#x%Zi#y%Zi#|%Zi(X%Zi(i%Zi(q%Zi!Y%Zi!Z%Zi~O(q%QOP%]iZ%]ij%]in%]i|%]i}%]i!P%]i!h%]i!i%]i!k%]i!o%]i#j%]i#k%]i#l%]i#m%]i#n%]i#o%]i#p%]i#q%]i#r%]i#t%]i#v%]i#x%]i#y%]i#|%]i(X%]i(i%]i(p%]i!Y%]i!Z%]i~O#|$ky!Y$ky!Z$ky~P#EhO#|#_y!Y#_y!Z#_y~P#EhO!d#vO!Y'^q!j'^q~O!Y/iO!j(vy~O!V'`q!Y'`q~P#.wO!V9}O~P#.wO!Y0xO!Z)Py~O!Y5]O!Z(|q~O![1bO%c:UO~O!j:XO~O!['[O%c:^O~OP$wqZ$wqn$wq}$wq!h$wq!i$wq!k$wq!o$wq#j$wq#k$wq#l$wq#m$wq#n$wq#o$wq#p$wq#q$wq#r$wq#t$wq#v$wq#x$wq#y$wq#|$wq(X$wq(i$wq!Y$wq!Z$wq~P&+_O|){O!P)|O(q%QOP'caZ'caj'can'ca}'ca!h'ca!i'ca!k'ca!o'ca#j'ca#k'ca#l'ca#m'ca#n'ca#o'ca#p'ca#q'ca#r'ca#t'ca#v'ca#x'ca#y'ca#|'ca(X'ca(i'ca(p'ca!Y'ca!Z'ca~O|){O!P)|OP'eaZ'eaj'ean'ea}'ea!h'ea!i'ea!k'ea!o'ea#j'ea#k'ea#l'ea#m'ea#n'ea#o'ea#p'ea#q'ea#r'ea#t'ea#v'ea#x'ea#y'ea#|'ea(X'ea(i'ea(p'ea(q'ea!Y'ea!Z'ea~OP$yqZ$yqn$yq}$yq!h$yq!i$yq!k$yq!o$yq#j$yq#k$yq#l$yq#m$yq#n$yq#o$yq#p$yq#q$yq#r$yq#t$yq#v$yq#x$yq#y$yq#|$yq(X$yq(i$yq!Y$yq!Z$yq~P&+_Of%_!Z!Y%_!Z#[%_!Z#|%_!Z~P!0}O!Y'iq!Z'iq~P#EhO!Y#d!Z!Z#d!Z~P#EhO#g%_!ZP%_!ZZ%_!Z`%_!Zn%_!Z}%_!Z!Y%_!Z!h%_!Z!i%_!Z!k%_!Z!o%_!Z#j%_!Z#k%_!Z#l%_!Z#m%_!Z#n%_!Z#o%_!Z#p%_!Z#q%_!Z#r%_!Z#t%_!Z#v%_!Z#x%_!Z#y%_!Z'r%_!Z(X%_!Z(i%_!Z!j%_!Z!V%_!Z'p%_!Z#[%_!Zr%_!Z![%_!Z%c%_!Z!d%_!Z~P#.wOP%_!ZZ%_!Zn%_!Z}%_!Z!h%_!Z!i%_!Z!k%_!Z!o%_!Z#j%_!Z#k%_!Z#l%_!Z#m%_!Z#n%_!Z#o%_!Z#p%_!Z#q%_!Z#r%_!Z#t%_!Z#v%_!Z#x%_!Z#y%_!Z#|%_!Z(X%_!Z(i%_!Z!Y%_!Z!Z%_!Z~P&+_Or(]X~P1qO'|!lO~P!*fO!VeX!YeX#[eX~P&0aOP[XZ[Xn[X|[X}[X!P[X!Y[X!YeX!h[X!i[X!k[X!o[X#[[X#[eX#geX#j[X#k[X#l[X#m[X#n[X#o[X#p[X#q[X#r[X#t[X#v[X#x[X#y[X$O[X(X[X(i[X(p[X(q[X~O!deX!j[X!jeX(ieX~P'EROP:iOQ:iORfOc<dOd!iOlkOn:iOokOpkOvkOx:iOz:iO!PWO!TkO!UkO![XO!f:lO!kZO!n:iO!o:iO!p:iO!r:mO!t:pO!w!hO$T!kO'{)ZO'}TO(QUO(XVO(g[O(u<bO~O!Y:}O!Z$ma~Og%WOl%XOn$uOo$tOp$tOv%YOx%ZOz;XO!P$|O![$}O!f<iO!k$yO#f;_O$T%_O$o;ZO$q;]O$t%`O'{(qO'}TO(QUO(X$vO(p%OO(q%QO~O#s)bO~P'IwOn!bX(i!bX~P# qO!Z[X!ZeX~P'ERO!VeX!V$uX!YeX!Y$uX#[eX~P!/tO#g:qO~O!d#vO#g:qO~O#[;RO~O#r:vO~O#[;bO!Y(nX!Z(nX~O#[;RO!Y(lX!Z(lX~O#g;cO~Of;eO~P!0}O#g;kO~O#g;lO~O!d#vO#g;mO~O!d#vO#g;cO~O#|;nO~P#EhO#g;oO~O#g;pO~O#g;uO~O#g;vO~O#g;wO~O#g;xO~O#|;yO~P!0}O#|;zO~P!0}O!i#P#Q#S#T#W#e#f#q(u$o$q$t%W%b%c%d%k%m%p%q%s%u~'vS#k!U't'|#lo#j#mn|'u$Y'u'{$[([~",goto:"$4`)TPPPPP)UPP)XP)jP*z/PPPPP5wPP6_PP<U?kP@OP@OPPP@OPBOP@OP@OP@OPBSPPBXPBsPGlPPPGpPPPPGpJrPPPJxKtPGpPNSPPPP!!bGpPPPGpPGpP!$pGpP!(V!)X!)bP!*U!*Y!*UPPPPP!-f!)XPP!-v!.pP!1dGpGp!1i!4t!9[!9[!=YPPP!=bGpPPPPPPPPPPP!@pP!A}PPGp!C`PGpPGpGpGpGpPGp!DrP!G{P!KQP!KU!K`!Kd!KdP!GxP!Kh!KhP!NmP!NqGpGp!Nw##{@OP@OP@O@OP#%X@O@O#'c@O#*R@O#,V@O@O#,u#/R#/R#/W#/a#/R#/jP#/RP@O#0S@O#3s@O@O5wPPP#7jPPP#8T#8TP#8TP#8k#8TPP#8qP#8hP#8h#9U#8h#9p#9v5t)X#9y)XP#:Q#:Q#:QP)XP)XP)XP)XPP)XP#:W#:ZP#:Z)XP#:_P#:bP)XP)XP)XP)XP)XP)X)XPP#:h#:n#:y#;P#;V#;]#;c#;q#;w#;}#<X#<_#<i#<y#=P#=q#>T#>Z#>a#>o#?U#@s#AR#AY#Bn#B|#Dh#Dv#D|#ES#EY#Ed#Ej#Ep#Ez#F^#FdPPPPPPPPPP#FjPPPPPPP#G_#Jf#Ku#K|#LUPPPP$#[$&S$,l$,o$,r$-_$-b$-e$-l$-tP$-zP$.h$.l$/d$0r$0w$1_PP$1d$1j$1nP$1q$1u$1y$2o$3W$3o$3s$3v$3y$4P$4S$4W$4[R!|RoqOXst!Z#d%k&n&p&q&s,k,p1}2QY!vQ'[-]1b5dQ%qvQ%yyQ&Q|Q&f!VS'S!e-TQ'b!iS'h!r!yU*f$}*W*kQ+i%zQ+v&SQ,[&`Q-Z'ZQ-e'cQ-m'iQ0S*mQ1l,]R;`:m%QdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#y#|$P$Q$R$S$T$U$V$W$X$Y$Z$b$f%k%q&O&g&j&n&p&q&s&w'P'^'n(O(Q(W(_(s(w({)z+R+V,h,k,p-a-i-w-}.o.v/g0b0g0w1e1u1v1x1z1}2Q2S2s2y3a5a5k5{5|6P6d7}8S8c8mS#q]:j!r)]$]$n'T)o,|-P/O2c3v5_6Z9^9o:i:l:m:p:q:r:s:t:u:v:w:x:y:z:{:|:};R;`;b;c;e;m;n;w;x<eQ*x%[Q+n%|Q,^&cQ,e&kQ.f;WQ0n+aQ0r+cQ0}+oQ1t,cQ3R._Q4}0xQ5r1mQ6p3VQ6|;XQ7o5OR8s6q'OkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#y#|$P$Q$R$S$T$U$V$W$X$Y$Z$]$b$f$n%k%q&O&g&j&k&n&p&q&s&w'P'T'^'n(O(Q(W(_(s(w({)o)z+R+V+a,h,k,p,|-P-a-i-w-}._.o.v/O/g0b0g0w1e1u1v1x1z1}2Q2S2c2s2y3V3a3v5_5a5k5{5|6P6Z6d6q7}8S8c8m9^9o:i:l:m:p:q:r:s:t:u:v:w:x:y:z:{:|:};R;`;b;c;e;m;n;w;x<et!nQ!r!v!y!z'S'Z'['h'i'j-T-Z-]-m1b5d5f$z$ti#v#x$d$e$y$|%P%R%]%^%b)v)|*O*Q*S*V*]*c*s*t+`+c+z+}.^.l/^/f/p/q/s0W0Y0d1X1[1d3U4O4Z4c4m4u4w5j6n7[7e8P8p8}9b9t:U:^;P;Q;S;T;U;V;Y;Z;[;];^;_;f;g;h;i;k;l;o;p;q;r;s;t;u;v;y;z<b<j<k<n<oQ&T|Q'Q!eU'W%g*W-WQ+n%|Q,^&cQ0c*|Q0}+oQ1S+uQ1s,bQ1t,cQ4}0xQ5W1UQ5r1mQ5u1oQ5v1rQ7o5OQ7r5TQ8[5xQ9]7sR9h8XrnOXst!V!Z#d%k&e&n&p&q&s,k,p1}2QR,`&g&x^OPXYstuvwz!Z!`!g!j!o#S#d#o#u#y#|$P$Q$R$S$T$U$V$W$X$Y$Z$]$b$f$n%k%q&O&g&j&k&n&p&q&s&w'P'^'n(Q(W(_(s(w({)o)z+R+V+a,h,k,p,|-P-a-i-w-}._.o.v/O/g0b0g0w1e1u1v1x1z1}2Q2S2c2s2y3V3a3v5_5a5k5{5|6P6Z6d6q7}8S8c8m9^9o:i:l:m:p:q:r:s:t:u:v:w:x:y:z:{:|:};R;`;b;c;e;m;n;w;x<d<e[#]WZ#W#Z'T(O!b%hm#h#i#l$y%c%f(X(c(d(e*V*Z*^+T+U+W,g,}-{.R.S.T.V/f/i2V2}3O4R6Y6kQ%txQ%xyS%}|&SQ&Z!TQ'_!hQ'a!iQ(l#sS+h%y%zQ+l%|Q,V&^Q,Z&`S-d'b'cQ.a(mQ0v+iQ0|+oQ1O+pQ1R+tQ1g,WS1k,[,]Q2o-eQ4|0xQ5Q0{Q5V1TQ5q1lQ7n5OQ7q5SQ9X7mR:P9Y!O${i#x%P%R%]%^%b*O*Q*]*s*t.l/p0W0Y0d4O4m8}<b<j<k!S%vy!i!u%x%y%z'R'a'b'c'g'q*e+h+i-Q-d-e-l/z0v2h2o2v4eQ+b%tQ+{&WQ,O&XQ,Y&`Q.`(lQ1f,VU1j,Z,[,]Q3W.aQ5l1gS5p1k1lQ8W5q#[<f#v$d$e$y$|)v)|*S*V*c+`+c+z+}.^/^/f/q/s1X1[1d3U4Z4c4u4w5j6n7[7e8P8p9b9t:U:^;S;U;Y;[;^;f;h;k;o;q;s;u;y<n<oo<g;P;Q;T;V;Z;];_;g;i;l;p;r;t;v;zW%Ui%W*u<bS&W!Q&eQ&X!RQ&Y!SR+y&U${%Ti#v#x$d$e$y$|%P%R%]%^%b)v)|*O*Q*S*V*]*c*s*t+`+c+z+}.^.l/^/f/p/q/s0W0Y0d1X1[1d3U4O4Z4c4m4u4w5j6n7[7e8P8p8}9b9t:U:^;P;Q;S;T;U;V;Y;Z;[;];^;_;f;g;h;i;k;l;o;p;q;r;s;t;u;v;y;z<b<j<k<n<oT)w$v)xV*y%[;W;XW'W!e%g*W-WS(z#z#{Q+s&PS.Y(h(iQ1],PQ4n0aR7w5]'OkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#y#|$P$Q$R$S$T$U$V$W$X$Y$Z$]$b$f$n%k%q&O&g&j&k&n&p&q&s&w'P'T'^'n(O(Q(W(_(s(w({)o)z+R+V+a,h,k,p,|-P-a-i-w-}._.o.v/O/g0b0g0w1e1u1v1x1z1}2Q2S2c2s2y3V3a3v5_5a5k5{5|6P6Z6d6q7}8S8c8m9^9o:i:l:m:p:q:r:s:t:u:v:w:x:y:z:{:|:};R;`;b;c;e;m;n;w;x<e$i$ac#Y#e%o%p%r'}(T(o(v)O)P)Q)R)S)T)U)V)W)X)Y)[)_)c)m+^+r-R-p-u-z-|.k.q.u.w.x.y/Y0e2^2a2q2x3`3e3f3g3h3i3j3k3l3m3n3o3p3q3t3u3z4r4z6]6c6h6v6w7Q7R7y8g8k8t8z8{9q:R:Y:k<XT#TV#U'PkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#y#|$P$Q$R$S$T$U$V$W$X$Y$Z$]$b$f$n%k%q&O&g&j&k&n&p&q&s&w'P'T'^'n(O(Q(W(_(s(w({)o)z+R+V+a,h,k,p,|-P-a-i-w-}._.o.v/O/g0b0g0w1e1u1v1x1z1}2Q2S2c2s2y3V3a3v5_5a5k5{5|6P6Z6d6q7}8S8c8m9^9o:i:l:m:p:q:r:s:t:u:v:w:x:y:z:{:|:};R;`;b;c;e;m;n;w;x<eQ'U!eR2d-Tv!nQ!e!r!v!y!z'S'Z'['h'i'j-T-Z-]-m1b5d5fU*e$}*W*kS/z*f*mQ0T*nQ1_,RQ4e0SR4h0VnqOXst!Z#d%k&n&p&q&s,k,p1}2QQ&u!^Q'r!xS(n#u:qQ+f%wQ,T&ZQ,U&]Q-b'`Q-o'kS.j(s;cS0f+R;mQ0t+gQ1a,SQ2U,rQ2W,sQ2`-OQ2m-cQ2p-gS4s0g;wQ4x0uS4{0w;xQ6[2bQ6`2nQ6e2uQ7l4yQ8h6^Q8i6aQ8l6fR9n8e$d$`c#Y#e%p%r'}(T(o(v)O)P)Q)R)S)T)U)V)W)X)Y)[)_)c)m+^+r-R-p-u-z-|.k.q.u.x.y/Y0e2^2a2q2x3`3e3f3g3h3i3j3k3l3m3n3o3p3q3t3u3z4r4z6]6c6h6v6w7Q7R7y8g8k8t8z8{9q:R:Y:k<XS(k#p'eU*r%S(r3sS+]%o.wQ3S0nQ6m3RQ8r6pR9u8s$d$_c#Y#e%p%r'}(T(o(v)O)P)Q)R)S)T)U)V)W)X)Y)[)_)c)m+^+r-R-p-u-z-|.k.q.u.x.y/Y0e2^2a2q2x3`3e3f3g3h3i3j3k3l3m3n3o3p3q3t3u3z4r4z6]6c6h6v6w7Q7R7y8g8k8t8z8{9q:R:Y:k<XS(j#p'eS(|#{$`S+[%o.wS.Z(i(kQ.z)^Q0k+]R3P.['OkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#y#|$P$Q$R$S$T$U$V$W$X$Y$Z$]$b$f$n%k%q&O&g&j&k&n&p&q&s&w'P'T'^'n(O(Q(W(_(s(w({)o)z+R+V+a,h,k,p,|-P-a-i-w-}._.o.v/O/g0b0g0w1e1u1v1x1z1}2Q2S2c2s2y3V3a3v5_5a5k5{5|6P6Z6d6q7}8S8c8m9^9o:i:l:m:p:q:r:s:t:u:v:w:x:y:z:{:|:};R;`;b;c;e;m;n;w;x<eS#q]:jQ&p!XQ&q!YQ&s![Q&t!]R1|,nQ']!hQ+_%tQ-`'_S.](l+bQ2k-_W3T.`.a0m0oQ6_2lU6l3Q3S3WS8o6m6oS9s8q8rS:[9r9uQ:d:]R:g:eU!wQ'[-]T5b1b5d!Q_OXZ`st!V!Z#d#h%c%k&e&g&n&p&q&s(e,k,p.S1}2Q]!pQ!r'[-]1b5dT#q]:j%[{OPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#y#|$P$Q$R$S$T$U$V$W$X$Y$Z$b$f%k%q&O&g&j&k&n&p&q&s&w'P'^'n(O(Q(W(_(s(w({)z+R+V+a,h,k,p-a-i-w-}._.o.v/g0b0g0w1e1u1v1x1z1}2Q2S2s2y3V3a5a5k5{5|6P6d6q7}8S8c8mS(z#z#{S.Y(h(i!s<O$]$n'T)o,|-P/O2c3v5_6Z9^9o:i:l:m:p:q:r:s:t:u:v:w:x:y:z:{:|:};R;`;b;c;e;m;n;w;x<em!tQ!r!v!y!z'['h'i'j-]-m1b5d5fQ'p!uS(a#g1wS-k'g'sQ/l*YQ/x*eQ2w-nQ4V/mS4`/y0TQ7W4QS7c4f4hQ9P7XR9W7fQ#wbQ'o!uS(`#g1wS(b#m+QQ+S%dQ+d%uQ+j%{U-j'g'p'sQ.O(aQ/k*YQ/w*eQ/}*hQ0s+eQ1h,XS2t-k-nQ2|.WS4U/l/mS4_/x0TQ4b/|Q4d0OQ5n1iQ6g2wQ7V4QQ7Z4VS7_4`4hQ7d4gQ8U5oS9O7W7XQ9S7`Q9U7cQ9e8VQ9{9PQ9|9TQ:O9WQ:W9fQ:`9}Q<R;|Q<^<VR<_<WV!wQ'[-]%[aOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#y#|$P$Q$R$S$T$U$V$W$X$Y$Z$b$f%k%q&O&g&j&k&n&p&q&s&w'P'^'n(O(Q(W(_(s(w({)z+R+V+a,h,k,p-a-i-w-}._.o.v/g0b0g0w1e1u1v1x1z1}2Q2S2s2y3V3a5a5k5{5|6P6d6q7}8S8c8mS#wz!j!r;{$]$n'T)o,|-P/O2c3v5_6Z9^9o:i:l:m:p:q:r:s:t:u:v:w:x:y:z:{:|:};R;`;b;c;e;m;n;w;x<eR<R<d%[bOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#y#|$P$Q$R$S$T$U$V$W$X$Y$Z$b$f%k%q&O&g&j&k&n&p&q&s&w'P'^'n(O(Q(W(_(s(w({)z+R+V+a,h,k,p-a-i-w-}._.o.v/g0b0g0w1e1u1v1x1z1}2Q2S2s2y3V3a5a5k5{5|6P6d6q7}8S8c8mQ%dj!S%uy!i!u%x%y%z'R'a'b'c'g'q*e+h+i-Q-d-e-l/z0v2h2o2v4eS%{z!jQ+e%vQ,X&`W1i,Y,Z,[,]U5o1j1k1lS8V5p5qQ9f8W!r;|$]$n'T)o,|-P/O2c3v5_6Z9^9o:i:l:m:p:q:r:s:t:u:v:w:x:y:z:{:|:};R;`;b;c;e;m;n;w;x<eQ<V<cR<W<d%OeOPXYstuvw!Z!`!g!o#S#d#o#u#y#|$P$Q$R$S$T$U$V$W$X$Y$Z$b$f%k%q&O&g&j&n&p&q&s&w'P'^'n(Q(W(_(s(w({)z+R+V+a,h,k,p-a-i-w-}._.o.v/g0b0g0w1e1u1v1x1z1}2Q2S2s2y3V3a5a5k5{5|6P6d6q7}8S8c8mY#bWZ#W#Z(O!b%hm#h#i#l$y%c%f(X(c(d(e*V*Z*^+T+U+W,g,}-{.R.S.T.V/f/i2V2}3O4R6Y6kQ,f&k!p;}$]$n)o,|-P/O2c3v5_6Z9^9o:i:l:m:p:q:r:s:t:u:v:w:x:y:z:{:|:};R;`;b;c;e;m;n;w;x<eR<Q'TU'X!e%g*WR2f-W%QdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#y#|$P$Q$R$S$T$U$V$W$X$Y$Z$b$f%k%q&O&g&j&n&p&q&s&w'P'^'n(O(Q(W(_(s(w({)z+R+V,h,k,p-a-i-w-}.o.v/g0b0g0w1e1u1v1x1z1}2Q2S2s2y3a5a5k5{5|6P6d7}8S8c8m!r)]$]$n'T)o,|-P/O2c3v5_6Z9^9o:i:l:m:p:q:r:s:t:u:v:w:x:y:z:{:|:};R;`;b;c;e;m;n;w;x<eQ,e&kQ0n+aQ3R._Q6p3VR8s6q!b$Vc#Y%o'}(T(o(v)X)Y)_)c+r-p-u-z-|.k.q/Y0e2q2x3`3q4r4z6c6h6v8k9q:k!P:x)[)m-R.w2^2a3e3o3p3t3z6]6w7Q7R7y8g8t8z8{:R:Y<X!f$Xc#Y%o'}(T(o(v)U)V)X)Y)_)c+r-p-u-z-|.k.q/Y0e2q2x3`3q4r4z6c6h6v8k9q:k!T:z)[)m-R.w2^2a3e3l3m3o3p3t3z6]6w7Q7R7y8g8t8z8{:R:Y<X!^$]c#Y%o'}(T(o(v)_)c+r-p-u-z-|.k.q/Y0e2q2x3`3q4r4z6c6h6v8k9q:kQ4O/dz<e)[)m-R.w2^2a3e3t3z6]6w7Q7R7y8g8t8z8{:R:Y<XQ<j<lR<k<m'OkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#y#|$P$Q$R$S$T$U$V$W$X$Y$Z$]$b$f$n%k%q&O&g&j&k&n&p&q&s&w'P'T'^'n(O(Q(W(_(s(w({)o)z+R+V+a,h,k,p,|-P-a-i-w-}._.o.v/O/g0b0g0w1e1u1v1x1z1}2Q2S2c2s2y3V3a3v5_5a5k5{5|6P6Z6d6q7}8S8c8m9^9o:i:l:m:p:q:r:s:t:u:v:w:x:y:z:{:|:};R;`;b;c;e;m;n;w;x<eS$oh$pR3w.}'VgOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#y#|$P$Q$R$S$T$U$V$W$X$Y$Z$]$b$f$n$p%k%q&O&g&j&k&n&p&q&s&w'P'T'^'n(O(Q(W(_(s(w({)o)z+R+V+a,h,k,p,|-P-a-i-w-}._.o.v.}/O/g0b0g0w1e1u1v1x1z1}2Q2S2c2s2y3V3a3v5_5a5k5{5|6P6Z6d6q7}8S8c8m9^9o:i:l:m:p:q:r:s:t:u:v:w:x:y:z:{:|:};R;`;b;c;e;m;n;w;x<eT$kf$qQ$ifS)f$l)jR)r$qT$jf$qT)h$l)j'VhOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#y#|$P$Q$R$S$T$U$V$W$X$Y$Z$]$b$f$n$p%k%q&O&g&j&k&n&p&q&s&w'P'T'^'n(O(Q(W(_(s(w({)o)z+R+V+a,h,k,p,|-P-a-i-w-}._.o.v.}/O/g0b0g0w1e1u1v1x1z1}2Q2S2c2s2y3V3a3v5_5a5k5{5|6P6Z6d6q7}8S8c8m9^9o:i:l:m:p:q:r:s:t:u:v:w:x:y:z:{:|:};R;`;b;c;e;m;n;w;x<eT$oh$pQ$rhR)q$p%[jOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#y#|$P$Q$R$S$T$U$V$W$X$Y$Z$b$f%k%q&O&g&j&k&n&p&q&s&w'P'^'n(O(Q(W(_(s(w({)z+R+V+a,h,k,p-a-i-w-}._.o.v/g0b0g0w1e1u1v1x1z1}2Q2S2s2y3V3a5a5k5{5|6P6d6q7}8S8c8m!s<c$]$n'T)o,|-P/O2c3v5_6Z9^9o:i:l:m:p:q:r:s:t:u:v:w:x:y:z:{:|:};R;`;b;c;e;m;n;w;x<e#elOPXZst!Z!`!o#S#d#o#|$n%k&g&j&k&n&p&q&s&w'P'^({)o+V+a,h,k,p-a._/O/g0b1e1u1v1x1z1}2Q2S3V3v5a5k5{5|6P6q7}8S8c!O%Si#x%P%R%]%^%b*O*Q*]*s*t.l/p0W0Y0d4O4m8}<b<j<k#[(r#v$d$e$y$|)v)|*S*V*c+`+c+z+}.^/^/f/q/s1X1[1d3U4Z4c4u4w5j6n7[7e8P8p9b9t:U:^;S;U;Y;[;^;f;h;k;o;q;s;u;y<n<oQ*}%`Q/Z){o3s;P;Q;T;V;Z;];_;g;i;l;p;r;t;v;z!O$zi#x%P%R%]%^%b*O*Q*]*s*t.l/p0W0Y0d4O4m8}<b<j<kQ*_${U*h$}*W*kQ+O%aQ0O*i#[<T#v$d$e$y$|)v)|*S*V*c+`+c+z+}.^/^/f/q/s1X1[1d3U4Z4c4u4w5j6n7[7e8P8p9b9t:U:^;S;U;Y;[;^;f;h;k;o;q;s;u;y<n<on<U;P;Q;T;V;Z;];_;g;i;l;p;r;t;v;zQ<Y<fQ<Z<gQ<[<hR<]<i!O%Si#x%P%R%]%^%b*O*Q*]*s*t.l/p0W0Y0d4O4m8}<b<j<k#[(r#v$d$e$y$|)v)|*S*V*c+`+c+z+}.^/^/f/q/s1X1[1d3U4Z4c4u4w5j6n7[7e8P8p9b9t:U:^;S;U;Y;[;^;f;h;k;o;q;s;u;y<n<oo3s;P;Q;T;V;Z;];_;g;i;l;p;r;t;v;znoOXst!Z#d%k&n&p&q&s,k,p1}2QS*b$|*VQ,y&zQ,z&|R4Y/q$z%Ti#v#x$d$e$y$|%P%R%]%^%b)v)|*O*Q*S*V*]*c*s*t+`+c+z+}.^.l/^/f/p/q/s0W0Y0d1X1[1d3U4O4Z4c4m4u4w5j6n7[7e8P8p8}9b9t:U:^;P;Q;S;T;U;V;Y;Z;[;];^;_;f;g;h;i;k;l;o;p;q;r;s;t;u;v;y;z<b<j<k<n<oQ+|&XQ1Z,OQ5Z1YR7v5[V*j$}*W*kU*j$}*W*kT5c1b5dU/|*g/g5aT4g0U7}Q+d%uQ/}*hQ0s+eQ1h,XQ5n1iQ8U5oQ9e8VR:W9f!O%Pi#x%P%R%]%^%b*O*Q*]*s*t.l/p0W0Y0d4O4m8}<b<j<kr*O$w(t*P*q+P/o0[0]3^4W4q7U7g9z<S<`<aS0W*p0X#[;S#v$d$e$y$|)v)|*S*V*c+`+c+z+}.^/^/f/q/s1X1[1d3U4Z4c4u4w5j6n7[7e8P8p9b9t:U:^;S;U;Y;[;^;f;h;k;o;q;s;u;y<n<on;T;P;Q;T;V;Z;];_;g;i;l;p;r;t;v;z!^;f(p)a*X*a.b.e.i/V/[/d/t0l1W1Y3Z4X4]5Y5[6r6u7]7a7i7k9R9V:_<l<m`;g3r6x6{7P8u9v9y:hS;q.d3[T;r6z8x!O%Ri#x%P%R%]%^%b*O*Q*]*s*t.l/p0W0Y0d4O4m8}<b<j<kv*Q$w(t*R*p+P/`/o0[0]3^4W4i4q7U7g9z<S<`<aS0Y*q0Z#[;U#v$d$e$y$|)v)|*S*V*c+`+c+z+}.^/^/f/q/s1X1[1d3U4Z4c4u4w5j6n7[7e8P8p9b9t:U:^;S;U;Y;[;^;f;h;k;o;q;s;u;y<n<on;V;P;Q;T;V;Z;];_;g;i;l;p;r;t;v;z!b;h(p)a*X*a.c.d.i/V/[/d/t0l1W1Y3X3Z4X4]5Y5[6r6s6u7]7a7i7k9R9V:_<l<md;i3r6y6z7P8u8v9v9w9y:hS;s.e3]T;t6{8yrnOXst!V!Z#d%k&e&n&p&q&s,k,p1}2QQ&b!UR,h&krnOXst!V!Z#d%k&e&n&p&q&s,k,p1}2QR&b!UQ,Q&YR1V+ysnOXst!V!Z#d%k&e&n&p&q&s,k,p1}2QQ1c,VS5i1f1gU8O5g5h5lS9a8Q8RS:S9`9cQ:a:TR:f:bQ&i!VR,a&eR5u1oS%}|&SR1O+pQ&n!WR,k&oR,q&tT2O,p2QR,u&uQ,t&uR2X,uQ'u!{R-q'uSsOtQ#dXT%ns#dQ#OTR'w#OQ#RUR'y#RQ)x$vR/W)xQ#UVR'{#UQ#XWU(R#X(S-xQ(S#YR-x(TQ-U'UR2e-UQ.m(tR3_.mQ.p(vS3b.p3cR3c.qQ-]'[R2i-]Y!rQ'[-]1b5dR'f!rU#_W%f*VU(Y#_(Z-yQ(Z#`R-y(UQ-X'XR2g-Xt`OXst!V!Z#d%k&e&g&n&p&q&s,k,p1}2QS#hZ%cU#r`#h.SR.S(eQ(f#jQ.P(bW.X(f.P2z6iQ2z.QR6i2{Q)j$lR/P)jQ$phR)p$pQ$ccU)`$c-t;OQ-t:kR;O)mQ/j*YW4S/j4T7Y9QU4T/k/l/mS7Y4U4VR9Q7Z$X)}$w(p(t)a*X*a*p*q*z*{+P.d.e.g.h.i/V/[/`/b/d/o/t0[0]0l1W1Y3X3Y3Z3^3r4W4X4]4i4k4q5Y5[6r6s6t6u6z6{6}7O7P7U7]7a7g7i7k8u8v8w9R9V9v9w9x9y9z:_:h<S<`<a<l<mQ/r*aU4[/r4^7^Q4^/tR7^4]S*k$}*WR0Q*kr*P$w(t*p*q+P/o0[0]3^4W4q7U7g9z<S<`<a!^.b(p)a*X*a.d.e.i/V/[/d/t0l1W1Y3Z4X4]5Y5[6r6u7]7a7i7k9R9V:_<l<mU/a*P.b6xa6x3r6z6{7P8u9v9y:hQ0X*pQ3[.dU4j0X3[8xR8x6zv*R$w(t*p*q+P/`/o0[0]3^4W4i4q7U7g9z<S<`<a!b.c(p)a*X*a.d.e.i/V/[/d/t0l1W1Y3X3Z4X4]5Y5[6r6s6u7]7a7i7k9R9V:_<l<mU/c*R.c6ye6y3r6z6{7P8u8v9v9w9y:hQ0Z*qQ3].eU4l0Z3]8yR8y6{Q*v%VR0_*vQ4v0lR7j4vQ+X%iR0j+XQ5^1]S7x5^9_R9_7yQ,S&ZR1`,SQ5d1bR7{5dQ1n,^S5s1n8YR8Y5uQ0y+lW5P0y5R7p9ZQ5R0|Q7p5QR9Z7qQ+q%}R1P+qQ2Q,pR6T2QYrOXst#dQ&r!ZQ+Z%kQ,j&nQ,l&pQ,m&qQ,o&sQ1{,kS2O,p2QR6S1}Q%mpQ&v!_Q&y!aQ&{!bQ&}!cQ'm!uQ+Y%jQ+f%wQ+x&TQ,`&iQ,w&xW-h'g'o'p'sQ-o'kQ0P*jQ0t+gS1q,a,dQ2Y,vQ2Z,yQ2[,zQ2p-gW2r-j-k-n-pQ4x0uQ5U1SQ5X1WQ5m1hQ5w1sQ6R1|U6b2q2t2wQ6e2uQ7l4yQ7t5WQ7u5YQ7z5cQ8T5nQ8Z5vS8j6c6gQ8l6fQ9[7rQ9d8UQ9i8[Q9p8kQ:Q9]Q:V9eQ:Z9qR:c:WQ%wyQ'`!iQ'k!uU+g%x%y%zQ-O'RU-c'a'b'cS-g'g'qQ/v*eS0u+h+iQ2b-QS2n-d-eQ2u-lQ4a/zQ4y0vQ6^2hQ6a2oQ6f2vR7b4eS$xi<bR*w%WU%Vi%W<bR0^*uQ$wiS(p#v+cQ(t#xS)a$d$eQ*X$yS*a$|*VQ*p%PQ*q%RQ*z%]Q*{%^Q+P%bQ.d;SQ.e;UQ.g;YQ.h;[Q.i;^Q/V)vS/[)|/^Q/`*OQ/b*QQ/d*SQ/o*]S/t*c/fQ0[*sQ0]*th0l+`.^1d3U5j6n8P8p9b9t:U:^Q1W+zQ1Y+}Q3X;fQ3Y;hQ3Z;kQ3^.lS3r;P;QQ4W/pQ4X/qQ4]/sQ4i0WQ4k0YQ4q0dQ5Y1XQ5[1[Q6r;oQ6s;qQ6t;sQ6u;uQ6z;TQ6{;VQ6};ZQ7O;]Q7P;_Q7U4OQ7]4ZQ7a4cQ7g4mQ7i4uQ7k4wQ8u;lQ8v;gQ8w;iQ9R7[Q9V7eQ9v;pQ9w;rQ9x;tQ9y;vQ9z8}Q:_;yQ:h;zQ<S<bQ<`<jQ<a<kQ<l<nR<m<onpOXst!Z#d%k&n&p&q&s,k,p1}2QQ!fPS#fZ#oQ&x!`U'd!o5a7}Q'z#SQ(}#|Q)n$nS,d&g&jQ,i&kQ,v&wQ,{'PQ-_'^Q.s({Q/T)oS0h+V/gQ0o+aQ1y,hQ2l-aQ3S._Q3y/OQ4o0bQ5h1eQ5y1uQ5z1vQ6O1xQ6Q1zQ6V2SQ6m3VQ7S3vQ8R5kQ8_5{Q8`5|Q8b6PQ8r6qQ9c8SR9m8c#YcOPXZst!Z!`!o#d#o#|%k&g&j&k&n&p&q&s&w'P'^({+V+a,h,k,p-a._/g0b1e1u1v1x1z1}2Q2S3V5a5k5{5|6P6q7}8S8cQ#YWQ#eYQ%ouQ%pvS%rw!gS'}#W(QQ(T#ZQ(o#uQ(v#yQ)O$PQ)P$QQ)Q$RQ)R$SQ)S$TQ)T$UQ)U$VQ)V$WQ)W$XQ)X$YQ)Y$ZQ)[$]Q)_$bQ)c$fW)m$n)o/O3vQ+^%qQ+r&OS-R'T2cQ-p'nS-u(O-wQ-z(WQ-|(_Q.k(sQ.q(wQ.u:iQ.w:lQ.x:mQ.y:pQ/Y)zQ0e+RQ2^,|Q2a-PQ2q-iQ2x-}Q3`.oQ3e:qQ3f:rQ3g:sQ3h:tQ3i:uQ3j:vQ3k:wQ3l:xQ3m:yQ3n:zQ3o:{Q3p:|Q3q.vQ3t;RQ3u;`Q3z:}Q4r0gQ4z0wQ6];bQ6c2sQ6h2yQ6v3aQ6w;cQ7Q;eQ7R;mQ7y5_Q8g6ZQ8k6dQ8t;nQ8z;wQ8{;xQ9q8mQ:R9^Q:Y9oQ:k#SR<X<eR#[WR'V!el!tQ!r!v!y!z'['h'i'j-]-m1b5d5fS'R!e-TS-Q'S'ZR2h-ZR(u#xR(x#yQ!fQT-['[-]]!qQ!r'[-]1b5dQ#p]R'e:jY!uQ'[-]1b5dQ'g!rS'q!v!yS's!z5fS-l'h'iQ-n'jR2v-mT#kZ%cS#jZ%cS%im,gU(b#h#i#lS.Q(c(dQ.U(eQ0i+WQ2{.RU2|.S.T.VS6j2}3OR8n6kd#^W#W#Z%f(O(X*V+T-{/fr#gZm#h#i#l%c(c(d(e+W.R.S.T.V2}3O6kS*Y$y*^Q/m*ZQ1w,gQ2_,}Q4Q/iQ6X2VQ7X4RQ8f6YT<P'T+UV#aW%f*VU#`W%f*VS(P#W(XU(U#Z+T/fS-S'T+UT-v(O-{V'Y!e%g*WQ$lfR)t$qT)i$l)jR3x.}T*[$y*^T*d$|*VQ0m+`Q3Q.^Q5g1dQ6o3UQ8Q5jQ8q6nQ9`8PQ9r8pQ:T9bQ:]9tQ:b:UR:e:^nqOXst!Z#d%k&n&p&q&s,k,p1}2QQ&h!VR,`&etmOXst!U!V!Z#d%k&e&n&p&q&s,k,p1}2QR,g&kT%jm,gR1^,PR,_&cQ&R|R+w&SR+m%|T&l!W&oT&m!W&oT2P,p2Q",nodeNames:" ArithOp ArithOp JSXStartTag LineComment BlockComment Script Hashbang ExportDeclaration export Star as VariableName String Escape from ; default FunctionDeclaration async function VariableDefinition > < TypeParamList TypeDefinition extends ThisType this LiteralType ArithOp Number BooleanLiteral TemplateType InterpolationEnd Interpolation InterpolationStart NullType null VoidType void TypeofType typeof MemberExpression . ?. PropertyName [ TemplateString Escape Interpolation super RegExp ] ArrayExpression Spread , } { ObjectExpression Property async get set PropertyDefinition Block : NewExpression new TypeArgList CompareOp < ) ( ArgList UnaryExpression delete LogicOp BitOp YieldExpression yield AwaitExpression await ParenthesizedExpression ClassExpression class ClassBody MethodDeclaration Decorator @ MemberExpression PrivatePropertyName CallExpression declare Privacy static abstract override PrivatePropertyDefinition PropertyDeclaration readonly accessor Optional TypeAnnotation Equals StaticBlock FunctionExpression ArrowFunction ParamList ParamList ArrayPattern ObjectPattern PatternProperty Privacy readonly Arrow MemberExpression BinaryExpression ArithOp ArithOp ArithOp ArithOp BitOp CompareOp instanceof satisfies in const CompareOp BitOp BitOp BitOp LogicOp LogicOp ConditionalExpression LogicOp LogicOp AssignmentExpression UpdateOp PostfixExpression CallExpression TaggedTemplateExpression DynamicImport import ImportMeta JSXElement JSXSelfCloseEndTag JSXSelfClosingTag JSXIdentifier JSXBuiltin JSXIdentifier JSXNamespacedName JSXMemberExpression JSXSpreadAttribute JSXAttribute JSXAttributeValue JSXEscape JSXEndTag JSXOpenTag JSXFragmentTag JSXText JSXEscape JSXStartCloseTag JSXCloseTag PrefixCast ArrowFunction TypeParamList SequenceExpression KeyofType keyof UniqueType unique ImportType InferredType infer TypeName ParenthesizedType FunctionSignature ParamList NewSignature IndexedType TupleType Label ArrayType ReadonlyType ObjectType MethodType PropertyType IndexSignature PropertyDefinition CallSignature TypePredicate is NewSignature new UnionType LogicOp IntersectionType LogicOp ConditionalType ParameterizedType ClassDeclaration abstract implements type VariableDeclaration let var using TypeAliasDeclaration InterfaceDeclaration interface EnumDeclaration enum EnumBody NamespaceDeclaration namespace module AmbientDeclaration declare GlobalDeclaration global ClassDeclaration ClassBody AmbientFunctionDeclaration ExportGroup VariableName VariableName ImportDeclaration ImportGroup ForStatement for ForSpec ForInSpec ForOfSpec of WhileStatement while WithStatement with DoStatement do IfStatement if else SwitchStatement switch SwitchBody CaseLabel case DefaultLabel TryStatement try CatchClause catch FinallyClause finally ReturnStatement return ThrowStatement throw BreakStatement break ContinueStatement continue DebuggerStatement debugger LabeledStatement ExpressionStatement SingleExpression SingleClassItem",maxTerm:372,context:dX,nodeProps:[["isolate",-8,4,5,13,33,35,48,50,52,""],["group",-26,8,16,18,65,201,205,209,210,212,215,218,228,230,236,238,240,242,245,251,257,259,261,263,265,267,268,"Statement",-32,12,13,28,31,32,38,48,51,52,54,59,67,75,79,81,83,84,106,107,116,117,134,137,139,140,141,142,144,145,164,165,167,"Expression",-23,27,29,33,37,39,41,168,170,172,173,175,176,177,179,180,181,183,184,185,195,197,199,200,"Type",-3,87,99,105,"ClassItem"],["openedBy",22,"<",34,"InterpolationStart",53,"[",57,"{",72,"(",157,"JSXStartCloseTag"],["closedBy",23,">",36,"InterpolationEnd",47,"]",58,"}",73,")",162,"JSXEndTag"]],propSources:[yX],skippedNodes:[0,4,5,271],repeatNodeCount:37,tokenData:"$HR(CSR!bOX%ZXY+gYZ-yZ[+g[]%Z]^.c^p%Zpq+gqr/mrs3cst:_tuEruvJSvwLkwx! Yxy!'iyz!(sz{!)}{|!,q|}!.O}!O!,q!O!P!/Y!P!Q!9j!Q!R#:O!R![#<_![!]#I_!]!^#Jk!^!_#Ku!_!`$![!`!a$$v!a!b$*T!b!c$.S!c!}Er!}#O$/^#O#P$0h#P#Q$6P#Q#R$7Z#R#SEr#S#T$8h#T#o$9r#o#p$>S#p#q$>x#q#r$@Y#r#s$Af#s$f%Z$f$g+g$g#BYEr#BY#BZ$Bp#BZ$ISEr$IS$I_$Bp$I_$I|Er$I|$I}$E{$I}$JO$E{$JO$JTEr$JT$JU$Bp$JU$KVEr$KV$KW$Bp$KW&FUEr&FU&FV$Bp&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$Bp?HUOEr(n%d_$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&j&hT$f&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c&j&zP;=`<%l&c'|'U]$f&j(R!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!b(SU(R!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!b(iP;=`<%l'}'|(oP;=`<%l&}'[(y]$f&j(OpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(rp)wU(OpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)rp*^P;=`<%l)r'[*dP;=`<%l(r#S*nX(Op(R!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g#S+^P;=`<%l*g(n+dP;=`<%l%Z(CS+rq$f&j(Op(R!b't(;dOX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p$f%Z$f$g+g$g#BY%Z#BY#BZ+g#BZ$IS%Z$IS$I_+g$I_$JT%Z$JT$JU+g$JU$KV%Z$KV$KW+g$KW&FU%Z&FU&FV+g&FV;'S%Z;'S;=`+a<%l?HT%Z?HT?HU+g?HUO%Z(CS.ST(P#S$f&j'u(;dO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c(CS.n_$f&j(Op(R!b'u(;dOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#`/x`$f&j!o$Ip(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S1V`#t$Id$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`2X!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S2d_#t$Id$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/|3l_'}$(n$f&j(R!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k(^4r_$f&j(R!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k&z5vX$f&jOr5qrs6cs!^5q!^!_6y!_#o5q#o#p6y#p;'S5q;'S;=`7h<%lO5q&z6jT$a`$f&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c`6|TOr6yrs7]s;'S6y;'S;=`7b<%lO6y`7bO$a``7eP;=`<%l6y&z7kP;=`<%l5q(^7w]$a`$f&j(R!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!r8uZ(R!bOY8pYZ6yZr8prs9hsw8pwx6yx#O8p#O#P6y#P;'S8p;'S;=`:R<%lO8p!r9oU$a`(R!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!r:UP;=`<%l8p(^:[P;=`<%l4k#%|:hh$f&j(Op(R!bOY%ZYZ&cZq%Zqr<Srs&}st%ZtuCruw%Zwx(rx!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr(r<__VS$f&j(Op(R!bOY<SYZ&cZr<Srs=^sw<Swx@nx!^<S!^!_Bm!_#O<S#O#P>`#P#o<S#o#pBm#p;'S<S;'S;=`Cl<%lO<S(Q=g]VS$f&j(R!bOY=^YZ&cZw=^wx>`x!^=^!^!_?q!_#O=^#O#P>`#P#o=^#o#p?q#p;'S=^;'S;=`@h<%lO=^&n>gXVS$f&jOY>`YZ&cZ!^>`!^!_?S!_#o>`#o#p?S#p;'S>`;'S;=`?k<%lO>`S?XSVSOY?SZ;'S?S;'S;=`?e<%lO?SS?hP;=`<%l?S&n?nP;=`<%l>`!f?xWVS(R!bOY?qZw?qwx?Sx#O?q#O#P?S#P;'S?q;'S;=`@b<%lO?q!f@eP;=`<%l?q(Q@kP;=`<%l=^'`@w]VS$f&j(OpOY@nYZ&cZr@nrs>`s!^@n!^!_Ap!_#O@n#O#P>`#P#o@n#o#pAp#p;'S@n;'S;=`Bg<%lO@ntAwWVS(OpOYApZrAprs?Ss#OAp#O#P?S#P;'SAp;'S;=`Ba<%lOAptBdP;=`<%lAp'`BjP;=`<%l@n#WBvYVS(Op(R!bOYBmZrBmrs?qswBmwxApx#OBm#O#P?S#P;'SBm;'S;=`Cf<%lOBm#WCiP;=`<%lBm(rCoP;=`<%l<S#%|C}i$f&j(g!L^(Op(R!bOY%ZYZ&cZr%Zrs&}st%ZtuCruw%Zwx(rx!Q%Z!Q![Cr![!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr#%|EoP;=`<%lCr(CSFRk$f&j(Op(R!b$Y#t'{&;d([!LYOY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr+dHRk$f&j(Op(R!b$Y#tOY%ZYZ&cZr%Zrs&}st%ZtuGvuw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Gv![!^%Z!^!_*g!_!c%Z!c!}Gv!}#O%Z#O#P&c#P#R%Z#R#SGv#S#T%Z#T#oGv#o#p*g#p$g%Z$g;'SGv;'S;=`Iv<%lOGv+dIyP;=`<%lGv(CSJPP;=`<%lEr%#SJ_`$f&j(Op(R!b#l$IdOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#SKl_$f&j$O$Id(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&COLva(q&;`$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sv%ZvwM{wx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#SNW`$f&j#x$Id(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/|! c_(Q$)`$f&j(OpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b'l!!i_$f&j(OpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b&z!#mX$f&jOw!#hwx6cx!^!#h!^!_!$Y!_#o!#h#o#p!$Y#p;'S!#h;'S;=`!$r<%lO!#h`!$]TOw!$Ywx7]x;'S!$Y;'S;=`!$l<%lO!$Y`!$oP;=`<%l!$Y&z!$uP;=`<%l!#h'l!%R]$a`$f&j(OpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r!Q!&PZ(OpOY!%zYZ!$YZr!%zrs!$Ysw!%zwx!&rx#O!%z#O#P!$Y#P;'S!%z;'S;=`!']<%lO!%z!Q!&yU$a`(OpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)r!Q!'`P;=`<%l!%z'l!'fP;=`<%l!!b(*Q!'t_!k(!b$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z!'l!)O_!jM|$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'+h!*[b$f&j(Op(R!b'|#)d#m$IdOY%ZYZ&cZr%Zrs&}sw%Zwx(rxz%Zz{!+d{!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S!+o`$f&j(Op(R!b#j$IdOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&-O!,|`$f&j(Op(R!bn&%`OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&C[!.Z_!Y&;l$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(CS!/ec$f&j(Op(R!b|'<nOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!0p!P!Q%Z!Q![!3Y![!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z!'d!0ya$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!2O!P!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z!'d!2Z_!XMt$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l!3eg$f&j(Op(R!bo$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!3Y![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S!3Y#S#X%Z#X#Y!4|#Y#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l!5Vg$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx{%Z{|!6n|}%Z}!O!6n!O!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l!6wc$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l!8_c$f&j(Op(R!bo$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(CS!9uf$f&j(Op(R!b#k$IdOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcxz!;Zz{#-}{!P!;Z!P!Q#/d!Q!^!;Z!^!_#(i!_!`#7S!`!a#8i!a!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z(r!;fb$f&j(Op(R!b!USOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z(Q!<w`$f&j(R!b!USOY!<nYZ&cZw!<nwx!=yx!P!<n!P!Q!Eq!Q!^!<n!^!_!Gr!_!}!<n!}#O!KS#O#P!Dy#P#o!<n#o#p!Gr#p;'S!<n;'S;=`!L]<%lO!<n&n!>Q^$f&j!USOY!=yYZ&cZ!P!=y!P!Q!>|!Q!^!=y!^!_!@c!_!}!=y!}#O!CW#O#P!Dy#P#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y&n!?Td$f&j!USO!^&c!_#W&c#W#X!>|#X#Z&c#Z#[!>|#[#]&c#]#^!>|#^#a&c#a#b!>|#b#g&c#g#h!>|#h#i&c#i#j!>|#j#k!>|#k#m&c#m#n!>|#n#o&c#p;'S&c;'S;=`&w<%lO&cS!@hX!USOY!@cZ!P!@c!P!Q!AT!Q!}!@c!}#O!Ar#O#P!Bq#P;'S!@c;'S;=`!CQ<%lO!@cS!AYW!US#W#X!AT#Z#[!AT#]#^!AT#a#b!AT#g#h!AT#i#j!AT#j#k!AT#m#n!ATS!AuVOY!ArZ#O!Ar#O#P!B[#P#Q!@c#Q;'S!Ar;'S;=`!Bk<%lO!ArS!B_SOY!ArZ;'S!Ar;'S;=`!Bk<%lO!ArS!BnP;=`<%l!ArS!BtSOY!@cZ;'S!@c;'S;=`!CQ<%lO!@cS!CTP;=`<%l!@c&n!C][$f&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#O!CW#O#P!DR#P#Q!=y#Q#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW&n!DWX$f&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW&n!DvP;=`<%l!CW&n!EOX$f&jOY!=yYZ&cZ!^!=y!^!_!@c!_#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y&n!EnP;=`<%l!=y(Q!Ezl$f&j(R!b!USOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#W&}#W#X!Eq#X#Z&}#Z#[!Eq#[#]&}#]#^!Eq#^#a&}#a#b!Eq#b#g&}#g#h!Eq#h#i&}#i#j!Eq#j#k!Eq#k#m&}#m#n!Eq#n#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!f!GyZ(R!b!USOY!GrZw!Grwx!@cx!P!Gr!P!Q!Hl!Q!}!Gr!}#O!JU#O#P!Bq#P;'S!Gr;'S;=`!J|<%lO!Gr!f!Hse(R!b!USOY'}Zw'}x#O'}#P#W'}#W#X!Hl#X#Z'}#Z#[!Hl#[#]'}#]#^!Hl#^#a'}#a#b!Hl#b#g'}#g#h!Hl#h#i'}#i#j!Hl#j#k!Hl#k#m'}#m#n!Hl#n;'S'};'S;=`(f<%lO'}!f!JZX(R!bOY!JUZw!JUwx!Arx#O!JU#O#P!B[#P#Q!Gr#Q;'S!JU;'S;=`!Jv<%lO!JU!f!JyP;=`<%l!JU!f!KPP;=`<%l!Gr(Q!KZ^$f&j(R!bOY!KSYZ&cZw!KSwx!CWx!^!KS!^!_!JU!_#O!KS#O#P!DR#P#Q!<n#Q#o!KS#o#p!JU#p;'S!KS;'S;=`!LV<%lO!KS(Q!LYP;=`<%l!KS(Q!L`P;=`<%l!<n'`!Ll`$f&j(Op!USOY!LcYZ&cZr!Lcrs!=ys!P!Lc!P!Q!Mn!Q!^!Lc!^!_# o!_!}!Lc!}#O#%P#O#P!Dy#P#o!Lc#o#p# o#p;'S!Lc;'S;=`#&Y<%lO!Lc'`!Mwl$f&j(Op!USOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#W(r#W#X!Mn#X#Z(r#Z#[!Mn#[#](r#]#^!Mn#^#a(r#a#b!Mn#b#g(r#g#h!Mn#h#i(r#i#j!Mn#j#k!Mn#k#m(r#m#n!Mn#n#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(rt# vZ(Op!USOY# oZr# ors!@cs!P# o!P!Q#!i!Q!}# o!}#O#$R#O#P!Bq#P;'S# o;'S;=`#$y<%lO# ot#!pe(Op!USOY)rZr)rs#O)r#P#W)r#W#X#!i#X#Z)r#Z#[#!i#[#])r#]#^#!i#^#a)r#a#b#!i#b#g)r#g#h#!i#h#i)r#i#j#!i#j#k#!i#k#m)r#m#n#!i#n;'S)r;'S;=`*Z<%lO)rt#$WX(OpOY#$RZr#$Rrs!Ars#O#$R#O#P!B[#P#Q# o#Q;'S#$R;'S;=`#$s<%lO#$Rt#$vP;=`<%l#$Rt#$|P;=`<%l# o'`#%W^$f&j(OpOY#%PYZ&cZr#%Prs!CWs!^#%P!^!_#$R!_#O#%P#O#P!DR#P#Q!Lc#Q#o#%P#o#p#$R#p;'S#%P;'S;=`#&S<%lO#%P'`#&VP;=`<%l#%P'`#&]P;=`<%l!Lc(r#&kn$f&j(Op(R!b!USOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#W%Z#W#X#&`#X#Z%Z#Z#[#&`#[#]%Z#]#^#&`#^#a%Z#a#b#&`#b#g%Z#g#h#&`#h#i%Z#i#j#&`#j#k#&`#k#m%Z#m#n#&`#n#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#W#(r](Op(R!b!USOY#(iZr#(irs!Grsw#(iwx# ox!P#(i!P!Q#)k!Q!}#(i!}#O#+`#O#P!Bq#P;'S#(i;'S;=`#,`<%lO#(i#W#)th(Op(R!b!USOY*gZr*grs'}sw*gwx)rx#O*g#P#W*g#W#X#)k#X#Z*g#Z#[#)k#[#]*g#]#^#)k#^#a*g#a#b#)k#b#g*g#g#h#)k#h#i*g#i#j#)k#j#k#)k#k#m*g#m#n#)k#n;'S*g;'S;=`+Z<%lO*g#W#+gZ(Op(R!bOY#+`Zr#+`rs!JUsw#+`wx#$Rx#O#+`#O#P!B[#P#Q#(i#Q;'S#+`;'S;=`#,Y<%lO#+`#W#,]P;=`<%l#+`#W#,cP;=`<%l#(i(r#,o`$f&j(Op(R!bOY#,fYZ&cZr#,frs!KSsw#,fwx#%Px!^#,f!^!_#+`!_#O#,f#O#P!DR#P#Q!;Z#Q#o#,f#o#p#+`#p;'S#,f;'S;=`#-q<%lO#,f(r#-tP;=`<%l#,f(r#-zP;=`<%l!;Z(CS#.[b$f&j(Op(R!b'v(;d!USOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z(CS#/o_$f&j(Op(R!bS(;dOY#/dYZ&cZr#/drs#0nsw#/dwx#4Ox!^#/d!^!_#5}!_#O#/d#O#P#1p#P#o#/d#o#p#5}#p;'S#/d;'S;=`#6|<%lO#/d(Bb#0w]$f&j(R!bS(;dOY#0nYZ&cZw#0nwx#1px!^#0n!^!_#3R!_#O#0n#O#P#1p#P#o#0n#o#p#3R#p;'S#0n;'S;=`#3x<%lO#0n(AO#1wX$f&jS(;dOY#1pYZ&cZ!^#1p!^!_#2d!_#o#1p#o#p#2d#p;'S#1p;'S;=`#2{<%lO#1p(;d#2iSS(;dOY#2dZ;'S#2d;'S;=`#2u<%lO#2d(;d#2xP;=`<%l#2d(AO#3OP;=`<%l#1p(<v#3YW(R!bS(;dOY#3RZw#3Rwx#2dx#O#3R#O#P#2d#P;'S#3R;'S;=`#3r<%lO#3R(<v#3uP;=`<%l#3R(Bb#3{P;=`<%l#0n(Ap#4X]$f&j(OpS(;dOY#4OYZ&cZr#4Ors#1ps!^#4O!^!_#5Q!_#O#4O#O#P#1p#P#o#4O#o#p#5Q#p;'S#4O;'S;=`#5w<%lO#4O(<U#5XW(OpS(;dOY#5QZr#5Qrs#2ds#O#5Q#O#P#2d#P;'S#5Q;'S;=`#5q<%lO#5Q(<U#5tP;=`<%l#5Q(Ap#5zP;=`<%l#4O(=h#6WY(Op(R!bS(;dOY#5}Zr#5}rs#3Rsw#5}wx#5Qx#O#5}#O#P#2d#P;'S#5};'S;=`#6v<%lO#5}(=h#6yP;=`<%l#5}(CS#7PP;=`<%l#/d%#W#7ab$f&j$O$Id(Op(R!b!USOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z+h#8vb$W#t$f&j(Op(R!b!USOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z$/l#:Zp$f&j(Op(R!bo$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#U%Z#U#V#?i#V#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#d#Bq#d#l%Z#l#m#Es#m#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#<jk$f&j(Op(R!bo$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#>j_$f&j(Op(R!bo$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#?rd$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#A]f$f&j(Op(R!bo$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#Bzc$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#Dbe$f&j(Op(R!bo$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#E|g$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#Gpi$f&j(Op(R!bo$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%Gh#Il_!d$b$f&j#|%<f(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)[#Jv_`l$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(@^#LS^g!*v!h'.r(Op(R!b(uSOY*gZr*grs'}sw*gwx)rx!P*g!P!Q#MO!Q!^*g!^!_#Mt!_!`$ f!`#O*g#P;'S*g;'S;=`+Z<%lO*g(n#MXX$h&j(Op(R!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g$Kh#M}Z#n$Id(Op(R!bOY*gZr*grs'}sw*gwx)rx!_*g!_!`#Np!`#O*g#P;'S*g;'S;=`+Z<%lO*g$Kh#NyX$O$Id(Op(R!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g$Kh$ oX#o$Id(Op(R!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g%Gh$!ga#[%?x$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`!a$#l!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#W$#w_#g$Ih$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%Gh$%VafBf#o$Id$c#|$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`$&[!`!a$'f!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S$&g_#o$Id$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S$'qa#n$Id$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`!a$(v!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S$)R`#n$Id$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'+h$*`c(i$Ip$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P$+k!P!^%Z!^!_*g!_!a%Z!a!b$,u!b#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'+`$+v_}'#p$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S$-Q`$f&j#y$Id(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#&^$.__!{!Ln$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(@^$/i_!P(8n$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(n$0mZ$f&jO!^$1`!^!_$1v!_#i$1`#i#j$1{#j#l$1`#l#m$3n#m#o$1`#o#p$1v#p;'S$1`;'S;=`$5y<%lO$1`(n$1gT^#S$f&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c#S$1{O^#S(n$2Q[$f&jO!Q&c!Q![$2v![!^&c!_!c&c!c!i$2v!i#T&c#T#Z$2v#Z#o&c#o#p$5^#p;'S&c;'S;=`&w<%lO&c(n$2{Z$f&jO!Q&c!Q![$3n![!^&c!_!c&c!c!i$3n!i#T&c#T#Z$3n#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$3sZ$f&jO!Q&c!Q![$4f![!^&c!_!c&c!c!i$4f!i#T&c#T#Z$4f#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$4kZ$f&jO!Q&c!Q![$1`![!^&c!_!c&c!c!i$1`!i#T&c#T#Z$1`#Z#o&c#p;'S&c;'S;=`&w<%lO&c#S$5aR!Q![$5j!c!i$5j#T#Z$5j#S$5mS!Q![$5j!c!i$5j#T#Z$5j#q#r$1v(n$5|P;=`<%l$1`!2r$6[_!V!+S$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S$7f`#v$Id$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&,v$8s_$f&j(Op(R!b(X&%WOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(CS$:Rk$f&j(Op(R!b'{&;d$[#t([!LYOY%ZYZ&cZr%Zrs&}st%Ztu$9ruw%Zwx(rx}%Z}!O$;v!O!Q%Z!Q![$9r![!^%Z!^!_*g!_!c%Z!c!}$9r!}#O%Z#O#P&c#P#R%Z#R#S$9r#S#T%Z#T#o$9r#o#p*g#p$g%Z$g;'S$9r;'S;=`$=|<%lO$9r+d$<Rk$f&j(Op(R!b$[#tOY%ZYZ&cZr%Zrs&}st%Ztu$;vuw%Zwx(rx}%Z}!O$;v!O!Q%Z!Q![$;v![!^%Z!^!_*g!_!c%Z!c!}$;v!}#O%Z#O#P&c#P#R%Z#R#S$;v#S#T%Z#T#o$;v#o#p*g#p$g%Z$g;'S$;v;'S;=`$=v<%lO$;v+d$=yP;=`<%l$;v(CS$>PP;=`<%l$9r!5p$>]X![!3l(Op(R!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g&CO$?Ta(p&;`$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p#q$,u#q;'S%Z;'S;=`+a<%lO%Z%#`$@g_!Z$I`r`$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(r$Aq_!pS$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(CS$CR|$f&j(Op(R!b't(;d$Y#t'{&;d([!LYOX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$f%Z$f$g+g$g#BYEr#BY#BZ$Bp#BZ$ISEr$IS$I_$Bp$I_$JTEr$JT$JU$Bp$JU$KVEr$KV$KW$Bp$KW&FUEr&FU&FV$Bp&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$Bp?HUOEr(CS$F^k$f&j(Op(R!b'u(;d$Y#t'{&;d([!LYOY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr",tokenizers:[mX,gX,OX,2,3,4,5,6,7,8,9,10,11,12,13,pX,new gc("$S~RRtu[#O#Pg#S#T#|~_P#o#pb~gOt~~jVO#i!P#i#j!U#j#l!P#l#m!q#m;'S!P;'S;=`#v<%lO!P~!UO!R~~!XS!Q![!e!c!i!e#T#Z!e#o#p#Z~!hR!Q![!q!c!i!q#T#Z!q~!tR!Q![!}!c!i!}#T#Z!}~#QR!Q![!P!c!i!P#T#Z!P~#^R!Q![#g!c!i#g#T#Z#g~#jS!Q![#g!c!i#g#T#Z#g#q#r!P~#yP;=`<%l!P~$RO(Z~~",141,332),new gc("j~RQYZXz{^~^O'x~~aP!P!Qd~iO'y~~",25,315)],topRules:{Script:[0,6],SingleExpression:[1,269],SingleClassItem:[2,270]},dialects:{jsx:0,ts:14826},dynamicPrecedences:{69:1,79:1,81:1,165:1,193:1},specialized:[{term:319,get:i=>kX[i]||-1},{term:334,get:i=>bX[i]||-1},{term:70,get:i=>SX[i]||-1}],tokenPrec:14850}),Cv=[Ot("function ${name}(${params}) {\n	${}\n}",{label:"function",detail:"definition",type:"keyword"}),Ot("for (let ${index} = 0; ${index} < ${bound}; ${index}++) {\n	${}\n}",{label:"for",detail:"loop",type:"keyword"}),Ot("for (let ${name} of ${collection}) {\n	${}\n}",{label:"for",detail:"of loop",type:"keyword"}),Ot("do {\n	${}\n} while (${})",{label:"do",detail:"loop",type:"keyword"}),Ot("while (${}) {\n	${}\n}",{label:"while",detail:"loop",type:"keyword"}),Ot(`try {
	\${}
} catch (\${error}) {
	\${}
}`,{label:"try",detail:"/ catch block",type:"keyword"}),Ot("if (${}) {\n	${}\n}",{label:"if",detail:"block",type:"keyword"}),Ot(`if (\${}) {
	\${}
} else {
	\${}
}`,{label:"if",detail:"/ else block",type:"keyword"}),Ot(`class \${name} {
	constructor(\${params}) {
		\${}
	}
}`,{label:"class",detail:"definition",type:"keyword"}),Ot('import {${names}} from "${module}"\n${}',{label:"import",detail:"named",type:"keyword"}),Ot('import ${name} from "${module}"\n${}',{label:"import",detail:"default",type:"keyword"})],xX=Cv.concat([Ot("interface ${name} {\n	${}\n}",{label:"interface",detail:"definition",type:"keyword"}),Ot("type ${name} = ${type}",{label:"type",detail:"definition",type:"keyword"}),Ot("enum ${name} {\n	${}\n}",{label:"enum",detail:"definition",type:"keyword"})]),Hy=new rw,Tv=new Set(["Script","Block","FunctionExpression","FunctionDeclaration","ArrowFunction","MethodDeclaration","ForStatement"]);function go(i){return(e,t)=>{let n=e.node.getChild("VariableDefinition");return n&&t(n,i),!0}}const vX=["FunctionDeclaration"],$X={FunctionDeclaration:go("function"),ClassDeclaration:go("class"),ClassExpression:()=>!0,EnumDeclaration:go("constant"),TypeAliasDeclaration:go("type"),NamespaceDeclaration:go("namespace"),VariableDefinition(i,e){i.matchContext(vX)||e(i,"variable")},TypeDefinition(i,e){e(i,"type")},__proto__:null};function Mv(i,e){let t=Hy.get(e);if(t)return t;let n=[],r=!0;function s(o,l){let a=i.sliceString(o.from,o.to);n.push({label:a,type:l})}return e.cursor(ce.IncludeAnonymous).iterate(o=>{if(r)r=!1;else if(o.name){let l=$X[o.name];if(l&&l(o,s)||Tv.has(o.name))return!1}else if(o.to-o.from>8192){for(let l of Mv(i,o.node))n.push(l);return!1}}),Hy.set(e,n),n}const Ky=/^[\w$\xa1-\uffff][\w$\d\xa1-\uffff]*$/,Av=["TemplateString","String","RegExp","LineComment","BlockComment","VariableDefinition","TypeDefinition","Label","PropertyDefinition","PropertyName","PrivatePropertyDefinition","PrivatePropertyName",".","?."];function PX(i){let e=ae(i.state).resolveInner(i.pos,-1);if(Av.indexOf(e.name)>-1)return null;let t=e.name=="VariableName"||e.to-e.from<20&&Ky.test(i.state.sliceDoc(e.from,e.to));if(!t&&!i.explicit)return null;let n=[];for(let r=e;r;r=r.parent)Tv.has(r.name)&&(n=n.concat(Mv(i.state.doc,r)));return{options:n,from:t?e.from:i.pos,validFor:Ky}}const Xn=Bs.define({name:"javascript",parser:wX.configure({props:[Jl.add({IfStatement:Ph({except:/^\s*({|else\b)/}),TryStatement:Ph({except:/^\s*({|catch\b|finally\b)/}),LabeledStatement:g2,SwitchBody:i=>{let e=i.textAfter,t=/^\s*\}/.test(e),n=/^\s*(case|default)\b/.test(e);return i.baseIndent+(t?0:n?1:2)*i.unit},Block:m2({closing:"}"}),ArrowFunction:i=>i.baseIndent+i.unit,"TemplateString BlockComment":()=>null,"Statement Property":Ph({except:/^{/}),JSXElement(i){let e=/^\s*<\//.test(i.textAfter);return i.lineIndent(i.node.from)+(e?0:i.unit)},JSXEscape(i){let e=/\s*\}/.test(i.textAfter);return i.lineIndent(i.node.from)+(e?0:i.unit)},"JSXOpenTag JSXSelfClosingTag"(i){return i.column(i.node.from)+i.unit}}),eo.add({"Block ClassBody SwitchBody EnumBody ObjectExpression ArrayExpression ObjectType":dw,BlockComment(i){return{from:i.from+2,to:i.to-2}}})]}),languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"`"]},commentTokens:{line:"//",block:{open:"/*",close:"*/"}},indentOnInput:/^\s*(?:case |default:|\{|\}|<\/)$/,wordChars:"$"}}),Zv={test:i=>/^JSX/.test(i.name),facet:Vc({commentTokens:{block:{open:"{/*",close:"*/}"}}})},Rv=Xn.configure({dialect:"ts"},"typescript"),Ev=Xn.configure({dialect:"jsx",props:[Jp.add(i=>i.isTop?[Zv]:void 0)]}),Nv=Xn.configure({dialect:"jsx ts",props:[Jp.add(i=>i.isTop?[Zv]:void 0)]},"typescript");let Dv=i=>({label:i,type:"keyword"});const Iv="break case const continue default delete export extends false finally in instanceof let new return static super switch this throw true typeof var yield".split(" ").map(Dv),QX=Iv.concat(["declare","implements","private","protected","public"].map(Dv));function CX(i={}){let e=i.jsx?i.typescript?Nv:Ev:i.typescript?Rv:Xn,t=i.typescript?xX.concat(QX):Cv.concat(Iv);return new Zl(e,[Xn.data.of({autocomplete:DN(Av,Sx(t))}),Xn.data.of({autocomplete:PX}),i.jsx?AX:[]])}function TX(i){for(;;){if(i.name=="JSXOpenTag"||i.name=="JSXSelfClosingTag"||i.name=="JSXFragmentTag")return i;if(i.name=="JSXEscape"||!i.parent)return null;i=i.parent}}function Jy(i,e,t=i.length){for(let n=e==null?void 0:e.firstChild;n;n=n.nextSibling)if(n.name=="JSXIdentifier"||n.name=="JSXBuiltin"||n.name=="JSXNamespacedName"||n.name=="JSXMemberExpression")return i.sliceString(n.from,Math.min(n.to,t));return""}const MX=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),AX=M.inputHandler.of((i,e,t,n,r)=>{if((MX?i.composing:i.compositionStarted)||i.state.readOnly||e!=t||n!=">"&&n!="/"||!Xn.isActiveAt(i.state,e,-1))return!1;let s=r(),{state:o}=s,l=o.changeByRange(a=>{var h;let{head:c}=a,f=ae(o).resolveInner(c-1,-1),u;if(f.name=="JSXStartTag"&&(f=f.parent),!(o.doc.sliceString(c-1,c)!=n||f.name=="JSXAttributeValue"&&f.to>c)){if(n==">"&&f.name=="JSXFragmentTag")return{range:a,changes:{from:c,insert:"</>"}};if(n=="/"&&f.name=="JSXStartCloseTag"){let d=f.parent,p=d.parent;if(p&&d.from==c-2&&((u=Jy(o.doc,p.firstChild,c))||((h=p.firstChild)===null||h===void 0?void 0:h.name)=="JSXFragmentTag")){let m=`${u}>`;return{range:b.cursor(c+m.length,-1),changes:{from:c,insert:m}}}}else if(n==">"){let d=TX(f);if(d&&d.name=="JSXOpenTag"&&!/^\/?>|^<\//.test(o.doc.sliceString(c,c+2))&&(u=Jy(o.doc,d,c)))return{range:a,changes:{from:c,insert:`</${u}>`}}}}return{range:a}});return l.changes.empty?!1:(i.dispatch([s,o.update(l,{userEvent:"input.complete",scrollIntoView:!0})]),!0)}),Oo=["_blank","_self","_top","_parent"],du=["ascii","utf-8","utf-16","latin1","latin1"],pu=["get","post","put","delete"],mu=["application/x-www-form-urlencoded","multipart/form-data","text/plain"],Pt=["true","false"],N={},ZX={a:{attrs:{href:null,ping:null,type:null,media:null,target:Oo,hreflang:null}},abbr:N,address:N,area:{attrs:{alt:null,coords:null,href:null,target:null,ping:null,media:null,hreflang:null,type:null,shape:["default","rect","circle","poly"]}},article:N,aside:N,audio:{attrs:{src:null,mediagroup:null,crossorigin:["anonymous","use-credentials"],preload:["none","metadata","auto"],autoplay:["autoplay"],loop:["loop"],controls:["controls"]}},b:N,base:{attrs:{href:null,target:Oo}},bdi:N,bdo:N,blockquote:{attrs:{cite:null}},body:N,br:N,button:{attrs:{form:null,formaction:null,name:null,value:null,autofocus:["autofocus"],disabled:["autofocus"],formenctype:mu,formmethod:pu,formnovalidate:["novalidate"],formtarget:Oo,type:["submit","reset","button"]}},canvas:{attrs:{width:null,height:null}},caption:N,center:N,cite:N,code:N,col:{attrs:{span:null}},colgroup:{attrs:{span:null}},command:{attrs:{type:["command","checkbox","radio"],label:null,icon:null,radiogroup:null,command:null,title:null,disabled:["disabled"],checked:["checked"]}},data:{attrs:{value:null}},datagrid:{attrs:{disabled:["disabled"],multiple:["multiple"]}},datalist:{attrs:{data:null}},dd:N,del:{attrs:{cite:null,datetime:null}},details:{attrs:{open:["open"]}},dfn:N,div:N,dl:N,dt:N,em:N,embed:{attrs:{src:null,type:null,width:null,height:null}},eventsource:{attrs:{src:null}},fieldset:{attrs:{disabled:["disabled"],form:null,name:null}},figcaption:N,figure:N,footer:N,form:{attrs:{action:null,name:null,"accept-charset":du,autocomplete:["on","off"],enctype:mu,method:pu,novalidate:["novalidate"],target:Oo}},h1:N,h2:N,h3:N,h4:N,h5:N,h6:N,head:{children:["title","base","link","style","meta","script","noscript","command"]},header:N,hgroup:N,hr:N,html:{attrs:{manifest:null}},i:N,iframe:{attrs:{src:null,srcdoc:null,name:null,width:null,height:null,sandbox:["allow-top-navigation","allow-same-origin","allow-forms","allow-scripts"],seamless:["seamless"]}},img:{attrs:{alt:null,src:null,ismap:null,usemap:null,width:null,height:null,crossorigin:["anonymous","use-credentials"]}},input:{attrs:{alt:null,dirname:null,form:null,formaction:null,height:null,list:null,max:null,maxlength:null,min:null,name:null,pattern:null,placeholder:null,size:null,src:null,step:null,value:null,width:null,accept:["audio/*","video/*","image/*"],autocomplete:["on","off"],autofocus:["autofocus"],checked:["checked"],disabled:["disabled"],formenctype:mu,formmethod:pu,formnovalidate:["novalidate"],formtarget:Oo,multiple:["multiple"],readonly:["readonly"],required:["required"],type:["hidden","text","search","tel","url","email","password","datetime","date","month","week","time","datetime-local","number","range","color","checkbox","radio","file","submit","image","reset","button"]}},ins:{attrs:{cite:null,datetime:null}},kbd:N,keygen:{attrs:{challenge:null,form:null,name:null,autofocus:["autofocus"],disabled:["disabled"],keytype:["RSA"]}},label:{attrs:{for:null,form:null}},legend:N,li:{attrs:{value:null}},link:{attrs:{href:null,type:null,hreflang:null,media:null,sizes:["all","16x16","16x16 32x32","16x16 32x32 64x64"]}},map:{attrs:{name:null}},mark:N,menu:{attrs:{label:null,type:["list","context","toolbar"]}},meta:{attrs:{content:null,charset:du,name:["viewport","application-name","author","description","generator","keywords"],"http-equiv":["content-language","content-type","default-style","refresh"]}},meter:{attrs:{value:null,min:null,low:null,high:null,max:null,optimum:null}},nav:N,noscript:N,object:{attrs:{data:null,type:null,name:null,usemap:null,form:null,width:null,height:null,typemustmatch:["typemustmatch"]}},ol:{attrs:{reversed:["reversed"],start:null,type:["1","a","A","i","I"]},children:["li","script","template","ul","ol"]},optgroup:{attrs:{disabled:["disabled"],label:null}},option:{attrs:{disabled:["disabled"],label:null,selected:["selected"],value:null}},output:{attrs:{for:null,form:null,name:null}},p:N,param:{attrs:{name:null,value:null}},pre:N,progress:{attrs:{value:null,max:null}},q:{attrs:{cite:null}},rp:N,rt:N,ruby:N,samp:N,script:{attrs:{type:["text/javascript"],src:null,async:["async"],defer:["defer"],charset:du}},section:N,select:{attrs:{form:null,name:null,size:null,autofocus:["autofocus"],disabled:["disabled"],multiple:["multiple"]}},slot:{attrs:{name:null}},small:N,source:{attrs:{src:null,type:null,media:null}},span:N,strong:N,style:{attrs:{type:["text/css"],media:null,scoped:null}},sub:N,summary:N,sup:N,table:N,tbody:N,td:{attrs:{colspan:null,rowspan:null,headers:null}},template:N,textarea:{attrs:{dirname:null,form:null,maxlength:null,name:null,placeholder:null,rows:null,cols:null,autofocus:["autofocus"],disabled:["disabled"],readonly:["readonly"],required:["required"],wrap:["soft","hard"]}},tfoot:N,th:{attrs:{colspan:null,rowspan:null,headers:null,scope:["row","col","rowgroup","colgroup"]}},thead:N,time:{attrs:{datetime:null}},title:N,tr:N,track:{attrs:{src:null,label:null,default:null,kind:["subtitles","captions","descriptions","chapters","metadata"],srclang:null}},ul:{children:["li","script","template","ul","ol"]},var:N,video:{attrs:{src:null,poster:null,width:null,height:null,crossorigin:["anonymous","use-credentials"],preload:["auto","metadata","none"],autoplay:["autoplay"],mediagroup:["movie"],muted:["muted"],controls:["controls"]}},wbr:N},Wv={accesskey:null,class:null,contenteditable:Pt,contextmenu:null,dir:["ltr","rtl","auto"],draggable:["true","false","auto"],dropzone:["copy","move","link","string:","file:"],hidden:["hidden"],id:null,inert:["inert"],itemid:null,itemprop:null,itemref:null,itemscope:["itemscope"],itemtype:null,lang:["ar","bn","de","en-GB","en-US","es","fr","hi","id","ja","pa","pt","ru","tr","zh"],spellcheck:Pt,autocorrect:Pt,autocapitalize:Pt,style:null,tabindex:null,title:null,translate:["yes","no"],rel:["stylesheet","alternate","author","bookmark","help","license","next","nofollow","noreferrer","prefetch","prev","search","tag"],role:"alert application article banner button cell checkbox complementary contentinfo dialog document feed figure form grid gridcell heading img list listbox listitem main navigation region row rowgroup search switch tab table tabpanel textbox timer".split(" "),"aria-activedescendant":null,"aria-atomic":Pt,"aria-autocomplete":["inline","list","both","none"],"aria-busy":Pt,"aria-checked":["true","false","mixed","undefined"],"aria-controls":null,"aria-describedby":null,"aria-disabled":Pt,"aria-dropeffect":null,"aria-expanded":["true","false","undefined"],"aria-flowto":null,"aria-grabbed":["true","false","undefined"],"aria-haspopup":Pt,"aria-hidden":Pt,"aria-invalid":["true","false","grammar","spelling"],"aria-label":null,"aria-labelledby":null,"aria-level":null,"aria-live":["off","polite","assertive"],"aria-multiline":Pt,"aria-multiselectable":Pt,"aria-owns":null,"aria-posinset":null,"aria-pressed":["true","false","mixed","undefined"],"aria-readonly":Pt,"aria-relevant":null,"aria-required":Pt,"aria-selected":["true","false","undefined"],"aria-setsize":null,"aria-sort":["ascending","descending","none","other"],"aria-valuemax":null,"aria-valuemin":null,"aria-valuenow":null,"aria-valuetext":null},Xv="beforeunload copy cut dragstart dragover dragleave dragenter dragend drag paste focus blur change click load mousedown mouseenter mouseleave mouseup keydown keyup resize scroll unload".split(" ").map(i=>"on"+i);for(let i of Xv)Wv[i]=null;class ql{constructor(e,t){this.tags=Object.assign(Object.assign({},ZX),e),this.globalAttrs=Object.assign(Object.assign({},Wv),t),this.allTags=Object.keys(this.tags),this.globalAttrNames=Object.keys(this.globalAttrs)}}ql.default=new ql;function js(i,e,t=i.length){if(!e)return"";let n=e.firstChild,r=n&&n.getChild("TagName");return r?i.sliceString(r.from,Math.min(r.to,t)):""}function _s(i,e=!1){for(;i;i=i.parent)if(i.name=="Element")if(e)e=!1;else return i;return null}function Bv(i,e,t){let n=t.tags[js(i,_s(e))];return(n==null?void 0:n.children)||t.allTags}function Pm(i,e){let t=[];for(let n=_s(e);n&&!n.type.isTop;n=_s(n.parent)){let r=js(i,n);if(r&&n.lastChild.name=="CloseTag")break;r&&t.indexOf(r)<0&&(e.name=="EndTag"||e.from>=n.firstChild.to)&&t.push(r)}return t}const Vv=/^[:\-\.\w\u00b7-\uffff]*$/;function e1(i,e,t,n,r){let s=/\s*>/.test(i.sliceDoc(r,r+5))?"":">",o=_s(t,!0);return{from:n,to:r,options:Bv(i.doc,o,e).map(l=>({label:l,type:"type"})).concat(Pm(i.doc,t).map((l,a)=>({label:"/"+l,apply:"/"+l+s,type:"type",boost:99-a}))),validFor:/^\/?[:\-\.\w\u00b7-\uffff]*$/}}function t1(i,e,t,n){let r=/\s*>/.test(i.sliceDoc(n,n+5))?"":">";return{from:t,to:n,options:Pm(i.doc,e).map((s,o)=>({label:s,apply:s+r,type:"type",boost:99-o})),validFor:Vv}}function RX(i,e,t,n){let r=[],s=0;for(let o of Bv(i.doc,t,e))r.push({label:"<"+o,type:"type"});for(let o of Pm(i.doc,t))r.push({label:"</"+o+">",type:"type",boost:99-s++});return{from:n,to:n,options:r,validFor:/^<\/?[:\-\.\w\u00b7-\uffff]*$/}}function EX(i,e,t,n,r){let s=_s(t),o=s?e.tags[js(i.doc,s)]:null,l=o&&o.attrs?Object.keys(o.attrs):[],a=o&&o.globalAttrs===!1?l:l.length?l.concat(e.globalAttrNames):e.globalAttrNames;return{from:n,to:r,options:a.map(h=>({label:h,type:"property"})),validFor:Vv}}function NX(i,e,t,n,r){var s;let o=(s=t.parent)===null||s===void 0?void 0:s.getChild("AttributeName"),l=[],a;if(o){let h=i.sliceDoc(o.from,o.to),c=e.globalAttrs[h];if(!c){let f=_s(t),u=f?e.tags[js(i.doc,f)]:null;c=(u==null?void 0:u.attrs)&&u.attrs[h]}if(c){let f=i.sliceDoc(n,r).toLowerCase(),u='"',d='"';/^['"]/.test(f)?(a=f[0]=='"'?/^[^"]*$/:/^[^']*$/,u="",d=i.sliceDoc(r,r+1)==f[0]?"":f[0],f=f.slice(1),n++):a=/^[^\s<>='"]*$/;for(let p of c)l.push({label:p,apply:u+p+d,type:"constant"})}}return{from:n,to:r,options:l,validFor:a}}function qv(i,e){let{state:t,pos:n}=e,r=ae(t).resolveInner(n,-1),s=r.resolve(n);for(let o=n,l;s==r&&(l=r.childBefore(o));){let a=l.lastChild;if(!a||!a.type.isError||a.from<a.to)break;s=r=l,o=a.from}return r.name=="TagName"?r.parent&&/CloseTag$/.test(r.parent.name)?t1(t,r,r.from,n):e1(t,i,r,r.from,n):r.name=="StartTag"?e1(t,i,r,n,n):r.name=="StartCloseTag"||r.name=="IncompleteCloseTag"?t1(t,r,n,n):r.name=="OpenTag"||r.name=="SelfClosingTag"||r.name=="AttributeName"?EX(t,i,r,r.name=="AttributeName"?r.from:n,n):r.name=="Is"||r.name=="AttributeValue"||r.name=="UnquotedAttributeValue"?NX(t,i,r,r.name=="Is"?n:r.from,n):e.explicit&&(s.name=="Element"||s.name=="Text"||s.name=="Document")?RX(t,i,r,n):null}function DX(i){return qv(ql.default,i)}function IX(i){let{extraTags:e,extraGlobalAttributes:t}=i,n=t||e?new ql(e,t):ql.default;return r=>qv(n,r)}const WX=Xn.parser.configure({top:"SingleExpression"}),Lv=[{tag:"script",attrs:i=>i.type=="text/typescript"||i.lang=="ts",parser:Rv.parser},{tag:"script",attrs:i=>i.type=="text/babel"||i.type=="text/jsx",parser:Ev.parser},{tag:"script",attrs:i=>i.type=="text/typescript-jsx",parser:Nv.parser},{tag:"script",attrs(i){return/^(importmap|speculationrules|application\/(.+\+)?json)$/i.test(i.type)},parser:WX},{tag:"script",attrs(i){return!i.type||/^(?:text|application)\/(?:x-)?(?:java|ecma)script$|^module$|^$/i.test(i.type)},parser:Xn.parser},{tag:"style",attrs(i){return(!i.lang||i.lang=="css")&&(!i.type||/^(text\/)?(x-)?(stylesheet|css)$/i.test(i.type))},parser:kc.parser}],zv=[{name:"style",parser:kc.parser.configure({top:"Styles"})}].concat(Xv.map(i=>({name:i,parser:Xn.parser}))),Yv=Bs.define({name:"html",parser:xW.configure({props:[Jl.add({Element(i){let e=/^(\s*)(<\/)?/.exec(i.textAfter);return i.node.to<=i.pos+e[0].length?i.continue():i.lineIndent(i.node.from)+(e[2]?0:i.unit)},"OpenTag CloseTag SelfClosingTag"(i){return i.column(i.node.from)+i.unit},Document(i){if(i.pos+/\s*/.exec(i.textAfter)[0].length<i.node.to)return i.continue();let e=null,t;for(let n=i.node;;){let r=n.lastChild;if(!r||r.name!="Element"||r.to!=n.to)break;e=n=r}return e&&!((t=e.lastChild)&&(t.name=="CloseTag"||t.name=="SelfClosingTag"))?i.lineIndent(e.from)+i.unit:null}}),eo.add({Element(i){let e=i.firstChild,t=i.lastChild;return!e||e.name!="OpenTag"?null:{from:e.to,to:t.name=="CloseTag"?t.from:i.to}}}),$w.add({"OpenTag CloseTag":i=>i.getChild("TagName")})]}),languageData:{commentTokens:{block:{open:"<!--",close:"-->"}},indentOnInput:/^\s*<\/\w+\W$/,wordChars:"-._"}}),Mh=Yv.configure({wrap:wv(Lv,zv)});function XX(i={}){let e="",t;i.matchClosingTags===!1&&(e="noMatch"),i.selfClosingTags===!0&&(e=(e?e+" ":"")+"selfClosing"),(i.nestedLanguages&&i.nestedLanguages.length||i.nestedAttributes&&i.nestedAttributes.length)&&(t=wv((i.nestedLanguages||[]).concat(Lv),(i.nestedAttributes||[]).concat(zv)));let n=t?Yv.configure({wrap:t,dialect:e}):e?Mh.configure({dialect:e}):Mh;return new Zl(n,[Mh.data.of({autocomplete:IX(i)}),i.autoCloseTags!==!1?BX:[],CX().support,HW().support])}const n1=new Set("area base br col command embed frame hr img input keygen link meta param source track wbr menuitem".split(" ")),BX=M.inputHandler.of((i,e,t,n,r)=>{if(i.composing||i.state.readOnly||e!=t||n!=">"&&n!="/"||!Mh.isActiveAt(i.state,e,-1))return!1;let s=r(),{state:o}=s,l=o.changeByRange(a=>{var h,c,f;let u=o.doc.sliceString(a.from-1,a.to)==n,{head:d}=a,p=ae(o).resolveInner(d-1,-1),m;if((p.name=="TagName"||p.name=="StartTag")&&(p=p.parent),u&&n==">"&&p.name=="OpenTag"){if(((c=(h=p.parent)===null||h===void 0?void 0:h.lastChild)===null||c===void 0?void 0:c.name)!="CloseTag"&&(m=js(o.doc,p.parent,d))&&!n1.has(m)){let g=d+(o.doc.sliceString(d,d+1)===">"?1:0),y=`</${m}>`;return{range:a,changes:{from:d,to:g,insert:y}}}}else if(u&&n=="/"&&p.name=="IncompleteCloseTag"){let g=p.parent;if(p.from==d-2&&((f=g.lastChild)===null||f===void 0?void 0:f.name)!="CloseTag"&&(m=js(o.doc,g,d))&&!n1.has(m)){let y=d+(o.doc.sliceString(d,d+1)===">"?1:0),k=`${m}>`;return{range:b.cursor(d+k.length,-1),changes:{from:d,to:y,insert:k}}}}return{range:a}});return l.changes.empty?!1:(i.dispatch([s,o.update(l,{userEvent:"input.complete",scrollIntoView:!0})]),!0)}),jv=Vc({commentTokens:{block:{open:"<!--",close:"-->"}}}),_v=new B,Fv=yI.configure({props:[eo.add(i=>!i.is("Block")||i.is("Document")||ip(i)!=null?void 0:(e,t)=>({from:t.doc.lineAt(e.from).to,to:e.to})),_v.add(ip),Jl.add({Document:()=>null}),Di.add({Document:jv})]});function ip(i){let e=/^(?:ATX|Setext)Heading(\d)$/.exec(i.name);return e?+e[1]:void 0}function VX(i,e){let t=i;for(;;){let n=t.nextSibling,r;if(!n||(r=ip(n.type))!=null&&r<=e)break;t=n}return t.to}const qX=uw.of((i,e,t)=>{for(let n=ae(i).resolveInner(t,-1);n&&!(n.from<e);n=n.parent){let r=n.type.prop(_v);if(r==null)continue;let s=VX(n,r);if(s>t)return{from:t,to:s}}return null});function Qm(i){return new Zt(jv,i,[qX],"markdown")}const LX=Qm(Fv),zX=Fv.configure([TI,AI,MI,ZI,{props:[eo.add({Table:(i,e)=>({from:e.doc.lineAt(i.from).to,to:i.to})})]}]),Uv=Qm(zX);function YX(i,e){return t=>{if(t&&i){let n=null;if(t=/\S*/.exec(t)[0],typeof i=="function"?n=i(t):n=tc.matchLanguageName(i,t,!0),n instanceof tc)return n.support?n.support.language.parser:Br.getSkippingParser(n.load());if(n)return n.parser}return e?e.parser:null}}class Va{constructor(e,t,n,r,s,o,l){this.node=e,this.from=t,this.to=n,this.spaceBefore=r,this.spaceAfter=s,this.type=o,this.item=l}blank(e,t=!0){let n=this.spaceBefore+(this.node.name=="Blockquote"?">":"");if(e!=null){for(;n.length<e;)n+=" ";return n}else{for(let r=this.to-this.from-n.length-this.spaceAfter.length;r>0;r--)n+=" ";return n+(t?this.spaceAfter:"")}}marker(e,t){let n=this.node.name=="OrderedList"?String(+Hv(this.item,e)[2]+t):"";return this.spaceBefore+n+this.type+this.spaceAfter}}function Gv(i,e){let t=[];for(let r=i;r&&r.name!="Document";r=r.parent)(r.name=="ListItem"||r.name=="Blockquote"||r.name=="FencedCode")&&t.push(r);let n=[];for(let r=t.length-1;r>=0;r--){let s=t[r],o,l=e.lineAt(s.from),a=s.from-l.from;if(s.name=="FencedCode")n.push(new Va(s,a,a,"","","",null));else if(s.name=="Blockquote"&&(o=/^ *>( ?)/.exec(l.text.slice(a))))n.push(new Va(s,a,a+o[0].length,"",o[1],">",null));else if(s.name=="ListItem"&&s.parent.name=="OrderedList"&&(o=/^( *)\d+([.)])( *)/.exec(l.text.slice(a)))){let h=o[3],c=o[0].length;h.length>=4&&(h=h.slice(0,h.length-4),c-=4),n.push(new Va(s.parent,a,a+c,o[1],h,o[2],s))}else if(s.name=="ListItem"&&s.parent.name=="BulletList"&&(o=/^( *)([-+*])( {1,4}\[[ xX]\])?( +)/.exec(l.text.slice(a)))){let h=o[4],c=o[0].length;h.length>4&&(h=h.slice(0,h.length-4),c-=4);let f=o[2];o[3]&&(f+=o[3].replace(/[xX]/," ")),n.push(new Va(s.parent,a,a+c,o[1],h,f,s))}}return n}function Hv(i,e){return/^(\s*)(\d+)(?=[.)])/.exec(e.sliceString(i.from,i.from+10))}function gu(i,e,t,n=0){for(let r=-1,s=i;;){if(s.name=="ListItem"){let l=Hv(s,e),a=+l[2];if(r>=0){if(a!=r+1)return;t.push({from:s.from+l[1].length,to:s.from+l[0].length,insert:String(r+2+n)})}r=a}let o=s.nextSibling;if(!o)break;s=o}}function Cm(i,e){let t=/^[ \t]*/.exec(i)[0].length;if(!t||e.facet(Js)!="	")return i;let n=dn(i,4,t),r="";for(let s=n;s>0;)s>=4?(r+="	",s-=4):(r+=" ",s--);return r+i.slice(t)}const jX=({state:i,dispatch:e})=>{let t=ae(i),{doc:n}=i,r=null,s=i.changeByRange(o=>{if(!o.empty||!Uv.isActiveAt(i,o.from))return r={range:o};let l=o.from,a=n.lineAt(l),h=Gv(t.resolveInner(l,-1),n);for(;h.length&&h[h.length-1].from>l-a.from;)h.pop();if(!h.length)return r={range:o};let c=h[h.length-1];if(c.to-c.spaceAfter.length>l-a.from)return r={range:o};let f=l>=c.to-c.spaceAfter.length&&!/\S/.test(a.text.slice(c.to));if(c.item&&f){let g=c.node.firstChild,y=c.node.getChild("ListItem","ListItem");if(g.to>=l||y&&y.to<l||a.from>0&&!/[^\s>]/.test(n.lineAt(a.from-1).text)){let k=h.length>1?h[h.length-2]:null,v,$="";k&&k.item?(v=a.from+k.from,$=k.marker(n,1)):v=a.from+(k?k.to:0);let S=[{from:v,to:l,insert:$}];return c.node.name=="OrderedList"&&gu(c.item,n,S,-2),k&&k.node.name=="OrderedList"&&gu(k.item,n,S),{range:b.cursor(v+$.length),changes:S}}else{let k=r1(h,i,a);return{range:b.cursor(l+k.length+1),changes:{from:a.from,insert:k+i.lineBreak}}}}if(c.node.name=="Blockquote"&&f&&a.from){let g=n.lineAt(a.from-1),y=/>\s*$/.exec(g.text);if(y&&y.index==c.from){let k=i.changes([{from:g.from+y.index,to:g.to},{from:a.from+c.from,to:a.to}]);return{range:o.map(k),changes:k}}}let u=[];c.node.name=="OrderedList"&&gu(c.item,n,u);let d=c.item&&c.item.from<a.from,p="";if(!d||/^[\s\d.)\-+*>]*/.exec(a.text)[0].length>=c.to)for(let g=0,y=h.length-1;g<=y;g++)p+=g==y&&!d?h[g].marker(n,1):h[g].blank(g<y?dn(a.text,4,h[g+1].from)-p.length:null);let m=l;for(;m>a.from&&/\s/.test(a.text.charAt(m-a.from-1));)m--;return p=Cm(p,i),_X(c.node,i.doc)&&(p=r1(h,i,a)+i.lineBreak+p),u.push({from:m,to:l,insert:i.lineBreak+p}),{range:b.cursor(m+p.length+1),changes:u}});return r?!1:(e(i.update(s,{scrollIntoView:!0,userEvent:"input"})),!0)};function i1(i){return i.name=="QuoteMark"||i.name=="ListMark"}function _X(i,e){if(i.name!="OrderedList"&&i.name!="BulletList")return!1;let t=i.firstChild,n=i.getChild("ListItem","ListItem");if(!n)return!1;let r=e.lineAt(t.to),s=e.lineAt(n.from),o=/^[\s>]*$/.test(r.text);return r.number+(o?0:1)<s.number}function r1(i,e,t){let n="";for(let r=0,s=i.length-2;r<=s;r++)n+=i[r].blank(r<s?dn(t.text,4,i[r+1].from)-n.length:null,r<s);return Cm(n,e)}function FX(i,e){let t=i.resolveInner(e,-1),n=e;i1(t)&&(n=t.from,t=t.parent);for(let r;r=t.childBefore(n);)if(i1(r))n=r.from;else if(r.name=="OrderedList"||r.name=="BulletList")t=r.lastChild,n=t.to;else break;return t}const UX=({state:i,dispatch:e})=>{let t=ae(i),n=null,r=i.changeByRange(s=>{let o=s.from,{doc:l}=i;if(s.empty&&Uv.isActiveAt(i,s.from)){let a=l.lineAt(o),h=Gv(FX(t,o),l);if(h.length){let c=h[h.length-1],f=c.to-c.spaceAfter.length+(c.spaceAfter?1:0);if(o-a.from>f&&!/\S/.test(a.text.slice(f,o-a.from)))return{range:b.cursor(a.from+f),changes:{from:a.from+f,to:o}};if(o-a.from==f&&(!c.item||a.from<=c.item.from||!/\S/.test(a.text.slice(0,c.to)))){let u=a.from+c.from;if(c.item&&c.node.from<c.item.from&&/\S/.test(a.text.slice(c.from,c.to))){let d=c.blank(dn(a.text,4,c.to)-dn(a.text,4,c.from));return u==a.from&&(d=Cm(d,i)),{range:b.cursor(u+d.length),changes:{from:u,to:a.from+c.to,insert:d}}}if(u<o)return{range:b.cursor(u),changes:{from:u,to:o}}}}}return n={range:s}});return n?!1:(e(i.update(r,{scrollIntoView:!0,userEvent:"delete"})),!0)},GX=[{key:"Enter",run:jX},{key:"Backspace",run:UX}],rp=XX({matchClosingTags:!1});function HX(i={}){let{codeLanguages:e,defaultCodeLanguage:t,addKeymap:n=!0,base:{parser:r}=LX,completeHTMLTags:s=!0}=i;if(!(r instanceof Kc))throw new RangeError("Base parser provided to `markdown` should be a Markdown parser");let o=i.extensions?[i.extensions]:[],l=[rp.support],a;t instanceof Zl?(l.push(t.support),a=t.language):t&&(a=t);let h=e||a?YX(e,a):void 0;o.push(bI({codeParser:h,htmlParser:rp.language.parser})),n&&l.push(di.high(Gs.of(GX)));let c=Qm(r.configure(o));return s&&l.push(c.data.of({autocomplete:KX})),new Zl(c,l)}function KX(i){let{state:e,pos:t}=i,n=/<[:\-\.\w\u00b7-\uffff]*$/.exec(e.sliceDoc(t-25,t));if(!n)return null;let r=ae(e).resolveInner(t,-1);for(;r&&!r.type.isTop;){if(r.name=="CodeBlock"||r.name=="FencedCode"||r.name=="ProcessingInstructionBlock"||r.name=="CommentBlock"||r.name=="Link"||r.name=="Image")return null;r=r.parent}return{from:t-n[0].length,to:t,options:JX(),validFor:/^<[:\-\.\w\u00b7-\uffff]*$/}}let Ou=null;function JX(){if(Ou)return Ou;let i=DX(new dm(j.create({extensions:rp}),0,!0));return Ou=i?i.options:[]}const e5="#e5c07b",s1="#e06c75",t5="#56b6c2",n5="#ffffff",Ah="#abb2bf",sp="#7d8799",i5="#61afef",r5="#98c379",o1="#d19a66",s5="#c678dd",o5="#21252b",l1="#2c313a",a1="#282c34",yu="#353a42",l5="#3E4451",h1="#528bff",a5=M.theme({"&":{color:Ah,backgroundColor:a1},".cm-content":{caretColor:h1},".cm-cursor, .cm-dropCursor":{borderLeftColor:h1},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:l5},".cm-panels":{backgroundColor:o5,color:Ah},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:a1,color:sp,border:"none"},".cm-activeLineGutter":{backgroundColor:l1},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:yu},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:yu,borderBottomColor:yu},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:l1,color:Ah}}},{dark:!0}),h5=ta.define([{tag:O.keyword,color:s5},{tag:[O.name,O.deleted,O.character,O.propertyName,O.macroName],color:s1},{tag:[O.function(O.variableName),O.labelName],color:i5},{tag:[O.color,O.constant(O.name),O.standard(O.name)],color:o1},{tag:[O.definition(O.name),O.separator],color:Ah},{tag:[O.typeName,O.className,O.number,O.changed,O.annotation,O.modifier,O.self,O.namespace],color:e5},{tag:[O.operator,O.operatorKeyword,O.url,O.escape,O.regexp,O.link,O.special(O.string)],color:t5},{tag:[O.meta,O.comment],color:sp},{tag:O.strong,fontWeight:"bold"},{tag:O.emphasis,fontStyle:"italic"},{tag:O.strikethrough,textDecoration:"line-through"},{tag:O.link,color:sp,textDecoration:"underline"},{tag:O.heading,fontWeight:"bold",color:s1},{tag:[O.atom,O.bool,O.special(O.variableName)],color:o1},{tag:[O.processingInstruction,O.string,O.inserted],color:r5},{tag:O.invalid,color:n5}]),c5=[a5,Sw(h5)];var f5="Expected a function",c1=NaN,u5="[object Symbol]",d5=/^\s+|\s+$/g,p5=/^[-+]0x[0-9a-f]+$/i,m5=/^0b[01]+$/i,g5=/^0o[0-7]+$/i,O5=parseInt,y5=typeof fa=="object"&&fa&&fa.Object===Object&&fa,k5=typeof self=="object"&&self&&self.Object===Object&&self,b5=y5||k5||Function("return this")(),S5=Object.prototype,w5=S5.toString,x5=Math.max,v5=Math.min,ku=function(){return b5.Date.now()};function $5(i,e,t){var n,r,s,o,l,a,h=0,c=!1,f=!1,u=!0;if(typeof i!="function")throw new TypeError(f5);e=f1(e)||0,op(t)&&(c=!!t.leading,f="maxWait"in t,s=f?x5(f1(t.maxWait)||0,e):s,u="trailing"in t?!!t.trailing:u);function d(x){var Q=n,X=r;return n=r=void 0,h=x,o=i.apply(X,Q),o}function p(x){return h=x,l=setTimeout(y,e),c?d(x):o}function m(x){var Q=x-a,X=x-h,A=e-Q;return f?v5(A,s-X):A}function g(x){var Q=x-a,X=x-h;return a===void 0||Q>=e||Q<0||f&&X>=s}function y(){var x=ku();if(g(x))return k(x);l=setTimeout(y,m(x))}function k(x){return l=void 0,u&&n?d(x):(n=r=void 0,o)}function v(){l!==void 0&&clearTimeout(l),h=0,n=a=r=l=void 0}function $(){return l===void 0?o:k(ku())}function S(){var x=ku(),Q=g(x);if(n=arguments,r=this,a=x,Q){if(l===void 0)return p(a);if(f)return l=setTimeout(y,e),d(a)}return l===void 0&&(l=setTimeout(y,e)),o}return S.cancel=v,S.flush=$,S}function op(i){var e=typeof i;return!!i&&(e=="object"||e=="function")}function P5(i){return!!i&&typeof i=="object"}function Q5(i){return typeof i=="symbol"||P5(i)&&w5.call(i)==u5}function f1(i){if(typeof i=="number")return i;if(Q5(i))return c1;if(op(i)){var e=typeof i.valueOf=="function"?i.valueOf():i;i=op(e)?e+"":e}if(typeof i!="string")return i===0?i:+i;i=i.replace(d5,"");var t=m5.test(i);return t||g5.test(i)?O5(i.slice(2),t?2:8):p5.test(i)?c1:+i}var C5=$5;const T5=nP(C5);class Kv{constructor(){this.beforeMountedListeners=[],this.mountedListeners=[],this.updatedListeners=[],this.markdownUpdatedListeners=[],this.blurListeners=[],this.focusListeners=[],this.destroyListeners=[],this.beforeMount=e=>(this.beforeMountedListeners.push(e),this),this.mounted=e=>(this.mountedListeners.push(e),this),this.updated=e=>(this.updatedListeners.push(e),this)}get listeners(){return{beforeMount:this.beforeMountedListeners,mounted:this.mountedListeners,updated:this.updatedListeners,markdownUpdated:this.markdownUpdatedListeners,blur:this.blurListeners,focus:this.focusListeners,destroy:this.destroyListeners}}markdownUpdated(e){return this.markdownUpdatedListeners.push(e),this}blur(e){return this.blurListeners.push(e),this}focus(e){return this.focusListeners.push(e),this}destroy(e){return this.destroyListeners.push(e),this}}const lp=ne(new Kv,"listener"),M5=new Ht("MILKDOWN_LISTENER"),Jv=i=>(i.inject(lp,new Kv),async()=>{await i.wait(Cr);const e=i.get(lp),{listeners:t}=e;t.beforeMount.forEach(l=>l(i)),await i.wait(el);const n=i.get(tl);let r=null,s=null;const o=new wt({key:M5,view:()=>({destroy:()=>{t.destroy.forEach(l=>l(i))}}),props:{handleDOMEvents:{focus:()=>(t.focus.forEach(l=>l(i)),!1),blur:()=>(t.blur.forEach(l=>l(i)),!1)}},state:{init:(l,a)=>{r=a.doc,s=n(a.doc)},apply:l=>!l.docChanged||l.getMeta("addToHistory")===!1?void 0:T5(()=>{const{doc:a}=l;if(t.updated.length>0&&r&&!r.eq(a)&&t.updated.forEach(h=>{h(i,a,r)}),t.markdownUpdated.length>0&&r&&!r.eq(a)){const h=n(a);t.markdownUpdated.forEach(c=>{c(i,h,s)}),s=h}r=a},200)()}});i.update(un,l=>l.concat(o)),await i.wait(hh),t.mounted.forEach(l=>l(i))});Jv.meta={package:"@milkdown/plugin-listener",displayName:"Listener"};const A5=[["","ss"],["","Ss"],["","ae"],["","Ae"],["","oe"],["","Oe"],["","ue"],["","Ue"],["","A"],["","A"],["","A"],["","A"],["","Ae"],["","A"],["","AE"],["","C"],["","E"],["","E"],["","E"],["","E"],["","I"],["","I"],["","I"],["","I"],["","D"],["","N"],["","O"],["","O"],["","O"],["","O"],["","Oe"],["","O"],["","O"],["","U"],["","U"],["","U"],["","Ue"],["","U"],["","Y"],["","TH"],["","ss"],["","a"],["","a"],["","a"],["","a"],["","ae"],["","a"],["","ae"],["","c"],["","e"],["","e"],["","e"],["","e"],["","i"],["","i"],["","i"],["","i"],["","d"],["","n"],["","o"],["","o"],["","o"],["","o"],["","oe"],["","o"],["","o"],["","u"],["","u"],["","u"],["","ue"],["","u"],["","y"],["","th"],["","y"],["","SS"],["","a"],["","A"],["","a"],["","A"],["","a"],["","A"],["","a"],["","A"],["","e"],["","E"],["","e"],["","E"],["","e"],["","E"],["","i"],["","I"],["","i"],["","I"],["","o"],["","O"],["","o"],["","O"],["","o"],["","O"],["","o"],["","O"],["","u"],["","U"],["","u"],["","U"],["","y"],["","Y"],["","a"],["","A"],["","D"],["","d"],["","i"],["","I"],["","u"],["","U"],["","o"],["","O"],["","u"],["","U"],["","a"],["","A"],["","a"],["","A"],["","a"],["","A"],["","a"],["","A"],["","a"],["","A"],["","a"],["","A"],["","a"],["","A"],["","a"],["","A"],["","a"],["","A"],["","a"],["","A"],["","a"],["","A"],["","a"],["","A"],["","e"],["","E"],["","e"],["","E"],["","e"],["","E"],["","e"],["","E"],["","e"],["","E"],["","e"],["","E"],["","e"],["","E"],["","e"],["","E"],["","i"],["","I"],["","i"],["","I"],["","o"],["","O"],["","o"],["","O"],["","o"],["","O"],["","o"],["","O"],["","o"],["","O"],["","o"],["","O"],["","o"],["","O"],["","o"],["","O"],["","o"],["","O"],["","o"],["","O"],["","o"],["","O"],["","o"],["","O"],["","u"],["","U"],["","u"],["","U"],["","u"],["","U"],["","u"],["","U"],["","u"],["","U"],["","u"],["","U"],["","u"],["","U"],["","y"],["","Y"],["","y"],["","Y"],["","y"],["","Y"],["","y"],["","Y"],["","e"],["","a"],["","a"],["","w"],["","i"],["","y"],["","a"],["","b"],["","t"],["","t"],["","th"],["","j"],["","h"],["","kh"],["","d"],["","dh"],["","r"],["","z"],["","s"],["","sh"],["","s"],["","d"],["","t"],["","z"],["","e"],["","gh"],["","_"],["","f"],["","q"],["","k"],["","l"],["","m"],["","n"],["","h"],["","w"],["","a"],["","y"],["","a"],["","u"],["","i"],["","0"],["","1"],["","2"],["","3"],["","4"],["","5"],["","6"],["","7"],["","8"],["","9"],["","ch"],["","k"],["","g"],["","p"],["","zh"],["","y"],["","0"],["","1"],["","2"],["","3"],["","4"],["","5"],["","6"],["","7"],["","8"],["","9"],["","p"],["","z"],["","c"],["","d"],["","d"],["","r"],["","r"],["","z"],["","g"],["","x"],["","g"],["","n"],["","e"],["","e"],["","ai"],["","t"],["","d"],["","r"],["","n"],["","h"],["","h"],["","e"],["","A"],["","a"],["","B"],["","b"],["","V"],["","v"],["","G"],["","g"],["","D"],["","d"],["","ye"],["","Ye"],["","yE"],["","YE"],["","E"],["","e"],["","Yo"],["","yo"],["","Zh"],["","zh"],["","Z"],["","z"],["","I"],["","i"],["","iy"],["","Iy"],["","IY"],["","iY"],["","Y"],["","y"],["","K"],["","k"],["","L"],["","l"],["","M"],["","m"],["","N"],["","n"],["","O"],["","o"],["","P"],["","p"],["","R"],["","r"],["","S"],["","s"],["","T"],["","t"],["","U"],["","u"],["","F"],["","f"],["","Kh"],["","kh"],["","Ts"],["","ts"],["","Ch"],["","ch"],["","Sh"],["","sh"],["","Sch"],["","sch"],["",""],["",""],["","Y"],["","y"],["",""],["",""],["","E"],["","e"],["","Yu"],["","yu"],["","Ya"],["","ya"],["","a"],["","A"],["","s"],["","S"],["","t"],["","T"],["","t"],["","T"],["","s"],["","S"],["","c"],["","C"],["","g"],["","G"],["","i"],["","I"],["","a"],["","A"],["","b"],["","B"],["","g"],["","G"],["","d"],["","D"],["","ye"],["","Ye"],["","z"],["","Z"],["","e"],["","E"],["","y"],["","Y"],["","t"],["","T"],["","zh"],["","Zh"],["","i"],["","I"],["","l"],["","L"],["","kh"],["","Kh"],["","ts"],["","Ts"],["","k"],["","K"],["","h"],["","H"],["","dz"],["","Dz"],["","gh"],["","Gh"],["","tch"],["","Tch"],["","m"],["","M"],["","y"],["","Y"],["","n"],["","N"],["","sh"],["","Sh"],["","vo"],["","Vo"],["","ch"],["","Ch"],["","p"],["","P"],["","j"],["","J"],["","r"],["","R"],["","s"],["","S"],["","v"],["","V"],["","t"],["","T"],["","r"],["","R"],["","c"],["","C"],["","u"],["","U"],["","U"],["","p"],["","P"],["","q"],["","Q"],["","o"],["","O"],["","f"],["","F"],["","yev"],["","a"],["","b"],["","g"],["","d"],["","e"],["","v"],["","z"],["","t"],["","i"],["","k"],["","l"],["","m"],["","n"],["","o"],["","p"],["","zh"],["","r"],["","s"],["","t"],["","u"],["","ph"],["","q"],["","gh"],["","k"],["","sh"],["","ch"],["","ts"],["","dz"],["","ts"],["","tch"],["","kh"],["","j"],["","h"],["","c"],["","d"],["","e"],["","n"],["","r"],["","s"],["","t"],["","u"],["","z"],["","C"],["","D"],["","E"],["","N"],["","R"],["","S"],["","T"],["","U"],["","Z"],["","h"],["","sh"],["","n"],["","r"],["","b"],["","lh"],["","k"],["","a"],["","v"],["","m"],["","f"],["","dh"],["","th"],["","l"],["","g"],["","gn"],["","s"],["","d"],["","z"],["","t"],["","y"],["","p"],["","j"],["","ch"],["","tt"],["","hh"],["","kh"],["","th"],["","z"],["","sh"],["","s"],["","d"],["","t"],["","z"],["","a"],["","gh"],["","q"],["","w"],["","a"],["","aa"],["","i"],["","ee"],["","u"],["","oo"],["","e"],["","ey"],["","o"],["","oa"],["",""],["","a"],["","v"],["","g"],["","d"],["","e"],["","z"],["","i"],["","th"],["","i"],["","k"],["","l"],["","m"],["","n"],["","ks"],["","o"],["","p"],["","r"],["","s"],["","t"],["","y"],["","f"],["","x"],["","ps"],["","o"],["","a"],["","e"],["","i"],["","o"],["","y"],["","i"],["","o"],["","s"],["","i"],["","y"],["","y"],["","i"],["","A"],["","B"],["","G"],["","D"],["","E"],["","Z"],["","I"],["","TH"],["","I"],["","K"],["","L"],["","M"],["","N"],["","KS"],["","O"],["","P"],["","R"],["","S"],["","T"],["","Y"],["","F"],["","X"],["","PS"],["","O"],["","A"],["","E"],["","I"],["","O"],["","Y"],["","I"],["","O"],["","I"],["","Y"],["","a"],["","e"],["","g"],["","i"],["","k"],["","l"],["","n"],["","u"],["","A"],["","E"],["","G"],["","I"],["","K"],["","L"],["","N"],["","U"],["","c"],["","s"],["","z"],["","C"],["","S"],["","Z"],["","a"],["","c"],["","e"],["","e"],["","i"],["","s"],["","u"],["","u"],["","z"],["","A"],["","C"],["","E"],["","E"],["","I"],["","S"],["","U"],["","U"],["","Kj"],["","kj"],["","Lj"],["","lj"],["","Nj"],["","nj"],["","Ts"],["","ts"],["","a"],["","c"],["","e"],["","l"],["","n"],["","s"],["","z"],["","z"],["","A"],["","C"],["","E"],["","L"],["","N"],["","S"],["","Z"],["","Z"],["","Ye"],["","I"],["","Yi"],["","G"],["","ye"],["","i"],["","yi"],["","g"],["","IJ"],["","ij"],["","c"],["","Y"],["","b"],["","t"],["","Bo"],["","B"],["","CE"],["","C"],["","Cr"],["","F"],["","m"],["","N"],["","Pt"],["","Rs"],["","W"],["","s"],["","E"],["","K"],["","T"],["","Dp"],["","S"],["","P"],["","G"],["","A"],["","S"],["","C"],["","tt"],["","S"],["","T"],["","R"],["","L"],["","P"],["","B"],["","$"],["","c"],["","Y"],["","W"],["","A"],["","B"],["","C"],["","D"],["","E"],["","F"],["","G"],["","H"],["","I"],["","J"],["","K"],["","L"],["","M"],["","N"],["","O"],["","P"],["","Q"],["","R"],["","S"],["","T"],["","U"],["","V"],["","W"],["","X"],["","Y"],["","Z"],["","a"],["","b"],["","c"],["","d"],["","e"],["","f"],["","g"],["","h"],["","i"],["","j"],["","k"],["","l"],["","m"],["","n"],["","o"],["","p"],["","q"],["","r"],["","s"],["","t"],["","u"],["","v"],["","w"],["","x"],["","y"],["","z"],["","A"],["","B"],["","C"],["","D"],["","E"],["","F"],["","G"],["","H"],["","I"],["","J"],["","K"],["","L"],["","M"],["","N"],["","O"],["","P"],["","Q"],["","R"],["","S"],["","T"],["","U"],["","V"],["","W"],["","X"],["","Y"],["","Z"],["","a"],["","b"],["","c"],["","d"],["","e"],["","f"],["","g"],["","i"],["","j"],["","k"],["","l"],["","m"],["","n"],["","o"],["","p"],["","q"],["","r"],["","s"],["","t"],["","u"],["","v"],["","w"],["","x"],["","y"],["","z"],["","A"],["","B"],["","C"],["","D"],["","E"],["","F"],["","G"],["","H"],["","I"],["","J"],["","K"],["","L"],["","M"],["","N"],["","O"],["","P"],["","Q"],["","R"],["","S"],["","T"],["","U"],["","V"],["","W"],["","X"],["","Y"],["","Z"],["","a"],["","b"],["","c"],["","d"],["","e"],["","f"],["","g"],["","h"],["","i"],["","j"],["","k"],["","l"],["","m"],["","n"],["","o"],["","p"],["","q"],["","r"],["","s"],["","t"],["","u"],["","v"],["","w"],["","x"],["","y"],["","z"],["","A"],["","C"],["","D"],["","g"],["","J"],["","K"],["","N"],["","O"],["","P"],["","Q"],["","S"],["","T"],["","U"],["","V"],["","W"],["","X"],["","Y"],["","Z"],["","a"],["","b"],["","c"],["","d"],["","f"],["","h"],["","i"],["","j"],["","h"],["","l"],["","m"],["","n"],["","p"],["","q"],["","r"],["","s"],["","t"],["","u"],["","v"],["","w"],["","x"],["","y"],["","z"],["","A"],["","B"],["","C"],["","D"],["","E"],["","F"],["","G"],["","H"],["","I"],["","J"],["","K"],["","L"],["","M"],["","N"],["","O"],["","P"],["","Q"],["","R"],["","S"],["","T"],["","U"],["","V"],["","W"],["","X"],["","Y"],["","Z"],["","a"],["","b"],["","c"],["","d"],["","e"],["","f"],["","g"],["","h"],["","i"],["","j"],["","k"],["","l"],["","m"],["","n"],["","o"],["","p"],["","q"],["","r"],["","s"],["","t"],["","u"],["","v"],["","w"],["","x"],["","y"],["","z"],["","A"],["","B"],["","D"],["","E"],["","F"],["","G"],["","J"],["","K"],["","L"],["","M"],["","N"],["","O"],["","P"],["","Q"],["","S"],["","T"],["","U"],["","V"],["","W"],["","X"],["","Y"],["","a"],["","b"],["","c"],["","d"],["","e"],["","f"],["","g"],["","h"],["","i"],["","j"],["","k"],["","l"],["","m"],["","n"],["","o"],["","p"],["","q"],["","r"],["","s"],["","t"],["","u"],["","v"],["","w"],["","x"],["","y"],["","z"],["","A"],["","B"],["","D"],["","E"],["","F"],["","G"],["","I"],["","J"],["","K"],["","L"],["","M"],["","N"],["","S"],["","T"],["","U"],["","V"],["","W"],["","X"],["","Y"],["","a"],["","b"],["","c"],["","d"],["","e"],["","f"],["","g"],["","h"],["","i"],["","j"],["","k"],["","l"],["","m"],["","n"],["","o"],["","p"],["","q"],["","r"],["","s"],["","t"],["","u"],["","v"],["","w"],["","x"],["","y"],["","z"],["","A"],["","B"],["","C"],["","D"],["","E"],["","F"],["","G"],["","H"],["","I"],["","J"],["","K"],["","L"],["","M"],["","N"],["","O"],["","P"],["","Q"],["","R"],["","S"],["","T"],["","U"],["","V"],["","W"],["","X"],["","Y"],["","Z"],["","a"],["","b"],["","c"],["","d"],["","e"],["","f"],["","g"],["","h"],["","i"],["","j"],["","k"],["","l"],["","m"],["","n"],["","o"],["","p"],["","q"],["","r"],["","s"],["","t"],["","u"],["","v"],["","w"],["","x"],["","y"],["","z"],["","A"],["","B"],["","C"],["","D"],["","E"],["","F"],["","G"],["","H"],["","I"],["","J"],["","K"],["","L"],["","M"],["","N"],["","O"],["","P"],["","Q"],["","R"],["","S"],["","T"],["","U"],["","V"],["","W"],["","X"],["","Y"],["","Z"],["","a"],["","b"],["","c"],["","d"],["","e"],["","f"],["","g"],["","h"],["","i"],["","j"],["","k"],["","l"],["","m"],["","n"],["","o"],["","p"],["","q"],["","r"],["","s"],["","t"],["","u"],["","v"],["","w"],["","x"],["","y"],["","z"],["","A"],["","B"],["","C"],["","D"],["","E"],["","F"],["","G"],["","H"],["","I"],["","J"],["","K"],["","L"],["","M"],["","N"],["","O"],["","P"],["","Q"],["","R"],["","S"],["","T"],["","U"],["","V"],["","W"],["","X"],["","Y"],["","Z"],["","a"],["","b"],["","c"],["","d"],["","e"],["","f"],["","g"],["","h"],["","i"],["","j"],["","k"],["","l"],["","m"],["","n"],["","o"],["","p"],["","q"],["","r"],["","s"],["","t"],["","u"],["","v"],["","w"],["","x"],["","y"],["","z"],["","A"],["","B"],["","C"],["","D"],["","E"],["","F"],["","G"],["","H"],["","I"],["","J"],["","K"],["","L"],["","M"],["","N"],["","O"],["","P"],["","Q"],["","R"],["","S"],["","T"],["","U"],["","V"],["","W"],["","X"],["","Y"],["","Z"],["","a"],["","b"],["","c"],["","d"],["","e"],["","f"],["","g"],["","h"],["","i"],["","j"],["","k"],["","l"],["","m"],["","n"],["","o"],["","p"],["","q"],["","r"],["","s"],["","t"],["","u"],["","v"],["","w"],["","x"],["","y"],["","z"],["","A"],["","B"],["","C"],["","D"],["","E"],["","F"],["","G"],["","H"],["","I"],["","J"],["","K"],["","L"],["","M"],["","N"],["","O"],["","P"],["","Q"],["","R"],["","S"],["","T"],["","U"],["","V"],["","W"],["","X"],["","Y"],["","Z"],["","a"],["","b"],["","c"],["","d"],["","e"],["","f"],["","g"],["","h"],["","i"],["","j"],["","k"],["","l"],["","m"],["","n"],["","o"],["","p"],["","q"],["","r"],["","s"],["","t"],["","u"],["","v"],["","w"],["","x"],["","y"],["","z"],["","A"],["","B"],["","C"],["","D"],["","E"],["","F"],["","G"],["","H"],["","I"],["","J"],["","K"],["","L"],["","M"],["","N"],["","O"],["","P"],["","Q"],["","R"],["","S"],["","T"],["","U"],["","V"],["","W"],["","X"],["","Y"],["","Z"],["","a"],["","b"],["","c"],["","d"],["","e"],["","f"],["","g"],["","h"],["","i"],["","j"],["","k"],["","l"],["","m"],["","n"],["","o"],["","p"],["","q"],["","r"],["","s"],["","t"],["","u"],["","v"],["","w"],["","x"],["","y"],["","z"],["","l"],["","j"],["","A"],["","B"],["","G"],["","D"],["","E"],["","Z"],["","I"],["","TH"],["","I"],["","K"],["","L"],["","M"],["","N"],["","KS"],["","O"],["","P"],["","R"],["","TH"],["","S"],["","T"],["","Y"],["","F"],["","x"],["","PS"],["","O"],["","D"],["","a"],["","b"],["","g"],["","d"],["","e"],["","z"],["","i"],["","th"],["","i"],["","k"],["","l"],["","m"],["","n"],["","ks"],["","o"],["","p"],["","r"],["","s"],["","s"],["","t"],["","y"],["","f"],["","x"],["","ps"],["","o"],["","d"],["","E"],["","TH"],["","K"],["","f"],["","r"],["","p"],["","A"],["","V"],["","G"],["","D"],["","E"],["","Z"],["","I"],["","TH"],["","I"],["","K"],["","L"],["","M"],["","N"],["","KS"],["","O"],["","P"],["","S"],["","TH"],["","S"],["","T"],["","Y"],["","F"],["","X"],["","PS"],["","O"],["","D"],["","a"],["","v"],["","g"],["","d"],["","e"],["","z"],["","i"],["","th"],["","i"],["","k"],["","l"],["","m"],["","n"],["","ks"],["","o"],["","p"],["","r"],["","s"],["","s"],["","t"],["","y"],["","f"],["","x"],["","ps"],["","o"],["","a"],["","e"],["","i"],["","k"],["","f"],["","r"],["","p"],["","A"],["","B"],["","G"],["","D"],["","E"],["","Z"],["","I"],["","TH"],["","I"],["","K"],["","L"],["","M"],["","N"],["","KS"],["","O"],["","P"],["","R"],["","TH"],["","S"],["","T"],["","Y"],["","F"],["","X"],["","PS"],["","O"],["","D"],["","a"],["","v"],["","g"],["","d"],["","e"],["","z"],["","i"],["","th"],["","i"],["","k"],["","l"],["","m"],["","n"],["","ks"],["","o"],["","p"],["","r"],["","s"],["","s"],["","t"],["","y"],["","f"],["","x"],["","ps"],["","o"],["","a"],["","e"],["","i"],["","k"],["","f"],["","r"],["","p"],["","A"],["","V"],["","G"],["","D"],["","E"],["","Z"],["","I"],["","TH"],["","I"],["","K"],["","L"],["","M"],["","N"],["","KS"],["","O"],["","P"],["","S"],["","TH"],["","S"],["","T"],["","Y"],["","F"],["","X"],["","PS"],["","O"],["","D"],["","av"],["","g"],["","d"],["","e"],["","z"],["","i"],["","i"],["","th"],["","i"],["","k"],["","l"],["","m"],["","n"],["","ks"],["","o"],["","p"],["","r"],["","s"],["","s"],["","t"],["","y"],["","f"],["","x"],["","ps"],["","o"],["","a"],["","e"],["","i"],["","k"],["","f"],["","r"],["","p"],["","F"],["","f"],["","(a)"],["","(b)"],["","(c)"],["","(d)"],["","(e)"],["","(f)"],["","(g)"],["","(h)"],["","(i)"],["","(j)"],["","(k)"],["","(l)"],["","(m)"],["","(n)"],["","(o)"],["","(p)"],["","(q)"],["","(r)"],["","(s)"],["","(t)"],["","(u)"],["","(v)"],["","(w)"],["","(x)"],["","(y)"],["","(z)"],["","(A)"],["","(B)"],["","(C)"],["","(D)"],["","(E)"],["","(F)"],["","(G)"],["","(H)"],["","(I)"],["","(J)"],["","(K)"],["","(L)"],["","(N)"],["","(O)"],["","(P)"],["","(Q)"],["","(R)"],["","(S)"],["","(T)"],["","(U)"],["","(V)"],["","(W)"],["","(X)"],["","(Y)"],["","(Z)"],["","(a)"],["","(b)"],["","(b)"],["","(c)"],["","(e)"],["","(f)"],["","(g)"],["","(h)"],["","(i)"],["","(j)"],["","(k)"],["","(l)"],["","(m)"],["","(n)"],["","(o)"],["","(p)"],["","(q)"],["","(r)"],["","(s)"],["","(t)"],["","(u)"],["","(v)"],["","(w)"],["","(x)"],["","(y)"],["","(z)"],["","C"],["","c"],["","G"],["","g"],["","H"],["","h"],["","Z"],["","z"],["","0"],["","1"],["","2"],["","3"],["","4"],["","5"],["","6"],["","7"],["","8"],["","9"],["","0"],["","1"],["","2"],["","3"],["","4"],["","5"],["","6"],["","7"],["","8"],["","9"],["","0"],["","1"],["","2"],["","3"],["","4"],["","5"],["","6"],["","7"],["","8"],["","9"],["","0"],["","1"],["","2"],["","3"],["","4"],["","5"],["","6"],["","7"],["","8"],["","9"],["","0"],["","1"],["","2"],["","3"],["","4"],["","5"],["","6"],["","7"],["","8"],["","9"],["","1"],["","2"],["","3"],["","4"],["","5"],["","6"],["","7"],["","8"],["","9"],["","10"],["","11"],["","12"],["","13"],["","14"],["","15"],["","16"],["","17"],["","18"],["","19"],["","20"],["","1"],["","2"],["","3"],["","4"],["","5"],["","6"],["","7"],["","8"],["","9"],["","10"],["","11"],["","12"],["","13"],["","14"],["","15"],["","16"],["","17"],["","18"],["","19"],["","20"],["","1."],["","2."],["","3."],["","4."],["","5."],["","6."],["","7."],["","8."],["","9."],["","10."],["","11."],["","12."],["","13."],["","14."],["","15."],["","16."],["","17."],["","18."],["","19."],["","20."],["","0"],["","11"],["","12"],["","13"],["","14"],["","15"],["","16"],["","17"],["","18"],["","19"],["","20"],["","1"],["","2"],["","3"],["","4"],["","5"],["","6"],["","7"],["","8"],["","9"],["","10"],["","0"],["","&"],["","&"],["","&"],["","&"],["","&"],["","&"],["",'"'],["",'"'],["",'"'],["","?!"],["","?!"],["","?!"],["","?!"],["","/"],["","\\"],["","AR"],["","V"],["","V"],["","VR"],["","VF"],["","2"],["","5"],["","f"],["","W"],["","U"],["","V"],["","T"],["","V"],["","MB"],["","VB"],["","3B"],["","3B"],["","100"],["","BACK"],["","END"],["","ON!"],["","SOON"],["","TOP"],["","18"],["","abc"],["","ABCD"],["","abcd"],["","1234"],["","T&@%"],["#","#"],["*","*"],["0","0"],["1","1"],["2","2"],["3","3"],["4","4"],["5","5"],["6","6"],["7","7"],["8","8"],["9","9"],["","10"],["","A"],["","B"],["","AB"],["","CL"],["","O"],["","P"],["","SOS"],["","C"],["","D"],["","E"],["","F"],["","G"],["","H"],["","I"],["","J"],["","K"],["","L"],["","M"],["","N"],["","Q"],["","R"],["","S"],["","T"],["","U"],["","V"],["","W"],["","X"],["","Y"],["","Z"]],Z5=(i,e)=>{for(const[t,n]of e)i=i.replace(new RegExp(fp(t),"g"),n);return i};function R5(i,e){if(typeof i!="string")throw new TypeError(`Expected a string, got \`${typeof i}\``);e={customReplacements:[],...e};const t=new Map([...A5,...e.customReplacements]);return i=i.normalize(),i=Z5(i,t),i=i.normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").normalize(),i}const E5=[["&"," and "],[""," unicorn "],[""," love "]],N5=i=>i.replace(/([A-Z]{2,})(\d+)/g,"$1 $2").replace(/([a-z\d]+)([A-Z]{2,})/g,"$1 $2").replace(/([a-z\d])([A-Z])/g,"$1 $2").replace(/([A-Z]+)([A-Z][a-rt-z\d]+)/g,"$1 $2"),D5=(i,e)=>{const t=fp(e);return i.replace(new RegExp(`${t}{2,}`,"g"),e).replace(new RegExp(`^${t}|${t}$`,"g"),"")},I5=i=>{let e="a-z\\d";if(e+=i.lowercase?"":"A-Z",i.preserveCharacters.length>0)for(const t of i.preserveCharacters){if(t===i.separator)throw new Error(`The separator character \`${i.separator}\` cannot be included in preserved characters: ${i.preserveCharacters}`);e+=fp(t)}return new RegExp(`[^${e}]+`,"g")};function W5(i,e){if(typeof i!="string")throw new TypeError(`Expected a string, got \`${typeof i}\``);e={separator:"-",lowercase:!0,decamelize:!0,customReplacements:[],preserveLeadingUnderscore:!1,preserveTrailingDash:!1,preserveCharacters:[],...e};const t=e.preserveLeadingUnderscore&&i.startsWith("_"),n=e.preserveTrailingDash&&i.endsWith("-"),r=new Map([...E5,...e.customReplacements]);i=R5(i,{customReplacements:r}),e.decamelize&&(i=N5(i));const s=I5(e);return e.lowercase&&(i=i.toLowerCase()),i=i.replace(/([a-zA-Z\d]+)'([ts])(\s|$)/g,"$1$2$3"),i=i.replace(s,e.separator),i=i.replace(/\\/g,""),e.separator&&(i=D5(i,e.separator)),t&&(i=`_${i}`),n&&(i=`${i}-`),i}function X5(i,e){return function(t,n){let{$from:r,$to:s,node:o}=t.selection;if(o&&o.isBlock||r.depth<2||!r.sameParent(s))return!1;let l=r.node(-1);if(l.type!=i)return!1;if(r.parent.content.size==0&&r.node(-1).childCount==r.indexAfter(-1)){if(r.depth==3||r.node(-3).type!=i||r.index(-2)!=r.node(-2).childCount-1)return!1;if(n){let f=P.empty,u=r.index(-1)?1:r.index(-2)?2:3;for(let y=r.depth-u;y>=r.depth-3;y--)f=P.from(r.node(y).copy(f));let d=r.indexAfter(-1)<r.node(-2).childCount?1:r.indexAfter(-2)<r.node(-3).childCount?2:3;f=f.append(P.from(i.createAndFill()));let p=r.before(r.depth-(u-1)),m=t.tr.replace(p,r.after(-d),new Z(f,4-u,0)),g=-1;m.doc.nodesBetween(p,m.doc.content.size,(y,k)=>{if(g>-1)return!1;y.isTextblock&&y.content.size==0&&(g=k+1)}),g>-1&&m.setSelection(_.near(m.doc.resolve(g))),n(m.scrollIntoView())}return!0}let a=s.pos==r.end()?l.contentMatchAt(0).defaultType:null,h=t.tr.delete(r.pos,s.pos),c=a?[e?{type:i,attrs:e}:null,{type:a}]:void 0;return Go(h.doc,r.pos,2,c)?(n&&n(h.split(r.pos,2,c).scrollIntoView()),!0):!1}}function e$(i){return function(e,t){let{$from:n,$to:r}=e.selection,s=n.blockRange(r,o=>o.childCount>0&&o.firstChild.type==i);return s?t?n.node(s.depth-1).type==i?B5(e,t,i,s):V5(e,t,s):!0:!1}}function B5(i,e,t,n){let r=i.tr,s=n.end,o=n.$to.end(n.depth);s<o&&(r.step(new He(s-1,o,s,o,new Z(P.from(t.create(null,n.parent.copy())),1,0),1,!0)),n=new D1(r.doc.resolve(n.$from.pos),r.doc.resolve(o),n.depth));const l=vc(n);if(l==null)return!1;r.lift(n,l);let a=r.mapping.map(s,-1)-1;return $c(r.doc,a)&&r.join(a),e(r.scrollIntoView()),!0}function V5(i,e,t){let n=i.tr,r=t.parent;for(let d=t.end,p=t.endIndex-1,m=t.startIndex;p>m;p--)d-=r.child(p).nodeSize,n.delete(d-1,d+1);let s=n.doc.resolve(t.start),o=s.nodeAfter;if(n.mapping.map(t.end)!=t.start+s.nodeAfter.nodeSize)return!1;let l=t.startIndex==0,a=t.endIndex==r.childCount,h=s.node(-1),c=s.index(-1);if(!h.canReplace(c+(l?0:1),c+1,o.content.append(a?P.empty:P.from(r))))return!1;let f=s.pos,u=f+o.nodeSize;return n.step(new He(f-(l?1:0),u+(a?1:0),f+1,u-1,new Z((l?P.empty:P.from(r.copy(P.empty))).append(a?P.empty:P.from(r.copy(P.empty))),l?0:1,a?0:1),l?0:1)),e(n.scrollIntoView()),!0}function q5(i){return function(e,t){let{$from:n,$to:r}=e.selection,s=n.blockRange(r,h=>h.childCount>0&&h.firstChild.type==i);if(!s)return!1;let o=s.startIndex;if(o==0)return!1;let l=s.parent,a=l.child(o-1);if(a.type!=i)return!1;if(t){let h=a.lastChild&&a.lastChild.type==l.type,c=P.from(h?i.create():null),f=new Z(P.from(i.create(null,P.from(l.type.create(null,c)))),h?3:1,0),u=s.start,d=s.end;t(e.tr.step(new He(u-(h?3:1),d,u,d,f,1,!0)).scrollIntoView())}return!0}}function L5(i){const e=new Map;if(!i||!i.type)throw new Error("mdast-util-definitions expected node");return Lr(i,"definition",function(n){const r=u1(n.identifier);r&&!e.get(r)&&e.set(r,n)}),t;function t(n){const r=u1(n);return e.get(r)}}function u1(i){return String(i||"").toUpperCase()}function z5(){return function(i){const e=L5(i);Lr(i,function(t,n,r){if(t.type==="definition"&&r!==void 0&&typeof n=="number")return r.children.splice(n,1),[vg,n];if(t.type==="imageReference"||t.type==="linkReference"){const s=e(t.identifier);if(s&&r&&typeof n=="number")return r.children[n]=t.type==="imageReference"?{type:"image",url:s.url,title:s.title,alt:t.alt}:{type:"link",url:s.url,title:s.title,children:t.children},[vg,n]}})}}function t$(i,e){var t;if(!(e.childCount>=1&&((t=e.lastChild)==null?void 0:t.type.name)==="hardbreak")){i.next(e.content);return}const n=[];e.content.forEach((r,s,o)=>{o!==e.childCount-1&&n.push(r)}),i.next(P.fromArray(n))}function w(i,e){return Object.assign(i,{meta:{package:"@milkdown/preset-commonmark",...e}}),i}const Tm=Rc("emphasis");w(Tm,{displayName:"Attr<emphasis>",group:"Emphasis"});const ro=Zc("emphasis",i=>({attrs:{marker:{default:i.get(Jo).emphasis||"*"}},parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style",getAttrs:e=>e==="italic"}],toDOM:e=>["em",i.get(Tm.key)(e)],parseMarkdown:{match:e=>e.type==="emphasis",runner:(e,t,n)=>{e.openMark(n,{marker:t.marker}),e.next(t.children),e.closeMark(n)}},toMarkdown:{match:e=>e.type.name==="emphasis",runner:(e,t)=>{e.withMark(t,"emphasis",void 0,{marker:t.attrs.marker})}}}));w(ro.mark,{displayName:"MarkSchema<emphasis>",group:"Emphasis"});w(ro.ctx,{displayName:"MarkSchemaCtx<emphasis>",group:"Emphasis"});const Jc=ue("ToggleEmphasis",i=>()=>Cp(ro.type(i)));w(Jc,{displayName:"Command<toggleEmphasisCommand>",group:"Emphasis"});const n$=pt(i=>Mc(/(?:^|[^*])\*([^*]+)\*$/,ro.type(i),{getAttr:()=>({marker:"*"}),updateCaptured:({fullMatch:e,start:t})=>e.startsWith("*")?{}:{fullMatch:e.slice(1),start:t+1}}));w(n$,{displayName:"InputRule<emphasis>|Star",group:"Emphasis"});const i$=pt(i=>Mc(/(?:^|[^_])_([^_]+)_$/,ro.type(i),{getAttr:()=>({marker:"_"}),updateCaptured:({fullMatch:e,start:t})=>e.startsWith("_")?{}:{fullMatch:e.slice(1),start:t+1}}));w(i$,{displayName:"InputRule<emphasis>|Underscore",group:"Emphasis"});const Mm=Kt("emphasisKeymap",{ToggleEmphasis:{shortcuts:"Mod-i",command:i=>{const e=i.get(re);return()=>e.call(Jc.key)}}});w(Mm.ctx,{displayName:"KeymapCtx<emphasis>",group:"Emphasis"});w(Mm.shortcuts,{displayName:"Keymap<emphasis>",group:"Emphasis"});const Am=Rc("strong");w(Am,{displayName:"Attr<strong>",group:"Strong"});const sa=Zc("strong",i=>({attrs:{marker:{default:i.get(Jo).strong||"*"}},parseDOM:[{tag:"b"},{tag:"strong"},{style:"font-style",getAttrs:e=>e==="bold"}],toDOM:e=>["strong",i.get(Am.key)(e)],parseMarkdown:{match:e=>e.type==="strong",runner:(e,t,n)=>{e.openMark(n,{marker:t.marker}),e.next(t.children),e.closeMark(n)}},toMarkdown:{match:e=>e.type.name==="strong",runner:(e,t)=>{e.withMark(t,"strong",void 0,{marker:t.attrs.marker})}}}));w(sa.mark,{displayName:"MarkSchema<strong>",group:"Strong"});w(sa.ctx,{displayName:"MarkSchemaCtx<strong>",group:"Strong"});const ef=ue("ToggleStrong",i=>()=>Cp(sa.type(i)));w(ef,{displayName:"Command<toggleStrongCommand>",group:"Strong"});const r$=pt(i=>Mc(/(?:\*\*|__)([^*_]+)(?:\*\*|__)$/,sa.type(i),{getAttr:e=>({marker:e[0].startsWith("*")?"*":"_"})}));w(r$,{displayName:"InputRule<strong>",group:"Strong"});const Zm=Kt("strongKeymap",{ToggleBold:{shortcuts:["Mod-b"],command:i=>{const e=i.get(re);return()=>e.call(ef.key)}}});w(Zm.ctx,{displayName:"KeymapCtx<strong>",group:"Strong"});w(Zm.shortcuts,{displayName:"Keymap<strong>",group:"Strong"});const Rm=Rc("inlineCode");w(Rm,{displayName:"Attr<inlineCode>",group:"InlineCode"});const Ii=Zc("inlineCode",i=>({priority:100,code:!0,inclusive:!1,parseDOM:[{tag:"code"}],toDOM:e=>["code",i.get(Rm.key)(e)],parseMarkdown:{match:e=>e.type==="inlineCode",runner:(e,t,n)=>{e.openMark(n),e.addText(t.value),e.closeMark(n)}},toMarkdown:{match:e=>e.type.name==="inlineCode",runner:(e,t,n)=>{e.withMark(t,"inlineCode",n.text||"")}}}));w(Ii.mark,{displayName:"MarkSchema<inlineCode>",group:"InlineCode"});w(Ii.ctx,{displayName:"MarkSchemaCtx<inlineCode>",group:"InlineCode"});const tf=ue("ToggleInlineCode",i=>()=>(e,t)=>{const{selection:n,tr:r}=e;if(n.empty)return!1;const{from:s,to:o}=n;return e.doc.rangeHasMark(s,o,Ii.type(i))?(t==null||t(r.removeMark(s,o,Ii.type(i))),!0):(Object.keys(e.schema.marks).filter(l=>l!==Ii.type.name).map(l=>e.schema.marks[l]).forEach(l=>{r.removeMark(s,o,l)}),t==null||t(r.addMark(s,o,Ii.type(i).create())),!0)});w(tf,{displayName:"Command<toggleInlineCodeCommand>",group:"InlineCode"});const s$=pt(i=>Mc(/(?:\`)([^\`]+)(?:\`)$/,Ii.type(i)));w(s$,{displayName:"InputRule<inlineCodeInputRule>",group:"InlineCode"});const Em=Kt("inlineCodeKeymap",{ToggleInlineCode:{shortcuts:"Mod-e",command:i=>{const e=i.get(re);return()=>e.call(tf.key)}}});w(Em.ctx,{displayName:"KeymapCtx<inlineCode>",group:"InlineCode"});w(Em.shortcuts,{displayName:"Keymap<inlineCode>",group:"InlineCode"});const Nm=Rc("link");w(Nm,{displayName:"Attr<link>",group:"Link"});const Ts=Zc("link",i=>({attrs:{href:{},title:{default:null}},parseDOM:[{tag:"a[href]",getAttrs:e=>{if(!(e instanceof HTMLElement))throw zr(e);return{href:e.getAttribute("href"),title:e.getAttribute("title")}}}],toDOM:e=>["a",{...i.get(Nm.key)(e),...e.attrs}],parseMarkdown:{match:e=>e.type==="link",runner:(e,t,n)=>{const r=t.url,s=t.title;e.openMark(n,{href:r,title:s}),e.next(t.children),e.closeMark(n)}},toMarkdown:{match:e=>e.type.name==="link",runner:(e,t)=>{e.withMark(t,"link",void 0,{title:t.attrs.title,url:t.attrs.href})}}}));w(Ts.mark,{displayName:"MarkSchema<link>",group:"Link"});const bc=ue("ToggleLink",i=>(e={})=>Cp(Ts.type(i),e));w(bc,{displayName:"Command<toggleLinkCommand>",group:"Link"});const Dm=ue("UpdateLink",i=>(e={})=>(t,n)=>{if(!n)return!1;let r,s=-1;const{selection:o}=t,{from:l,to:a}=o;if(t.doc.nodesBetween(l,l===a?a+1:a,(p,m)=>{if(Ts.type(i).isInSet(p.marks))return r=p,s=m,!1}),!r)return!1;const h=r.marks.find(({type:p})=>p===Ts.type(i));if(!h)return!1;const c=s,f=s+r.nodeSize,{tr:u}=t,d=Ts.type(i).create({...h.attrs,...e});return d?(n(u.removeMark(c,f,h).addMark(c,f,d).setSelection(new J(u.selection.$anchor)).scrollIntoView()),!0):!1});w(Dm,{displayName:"Command<updateLinkCommand>",group:"Link"});const o$=Tp("doc",()=>({content:"block+",parseMarkdown:{match:({type:i})=>i==="root",runner:(i,e,t)=>{i.injectRoot(e,t)}},toMarkdown:{match:i=>i.type.name==="doc",runner:(i,e)=>{i.openNode("root"),i.next(e.content)}}}));w(o$,{displayName:"NodeSchema<doc>",group:"Doc"});const Im=tt("paragraph");w(Im,{displayName:"Attr<paragraph>",group:"Paragraph"});const mi=et("paragraph",i=>({content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM:e=>["p",i.get(Im.key)(e),0],parseMarkdown:{match:e=>e.type==="paragraph",runner:(e,t,n)=>{e.openNode(n),t.children?e.next(t.children):e.addText(t.value||""),e.closeNode()}},toMarkdown:{match:e=>e.type.name==="paragraph",runner:(e,t)=>{e.openNode("paragraph"),t$(e,t),e.closeNode()}}}));w(mi.node,{displayName:"NodeSchema<paragraph>",group:"Paragraph"});w(mi.ctx,{displayName:"NodeSchemaCtx<paragraph>",group:"Paragraph"});const Wm=ue("TurnIntoText",i=>()=>yl(mi.type(i)));w(Wm,{displayName:"Command<turnIntoTextCommand>",group:"Paragraph"});const Xm=Kt("paragraphKeymap",{TurnIntoText:{shortcuts:"Mod-Alt-0",command:i=>{const e=i.get(re);return()=>e.call(Wm.key)}}});w(Xm.ctx,{displayName:"KeymapCtx<paragraph>",group:"Paragraph"});w(Xm.shortcuts,{displayName:"Keymap<paragraph>",group:"Paragraph"});const Y5=Array(6).fill(0).map((i,e)=>e+1);function j5(i){return W5(i.textContent)}const nf=jn(j5,"headingIdGenerator");w(nf,{displayName:"Ctx<HeadingIdGenerator>",group:"Heading"});const Bm=tt("heading");w(Bm,{displayName:"Attr<heading>",group:"Heading"});const nr=et("heading",i=>{const e=i.get(nf.key);return{content:"inline*",group:"block",defining:!0,attrs:{id:{default:""},level:{default:1}},parseDOM:Y5.map(t=>({tag:`h${t}`,getAttrs:n=>{if(!(n instanceof HTMLElement))throw zr(n);return{level:t,id:n.id}}})),toDOM:t=>[`h${t.attrs.level}`,{...i.get(Bm.key)(t),id:t.attrs.id||e(t)},0],parseMarkdown:{match:({type:t})=>t==="heading",runner:(t,n,r)=>{const s=n.depth;t.openNode(r,{level:s}),t.next(n.children),t.closeNode()}},toMarkdown:{match:t=>t.type.name==="heading",runner:(t,n)=>{t.openNode("heading",void 0,{depth:n.attrs.level}),t$(t,n),t.closeNode()}}}});w(nr.node,{displayName:"NodeSchema<heading>",group:"Heading"});w(nr.ctx,{displayName:"NodeSchemaCtx<heading>",group:"Heading"});const l$=pt(i=>Yk(/^(?<hashes>#+)\s$/,nr.type(i),e=>{var t,n;const r=((n=(t=e.groups)==null?void 0:t.hashes)==null?void 0:n.length)||0,s=i.get(Ss),{$from:o}=s.state.selection,l=o.node();if(l.type.name==="heading"){let a=Number(l.attrs.level)+Number(r);return a>6&&(a=6),{level:a}}return{level:r}}));w(l$,{displayName:"InputRule<wrapInHeadingInputRule>",group:"Heading"});const ei=ue("WrapInHeading",i=>e=>(e??(e=1),e<1?yl(mi.type(i)):yl(nr.type(i),{level:e})));w(ei,{displayName:"Command<wrapInHeadingCommand>",group:"Heading"});const Vm=ue("DowngradeHeading",i=>()=>(e,t,n)=>{const{$from:r}=e.selection,s=r.node();if(s.type!==nr.type(i)||!e.selection.empty||r.parentOffset!==0)return!1;const o=s.attrs.level-1;return o?(t==null||t(e.tr.setNodeMarkup(e.selection.$from.before(),void 0,{...s.attrs,level:o})),!0):yl(mi.type(i))(e,t,n)});w(Vm,{displayName:"Command<downgradeHeadingCommand>",group:"Heading"});const qm=Kt("headingKeymap",{TurnIntoH1:{shortcuts:"Mod-Alt-1",command:i=>{const e=i.get(re);return()=>e.call(ei.key,1)}},TurnIntoH2:{shortcuts:"Mod-Alt-2",command:i=>{const e=i.get(re);return()=>e.call(ei.key,2)}},TurnIntoH3:{shortcuts:"Mod-Alt-3",command:i=>{const e=i.get(re);return()=>e.call(ei.key,3)}},TurnIntoH4:{shortcuts:"Mod-Alt-4",command:i=>{const e=i.get(re);return()=>e.call(ei.key,4)}},TurnIntoH5:{shortcuts:"Mod-Alt-5",command:i=>{const e=i.get(re);return()=>e.call(ei.key,5)}},TurnIntoH6:{shortcuts:"Mod-Alt-6",command:i=>{const e=i.get(re);return()=>e.call(ei.key,6)}},DowngradeHeading:{shortcuts:["Delete","Backspace"],command:i=>{const e=i.get(re);return()=>e.call(Vm.key)}}});w(qm.ctx,{displayName:"KeymapCtx<heading>",group:"Heading"});w(qm.shortcuts,{displayName:"Keymap<heading>",group:"Heading"});const Lm=tt("blockquote");w(Lm,{displayName:"Attr<blockquote>",group:"Blockquote"});const oa=et("blockquote",i=>({content:"block+",group:"block",defining:!0,parseDOM:[{tag:"blockquote"}],toDOM:e=>["blockquote",i.get(Lm.key)(e),0],parseMarkdown:{match:({type:e})=>e==="blockquote",runner:(e,t,n)=>{e.openNode(n).next(t.children).closeNode()}},toMarkdown:{match:e=>e.type.name==="blockquote",runner:(e,t)=>{e.openNode("blockquote").next(t.content).closeNode()}}}));w(oa.node,{displayName:"NodeSchema<blockquote>",group:"Blockquote"});w(oa.ctx,{displayName:"NodeSchemaCtx<blockquote>",group:"Blockquote"});const a$=pt(i=>xp(/^\s*>\s$/,oa.type(i)));w(a$,{displayName:"InputRule<wrapInBlockquoteInputRule>",group:"Blockquote"});const zm=ue("WrapInBlockquote",i=>()=>Qp(oa.type(i)));w(zm,{displayName:"Command<wrapInBlockquoteCommand>",group:"Blockquote"});const Ym=Kt("blockquoteKeymap",{WrapInBlockquote:{shortcuts:"Mod-Shift-b",command:i=>{const e=i.get(re);return()=>e.call(zm.key)}}});w(Ym.ctx,{displayName:"KeymapCtx<blockquote>",group:"Blockquote"});w(Ym.shortcuts,{displayName:"Keymap<blockquote>",group:"Blockquote"});const jm=tt("codeBlock",()=>({pre:{},code:{}}));w(jm,{displayName:"Attr<codeBlock>",group:"CodeBlock"});const la=et("code_block",i=>({content:"text*",group:"block",marks:"",defining:!0,code:!0,attrs:{language:{default:""}},parseDOM:[{tag:"pre",preserveWhitespace:"full",getAttrs:e=>{if(!(e instanceof HTMLElement))throw zr(e);return{language:e.dataset.language}}}],toDOM:e=>{const t=i.get(jm.key)(e);return["pre",{...t.pre,"data-language":e.attrs.language},["code",t.code,0]]},parseMarkdown:{match:({type:e})=>e==="code",runner:(e,t,n)=>{const r=t.lang,s=t.value;e.openNode(n,{language:r}),s&&e.addText(s),e.closeNode()}},toMarkdown:{match:e=>e.type.name==="code_block",runner:(e,t)=>{var n;e.addNode("code",void 0,((n=t.content.firstChild)==null?void 0:n.text)||"",{lang:t.attrs.language})}}}));w(la.node,{displayName:"NodeSchema<codeBlock>",group:"CodeBlock"});w(la.ctx,{displayName:"NodeSchemaCtx<codeBlock>",group:"CodeBlock"});const h$=pt(i=>Yk(/^```(?<language>[a-z]*)?[\s\n]$/,la.type(i),e=>{var t;return{language:((t=e.groups)==null?void 0:t.language)??""}}));w(h$,{displayName:"InputRule<createCodeBlockInputRule>",group:"CodeBlock"});const _m=ue("CreateCodeBlock",i=>(e="")=>yl(la.type(i),{language:e}));w(_m,{displayName:"Command<createCodeBlockCommand>",group:"CodeBlock"});const _5=ue("UpdateCodeBlockLanguage",()=>({pos:i,language:e}={pos:-1,language:""})=>(t,n)=>i>=0?(n==null||n(t.tr.setNodeAttribute(i,"language",e)),!0):!1);w(_5,{displayName:"Command<updateCodeBlockLanguageCommand>",group:"CodeBlock"});const Fm=Kt("codeBlockKeymap",{CreateCodeBlock:{shortcuts:"Mod-Alt-c",command:i=>{const e=i.get(re);return()=>e.call(_m.key)}}});w(Fm.ctx,{displayName:"KeymapCtx<codeBlock>",group:"CodeBlock"});w(Fm.shortcuts,{displayName:"Keymap<codeBlock>",group:"CodeBlock"});const Um=tt("image");w(Um,{displayName:"Attr<image>",group:"Image"});const so=et("image",i=>({inline:!0,group:"inline",selectable:!0,draggable:!0,marks:"",atom:!0,defining:!0,isolating:!0,attrs:{src:{default:""},alt:{default:""},title:{default:""}},parseDOM:[{tag:"img[src]",getAttrs:e=>{if(!(e instanceof HTMLElement))throw zr(e);return{src:e.getAttribute("src")||"",alt:e.getAttribute("alt")||"",title:e.getAttribute("title")||e.getAttribute("alt")||""}}}],toDOM:e=>["img",{...i.get(Um.key)(e),...e.attrs}],parseMarkdown:{match:({type:e})=>e==="image",runner:(e,t,n)=>{const r=t.url,s=t.alt,o=t.title;e.addNode(n,{src:r,alt:s,title:o})}},toMarkdown:{match:e=>e.type.name==="image",runner:(e,t)=>{e.addNode("image",void 0,void 0,{title:t.attrs.title,url:t.attrs.src,alt:t.attrs.alt})}}}));w(so.node,{displayName:"NodeSchema<image>",group:"Image"});w(so.ctx,{displayName:"NodeSchemaCtx<image>",group:"Image"});const c$=ue("InsertImage",i=>(e={})=>(t,n)=>{if(!n)return!0;const{src:r="",alt:s="",title:o=""}=e,l=so.type(i).create({src:r,alt:s,title:o});return l&&n(t.tr.replaceSelectionWith(l).scrollIntoView()),!0});w(c$,{displayName:"Command<insertImageCommand>",group:"Image"});const f$=ue("UpdateImage",i=>(e={})=>(t,n)=>{const r=OT(t.selection,so.type(i));if(!r)return!1;const{node:s,pos:o}=r,l={...s.attrs},{src:a,alt:h,title:c}=e;return a!==void 0&&(l.src=a),h!==void 0&&(l.alt=h),c!==void 0&&(l.title=c),n==null||n(t.tr.setNodeMarkup(o,void 0,l).scrollIntoView()),!0});w(f$,{displayName:"Command<updateImageCommand>",group:"Image"});const F5=pt(i=>new gn(/!\[(?<alt>.*?)]\((?<filename>.*?)\s*(?="|\))"?(?<title>[^"]+)?"?\)/,(e,t,n,r)=>{const[s,o,l="",a]=t;return s?e.tr.replaceWith(n,r,so.type(i).create({src:l,alt:o,title:a})):null}));w(F5,{displayName:"InputRule<insertImageInputRule>",group:"Image"});const Gm=tt("hardbreak",i=>({"data-is-inline":i.attrs.isInline}));w(Gm,{displayName:"Attr<hardbreak>",group:"Hardbreak"});const Ar=et("hardbreak",i=>({inline:!0,group:"inline",attrs:{isInline:{default:!1}},selectable:!1,parseDOM:[{tag:"br"}],toDOM:e=>["br",i.get(Gm.key)(e)],parseMarkdown:{match:({type:e})=>e==="break",runner:(e,t,n)=>{var r;e.addNode(n,{isInline:!!((r=t.data)!=null&&r.isInline)})}},leafText:()=>`
`,toMarkdown:{match:e=>e.type.name==="hardbreak",runner:(e,t)=>{t.attrs.isInline?e.addNode("text",void 0,`
`):e.addNode("break")}}}));w(Ar.node,{displayName:"NodeSchema<hardbreak>",group:"Hardbreak"});w(Ar.ctx,{displayName:"NodeSchemaCtx<hardbreak>",group:"Hardbreak"});const Hm=ue("InsertHardbreak",i=>()=>(e,t)=>{var n;const{selection:r,tr:s}=e;if(!(r instanceof J))return!1;if(r.empty){const o=r.$from.node();if(o.childCount>0&&((n=o.lastChild)==null?void 0:n.type.name)==="hardbreak")return t==null||t(s.replaceRangeWith(r.to-1,r.to,e.schema.node("paragraph")).setSelection(_.near(s.doc.resolve(r.to))).scrollIntoView()),!0}return t==null||t(s.setMeta("hardbreak",!0).replaceSelectionWith(Ar.type(i).create()).scrollIntoView()),!0});w(Hm,{displayName:"Command<insertHardbreakCommand>",group:"Hardbreak"});const Km=Kt("hardbreakKeymap",{InsertHardbreak:{shortcuts:"Shift-Enter",command:i=>{const e=i.get(re);return()=>e.call(Hm.key)}}});w(Km.ctx,{displayName:"KeymapCtx<hardbreak>",group:"Hardbreak"});w(Km.shortcuts,{displayName:"Keymap<hardbreak>",group:"Hardbreak"});const Jm=tt("hr");w(Jm,{displayName:"Attr<hr>",group:"Hr"});const aa=et("hr",i=>({group:"block",parseDOM:[{tag:"hr"}],toDOM:e=>["hr",i.get(Jm.key)(e)],parseMarkdown:{match:({type:e})=>e==="thematicBreak",runner:(e,t,n)=>{e.addNode(n)}},toMarkdown:{match:e=>e.type.name==="hr",runner:e=>{e.addNode("thematicBreak")}}}));w(aa.node,{displayName:"NodeSchema<hr>",group:"Hr"});w(aa.ctx,{displayName:"NodeSchemaCtx<hr>",group:"Hr"});const u$=pt(i=>new gn(/^(?:---|___\s|\*\*\*\s)$/,(e,t,n,r)=>{const{tr:s}=e;return t[0]&&s.replaceWith(n-1,r,aa.type(i).create()),s}));w(u$,{displayName:"InputRule<insertHrInputRule>",group:"Hr"});const d$=ue("InsertHr",i=>()=>(e,t)=>{if(!t)return!0;const n=mi.node.type(i).create(),{tr:r,selection:s}=e,{from:o}=s,l=aa.type(i).create();if(!l)return!0;const a=r.replaceSelectionWith(l).insert(o,n),h=_.findFrom(a.doc.resolve(o),1,!0);return h&&t(a.setSelection(h).scrollIntoView()),!0});w(d$,{displayName:"Command<insertHrCommand>",group:"Hr"});const eg=tt("bulletList");w(eg,{displayName:"Attr<bulletList>",group:"BulletList"});const jr=et("bullet_list",i=>({content:"listItem+",group:"block",attrs:{spread:{default:!1}},parseDOM:[{tag:"ul",getAttrs:e=>{if(!(e instanceof HTMLElement))throw zr(e);return{spread:e.dataset.spread}}}],toDOM:e=>["ul",{...i.get(eg.key)(e),"data-spread":e.attrs.spread},0],parseMarkdown:{match:({type:e,ordered:t})=>e==="list"&&!t,runner:(e,t,n)=>{const r=t.spread!=null?`${t.spread}`:"false";e.openNode(n,{spread:r}).next(t.children).closeNode()}},toMarkdown:{match:e=>e.type.name==="bullet_list",runner:(e,t)=>{e.openNode("list",void 0,{ordered:!1,spread:t.attrs.spread==="true"}).next(t.content).closeNode()}}}));w(jr.node,{displayName:"NodeSchema<bulletList>",group:"BulletList"});w(jr.ctx,{displayName:"NodeSchemaCtx<bulletList>",group:"BulletList"});const p$=pt(i=>xp(/^\s*([-+*])\s$/,jr.type(i)));w(p$,{displayName:"InputRule<wrapInBulletListInputRule>",group:"BulletList"});const rf=ue("WrapInBulletList",i=>()=>Qp(jr.type(i)));w(rf,{displayName:"Command<wrapInBulletListCommand>",group:"BulletList"});const tg=Kt("bulletListKeymap",{WrapInBulletList:{shortcuts:"Mod-Alt-8",command:i=>{const e=i.get(re);return()=>e.call(rf.key)}}});w(tg.ctx,{displayName:"KeymapCtx<bulletListKeymap>",group:"BulletList"});w(tg.shortcuts,{displayName:"Keymap<bulletListKeymap>",group:"BulletList"});const ng=tt("orderedList");w(ng,{displayName:"Attr<orderedList>",group:"OrderedList"});const oo=et("ordered_list",i=>({content:"listItem+",group:"block",attrs:{order:{default:1},spread:{default:!1}},parseDOM:[{tag:"ol",getAttrs:e=>{if(!(e instanceof HTMLElement))throw zr(e);return{spread:e.dataset.spread,order:e.hasAttribute("start")?Number(e.getAttribute("start")):1}}}],toDOM:e=>["ol",{...i.get(ng.key)(e),...e.attrs.order===1?{}:e.attrs.order,"data-spread":e.attrs.spread},0],parseMarkdown:{match:({type:e,ordered:t})=>e==="list"&&!!t,runner:(e,t,n)=>{const r=t.spread!=null?`${t.spread}`:"true";e.openNode(n,{spread:r}).next(t.children).closeNode()}},toMarkdown:{match:e=>e.type.name==="ordered_list",runner:(e,t)=>{e.openNode("list",void 0,{ordered:!0,start:1,spread:t.attrs.spread==="true"}),e.next(t.content),e.closeNode()}}}));w(oo.node,{displayName:"NodeSchema<orderedList>",group:"OrderedList"});w(oo.ctx,{displayName:"NodeSchemaCtx<orderedList>",group:"OrderedList"});const m$=pt(i=>xp(/^\s*(\d+)\.\s$/,oo.type(i),e=>({order:Number(e[1])}),(e,t)=>t.childCount+t.attrs.order===Number(e[1])));w(m$,{displayName:"InputRule<wrapInOrderedListInputRule>",group:"OrderedList"});const ig=ue("WrapInOrderedList",i=>()=>Qp(oo.type(i)));w(ig,{displayName:"Command<wrapInOrderedListCommand>",group:"OrderedList"});const rg=Kt("orderedListKeymap",{WrapInOrderedList:{shortcuts:"Mod-Alt-7",command:i=>{const e=i.get(re);return()=>e.call(ig.key)}}});w(rg.ctx,{displayName:"KeymapCtx<orderedList>",group:"OrderedList"});w(rg.shortcuts,{displayName:"Keymap<orderedList>",group:"OrderedList"});const sg=tt("listItem");w(sg,{displayName:"Attr<listItem>",group:"ListItem"});const zn=et("list_item",i=>({group:"listItem",content:"block+",attrs:{label:{default:""},listType:{default:"bullet"},spread:{default:"true"}},defining:!0,parseDOM:[{tag:"li",getAttrs:e=>{if(!(e instanceof HTMLElement))throw zr(e);return{label:e.dataset.label,listType:e.dataset["list-type"],spread:e.dataset.spread}}}],toDOM:e=>["li",{...i.get(sg.key)(e),"data-label":e.attrs.label,"data-list-type":e.attrs.listType,"data-spread":e.attrs.spread},0],parseMarkdown:{match:({type:e})=>e==="listItem",runner:(e,t,n)=>{const r=t.label!=null?`${t.label}.`:"",s=t.label!=null?"ordered":"bullet",o=t.spread!=null?`${t.spread}`:"true";e.openNode(n,{label:r,listType:s,spread:o}),e.next(t.children),e.closeNode()}},toMarkdown:{match:e=>e.type.name==="list_item",runner:(e,t)=>{e.openNode("listItem",void 0,{spread:t.attrs.spread==="true"}),e.next(t.content),e.closeNode()}}}));w(zn.node,{displayName:"NodeSchema<listItem>",group:"ListItem"});w(zn.ctx,{displayName:"NodeSchemaCtx<listItem>",group:"ListItem"});const og=ue("SinkListItem",i=>()=>q5(zn.type(i)));w(og,{displayName:"Command<sinkListItemCommand>",group:"ListItem"});const lg=ue("LiftListItem",i=>()=>e$(zn.type(i)));w(lg,{displayName:"Command<liftListItemCommand>",group:"ListItem"});const ag=ue("SplitListItem",i=>()=>X5(zn.type(i)));w(ag,{displayName:"Command<splitListItemCommand>",group:"ListItem"});function U5(i){return(e,t,n)=>{const{selection:r}=e;if(!(r instanceof J))return!1;const{empty:s,$from:o}=r;if(!s||o.parentOffset!==0)return!1;const l=o.node(-1);return l.type!==zn.type(i)||l.firstChild!==o.node()||o.node(-2).childCount>1?!1:e$(zn.type(i))(e,t,n)}}const hg=ue("LiftFirstListItem",i=>()=>U5(i));w(hg,{displayName:"Command<liftFirstListItemCommand>",group:"ListItem"});const cg=Kt("listItemKeymap",{NextListItem:{shortcuts:"Enter",command:i=>{const e=i.get(re);return()=>e.call(ag.key)}},SinkListItem:{shortcuts:["Tab","Mod-]"],command:i=>{const e=i.get(re);return()=>e.call(og.key)}},LiftListItem:{shortcuts:["Shift-Tab","Mod-["],command:i=>{const e=i.get(re);return()=>e.call(lg.key)}},LiftFirstListItem:{shortcuts:["Backspace","Delete"],command:i=>{const e=i.get(re);return()=>e.call(hg.key)}}});w(cg.ctx,{displayName:"KeymapCtx<listItem>",group:"ListItem"});w(cg.shortcuts,{displayName:"Keymap<listItem>",group:"ListItem"});const g$=Tp("text",()=>({group:"inline",parseMarkdown:{match:({type:i})=>i==="text",runner:(i,e)=>{i.addText(e.value)}},toMarkdown:{match:i=>i.type.name==="text",runner:(i,e)=>{i.addNode("text",void 0,e.text)}}}));w(g$,{displayName:"NodeSchema<text>",group:"Text"});const fg=tt("html");w(fg,{displayName:"Attr<html>",group:"Html"});const ug=et("html",i=>({atom:!0,group:"inline",inline:!0,attrs:{value:{default:""}},toDOM:e=>{const t=document.createElement("span"),n={...i.get(fg.key)(e),"data-value":e.attrs.value,"data-type":"html"};return t.textContent=e.attrs.value,["span",n,e.attrs.value]},parseDOM:[{tag:'span[data-type="html"]',getAttrs:e=>({value:e.dataset.value??""})}],parseMarkdown:{match:({type:e})=>e==="html",runner:(e,t,n)=>{e.addNode(n,{value:t.value})}},toMarkdown:{match:e=>e.type.name==="html",runner:(e,t)=>{e.addNode("html",void 0,t.attrs.value)}}}));w(ug.node,{displayName:"NodeSchema<html>",group:"Html"});w(ug.ctx,{displayName:"NodeSchemaCtx<html>",group:"Html"});const G5=[o$,Im,mi,nf,Bm,nr,Gm,Ar,Lm,oa,jm,la,Jm,aa,Um,so,eg,jr,ng,oo,sg,zn,Tm,ro,Am,sa,Rm,Ii,Nm,Ts,fg,ug,g$].flat(),H5=[a$,p$,m$,h$,u$,l$].flat(),K5=[n$,i$,s$,r$],J5=[Wm,zm,ei,Vm,_m,Hm,d$,c$,f$,ig,rf,og,ag,lg,hg,Jc,tf,ef,bc,Dm],eB=[Ym,Fm,Km,qm,cg,rg,tg,Xm,Mm,Em,Zm].flat(),dg=ui("remarkAddOrderInList",()=>()=>i=>{Lr(i,"list",e=>{if(e.ordered){const t=e.start??1;e.children.forEach((n,r)=>{n.label=r+t})}})});w(dg.plugin,{displayName:"Remark<remarkAddOrderInListPlugin>",group:"Remark"});w(dg.options,{displayName:"RemarkConfig<remarkAddOrderInListPlugin>",group:"Remark"});const pg=ui("remarkLineBreak",()=>()=>i=>{const e=/[\t ]*(?:\r?\n|\r)/g;Lr(i,"text",(t,n,r)=>{if(!t.value||typeof t.value!="string")return;const s=[];let o=0;e.lastIndex=0;let l=e.exec(t.value);for(;l;){const a=l.index;o!==a&&s.push({type:"text",value:t.value.slice(o,a)}),s.push({type:"break",data:{isInline:!0}}),o=a+l[0].length,l=e.exec(t.value)}if(s.length>0&&r&&typeof n=="number")return o<t.value.length&&s.push({type:"text",value:t.value.slice(o)}),r.children.splice(n,1,...s),n+s.length})});w(pg.plugin,{displayName:"Remark<remarkLineBreak>",group:"Remark"});w(pg.options,{displayName:"RemarkConfig<remarkLineBreak>",group:"Remark"});const mg=ui("remarkInlineLink",()=>z5);w(mg.plugin,{displayName:"Remark<remarkInlineLinkPlugin>",group:"Remark"});w(mg.options,{displayName:"RemarkConfig<remarkInlineLinkPlugin>",group:"Remark"});const tB=i=>!!i.children,nB=i=>i.type==="html";function iB(i,e){return t(i,0,null)[0];function t(n,r,s){if(tB(n)){const o=[];for(let l=0,a=n.children.length;l<a;l++){const h=n.children[l];if(h){const c=t(h,l,n);if(c)for(let f=0,u=c.length;f<u;f++){const d=c[f];d&&o.push(d)}}}n.children=o}return e(n,r,s)}}const gg=ui("remarkHTMLTransformer",()=>()=>i=>{iB(i,(e,t,n)=>nB(e)?((n==null?void 0:n.type)==="root"&&(e.children=[{...e}],delete e.value,e.type="paragraph"),[e]):[e])});w(gg.plugin,{displayName:"Remark<remarkHtmlTransformer>",group:"Remark"});w(gg.options,{displayName:"RemarkConfig<remarkHtmlTransformer>",group:"Remark"});const Og=ui("remarkMarker",()=>()=>(i,e)=>{const t=n=>e.value.charAt(n.position.start.offset);Lr(i,n=>["strong","emphasis"].includes(n.type),n=>{n.marker=t(n)})});w(Og.plugin,{displayName:"Remark<remarkMarker>",group:"Remark"});w(Og.options,{displayName:"RemarkConfig<remarkMarker>",group:"Remark"});const O$=fi(()=>{let i=!1;const e=new Ht("MILKDOWN_INLINE_NODES_CURSOR"),t=new wt({key:e,state:{init(){return!1},apply(n){if(!n.selection.empty)return!1;const r=n.selection.$from,s=r.nodeBefore,o=r.nodeAfter;return!!(s&&o&&s.isInline&&!s.isText&&o.isInline&&!o.isText)}},props:{handleDOMEvents:{compositionend:(n,r)=>i?(i=!1,requestAnimationFrame(()=>{if(t.getState(n.state)){const s=n.state.selection.from;r.preventDefault(),n.dispatch(n.state.tr.insertText(r.data||"",s))}}),!0):!1,compositionstart:n=>(t.getState(n.state)&&(i=!0),!1),beforeinput:(n,r)=>{if(t.getState(n.state)&&r instanceof InputEvent&&r.data&&!i){const s=n.state.selection.from;return r.preventDefault(),n.dispatch(n.state.tr.insertText(r.data||"",s)),!0}return!1}},decorations(n){if(t.getState(n)){const r=n.selection.$from.pos,s=document.createElement("span"),o=qn.widget(r,s,{side:-1}),l=document.createElement("span"),a=qn.widget(r,l);return setTimeout(()=>{s.contentEditable="true",l.contentEditable="true"}),Pe.create(n.doc,[o,a])}return Pe.empty}}});return t});w(O$,{displayName:"Prose<inlineNodesCursorPlugin>",group:"Prose"});const y$=fi(i=>new wt({key:new Ht("MILKDOWN_HARDBREAK_MARKS"),appendTransaction:(e,t,n)=>{if(!e.length)return;const[r]=e;if(!r)return;const[s]=r.steps;if(r.getMeta("hardbreak")){if(!(s instanceof Ve))return;const{from:o}=s;return n.tr.setNodeMarkup(o,Ar.type(i),void 0,[])}if(s instanceof ii){let o=n.tr;const{from:l,to:a}=s;return n.doc.nodesBetween(l,a,(h,c)=>{h.type===Ar.type(i)&&(o=o.setNodeMarkup(c,Ar.type(i),void 0,[]))}),o}}}));w(y$,{displayName:"Prose<hardbreakClearMarkPlugin>",group:"Prose"});const yg=jn(["table","code_block"],"hardbreakFilterNodes");w(yg,{displayName:"Ctx<hardbreakFilterNodes>",group:"Prose"});const k$=fi(i=>{const e=i.get(yg.key);return new wt({key:new Ht("MILKDOWN_HARDBREAK_FILTER"),filterTransaction:(t,n)=>{const r=t.getMeta("hardbreak"),[s]=t.steps;if(r&&s){const{from:o}=s,l=n.doc.resolve(o);let a=l.depth,h=!0;for(;a>0;)e.includes(l.node(a).type.name)&&(h=!1),a--;return h}return!0}})});w(k$,{displayName:"Prose<hardbreakFilterPlugin>",group:"Prose"});const b$=fi(i=>{const e=new Ht("MILKDOWN_HEADING_ID"),t=n=>{if(n.composing)return;const r=i.get(nf.key),s=n.state.tr.setMeta("addToHistory",!1);let o=!1;n.state.doc.descendants((l,a)=>{if(l.type===nr.type(i)){if(l.textContent.trim().length===0)return;const h=l.attrs,c=r(l);h.id!==c&&(o=!0,s.setMeta(e,!0).setNodeMarkup(a,void 0,{...h,id:c}))}}),o&&n.dispatch(s)};return new wt({key:e,view:n=>(t(n),{update:r=>{t(r)}})})});w(b$,{displayName:"Prose<syncHeadingIdPlugin>",group:"Prose"});const S$=fi(i=>{const e=t=>{if(t.composing||!t.editable)return;const n=oo.type(i),r=jr.type(i),s=zn.type(i),o=t.state,l=(c,f)=>{let u=!1;const d=`${f+1}.`;return c.label!==d&&(c.label=d,u=!0),u};let a=o.tr,h=!1;o.doc.descendants((c,f,u,d)=>{if(c.type===r){const p=c.maybeChild(0);(p==null?void 0:p.type)===s&&p.attrs.listType==="ordered"&&(h=!0,a.setNodeMarkup(f,n,{spread:"true"}),c.descendants((m,g,y,k)=>{if(m.type===s){const v={...m.attrs};l(v,k)&&(a=a.setNodeMarkup(g,void 0,v))}return!1}))}else if(c.type===s&&(u==null?void 0:u.type)===n){const p={...c.attrs};let m=!1;p.listType!=="ordered"&&(p.listType="ordered",m=!0),u!=null&&u.maybeChild(0)&&(m=l(p,d)),m&&(a=a.setNodeMarkup(f,void 0,p),h=!0)}}),h&&t.dispatch(a.setMeta("addToHistory",!1))};return new wt({key:new Ht("MILKDOWN_KEEP_LIST_ORDER"),view:t=>(e(t),{update:n=>{e(n)}})})});w(S$,{displayName:"Prose<syncListOrderPlugin>",group:"Prose"});const rB=[y$,yg,k$,O$,dg,mg,pg,gg,Og,b$,S$].flat(),sB=[G5,H5,K5,J5,eB,rB].flat();function w$(i){var e,t,n="";if(typeof i=="string"||typeof i=="number")n+=i;else if(typeof i=="object")if(Array.isArray(i)){var r=i.length;for(e=0;e<r;e++)i[e]&&(t=w$(i[e]))&&(n&&(n+=" "),n+=t)}else for(t in i)i[t]&&(n&&(n+=" "),n+=t);return n}function oB(){for(var i,e,t=0,n="",r=arguments.length;t<r;t++)(i=arguments[t])&&(e=w$(i))&&(n&&(n+=" "),n+=e);return n}function lB(i){i.update(nl,e=>{const t=e.attributes;return{...e,attributes:n=>{const r=typeof t=="function"?t(n):t;return{...r,class:oB("prose dark:prose-invert outline-none",(r==null?void 0:r.class)||"","milkdown-theme-nord")}}}})}function aB(i){Lr(i,function(e,t,n){if(t!==void 0&&n&&e.type==="paragraph"&&e.children.every(function(r){return r.type==="text"&&/^\s*$/.test(r.value)}))return n.children.splice(t,1),t})}function hB(){return function(i){aB(i)}}function cB(i){return new RegExp("^(?:"+i.join("|")+")","i")}function sf(i){return new RegExp("^(?:"+i.join("|")+")$","i")}var fB=sf(["_G","_VERSION","assert","collectgarbage","dofile","error","getfenv","getmetatable","ipairs","load","loadfile","loadstring","module","next","pairs","pcall","print","rawequal","rawget","rawset","require","select","setfenv","setmetatable","tonumber","tostring","type","unpack","xpcall","coroutine.create","coroutine.resume","coroutine.running","coroutine.status","coroutine.wrap","coroutine.yield","debug.debug","debug.getfenv","debug.gethook","debug.getinfo","debug.getlocal","debug.getmetatable","debug.getregistry","debug.getupvalue","debug.setfenv","debug.sethook","debug.setlocal","debug.setmetatable","debug.setupvalue","debug.traceback","close","flush","lines","read","seek","setvbuf","write","io.close","io.flush","io.input","io.lines","io.open","io.output","io.popen","io.read","io.stderr","io.stdin","io.stdout","io.tmpfile","io.type","io.write","math.abs","math.acos","math.asin","math.atan","math.atan2","math.ceil","math.cos","math.cosh","math.deg","math.exp","math.floor","math.fmod","math.frexp","math.huge","math.ldexp","math.log","math.log10","math.max","math.min","math.modf","math.pi","math.pow","math.rad","math.random","math.randomseed","math.sin","math.sinh","math.sqrt","math.tan","math.tanh","os.clock","os.date","os.difftime","os.execute","os.exit","os.getenv","os.remove","os.rename","os.setlocale","os.time","os.tmpname","package.cpath","package.loaded","package.loaders","package.loadlib","package.path","package.preload","package.seeall","string.byte","string.char","string.dump","string.find","string.format","string.gmatch","string.gsub","string.len","string.lower","string.match","string.rep","string.reverse","string.sub","string.upper","table.concat","table.insert","table.maxn","table.remove","table.sort"]),uB=sf(["and","break","elseif","false","nil","not","or","return","true","function","end","if","then","else","do","while","repeat","until","for","in","local"]),dB=sf(["function","if","repeat","do","\\(","{"]),pB=sf(["end","until","\\)","}"]),mB=cB(["end","until","\\)","}","else","elseif"]);function d1(i){for(var e=0;i.eat("=");)++e;return i.eat("["),e}function kg(i,e){var t=i.next();return t=="-"&&i.eat("-")?i.eat("[")&&i.eat("[")?(e.cur=p1(d1(i),"comment"))(i,e):(i.skipToEnd(),"comment"):t=='"'||t=="'"?(e.cur=gB(t))(i,e):t=="["&&/[\[=]/.test(i.peek())?(e.cur=p1(d1(i),"string"))(i,e):/\d/.test(t)?(i.eatWhile(/[\w.%]/),"number"):/[\w_]/.test(t)?(i.eatWhile(/[\w\\\-_.]/),"variable"):null}function p1(i,e){return function(t,n){for(var r=null,s;(s=t.next())!=null;)if(r==null)s=="]"&&(r=0);else if(s=="=")++r;else if(s=="]"&&r==i){n.cur=kg;break}else r=null;return e}}function gB(i){return function(e,t){for(var n=!1,r;(r=e.next())!=null&&!(r==i&&!n);)n=!n&&r=="\\";return n||(t.cur=kg),"string"}}const OB={name:"lua",startState:function(){return{basecol:0,indentDepth:0,cur:kg}},token:function(i,e){if(i.eatSpace())return null;var t=e.cur(i,e),n=i.current();return t=="variable"&&(uB.test(n)?t="keyword":fB.test(n)&&(t="builtin")),t!="comment"&&t!="string"&&(dB.test(n)?++e.indentDepth:pB.test(n)&&--e.indentDepth),t},indent:function(i,e,t){var n=mB.test(e);return i.basecol+t.unit*(i.indentDepth-(n?1:0))},languageData:{indentOnInput:/^\s*(?:end|until|else|\)|\})$/,commentTokens:{line:"--",block:{open:"--[[",close:"]]--"}}}};function x$(i,e,t){for(let n=0;;n++){if(n==i.childCount||n==e.childCount)return i.childCount==e.childCount?null:t;let r=i.child(n),s=e.child(n);if(r==s){t+=r.nodeSize;continue}if(!r.sameMarkup(s))return t;if(r.isText&&r.text!=s.text){for(let o=0;r.text[o]==s.text[o];o++)t++;return t}if(r.content.size||s.content.size){let o=x$(r.content,s.content,t+1);if(o!=null)return o}t+=r.nodeSize}}function v$(i,e,t,n){for(let r=i.childCount,s=e.childCount;;){if(r==0||s==0)return r==s?null:{a:t,b:n};let o=i.child(--r),l=e.child(--s),a=o.nodeSize;if(o==l){t-=a,n-=a;continue}if(!o.sameMarkup(l))return{a:t,b:n};if(o.isText&&o.text!=l.text){let h=0,c=Math.min(o.text.length,l.text.length);for(;h<c&&o.text[o.text.length-h-1]==l.text[l.text.length-h-1];)h++,t--,n--;return{a:t,b:n}}if(o.content.size||l.content.size){let h=v$(o.content,l.content,t-1,n-1);if(h)return h}t-=a,n-=a}}class ye{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let n=0;n<e.length;n++)this.size+=e[n].nodeSize}nodesBetween(e,t,n,r=0,s){for(let o=0,l=0;l<t;o++){let a=this.content[o],h=l+a.nodeSize;if(h>e&&n(a,r+l,s||null,o)!==!1&&a.content.size){let c=l+1;a.nodesBetween(Math.max(0,e-c),Math.min(a.content.size,t-c),n,r+c)}l=h}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,n,r){let s="",o=!0;return this.nodesBetween(e,t,(l,a)=>{let h=l.isText?l.text.slice(Math.max(e,a)-a,t-a):l.isLeaf?r?typeof r=="function"?r(l):r:l.type.spec.leafText?l.type.spec.leafText(l):"":"";l.isBlock&&(l.isLeaf&&h||l.isTextblock)&&n&&(o?o=!1:s+=n),s+=h},0),s}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,n=e.firstChild,r=this.content.slice(),s=0;for(t.isText&&t.sameMarkup(n)&&(r[r.length-1]=t.withText(t.text+n.text),s=1);s<e.content.length;s++)r.push(e.content[s]);return new ye(r,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let n=[],r=0;if(t>e)for(let s=0,o=0;o<t;s++){let l=this.content[s],a=o+l.nodeSize;a>e&&((o<e||a>t)&&(l.isText?l=l.cut(Math.max(0,e-o),Math.min(l.text.length,t-o)):l=l.cut(Math.max(0,e-o-1),Math.min(l.content.size,t-o-1))),n.push(l),r+=l.nodeSize),o=a}return new ye(n,r)}cutByIndex(e,t){return e==t?ye.empty:e==0&&t==this.content.length?this:new ye(this.content.slice(e,t))}replaceChild(e,t){let n=this.content[e];if(n==t)return this;let r=this.content.slice(),s=this.size+t.nodeSize-n.nodeSize;return r[e]=t,new ye(r,s)}addToStart(e){return new ye([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new ye(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,n=0;t<this.content.length;t++){let r=this.content[t];e(r,n,t),n+=r.nodeSize}}findDiffStart(e,t=0){return x$(this,e,t)}findDiffEnd(e,t=this.size,n=e.size){return v$(this,e,t,n)}findIndex(e,t=-1){if(e==0)return qa(0,e);if(e==this.size)return qa(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let n=0,r=0;;n++){let s=this.child(n),o=r+s.nodeSize;if(o>=e)return o==e||t>0?qa(n+1,o):qa(n,r);r=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return ye.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new ye(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return ye.empty;let t,n=0;for(let r=0;r<e.length;r++){let s=e[r];n+=s.nodeSize,r&&s.isText&&e[r-1].sameMarkup(s)?(t||(t=e.slice(0,r)),t[t.length-1]=s.withText(t[t.length-1].text+s.text)):t&&t.push(s)}return new ye(t||e,n)}static from(e){if(!e)return ye.empty;if(e instanceof ye)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new ye([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}ye.empty=new ye([],0);const bu={index:0,offset:0};function qa(i,e){return bu.index=i,bu.offset=e,bu}class yB extends Error{}class fe{constructor(e,t,n){this.content=e,this.openStart=t,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let n=P$(this.content,e+this.openStart,t);return n&&new fe(n,this.openStart,this.openEnd)}removeBetween(e,t){return new fe($$(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return fe.empty;let n=t.openStart||0,r=t.openEnd||0;if(typeof n!="number"||typeof r!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new fe(ye.fromJSON(e,t.content),n,r)}static maxOpen(e,t=!0){let n=0,r=0;for(let s=e.firstChild;s&&!s.isLeaf&&(t||!s.type.spec.isolating);s=s.firstChild)n++;for(let s=e.lastChild;s&&!s.isLeaf&&(t||!s.type.spec.isolating);s=s.lastChild)r++;return new fe(e,n,r)}}fe.empty=new fe(ye.empty,0,0);function $$(i,e,t){let{index:n,offset:r}=i.findIndex(e),s=i.maybeChild(n),{index:o,offset:l}=i.findIndex(t);if(r==e||s.isText){if(l!=t&&!i.child(o).isText)throw new RangeError("Removing non-flat range");return i.cut(0,e).append(i.cut(t))}if(n!=o)throw new RangeError("Removing non-flat range");return i.replaceChild(n,s.copy($$(s.content,e-r-1,t-r-1)))}function P$(i,e,t,n){let{index:r,offset:s}=i.findIndex(e),o=i.maybeChild(r);if(s==e||o.isText)return n&&!n.canReplace(r,r,t)?null:i.cut(0,e).append(t).append(i.cut(e));let l=P$(o.content,e-s-1,t);return l&&i.replaceChild(r,o.copy(l))}const Q$=65535,C$=Math.pow(2,16);function kB(i,e){return i+e*C$}function m1(i){return i&Q$}function bB(i){return(i-(i&Q$))/C$}const T$=1,M$=2,Zh=4,A$=8;class g1{constructor(e,t,n){this.pos=e,this.delInfo=t,this.recover=n}get deleted(){return(this.delInfo&A$)>0}get deletedBefore(){return(this.delInfo&(T$|Zh))>0}get deletedAfter(){return(this.delInfo&(M$|Zh))>0}get deletedAcross(){return(this.delInfo&Zh)>0}}class At{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&At.empty)return At.empty}recover(e){let t=0,n=m1(e);if(!this.inverted)for(let r=0;r<n;r++)t+=this.ranges[r*3+2]-this.ranges[r*3+1];return this.ranges[n*3]+t+bB(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,n){let r=0,s=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?r:0);if(a>e)break;let h=this.ranges[l+s],c=this.ranges[l+o],f=a+h;if(e<=f){let u=h?e==a?-1:e==f?1:t:t,d=a+r+(u<0?0:c);if(n)return d;let p=e==(t<0?a:f)?null:kB(l/3,e-a),m=e==a?M$:e==f?T$:Zh;return(t<0?e!=a:e!=f)&&(m|=A$),new g1(d,m,p)}r+=c-h}return n?e+r:new g1(e+r,0,null)}touches(e,t){let n=0,r=m1(t),s=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?n:0);if(a>e)break;let h=this.ranges[l+s],c=a+h;if(e<=c&&l==r*3)return!0;n+=this.ranges[l+o]-h}return!1}forEach(e){let t=this.inverted?2:1,n=this.inverted?1:2;for(let r=0,s=0;r<this.ranges.length;r+=3){let o=this.ranges[r],l=o-(this.inverted?s:0),a=o+(this.inverted?0:s),h=this.ranges[r+t],c=this.ranges[r+n];e(l,l+h,a,a+c),s+=c-h}}invert(){return new At(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?At.empty:new At(e<0?[0,-e,0]:[0,0,e])}}At.empty=new At([]);const Su=Object.create(null);class it{getMap(){return At.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=Su[t.stepType];if(!n)throw new RangeError(`No step type ${t.stepType} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in Su)throw new RangeError("Duplicate use of step JSON ID "+e);return Su[e]=t,t.prototype.jsonID=e,t}}class Te{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new Te(e,null)}static fail(e){return new Te(null,e)}static fromReplace(e,t,n,r){try{return Te.ok(e.replace(t,n,r))}catch(s){if(s instanceof yB)return Te.fail(s.message);throw s}}}function bg(i,e,t){let n=[];for(let r=0;r<i.childCount;r++){let s=i.child(r);s.content.size&&(s=s.copy(bg(s.content,e,s))),s.isInline&&(s=e(s,t,r)),n.push(s)}return ye.fromArray(n)}class Sr extends it{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=e.resolve(this.from),r=n.node(n.sharedDepth(this.to)),s=new fe(bg(t.content,(o,l)=>!o.isAtom||!l.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),r),t.openStart,t.openEnd);return Te.fromReplace(e,this.from,this.to,s)}invert(){return new wr(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new Sr(t.pos,n.pos,this.mark)}merge(e){return e instanceof Sr&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Sr(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Sr(t.from,t.to,e.markFromJSON(t.mark))}}it.jsonID("addMark",Sr);class wr extends it{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=new fe(bg(t.content,r=>r.mark(this.mark.removeFromSet(r.marks)),e),t.openStart,t.openEnd);return Te.fromReplace(e,this.from,this.to,n)}invert(){return new Sr(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new wr(t.pos,n.pos,this.mark)}merge(e){return e instanceof wr&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new wr(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new wr(t.from,t.to,e.markFromJSON(t.mark))}}it.jsonID("removeMark",wr);class xr extends it{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Te.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return Te.fromReplace(e,this.pos,this.pos+1,new fe(ye.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let n=this.mark.addToSet(t.marks);if(n.length==t.marks.length){for(let r=0;r<t.marks.length;r++)if(!t.marks[r].isInSet(n))return new xr(this.pos,t.marks[r]);return new xr(this.pos,this.mark)}}return new Ll(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new xr(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new xr(t.pos,e.markFromJSON(t.mark))}}it.jsonID("addNodeMark",xr);class Ll extends it{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Te.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return Te.fromReplace(e,this.pos,this.pos+1,new fe(ye.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new xr(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Ll(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Ll(t.pos,e.markFromJSON(t.mark))}}it.jsonID("removeNodeMark",Ll);class ti extends it{constructor(e,t,n,r=!1){super(),this.from=e,this.to=t,this.slice=n,this.structure=r}apply(e){return this.structure&&ap(e,this.from,this.to)?Te.fail("Structure replace would overwrite content"):Te.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new At([this.from,this.to-this.from,this.slice.size])}invert(e){return new ti(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deletedAcross&&n.deletedAcross?null:new ti(t.pos,Math.max(t.pos,n.pos),this.slice)}merge(e){if(!(e instanceof ti)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?fe.empty:new fe(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new ti(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?fe.empty:new fe(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new ti(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new ti(t.from,t.to,fe.fromJSON(e,t.slice),!!t.structure)}}it.jsonID("replace",ti);class Ms extends it{constructor(e,t,n,r,s,o,l=!1){super(),this.from=e,this.to=t,this.gapFrom=n,this.gapTo=r,this.slice=s,this.insert=o,this.structure=l}apply(e){if(this.structure&&(ap(e,this.from,this.gapFrom)||ap(e,this.gapTo,this.to)))return Te.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return Te.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,t.content);return n?Te.fromReplace(e,this.from,this.to,n):Te.fail("Content does not fit in gap")}getMap(){return new At([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new Ms(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1),r=e.map(this.gapFrom,-1),s=e.map(this.gapTo,1);return t.deletedAcross&&n.deletedAcross||r<t.pos||s>n.pos?null:new Ms(t.pos,n.pos,r,s,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Ms(t.from,t.to,t.gapFrom,t.gapTo,fe.fromJSON(e,t.slice),t.insert,!!t.structure)}}it.jsonID("replaceAround",Ms);function ap(i,e,t){let n=i.resolve(e),r=t-e,s=n.depth;for(;r>0&&s>0&&n.indexAfter(s)==n.node(s).childCount;)s--,r--;if(r>0){let o=n.node(s).maybeChild(n.indexAfter(s));for(;r>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,r--}}return!1}class fl extends it{constructor(e,t,n){super(),this.pos=e,this.attr=t,this.value=n}apply(e){let t=e.nodeAt(this.pos);if(!t)return Te.fail("No node at attribute step's position");let n=Object.create(null);for(let s in t.attrs)n[s]=t.attrs[s];n[this.attr]=this.value;let r=t.type.create(n,null,t.marks);return Te.fromReplace(e,this.pos,this.pos+1,new fe(ye.from(r),0,t.isLeaf?0:1))}getMap(){return At.empty}invert(e){return new fl(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new fl(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new fl(t.pos,t.attr,t.value)}}it.jsonID("attr",fl);class Sc extends it{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let r in e.attrs)t[r]=e.attrs[r];t[this.attr]=this.value;let n=e.type.create(t,e.content,e.marks);return Te.ok(n)}getMap(){return At.empty}invert(e){return new Sc(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Sc(t.attr,t.value)}}it.jsonID("docAttr",Sc);let zl=class extends Error{};zl=function i(e){let t=Error.call(this,e);return t.__proto__=i.prototype,t};zl.prototype=Object.create(Error.prototype);zl.prototype.constructor=zl;zl.prototype.name="TransformError";const wu=Object.create(null);class De{constructor(e,t,n){this.$anchor=e,this.$head=t,this.ranges=n||[new SB(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=fe.empty){let n=t.content.lastChild,r=null;for(let l=0;l<t.openEnd;l++)r=n,n=n.lastChild;let s=e.steps.length,o=this.ranges;for(let l=0;l<o.length;l++){let{$from:a,$to:h}=o[l],c=e.mapping.slice(s);e.replaceRange(c.map(a.pos),c.map(h.pos),l?fe.empty:t),l==0&&k1(e,s,(n?n.isInline:r&&r.isTextblock)?-1:1)}}replaceWith(e,t){let n=e.steps.length,r=this.ranges;for(let s=0;s<r.length;s++){let{$from:o,$to:l}=r[s],a=e.mapping.slice(n),h=a.map(o.pos),c=a.map(l.pos);s?e.deleteRange(h,c):(e.replaceRangeWith(h,c,t),k1(e,n,t.isInline?-1:1))}}static findFrom(e,t,n=!1){let r=e.parent.inlineContent?new Et(e):fs(e.node(0),e.parent,e.pos,e.index(),t,n);if(r)return r;for(let s=e.depth-1;s>=0;s--){let o=t<0?fs(e.node(0),e.node(s),e.before(s+1),e.index(s),t,n):fs(e.node(0),e.node(s),e.after(s+1),e.index(s)+1,t,n);if(o)return o}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new li(e.node(0))}static atStart(e){return fs(e,e,0,0,1)||new li(e)}static atEnd(e){return fs(e,e,e.content.size,e.childCount,-1)||new li(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=wu[t.type];if(!n)throw new RangeError(`No selection type ${t.type} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in wu)throw new RangeError("Duplicate use of selection JSON ID "+e);return wu[e]=t,t.prototype.jsonID=e,t}getBookmark(){return Et.between(this.$anchor,this.$head).getBookmark()}}De.prototype.visible=!0;class SB{constructor(e,t){this.$from=e,this.$to=t}}let O1=!1;function y1(i){!O1&&!i.parent.inlineContent&&(O1=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+i.parent.type.name+")"))}class Et extends De{constructor(e,t=e){y1(e),y1(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let n=e.resolve(t.map(this.head));if(!n.parent.inlineContent)return De.near(n);let r=e.resolve(t.map(this.anchor));return new Et(r.parent.inlineContent?r:n,n)}replace(e,t=fe.empty){if(super.replace(e,t),t==fe.empty){let n=this.$from.marksAcross(this.$to);n&&e.ensureMarks(n)}}eq(e){return e instanceof Et&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new of(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new Et(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,n=t){let r=e.resolve(t);return new this(r,n==t?r:e.resolve(n))}static between(e,t,n){let r=e.pos-t.pos;if((!n||r)&&(n=r>=0?1:-1),!t.parent.inlineContent){let s=De.findFrom(t,n,!0)||De.findFrom(t,-n,!0);if(s)t=s.$head;else return De.near(t,n)}return e.parent.inlineContent||(r==0?e=t:(e=(De.findFrom(e,-n,!0)||De.findFrom(e,n,!0)).$anchor,e.pos<t.pos!=r<0&&(e=t))),new Et(e,t)}}De.jsonID("text",Et);class of{constructor(e,t){this.anchor=e,this.head=t}map(e){return new of(e.map(this.anchor),e.map(this.head))}resolve(e){return Et.between(e.resolve(this.anchor),e.resolve(this.head))}}class ln extends De{constructor(e){let t=e.nodeAfter,n=e.node(0).resolve(e.pos+t.nodeSize);super(e,n),this.node=t}map(e,t){let{deleted:n,pos:r}=t.mapResult(this.anchor),s=e.resolve(r);return n?De.near(s):new ln(s)}content(){return new fe(ye.from(this.node),0,0)}eq(e){return e instanceof ln&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Sg(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new ln(e.resolve(t.anchor))}static create(e,t){return new ln(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}ln.prototype.visible=!1;De.jsonID("node",ln);class Sg{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:n}=e.mapResult(this.anchor);return t?new of(n,n):new Sg(n)}resolve(e){let t=e.resolve(this.anchor),n=t.nodeAfter;return n&&ln.isSelectable(n)?new ln(t):De.near(t)}}class li extends De{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=fe.empty){if(t==fe.empty){e.delete(0,e.doc.content.size);let n=De.atStart(e.doc);n.eq(e.selection)||e.setSelection(n)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new li(e)}map(e){return new li(e)}eq(e){return e instanceof li}getBookmark(){return wB}}De.jsonID("all",li);const wB={map(){return this},resolve(i){return new li(i)}};function fs(i,e,t,n,r,s=!1){if(e.inlineContent)return Et.create(i,t);for(let o=n-(r>0?0:1);r>0?o<e.childCount:o>=0;o+=r){let l=e.child(o);if(l.isAtom){if(!s&&ln.isSelectable(l))return ln.create(i,t-(r<0?l.nodeSize:0))}else{let a=fs(i,l,t+r,r<0?l.childCount:0,r,s);if(a)return a}t+=l.nodeSize*r}return null}function k1(i,e,t){let n=i.steps.length-1;if(n<e)return;let r=i.steps[n];if(!(r instanceof ti||r instanceof Ms))return;let s=i.mapping.maps[n],o;s.forEach((l,a,h,c)=>{o==null&&(o=c)}),i.setSelection(De.near(i.doc.resolve(o),t))}function b1(i,e){return!e||!i?i:i.bind(e)}class La{constructor(e,t,n){this.name=e,this.init=b1(t.init,n),this.apply=b1(t.apply,n)}}new La("doc",{init(i){return i.doc||i.schema.topNodeType.createAndFill()},apply(i){return i.doc}}),new La("selection",{init(i,e){return i.selection||De.atStart(e.doc)},apply(i){return i.selection}}),new La("storedMarks",{init(i){return i.storedMarks||null},apply(i,e,t,n){return n.selection.$cursor?i.storedMarks:null}}),new La("scrollToSelection",{init(){return 0},apply(i,e){return i.scrolledIntoView?e+1:e}});class Yn{constructor(e,t,n={}){this.match=e,this.match=e,this.handler=typeof t=="string"?xB(t):t,this.undoable=n.undoable!==!1,this.inCode=n.inCode||!1}}function xB(i){return function(e,t,n,r){let s=i;if(t[1]){let o=t[0].lastIndexOf(t[1]);s+=t[0].slice(o+t[1].length),n+=o;let l=n-r;l>0&&(s=t[0].slice(o-l,o)+s,n=r)}return e.tr.insertText(s,n,r)}}new Yn(/--$/,"");new Yn(/\.\.\.$/,"");new Yn(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"");new Yn(/"$/,"");new Yn(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"");new Yn(/'$/,"");const vB=ui("remarkDirectivePlugin",()=>iP),An="containerDirectiveLabel",Z$=tt(An,()=>({"data-type":An})),R$=et(An,i=>({content:"text*",group:"block",marks:"",defining:!0,code:!0,parseDOM:[{tag:`div[data-type="${An}"]`}],toDOM:e=>["div",i.get(Z$.key)(e),["span",0]],parseMarkdown:{match:e=>e.type===An,runner:(e,t,n)=>{var r;let s;((r=t.children)==null?void 0:r.length)===1&&t.children[0].type==="inlineCode"?s=t.children[0].value.trim():s="",e.openNode(n),s!==""&&e.addText(s),e.closeNode()}},toMarkdown:{match:e=>e.type.name===An,runner:(e,t)=>{const n=t.textContent.trim().replace(/\s+/g," ");n!==""&&e.openNode(An).openNode("inlineCode",n).closeNode().closeNode()}}})),Mi="containerDirective",E$=tt(Mi,()=>({"data-type":Mi})),wg=et(Mi,i=>({content:`${An} bullet_list`,group:"block",atom:!1,defining:!0,attrs:{name:{default:"nil"}},parseDOM:[{tag:`div[data-type="${Mi}"]`}],toDOM:e=>["div",i.get(E$.key)(e),0],parseMarkdown:{match:e=>e.type===Mi,runner:(e,t,n)=>{var r,s;const{name:o}=t;e.openNode(n,{name:o}),((s=(r=t.children)==null?void 0:r[0])==null?void 0:s.type)!==An&&e.next({type:An,children:[{type:"inlineCode",value:" "}]}),e.next(t.children).closeNode()}},toMarkdown:{match:e=>e.type.name===Mi,runner:(e,t)=>{e.openNode(Mi,void 0,{name:t.attrs.name??"nil"}).next(t.content).closeNode()}}}));function N$(i,e,t,n,r){const{from:s,to:o}=t??e.selection,l=e.tr.doc.resolve(s);if(l.node(l.depth-1).type.name===Mi)return null;const a=e.tr.replaceRangeWith(s,o,wg.type(i).createChecked({name:n},[R$.type(i).createChecked(null,r?e.schema.text(r):null),jr.type(i).createChecked(null,[zn.type(i).createChecked(null,[mi.type(i).createChecked()])])]));return a.setSelection(new Et(a.doc.resolve(s+1)))}const D$=ue("insertDirective",i=>(e={})=>(t,n)=>{const r=N$(i,t,void 0,e.name,e.label);return r?(n&&n(r),!0):!1}),$B=pt(i=>new Yn(/^:::(?<name>[a-z]*)?(?:`(?<label>[^`]*)`)?[\s\n]$/,(e,t,n,r)=>{const{name:s,label:o}=t.groups;return N$(i,e,{from:n,to:r},s,o)})),PB=[Z$,R$,E$,wg,D$,$B,vB].flat(),QB=ui("remarkMdxPlugin",()=>rP),pr="mdxTextExpression",I$=tt(pr,()=>({"data-type":pr})),W$=et(pr,i=>({content:"text*",group:"inline",inline:!0,code:!0,isolating:!0,atom:!1,allowGapCursor:!0,parseDOM:[{tag:`code[data-type="${pr}"]`}],toDOM:e=>["code",i.get(I$.key)(e),0],parseMarkdown:{match:e=>e.type===pr,runner:(e,t,n)=>{e.openNode(n);const r=t.value;r!==""&&e.next({type:"text",value:r}),e.closeNode()}},toMarkdown:{match:e=>e.type.name===pr,runner:(e,t)=>{e.openNode(pr,t.textContent).closeNode()}}})),X$="",B$="",CB=[pt(()=>new Yn(/\\\{$/,X$)),pt(()=>new Yn(/\uFF5B[^{]*(\})$/,B$))],V$=ue("toggleMdxInlineCommand",i=>()=>(e,t)=>{const{selection:n}=e,r=e.doc.cut(n.from,n.to).textContent,s=W$.type(i).create(null,r?e.schema.text(r):null);return t&&t(e.tr.replaceSelectionWith(s)),!0}),TB=[QB,I$,CB,W$,V$].flat(),Wi="textDirectiveName",q$=tt(Wi,()=>({"data-type":Wi})),MB=et(Wi,i=>({content:"text*",group:"inline",inline:!0,isolating:!0,code:!0,atom:!1,allowGapCursor:!0,attrs:{name:{default:"nil"}},parseDOM:[{tag:`span[data-type="${Wi}"]`}],toDOM:e=>["span",i.get(q$.key)(e),0],parseMarkdown:{match:e=>e.type===Wi,runner:(e,t,n)=>{const{name:r}=t;e.openNode(n,{name:r}).next({type:"text",value:r}).closeNode()}},toMarkdown:{match:e=>e.type.name===Wi,runner:()=>{}}})),mr="textDirective",L$=tt(mr,()=>({"data-type":mr})),z$=et(mr,i=>({content:`${Wi} text*`,group:"inline",inline:!0,isolating:!0,atom:!1,allowGapCursor:!0,parseDOM:[{tag:`span[data-type="${mr}"]`}],toDOM:e=>["span",i.get(L$.key)(e),0],parseMarkdown:{match:e=>e.type===mr,runner:(e,t,n)=>{const{name:r}=t;e.openNode(n).next({type:Wi,name:r}).next(t.children).closeNode()}},toMarkdown:{match:e=>e.type.name===mr,runner:(e,t)=>{const n=t.firstChild;n&&e.openNode(mr,void 0,{name:n.textContent.replace(/\W+/g,"")}).next(t.content).closeNode()}}}));function AB(i,e,t,n){const{from:r,to:s}=n??e.selection,o=e.tr.replaceRangeWith(r,s,z$.type(i).create({name:t}));return o.setSelection(new Et(o.doc.resolve(r)))}const ZB=ue("insertTextDirective",i=>(e={})=>(t,n)=>{const r=AB(i,t,e.name);return r?(n&&n(r),!0):!1}),RB=[q$,MB,L$,z$,ZB].flat(),EB=ui("remarkSqueezeParagraphs",()=>hB),NB=ui("remarkReplaceEscapedBraces",()=>()=>i=>{Lr(i,e=>e.type==="text",e=>{const t=e;t.value=t.value.replace(/\{/g,X$).replace(/\}/g,B$)})}),DB=[EB,NB].flat(),Y$=[PB,TB,RB,DB].flat(),IB=["textContent"],WB=Dt({__name:"ResizableInput",props:{block:{type:Boolean},value:{},placeholder:{}},emits:["update:value"],setup(i,{emit:e}){J$(a=>({"497750b8":l.value}));const t=i,n=e,r=t.value??"",s=zt(r);function o(a){const h=a.target;if(h){let c=h==null?void 0:h.innerText;c.includes(`
`)&&(c=c.replace(/\n/g,""),h.innerText=c),s.value=c,n("update:value",c)}}const l=ps(()=>JSON.stringify(t.placeholder??""));return(a,h)=>(an(),ri("div",{class:"resizable-input not-prose",contenteditable:"false",style:eP({display:a.block?"block":"inline"}),onBlur:o},[pe("div",{class:Yl(["not-prose",{placeholding:s.value===""}]),contenteditable:"true",onInput:o,textContent:Rh(de(r))},null,42,IB)],36))}}),XB=(i,e)=>{const t=i.__vccOpts||i;for(const[n,r]of e)t[n]=r;return t},j$=XB(WB,[["__scopeId","data-v-214c62d0"]]),BB={class:"directive"},VB=Dt({__name:"DirectiveView",setup(i){const{contentRef:e,node:t,selected:n,setAttrs:r}=Wp(),s=ps(()=>t.value.attrs.name??"");function o(l){r({name:l})}return(l,a)=>(an(),ri("div",BB,[ct(j$,{value:s.value,class:"not-prose",placeholder:"macro name","onUpdate:value":o},null,8,["value"]),pe("div",{ref:de(e),class:Yl(["container",{selected:de(n)}])},null,2)]))}}),qB=["href"],LB=Dt({__name:"HeadingView",setup(i){const{contentRef:e,node:t,selected:n}=Wp(),r=ps(()=>Math.max(1,Math.min(6,t.value.attrs.level??1))),s=ps(()=>sP(t.value.textContent)),o=ps(()=>`#${s.value}`),l=zt(0);function a(){navigator.clipboard.writeText(o.value),l.value+=1,setTimeout(()=>{l.value-=1},1e3)}return(h,c)=>(an(),ri(hp,null,[(an(),v1(K$(`h${r.value}`),{id:s.value,class:"heading"},{default:xu(()=>[pe("span",{ref:de(e),class:Yl({selected:de(n)})},null,2),pe("a",{class:"show-anchor not-prose",contenteditable:"false",href:o.value},Rh(s.value),9,qB)]),_:1},8,["id"])),pe("button",{title:"Copy the anchor",onClick:a},Rh(l.value>0?"":""),1)],64))}}),zB={class:"paragraph"},YB={key:0},jB=["href"],_B=Dt({__name:"ParagraphView",setup(i){const{contentRef:e,getPos:t,node:n,selected:r,view:s}=Wp(),[,o]=MM();function l(d,p){return!!(d!=null&&d.isText&&d.marks.length===1&&d.marks[0].type.name===p)}function a(d){const p=d.childCount;return p===0?"normal":p===1&&l(d.child(0),"link")?"link":l(d.child(0),"inlineCode")?p===1?"code":"conditional":"normal"}function h(d){var p,m,g;const y=(g=(m=(p=d.firstChild)==null?void 0:p.marks[0])==null?void 0:m.attrs)==null?void 0:g.href;return typeof y=="string"?y:"#"}const c=zt("normal"),f=zt("");nn(()=>n.value,d=>{c.value=a(d),f.value=h(d)});function u(d){const p=o();f.value=d,p==null||p.action(m=>{const g=t();if(g){const{state:y}=s,{tr:k}=y;s.dispatch(y.tr.setSelection(new Et(k.doc.resolve(g+1)))),m.get(re).call(Dm.key,{url:d})}})}return(d,p)=>(an(),ri("div",zB,[pe("div",{ref:de(e),class:Yl({selected:de(r),link:c.value==="link",conditional:c.value==="conditional",code:c.value==="code"})},null,2),c.value==="link"?(an(),ri("span",YB,[ct(j$,{class:"not-prose",placeholder:"link",value:f.value,"onUpdate:value":u},null,8,["value"])])):Eh("",!0),c.value==="link"?(an(),ri("a",{key:1,href:f.value,contenteditable:"false"},"",8,jB)):Eh("",!0)]))}}),FB=pt(()=>new Yn(/\[\]$/,"[]"));function UB(i){function e(t,n){return nM(t.node,()=>i({component:n,stopEvent(r){const s=r.target;return(s==null?void 0:s.closest(".not-prose"))!==null}}))}return[e(wg,VB),e(nr,LB),e(mi,_B),FB].flat()}const GB={class:"brocatel-editor"},HB={key:0,class:"milkdown-menu"},KB=["checked"],JB={class:"milkdown-buttons"},eV=pe("i",null,"Italics",-1),tV=[eV],nV=pe("b",null,"Bold",-1),iV=[nV],rV=pe("b",null,"#",-1),sV=pe("u",null,"Link",-1),oV=[sV],lV=pe("b",null,"-",-1),aV=pe("code",null,"`Code`",-1),hV=[aV],cV=pe("code",null,"{Expr}",-1),fV=[cV],uV=pe("b",null,":::",-1),dV=Dt({__name:"EditorInner",props:{modelValue:{},menu:{type:Boolean},nord:{type:Boolean},linkAutoComplete:{type:Boolean},plugins:{},configs:{},plainText:{type:Boolean},plainTextCheckbox:{type:Boolean},darkMode:{type:Boolean},diagnostics:{},prompt:{type:Function}},emits:["update:modelValue","update:plainText"],setup(i,{emit:e}){const t=i,n=zt(t.plainText??!1);nn(()=>t.plainText,d=>{d!==void 0&&(n.value=d)});const r=e,s=zt(t.modelValue);function o(d){let p=0,m=d.line-1;for(;m>0;)p=s.value.indexOf(`
`,p+1),m-=1;return p+1+d.column-1}const l=zt([]);Xi("headings",l);const a=IM(),{get:h}=TM(d=>{let p=GT.make().config(m=>{m.set(ch,d),m.set(oh,s.value),m.get(lp).markdownUpdated((g,y)=>{s.value!==y&&(s.value=y,r("update:modelValue",y),l.value=Array.from(d.getElementsByClassName("heading")).filter(k=>k.id).map(k=>k.id))})});return t.nord&&(p=p.config(lB)),t.configs.forEach(m=>{p=p.config(m)}),p=p.use(sB).use(Jv).use(UB(a)).use(Y$),p=p.use(t.plugins),p});function c(d){var p;(p=h())==null||p.action(rM(d,!0))}nn(()=>t.modelValue,d=>{d!==s.value&&(r("update:plainText",!0),n.value=!0,H$(()=>{s.value=d,c(d)}))});function f(d,p){var m;return(m=h())==null?void 0:m.action(iM(d.key,p))}function u(){try{f(bc)}catch{const d=t.prompt("Link Url");d&&d!==""&&f(bc,{href:d})}}return(d,p)=>(an(),ri("div",GB,[t.menu?(an(),ri("div",HB,[d.plainTextCheckbox?(an(),ri("label",{key:0,class:Yl({error:d.diagnostics.length!==0})},[pe("input",{type:"checkbox",checked:n.value,onChange:p[0]||(p[0]=m=>{n.value=m.target.checked,r("update:plainText",n.value),n.value||c(s.value)})},null,40,KB),ca(" "+Rh(d.diagnostics.length===0?"":""),1)],2)):Eh("",!0),lf(pe("div",JB,[pe("button",{onClick:p[1]||(p[1]=m=>f(de(Jc)))},tV),pe("button",{onClick:p[2]||(p[2]=m=>f(de(ef)))},iV),pe("button",{onClick:p[3]||(p[3]=m=>f(de(ei)))},[rV,ca("Heading ")]),pe("button",{onClick:u},oV),pe("button",{onClick:p[4]||(p[4]=m=>f(de(rf)))},[lV,ca("Choices ")]),pe("button",{onClick:p[5]||(p[5]=m=>f(de(tf)))},hV),pe("button",{onClick:p[6]||(p[6]=m=>f(de(V$)))},fV),pe("button",{onClick:p[7]||(p[7]=m=>f(de(D$)))},[uV,ca("Directive ")])],512),[[af,!n.value]])])):Eh("",!0),lf(pe("div",null,[ct(de(rI),{extensions:[de(HX)({defaultCodeLanguage:de(im).define(de(OB))}),de(XD)(()=>d.diagnostics.map(m=>({message:m.message,severity:"error",from:o(m.start),to:o(m.end??m.start)}))),de(FD)(),de(M).lineWrapping,d.darkMode?de(c5):{extension:[]}],"indent-with-tab":!0,"tab-size":4,"model-value":s.value,"onUpdate:modelValue":p[8]||(p[8]=m=>{s.value=m,r("update:modelValue",m)})},null,8,["extensions","model-value"])],512),[[af,n.value]]),lf(ct(de(QM),null,null,512),[[af,!n.value]])]))}}),pV=Dt({__name:"BrocatelEditor",props:{modelValue:{default:""},menu:{type:Boolean,default:!0},nord:{type:Boolean,default:!0},plugins:{default:()=>[mb,mM,$M].flat()},configs:{default:()=>[]},linkAutoComplete:{type:Boolean,default:!0},plainText:{type:Boolean},diagnostics:{default:()=>[]},darkMode:{type:Boolean,default:!1},prompt:{type:Function,default:i=>window.prompt(i)}},emits:["update:modelValue","update:plainText"],setup(i,{emit:e}){const t=e;return(n,r)=>(an(),v1(de(CM),null,{default:xu(()=>[ct(de(UM),null,{default:xu(()=>[ct(dV,{"model-value":n.modelValue,menu:n.menu,nord:n.nord,"link-auto-complete":n.linkAutoComplete,plugins:n.plugins,configs:n.configs,prompt:n.prompt,"dark-mode":n.darkMode,"plain-text-checkbox":n.plainText!==void 0,"plain-text":n.plainText??!1,diagnostics:n.diagnostics??!1,"onUpdate:modelValue":r[0]||(r[0]=s=>t("update:modelValue",s)),"onUpdate:plainText":r[1]||(r[1]=s=>t("update:plainText",s))},null,8,["model-value","menu","nord","link-auto-complete","plugins","configs","prompt","dark-mode","plain-text-checkbox","plain-text","diagnostics"])]),_:1})]),_:1}))}}),eq=pV,tq=Y$;export{eq as BrocatelEditor,PB as directivePlugin,TB as mdxPlugin,DB as normalizationPlugin,tq as plugins,UB as useBetterViewPlugins};
